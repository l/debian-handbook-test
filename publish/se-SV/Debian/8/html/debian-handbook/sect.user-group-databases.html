<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">8.4. User and Group Databases</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-se-SV-1.0-1" /><meta
        name="keywords"
        content="Configuration, Localization, Locales, Network, Name resolution, Users, Groups, Accounts, Command-line interpreter, Shell, Printing, Bootloader, Kernel compiling" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="basic-configuration.html"
        title="Chapter 8. Basic Configuration: Network, Accounts, Printing..." /><link
        rel="prev"
        href="sect.hostname-name-service.html"
        title="8.3. Setting the Hostname and Configuring the Name Service" /><link
        rel="next"
        href="sect.creating-accounts.html"
        title="8.5. Creating Accounts" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/se-SV/stable/sect.user-group-databases.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.hostname-name-service.html"><strong>Prev</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.creating-accounts.html"><strong>Next</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.user-group-databases"></a>8.4. User and Group Databases</h2></div></div></div><a
          id="id-1.11.8.2"
          class="indexterm"></a><a
          id="id-1.11.8.3"
          class="indexterm"></a><a
          id="id-1.11.8.4"
          class="indexterm"></a><a
          id="id-1.11.8.5"
          class="indexterm"></a><div
          class="para">
			The list of users is usually stored in the <code
            class="filename">/etc/passwd</code> file, while the <code
            class="filename">/etc/shadow</code> file stores encrypted passwords. Both are text files, in a relatively simple format, which can be read and modified with a text editor. Each user is listed there on a line with several fields separated with a colon (“<code
            class="literal">:</code>”).
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>NOTE</em></span> Editing system files</strong></p></div></div></div><div
            class="para">
			The system files mentioned in this chapter are all plain text files, and can be edited with a text editor. Considering their importance to core system functionality, it is always a good idea to take extra precautions when editing system files. First, always make a copy or backup of a system file before opening or altering it. Second, on servers or machines where more than one person could potentially access the same file at the same time, take extra steps to guard against file corruption.
		</div><div
            class="para">
			For this purpose, it is enough to use the <code
              class="command">vipw</code> command to edit the <code
              class="filename">/etc/passwd</code> file, or <code
              class="command">vigr</code> to edit <code
              class="filename">/etc/group</code>. These commands lock the file in question prior to running the text editor, (<code
              class="command">vi</code> by default, unless the <code
              class="varname">EDITOR</code> environment variable has been altered). The <code
              class="literal">-s</code> option in these commands allows editing the corresponding <span
              class="foreignphrase"><em
                class="foreignphrase">shadow</em></span> file.
		</div></div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>BACK TO BASICS</em></span> Crypt, a one-way function</strong></p></div></div></div><a
            id="id-1.11.8.8.2"
            class="indexterm"></a><div
            class="para">
			<code
              class="command">crypt</code> is a one-way function that transforms a string (<code
              class="varname">A</code>) into another string (<code
              class="varname">B</code>) in a way that <code
              class="varname">A</code> cannot be derived from <code
              class="varname">B</code>. The only way to identify <code
              class="varname">A</code> is to test all possible values, checking each one to determine if transformation by the function will produce <code
              class="varname">B</code> or not. It uses up to 8 characters as input (string <code
              class="varname">A</code>) and generates a string of 13, printable, ASCII characters (string <code
              class="varname">B</code>).
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-passwd"></a>8.4.1. User List: <code
                    class="filename">/etc/passwd</code></h3></div></div></div><div
            class="para">
				Here is the list of fields in the <code
              class="filename">/etc/passwd</code> file:
			</div><a
            id="id-1.11.8.9.3"
            class="indexterm"></a><a
            id="id-1.11.8.9.4"
            class="indexterm"></a><a
            id="id-1.11.8.9.5"
            class="indexterm"></a><a
            id="id-1.11.8.9.6"
            class="indexterm"></a><a
            id="id-1.11.8.9.7"
            class="indexterm"></a><a
            id="id-1.11.8.9.8"
            class="indexterm"></a><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						login, for example <code
                    class="literal">rhertzog</code>;
					</div></li><li
                class="listitem"><div
                  class="para">
						password: this is a password encrypted by a one-way function (<code
                    class="command">crypt</code>), relying on <code
                    class="literal">DES</code>, <code
                    class="literal">MD5</code>, <code
                    class="literal">SHA-256</code> or <code
                    class="literal">SHA-512</code>. The special value “<code
                    class="literal">x</code>” indicates that the encrypted password is stored in <code
                    class="filename">/etc/shadow</code>;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">uid</code>: unique number identifying each user;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">gid</code>: unique number for the user's main group (Debian creates a specific group for each user by default);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">GECOS</code>: data field usually containing the user's full name;
					</div></li><li
                class="listitem"><div
                  class="para">
						login directory, assigned to the user for storage of their personal files (the environment variable <code
                    class="varname">$HOME</code> generally points here);
					</div></li><li
                class="listitem"><div
                  class="para">
						program to execute upon login. This is usually a command interpreter (shell), giving the user free rein. If you specify <code
                    class="command">/bin/false</code> (which does nothing and returns control immediately), the user cannot login.
					</div></li></ul></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>BACK TO BASICS</em></span> Unix group</strong></p></div></div></div><a
              id="id-1.11.8.9.10.2"
              class="indexterm"></a><div
              class="para">
				A Unix group is an entity including several users so that they can easily share files using the integrated permission system (by benefiting from the same rights). You can also restrict use of certain programs to a specific group.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-shadow"></a>8.4.2. The Hidden and Encrypted Password File: <code
                    class="filename">/etc/shadow</code></h3></div></div></div><a
            id="id-1.11.8.10.2"
            class="indexterm"></a><a
            id="id-1.11.8.10.3"
            class="indexterm"></a><div
            class="para">
				The <code
              class="filename">/etc/shadow</code> file contains the following fields:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						login;
					</div></li><li
                class="listitem"><div
                  class="para">
						encrypted password;
					</div></li><li
                class="listitem"><div
                  class="para">
						several fields managing password expiration.
					</div></li></ul></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DOCUMENTATION</em></span> <code
                        class="filename">/etc/passwd</code>, <code
                        class="filename">/etc/shadow</code> and <code
                        class="filename">/etc/group</code> file formats</strong></p></div></div></div><div
              class="para">
				These formats are documented in the following man pages: <span
                class="citerefentry"><span
                  class="refentrytitle">passwd</span>(5)</span>, <span
                class="citerefentry"><span
                  class="refentrytitle">shadow</span>(5)</span>, and <span
                class="citerefentry"><span
                  class="refentrytitle">group</span>(5)</span>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SECURITY</em></span> <code
                        class="filename">/etc/shadow</code> file security</strong></p></div></div></div><div
              class="para">
				<code
                class="filename">/etc/shadow</code>, unlike its alter-ego, <code
                class="filename">/etc/passwd</code>, cannot be read by regular users. Any encrypted password stored in <code
                class="filename">/etc/passwd</code> is readable by anybody; a cracker could try to “break” (or reveal) a password by one of several “brute force” methods which, simply put, guess at commonly used combinations of characters. This attack — called a "dictionary attack" — is no longer possible on systems using <code
                class="filename">/etc/shadow</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.account-modification"></a>8.4.3. Modifying an Existing Account or Password</h3></div></div></div><a
            id="id-1.11.8.11.2"
            class="indexterm"></a><a
            id="id-1.11.8.11.3"
            class="indexterm"></a><a
            id="id-1.11.8.11.4"
            class="indexterm"></a><a
            id="id-1.11.8.11.5"
            class="indexterm"></a><a
            id="id-1.11.8.11.6"
            class="indexterm"></a><div
            class="para">
				The following commands allow modification of the information stored in specific fields of the user databases: <code
              class="command">passwd</code> permits a regular user to change their password, which in turn, updates the <code
              class="filename">/etc/shadow</code> file; <code
              class="command">chfn</code> (CHange Full Name), reserved for the super-user (root), modifies the <code
              class="literal">GECOS</code> field. <code
              class="command">chsh</code> (CHange SHell) allows the user to change their login shell, however available choices will be limited to those listed in <code
              class="filename">/etc/shells</code>; the administrator, on the other hand, is not bound by this restriction and can set the shell to any program of their choosing.
			</div><div
            class="para">
				Finally, the <code
              class="command">chage</code> (CHange AGE) command allows the administrator to change the password expiration settings (the <code
              class="literal">-l <em
                class="replaceable">user</em></code> option will list the current settings). You can also force the expiration of a password using the <code
              class="command">passwd -e <em
                class="replaceable">user</em></code> command, which will require the user to change their password the next time they log in.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.disabling-account"></a>8.4.4. Disabling an Account</h3></div></div></div><a
            id="id-1.11.8.12.2"
            class="indexterm"></a><a
            id="id-1.11.8.12.3"
            class="indexterm"></a><div
            class="para">
				You may find yourself needing to “disable an account” (lock out a user), as a disciplinary measure, for the purposes of an investigation, or simply in the event of a prolonged or definitive absence of a user. A disabled account means the user cannot login or gain access to the machine. The account remains intact on the machine and no files or data are deleted; it is simply inaccessible. This is accomplished by using the command <code
              class="command">passwd -l <em
                class="replaceable">user</em></code> (lock). Re-enabling the account is done in similar fashion, with the <code
              class="literal">-u</code> option (unlock).
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.intro-nss"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>GOING FURTHER</em></span> NSS and system databases</strong></p></div></div></div><a
              id="id-1.11.8.12.5.2"
              class="indexterm"></a><a
              id="id-1.11.8.12.5.3"
              class="indexterm"></a><div
              class="para">
				Instead of using the usual files to manage lists of users and groups, you could use other types of databases, such as LDAP or <code
                class="command">db</code>, by using an appropriate NSS (Name Service Switch) module. The modules used are listed in the <code
                class="filename">/etc/nsswitch.conf</code> file, under the <code
                class="literal">passwd</code>, <code
                class="literal">shadow</code> and <code
                class="literal">group</code> entries. See <a
                class="xref"
                href="sect.ldap-directory.html#sect.config-nss">Section 11.7.3.1, “Configuring NSS”</a> for a specific example of the use of an NSS module by LDAP.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-group"></a>8.4.5. Group List: <code
                    class="filename">/etc/group</code></h3></div></div></div><div
            class="para">
				Groups are listed in the <code
              class="filename">/etc/group</code> file, a simple textual database in a format similar to that of the <code
              class="filename">/etc/passwd</code> file, with the following fields:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						group name;
					</div></li><li
                class="listitem"><div
                  class="para">
						password (optional): This is only used to join a group when one is not a usual member (with the <code
                    class="command">newgrp</code> or <code
                    class="command">sg</code> commands, see sidebar <a
                    class="xref"
                    href="sect.user-group-databases.html#sidebar.working-with-several-groups"><span
                      class="emphasis"><em>BACK TO BASICS</em></span> Working with several groups</a>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">gid</code>: unique group identification number;
					</div></li><li
                class="listitem"><div
                  class="para">
						list of members: list of names of users who are members of the group, separated by commas.
					</div></li></ul></div><div
            class="para">
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.working-with-several-groups"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>BACK TO BASICS</em></span> Working with several groups</strong></p></div></div></div><a
              id="id-1.11.8.13.5.2"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.3"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.4"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.5"
              class="indexterm"></a><div
              class="para">
				Each user may be a member of many groups; one of them is their “main group”. A user's main group is, by default, created during initial user configuration. By default, each file that a user creates belongs to them, as well as to their main group. This is not always desirable; for example, when the user needs to work in a directory shared by a group other than their main group. In this case, the user needs to change their main group using one of the following commands: <code
                class="command">newgrp</code>, which starts a new shell, or <code
                class="command">sg</code>, which simply executes a command using the supplied alternate group. These commands also allow the user to join a group to which they do not belong. If the group is password protected, they will need to supply the appropriate password before the command is executed.
			</div><div
              class="para">
				Alternatively, the user can set the <code
                class="literal">setgid</code> bit on the directory, which causes files created in that directory to automatically belong to the correct group. For more details, see sidebar <a
                class="xref"
                href="sect.rights-management.html#sidebar.setgid-dir"><span
                  class="emphasis"><em>SECURITY</em></span> <code
                  class="literal">setgid</code> directory and <span
                  class="emphasis"><em>sticky bit</em></span></a>.
			</div><div
              class="para">
				The <code
                class="command">id</code> command displays the current state of a user, with their personal identifier (<code
                class="varname">uid</code> variable), current main group (<code
                class="varname">gid</code> variable), and the list of groups to which they belong (<code
                class="varname">groups</code> variable).
			</div></div><a
            id="id-1.11.8.13.6"
            class="indexterm"></a><a
            id="id-1.11.8.13.7"
            class="indexterm"></a><div
            class="para">
				The <code
              class="command">addgroup</code> and <code
              class="command">delgroup</code> commands add or delete a group, respectively. The <code
              class="command">groupmod</code> command modifies a group's information (its <code
              class="literal">gid</code> or identifier). The command <code
              class="command">passwd -g <em
                class="replaceable">group</em></code> changes the password for the group, while the <code
              class="command">passwd -r -g <em
                class="replaceable">group</em></code> command deletes it.
			</div><a
            id="id-1.11.8.13.9"
            class="indexterm"></a><a
            id="id-1.11.8.13.10"
            class="indexterm"></a><a
            id="id-1.11.8.13.11"
            class="indexterm"></a><a
            id="id-1.11.8.13.12"
            class="indexterm"></a><a
            id="id-1.11.8.13.13"
            class="indexterm"></a><a
            id="id-1.11.8.13.14"
            class="indexterm"></a><a
            id="id-1.11.8.13.15"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TIP</em></span> <code
                        class="command">getent</code></strong></p></div></div></div><a
              id="id-1.11.8.13.16.2"
              class="indexterm"></a><div
              class="para">
				The <code
                class="command">getent</code> (get entries) command checks the system databases the standard way, using the appropriate library functions, which in turn call the NSS modules configured in the <code
                class="filename">/etc/nsswitch.conf</code> file. The command takes one or two arguments: the name of the database to check, and a possible search key. Thus, the command <code
                class="command">getent passwd rhertzog</code> will give the information from the user database regarding the user <code
                class="literal">rhertzog</code>.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.hostname-name-service.html"><strong>Prev</strong>8.3. Setting the Hostname and Configuring the Nam...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Up</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Home</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.creating-accounts.html"><strong>Next</strong>8.5. Creating Accounts</a></li></ul></body></html>
