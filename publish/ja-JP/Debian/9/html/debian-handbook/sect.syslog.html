<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">9.5. syslog システムイベント</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-ja-JP-1.0-1" /><meta
        name="keywords"
        content="システム起動, 初期化スクリプト, SSH, Telnet, 権限, パーミッション, 管理, inetd, cron, バックアップ, ホットプラグ, PCMCIA, APM, ACPI" /><link
        rel="home"
        href="index.html"
        title="Debian 管理者ハンドブック" /><link
        rel="up"
        href="unix-services.html"
        title="第 9 章 Unix サービス" /><link
        rel="prev"
        href="sect.administration-interfaces.html"
        title="9.4. 管理インターフェース" /><link
        rel="next"
        href="sect.inetd.html"
        title="9.6. inetd スーパーサーバ" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/ja-JP/stable/sect.syslog.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.administration-interfaces.html"><strong>戻る</strong></a></li><li
          class="home">Debian 管理者ハンドブック</li><li
          class="next"><a
            accesskey="n"
            href="sect.inetd.html"><strong>次へ</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.syslog"></a>9.5. <code
                  class="command">syslog</code> システムイベント</h2></div></div></div><a
          id="id-1.12.8.2"
          class="indexterm"></a><a
          id="id-1.12.8.3"
          class="indexterm"></a><a
          id="id-1.12.8.4"
          class="indexterm"></a><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.syslog-principe"></a>9.5.1. 原理とメカニズム</h3></div></div></div><div
            class="para">
				<code
              class="command">rsyslogd</code> デーモンはアプリケーションおよびカーネルからのサービスメッセージの収集を担当し、サービスメッセージをログファイルに配送します (通常 <code
              class="filename">/var/log/</code> ディレクトリに保存します)。<code
              class="command">rsyslogd</code> デーモンは <code
              class="filename">/etc/rsyslog.conf</code> ファイルの設定に従います。
			</div><div
            class="para">
				各ログメッセージはアプリケーションサブシステム (文書中では「facility」と呼ばれます) に関連付けられます。
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">auth</code> と <code
                    class="literal">authpriv</code>。認証に関連するメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">cron</code>。タスクスケジューリングサービスである <code
                    class="command">cron</code> と <code
                    class="command">atd</code> から受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">daemon</code>。特に分類されていないデーモン (DNS、NTP など) から受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ftp</code>。FTP サーバから受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">kern</code>。カーネルから受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">lpr</code>。印刷サブシステムから受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">mail</code>。電子メールサブシステムから受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">news</code>。Usenet サブシステム (特にニュースグループを管理する NNTP (Network News Transfer Protocol) サーバ) から受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">syslog</code>。<code
                    class="command">syslogd</code> サーバ (自分) から受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">user</code>。ユーザメッセージ (一般的なメッセージ) に関連するメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">uucp</code>。UUCP (Unix to Unix Copy Program、とりわけ昔は電子メールメッセージの配送に使われていた古いプロトコル) サーバから受け取ったメッセージです。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">local0</code> から <code
                    class="literal">local7</code>。ローカル利用向けに予約されているサブシステムから受け取ったメッセージです。
					</div></li></ul></div><div
            class="para">
				さらに各メッセージは優先度と関連付けられます。以下は優先度の高い順に挙げたリストです。
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">emerg</code>。システムが「助けてください!」と言っていることを示しています。これは非常事態で、おそらくシステムが不安定になっていることを示しています。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">alert</code>。システムが大至急対応を必要としており、遅れると危険な状態になることを示しています。この場合、すぐに何らかの措置を講じてください。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">crit</code>。システムが危機的状態に陥っていることを示しています。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">err</code>。システムにエラーが発生していることを示しています。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">warn</code>。システムが警告 (潜在的エラー) を発していることを示しています。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">notice</code>。システムが正常な状態とは言うものの、重要なメッセージを発していることを示しています。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">info</code>。システムが有益なメッセージを発していることを示しています。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">debug</code>。システムがデバッグメッセージを発していることを示しています。
					</div></li></ul></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.syslog-config"></a>9.5.2. 設定ファイル</h3></div></div></div><div
            class="para">
				<code
              class="filename">/etc/rsyslog.conf</code> ファイルの構文は <span
              class="citerefentry"><span
                class="refentrytitle">rsyslog.conf</span>(5)</span> マニュアルページで詳しく説明されています。しかし、<span
              class="pkg pkg">rsyslog-doc</span> パッケージから提供される HTML 文書 (<code
              class="filename">/usr/share/doc/rsyslog-doc/html/index.html</code>) も利用できます。全般的な原則は「セレクタ」と「アクション」の組を書くことです。セレクタはすべての関連するメッセージを定義し、アクションはそれらのメッセージをどのように取り扱うかを定義します。
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.syslog-selector-syntax"></a>9.5.2.1. セレクタの構文</h4></div></div></div><div
              class="para">
					セレクタは <code
                class="literal"><em
                  class="replaceable">subsystem</em>.<em
                  class="replaceable">priority</em></code> の組からなるセミコロン区切りリストです (たとえば <code
                class="literal">auth.notice;mail.info</code> などです)。アスタリスクはすべてのサブシステムまたはすべての優先度を表します (たとえば <code
                class="literal">*.alert</code>、<code
                class="literal">mail.*</code> などのように使います)。コンマで区切れば複数のサブシステムをグループ化することが可能です (たとえば <code
                class="literal">auth,mail.info</code> などのように使います)。優先度は指定した優先度と同じかより高い優先度を持つメッセージを意味しています。このため <code
                class="literal">auth.alert</code> は <code
                class="literal">alert</code> および <code
                class="literal">emerg</code> 優先度を持つ <code
                class="literal">auth</code> サブシステムメッセージを表現します。優先度の前に感嘆符 (!) を付けると否定を表します。言い換えれば、その優先度より低い優先度です。このため <code
                class="literal">auth.!notice</code> は <code
                class="literal">auth</code> サブシステムメッセージの内 <code
                class="literal">info</code> および <code
                class="literal">debug</code> 優先度を持つメッセージを表現します。優先度の前に等号 (=) を付けると、指定した優先度だけを表します (<code
                class="literal">auth.=notice</code> は <code
                class="literal">auth</code> サブシステムメッセージの内 <code
                class="literal">notice</code> 優先度を持つメッセージを表現します)。
				</div><div
              class="para">
					セレクタリスト内の各要素は前の要素を上書きします。このため、セレクタリストからある組を制限したり、特定の要素だけを除外することが可能です。たとえば、<code
                class="literal">kern.info;kern.!err</code> はカーネルから受け取った <code
                class="literal">info</code> 以上 <code
                class="literal">warn</code> 以下の優先度を持つメッセージを意味します。<code
                class="literal">none</code> 優先度は空の組を意味し (優先度を指定しないことを意味し)、あるサブシステムだけをメッセージの組から除外するのに役立つかもしれません。そんなわけで、<code
                class="literal">*.crit;kern.none</code> はカーネルから受け取った <code
                class="literal">crit</code> 以上の優先度を持つメッセージを意味します。
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.syslog-action-syntax"></a>9.5.2.2. アクションの構文</h4></div></div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>BACK TO BASICS</em></span> 名前付きパイプ、永続的なパイプ</strong></p></div></div></div><a
                id="id-1.12.8.6.4.2.2"
                class="indexterm"></a><a
                id="id-1.12.8.6.4.2.3"
                class="indexterm"></a><div
                class="para">
					名前付きパイプは特殊なファイル型で、古典的なパイプ (コマンドラインで「|」文字を使って表すパイプ) のように振る舞いますが、ファイルを経由します。名前付きパイプのメカニズムは 2 つの別々のプロセスを関連付けることが可能という利点を持っています。別のプロセスが名前付きパイプに書き込まれるデータを読む準備を整えるまで、名前付きパイプに書き込むプロセスはブロックされます。読み込み側のプロセスが書き込み側のプロセスの書き込んだデータを読み込むと、書き込み側のプロセスのブロックが解除されます。
				</div><div
                class="para">
					名前付きパイプは <code
                  class="command">mkfifo</code> コマンドで作成します。
				</div></div><div
              class="para">
					以下に指定できるさまざまなアクションを挙げます。
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							ファイルにメッセージを追記します (たとえば <code
                      class="filename">/var/log/messages</code> などのように指定します)。
						</div></li><li
                  class="listitem"><div
                    class="para">
							メッセージをリモートの <code
                      class="command">syslog</code> サーバに送信します (たとえば <code
                      class="literal">@log.falcot.com</code> などのように指定します)。
						</div></li><li
                  class="listitem"><div
                    class="para">
							既存の名前付きパイプにメッセージを送信します (たとえば <code
                      class="literal">|/dev/xconsole</code> などのように指定します)。
						</div></li><li
                  class="listitem"><div
                    class="para">
							ログイン中の個人または複数人のユーザにメッセージを送信します (たとえば <code
                      class="literal">root,rhertzog</code> などのように指定します)。
						</div></li><li
                  class="listitem"><div
                    class="para">
							ログイン中の全ユーザにメッセージを送信します (たとえば <code
                      class="literal">*</code> などのように指定します)。
						</div></li><li
                  class="listitem"><div
                    class="para">
							テキストコンソールにメッセージを書き込みます (たとえば <code
                      class="literal">/dev/tty8</code> などのように指定します)。
						</div></li></ul></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>SECURITY</em></span> ログの転送</strong></p></div></div></div><a
                id="id-1.12.8.6.4.5.2"
                class="indexterm"></a><div
                class="para">
					最重要のログを別のマシン (ログ記録専用マシン) に記録することは良い考えです。なぜなら、そうすることで侵入者に不正侵入の形跡を削除されないようにすることが可能だからです (形跡を削除するにはもちろん、ログ記録専用の別のマシンに不正アクセスするしかありません)。さらに、深刻な問題 (カーネルクラッシュなど) が起きた場合に、別のマシンにログを記録しておけば、クラッシュを引き起こす一連の出来事を決定できる可能性を増やすことが可能です。
				</div><div
                class="para">
					他のマシンから送信されたログメッセージを受け入れるには、<span
                  class="emphasis"><em>rsyslog</em></span> を再設定しなければいけません。具体的に言えば、<code
                  class="filename">/etc/rsyslog.conf</code> の中ですぐに利用できる状態になっているエントリ (<code
                  class="literal">$ModLoad imudp</code> と <code
                  class="literal">$UDPServerRun 514</code>) を有効化するだけで十分です。
				</div></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.administration-interfaces.html"><strong>戻る</strong>9.4. 管理インターフェース</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上に戻る</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>ホーム</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.inetd.html"><strong>次へ</strong>9.6. inetd スーパーサーバ</a></li></ul></body></html>
