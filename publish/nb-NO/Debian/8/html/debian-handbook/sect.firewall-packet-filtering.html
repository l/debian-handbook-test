<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">14.2. Brannmur eller pakkefiltrering</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-nb-NO-1.0-1" /><meta
        name="keywords"
        content="Brannmur, Nettfilter, IDS/NIDS" /><link
        rel="home"
        href="index.html"
        title="Håndbok for Debian-administratoren" /><link
        rel="up"
        href="security.html"
        title="Kapittel 14. Sikkerhet" /><link
        rel="prev"
        href="security.html"
        title="Kapittel 14. Sikkerhet" /><link
        rel="next"
        href="sect.supervision.html"
        title="14.3. Overvåking: Forebygging, avdekking, avskrekking" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/nb-NO/stable/sect.firewall-packet-filtering.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="security.html"><strong>Forrige</strong></a></li><li
          class="home">Håndbok for Debian-administratoren</li><li
          class="next"><a
            accesskey="n"
            href="sect.supervision.html"><strong>Neste</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.firewall-packet-filtering"></a>14.2. Brannmur eller pakkefiltrering</h2></div></div></div><a
          id="id-1.17.5.2"
          class="indexterm"></a><a
          id="id-1.17.5.3"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>DET GRUNNLEGGENDE</em></span> Brannmur</strong></p></div></div></div><a
            id="id-1.17.5.4.2"
            class="indexterm"></a><div
            class="para">
			En <span
              class="emphasis"><em>brannmur</em></span> er et stykke datautstyr med maskinvare og/eller programvare som sorterer innkommende og utgående nettverkspakker (som kommer til eller fra et lokalt nettverk), og bare slipper gjennom de som samsvarer med visse forhåndsbestemte betingelser.
		</div></div><div
          class="para">
			En brannmur er en nettverksport for filtrering, og er bare effektiv på pakker som må gå gjennom den. Den kan derfor bare være effektiv når den eneste ruten for disse pakkene er gjennom brannmuren.
		</div><div
          class="para">
			Mangelen på et standard oppsett (og «prosess, ikke produkt»-mottoet) forklarer mangelen av en nøkkelferdig løsning. Det fins derimot verktøy som gjør det enklere å sette opp <span
            class="emphasis"><em>nettfilter</em></span>-brannmuren, med en grafisk representasjon av filterreglene. <code
            class="command">fwbuilder</code> er utvilsomt blant de beste av dem.
		</div><a
          id="id-1.17.5.7"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>SPESIFIKT TILFELLE</em></span> Lokal brannmur</strong></p></div></div></div><div
            class="para">
			En brannmur kan begrenses til en bestemt maskin (til forskjell fra et helt nettverk), i så fall for å filtrere eller begrense adgang til noen tjenester, eller muligens hindre utgående forbindelser fra ondsinnede programmer som brukeren kunne, med vilje eller ei, ha installert.
		</div></div><div
          class="para">
			Linux-kjernen inneholder <span
            class="emphasis"><em>nettfilter</em></span>-brannmuren. Den kan kontrolleres fra brukerrommet med kommandoene <code
            class="command">iptables</code> og <code
            class="command">ip6tables</code>. Forskjellen mellom disse er at den første betjener IPv4-nettverket, mens den siste betjener IPv6. Siden begge nettverksprotokollene sannsynligvis vil fortsette å eksistere i årevis, vil begge verktøyene måtte brukes i parallell.
		</div><a
          id="id-1.17.5.10"
          class="indexterm"></a><a
          id="id-1.17.5.11"
          class="indexterm"></a><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.netfilter"></a>14.2.1. Oppførselen til netfilter</h3></div></div></div><div
            class="para">
				<span
              class="emphasis"><em>nettfilter</em></span> bruker fire forskjellige tabeller for regler om tre typer pakkeoperasjoner:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">filter</code> for filterregler (akseptere, nekte, ignorere en pakke)
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">nat</code> for oversetting av kilde- eller destinasjonsadresser og porter på pakker;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">mangle</code> for andre endringer av IP-pakker (inkludert felt og opsjoner for ToS — <span
                    class="emphasis"><em>Type of Service</em></span>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">raw</code> tillater andre manuelle modifikasjoner av pakker før de når forbindelsessporingssystemet.
					</div></li></ul></div><div
            class="para">
				Hver tabell inneholder en liste av regler kalt <span
              class="emphasis"><em>kjeder</em></span>. Brannmuren bruker standardkjeder til å håndtere pakker basert på predefinerte betingelser. Administratoren kan lage andre kjeder, som bare vil bli brukt når den refereres til av noen av standardkjedene (direkte eller indirekte).
			</div><a
            id="id-1.17.5.12.5"
            class="indexterm"></a><a
            id="id-1.17.5.12.6"
            class="indexterm"></a><div
            class="para">
				<code
              class="literal">filter</code> tabellen har tre standardkjeder:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">INPUT</code>: gjelder pakker der destinasjon er brannmuren selv;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">OUTPUT</code>: gjelder pakker som er sendt ut fra brannmuren;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">FORWARD</code>: gjelder pakker i transitt gjennom brannmuren (som verken er kilden eller destinasjon deres).
					</div></li></ul></div><div
            class="para">
				Tabellen <code
              class="literal">nat</code> har også tre standardkjeder:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">PREROUTING</code>: å endre pakker så snart de ankommer;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">POSTROUTING</code>: å modifisere pakker når de er klare til utsendelse;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">OUTPUT</code>: å modifisere pakker som genereres av selve brannmuren.
					</div></li></ul></div><div
            class="figure"><a
              xmlns=""
              id="figure.chaines-netfilter"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/netfilter.png"
                  alt="Hvordan nettfilter-kjeder påkalles" /></div></div><p
              class="title"><strong>Figur 14.1. Hvordan <span
                  class="emphasis"><em>nettfilter</em></span>-kjeder påkalles</strong></p></div><div
            class="para">
				Hver kjede er en liste med regler; hver regel er et sett av betingelser og en handling som skal utføres når vilkårene er oppfylt. Ved behandling av en pakke, skanner brannmur den riktige kjeden, en regel etter den andre; når vilkårene for en regel er oppfylt, «hopper» det (derav <code
              class="literal">-j</code>-alternativet i kommandoene) til det angitte tiltak for å fortsette prosessen. De vanligste handlingene er standardisert, med foreliggende øremerkede handlinger. Å ta én av disse standardhandlingene forstyrrer prosessen for kjeden, fordi pakkens skjebne allerede er fastsatt (bortsett fra unntaket som er nevnt nedenfor):
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DET GRUNNLEGGENDE</em></span> ICMP</strong></p></div></div></div><div
              class="para">
				ICMP (<span
                class="emphasis"><em>Internet Control Message </em></span>Protocol) er protokollen som brukes til å overføre utfyllende informasjon om kommunikasjon. Den tillater å teste nettverkstilkobling med <code
                class="command">ping</code>-kommandoen (som sender et ICMP <span
                class="emphasis"><em>echo request </em></span>-budskap, som det er ment at mottakeren skal svare med et ICMP <span
                class="emphasis"><em>echo reply</em></span>-budskap). Det signaliserer at en brannmur avviser en pakke, indikerer at en mottaksbuffer er overfylt, foreslår en bedre rute for de neste pakkene i forbindelsen, og så videre. Denne protokollen er definert i flere RFC-dokumenter; de opprinnelige RFC777 og RFC792 ble snart fullført og utvidet. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc777.html">http://www.faqs.org/rfcs/rfc777.html</a></div> <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc792.html">http://www.faqs.org/rfcs/rfc792.html</a></div>
			</div><div
              class="para">
				For referanse: En mottaksbuffer er en liten minnesone som lagrer data fra den tiden den kommer fra nettverket, og til den tid kjernen håndterer den. Hvis denne sonen er full, kan nye data ikke mottas, og ICMP signaliserer problemet, slik at senderen kan bremse ned sin overføringshastighet (som ideelt sett bør nå en likevekt etter en tid).
			</div><a
              id="id-1.17.5.12.13.4"
              class="indexterm"></a><a
              id="id-1.17.5.12.13.5"
              class="indexterm"></a><a
              id="id-1.17.5.12.13.6"
              class="indexterm"></a><a
              id="id-1.17.5.12.13.7"
              class="indexterm"></a><a
              id="id-1.17.5.12.13.8"
              class="indexterm"></a><div
              class="para">
				Merk at selv om et IPv4-nettverk kan fungere uten ICMP, er ICMPv6 strengt nødvendig for et IPv6-nettverk, siden det kombinerer flere funksjoner som var i IPv4-verdenen, spredt over ICMPv4, IGMP( <span
                class="emphasis"><em>Internet Group Membership Protocol</em></span>) og ARP (<span
                class="emphasis"><em>Address Resolution Protocol</em></span>). ICMPv6 er definert i RFC4443. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc4443.html">http://www.faqs.org/rfcs/rfc4443.html</a></div>
			</div></div><div
            class="para">
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ACCEPT</code>: tillater pakken å fortsette på sin vei;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">REJECT</code>: avviser pakken med en ICMP-feilpakke (<code
                    class="literal">--reject-with <em
                      class="replaceable">type</em></code>-valget til <code
                    class="command">iptables</code> tillater å velge typen feil);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">DROP</code>: slette (ignorere) pakken;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">LOG</code>: logg (via <code
                    class="command">syslogd</code>) en melding med en beskrivelse av pakken. Merk at denne handlingen ikke avbryter prosessen, og kjøringen av kjeden fortsetter med den neste regelen, som er grunnen til at logging av avslåtte pakker krever både en LOG-regel og en REJECT/DROP-regel;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ULOG</code>: logger et budskap via <code
                    class="command">ulogd</code>, som kan tilpasses bedre og mer effektivt enn <code
                    class="command">syslogd</code> for håndtering av et stort antall meldinger. Merk at denne handlingen, slik som LOG, også returnerer prosessen til den neste regelen i påkallingskjeden;
					</div></li><li
                class="listitem"><div
                  class="para">
						<em
                    class="replaceable">kjede_navn</em>: hopper til den gitte kjeden og evaluerer dens regler,
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">RETURN</code>: avbryter prosessen til den gjeldende kjeden, og går tilbake til den anropende kjeden; i tilfelle den aktuelle kjeden er standard, er det ingen påkallingskjede, slik at standardhandlingen (definert med <code
                    class="literal">-P</code>-valget til <code
                    class="command">iptables</code>) kjøres i stedet;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">SNAT</code> (bare i <code
                    class="literal">nat</code>-tabellen): bruk <span
                    class="emphasis"><em>kilde-NAT</em></span> (ekstra argumenter beskriver nøyaktig de endringene som skal brukes);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">DNAT</code> (bare i <code
                    class="literal">nat</code>-tabellen): bruk <span
                    class="emphasis"><em>endestasjon-NAT</em></span> (ekstra argumenter beskriver nøyaktig de endringene som skal brukes);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">MASQUERADE</code> (bare i <code
                    class="literal">nat</code>-tabellen): bruk <span
                    class="emphasis"><em>maske (masquerading)</em></span> (et spesialtilfelle av <span
                    class="emphasis"><em>Source NAT (kilde NAT)</em></span>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">REDIRECT</code> (bare i <code
                    class="literal">nat</code>-tabellen): å omdirigere en pakke til en gitt port i brannmuren selv. Denne kan brukes til å sette opp en gjennomsiktig nettmellomtjener som fungerer uten oppsett på klientsiden, siden klienten tror den kobles til mottakeren, mens kommunikasjonen faktisk gå gjennom mellomtjeneren.
					</div></li></ul></div><div
            class="para">
				Andre handlinger, spesielt dem som gjelder <code
              class="literal">mangle</code>-tabellen, er utenfor formålet med teksten her. <span
              class="citerefentry"><span
                class="refentrytitle">iptables</span>(8)</span> og <span
              class="citerefentry"><span
                class="refentrytitle">ip6tables</span>(8)</span> har en omfattende liste.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.iptables"></a>14.2.2. Syntaksen til <code
                    class="command">iptables</code> og <code
                    class="command">ip6tables</code></h3></div></div></div><div
            class="para">
				Kommandoene <code
              class="command">iptables</code> og <code
              class="command">ip6tables</code> kan håndtere tabeller, kjeder og regler. Alternativet deres <code
              class="literal">-t <em
                class="replaceable">tabell</em></code> indikerer hvilken tabell en kan operere fra (som standard <code
              class="literal">filter</code>).
			</div><a
            id="id-1.17.5.13.3"
            class="indexterm"></a><a
            id="id-1.17.5.13.4"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.iptables-command"></a>14.2.2.1. Kommandoer</h4></div></div></div><div
              class="para">
					<code
                class="literal">-N <em
                  class="replaceable">kjede</em></code>-valget lager en ny kjede. <code
                class="literal">-X <em
                  class="replaceable">kjede</em></code> sletter en tom eller ubrukt kjede. <code
                class="literal">-A <em
                  class="replaceable">kjede</em> <em
                  class="replaceable">regel</em></code> legger til en regel ved slutten av en gitt kjede. <code
                class="literal">-I <em
                  class="replaceable">kjede</em> <em
                  class="replaceable">regel_nummer</em> <em
                  class="replaceable">regel</em></code>-valget setter inn en regel før regelnummeret <em
                class="replaceable">regel_nummer</em>. <code
                class="literal">-D <em
                  class="replaceable">kjede</em> <em
                  class="replaceable">regel_nummer</em></code> (eller <code
                class="literal">-D <em
                  class="replaceable">kjede</em> <em
                  class="replaceable">regel</em></code>)-valget sletter en regel i en kjede; den første syntaksen identifiserer regelen som skal slettet ut fra nummeret den har. <code
                class="literal">-F <em
                  class="replaceable">kjede</em></code>-alternativet tømmer en kjede (sletter alle dens regler); hvis ingen kjede er nevnt, er alle reglene i tabellen slettet. <code
                class="literal">-L <em
                  class="replaceable">kjede</em></code>-valget lister reglene i kjeden. Til slutt, <code
                class="literal">-P <em
                  class="replaceable">kjede</em> <em
                  class="replaceable">handling</em></code>-valget definerer standardhandlingen, eller «policy», for en gitt kjede; Merk at bare standardkjeder kan ha en slik «policy».
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.iptables-rules"></a>14.2.2.2. Regler</h4></div></div></div><a
              id="id-1.17.5.13.6.2"
              class="indexterm"></a><div
              class="para">
					Hver regel er uttrykt som <code
                class="literal"><em
                  class="replaceable">forhold</em> -j <em
                  class="replaceable">handling</em> <em
                  class="replaceable">handlings_alternativer</em></code>. Hvis flere betingelser er beskrevet i den samme regelen, da er kriteriet forbindelsen mellom betingelsene (logisk <span
                class="emphasis"><em>og</em></span>), som er minst like restriktive som hver individuelle betingelse.
				</div><div
              class="para">
					Betingelsen <code
                class="literal">-p <em
                  class="replaceable">protokoll</em></code> samsvarer med protokollfeltet i IP-pakken. De vanligste verdiene er <code
                class="literal">tcp</code>, <code
                class="literal">udp</code>, <code
                class="literal">icmp</code>, og <code
                class="literal">icmpv6</code>. Å forhåndsinnstille betingelsen med et utropstegn som benekter betingelsen, som deretter blir en oppgave for «noen pakker med en annen protokoll enn den spesifiserte». Denne negasjonsmekanismen er ikke spesiell for <code
                class="literal">-p</code>-alternativet, og det kan brukes på alle andre forhold også.
				</div><div
              class="para">
					<code
                class="literal">-s <em
                  class="replaceable">adresse</em></code> eller <code
                class="literal">-s <em
                  class="replaceable">nettverk/maske</em></code>-betingelsen samsvarer med pakkens kildeadresse. Tilsvarende, <code
                class="literal">-d <em
                  class="replaceable">adresse</em></code> eller <code
                class="literal">-d <em
                  class="replaceable">nettverk/maske</em></code> samsvarer med måladressen.
				</div><div
              class="para">
					Betingelsen <code
                class="literal">-i <em
                  class="replaceable">grensesnitt</em></code> velger pakker som kommer inn fra et bestemt nettverksgrensesnitt. <code
                class="literal">-o <em
                  class="replaceable">grensesnitt</em></code> velger pakker som går ut via et spesifikt grensesnitt.
				</div><div
              class="para">
					Det er mer spesifikke betingelser, avhengig av de generelle betingelser som er beskrevet ovenfor. For eksempel kan <code
                class="literal">-p tcp</code>-betingelsen kompletteres med betingelser i TCP-portene, med klausuler som<code
                class="literal">--source-port <em
                  class="replaceable">port</em></code> og <code
                class="literal">--destination-port <em
                  class="replaceable">port</em></code>.
				</div><div
              class="para">
					Betingelsen <code
                class="literal">--state <em
                  class="replaceable">tilstand (status)</em></code> samsvarer med tilstanden til en pakke i en forbindelse (dette krever kjernemodulen <code
                class="command">ipt_conntrack</code> for koblingssporing). <code
                class="literal">NEW</code>-tilstanden beskriver en pakke som starter en ny forbindelse; <code
                class="literal">ESTABLISHED</code> samsvarer med pakker som tilhører en allerede eksisterende kobling, og <code
                class="literal">RELATED</code> samsvarer med pakker som initierer en ny tilkobling knyttet til en eksisterende (som er nyttig for <code
                class="literal">ftp-data</code>-forbindelsene i FTP-protokollens «aktivmodus»).
				</div><div
              class="para">
					Den forrige seksjonen viser tilgjengelige handlinger, men ikke de respektive alternativene.<code
                class="literal">LOG</code>-handlingen har for eksempel de følgende valgene:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-level</code>, med standardverdi <code
                      class="literal">warning</code>, indikerer alvorlighetsgraden <code
                      class="command">syslog</code>;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-prefix</code> tillater å spesifisere en tekst-forstavelse for å skille mellom loggede meldinger;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-tcp-sequence</code>, <code
                      class="literal">--log-tcp-options</code> og <code
                      class="literal">--log-ip-options</code> indikerer ekstra data som skal integreres i meldingen: henholdsvis TCP-sekvensnummer, TCP-alternativer, og IP-alternativer.
						</div></li></ul></div><div
              class="para">
					<code
                class="literal">DNAT</code>-handlingen gir <code
                class="literal">--to-destination <em
                  class="replaceable">adresse</em>:<em
                  class="replaceable">port</em></code> valget for å indikere den nye destinasjonens IP-adresse og/eller port. Tilsvarende, <code
                class="literal">SNAT</code> gir <code
                class="literal">--to-source <em
                  class="replaceable">adresse</em>:<em
                  class="replaceable">port</em></code> for å indikere den nye kildens IP-adresse og/eller port.
				</div><div
              class="para">
					<code
                class="literal">REDIRECT</code>-handlingen (bare hvis NAT er tilgjengelig) gir <code
                class="literal">--to-ports <em
                  class="replaceable">port(er)</em></code> valget for å angi porten, eller portområdet, dit pakkene skal omdirigeres.
				</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.creating-rules"></a>14.2.3. Å lage regler</h3></div></div></div><div
            class="para">
				Hver regeletablering krever bruk av <code
              class="command">iptables</code>/<code
              class="command">ip6tables</code>. Å skrive disse kommandoene manuelt kan være kjedelig, så anropene lagres vanligvis i et skript slik at det samme oppsettet blir satt opp automatisk hver gang maskinen starter. Dette skriptet kan skrives for hånd, men det kan også være interessant å forberede det med et høynivå verktøy som <code
              class="command">fwbuilder</code>.
			</div><pre
            class="screen">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>apt install fwbuilder</code></strong></pre><div
            class="para">
				Prinsippet er enkelt. I det første trinnet må man beskrive alle elementene som involveres i selve reglene:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						brannmuren selv, med sine nettverksgrensesnitt;
					</div></li><li
                class="listitem"><div
                  class="para">
						nettverkene, med sine tilhørende IP-serier;
					</div></li><li
                class="listitem"><div
                  class="para">
						tjenerne;
					</div></li><li
                class="listitem"><div
                  class="para">
						portene som tilhører de tjenestene som ligger på tjenerne.
					</div></li></ul></div><div
            class="para">
				Reglene blir deretter laget med enkle dra-og-slipp-handlinger på objektene. Noen kontekstmenyer kan endre betingelsen (nekte den, for eksempel). Deretter må handlingen velges og settes opp.
			</div><div
            class="para">
				Såvidt det gjelder IPv6, kan man enten lage to forskjellige regelsett for IPv4 og IPv6, eller bare lage ett, og la <code
              class="command">fwbuilder</code> oversette reglene ifølge de adressene som er tildelt stedene.
			</div><div
            class="figure"><a
              xmlns=""
              id="figure.fwbuilder"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/fwbuilder.png"
                  alt="Fwbuilders hovedvindu" /></div></div><p
              class="title"><strong>Figur 14.2. Fwbuilders hovedvindu</strong></p></div><a
            id="id-1.17.5.14.9"
            class="indexterm"></a><div
            class="para">
				<code
              class="command">fwbuilder</code> kan deretter generere et skript som setter opp brannmuren etter de regler som er angitt. Dens modulære arkitektur gir det muligheten til å generere skript rettet mot ulike systemer: <code
              class="command">iptables</code> for Linux, <code
              class="command">ipf</code> for FreeBSD, og <code
              class="command">pf</code> for OpenBSD.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.install-rules-at-boot"></a>14.2.4. Å installere reglene ved hver oppstart</h3></div></div></div><div
            class="para">
				I andre tilfeller er den anbefalte måten å registrere skriptet i et <code
              class="literal">up</code>-direktiv av <code
              class="filename">/etc/network/interfaces</code>-fil. I det følgende eksemplet er skriptet lagret under <code
              class="filename">/usr/local/etc/arrakis.fw</code>.
			</div><div
            class="example"><a
              xmlns=""
              id="example.network-interfaces-firewall"></a><p
              class="title"><strong>Eksempel 14.1. <code
                  class="filename">interfaces</code>-fil (grensesnittsfil) som påkaller et brannmursskript</strong></p><div
              class="example-contents"><pre
                class="programlisting">auto eth0
iface eth0 inet static
    address 192.168.0.1
    network 192.168.0.0
    netmask 255.255.255.0
    broadcast 192.168.0.255
    up /usr/local/etc/arrakis.fw</pre></div></div><div
            class="para">
				Dette forutsetter selvsagt at du bruker <span
              class="pkg pkg">ifupdown</span> til å sette opp nettverksgrensesnittet. Hvis du bruker noe annet (som <span
              class="emphasis"><em>NetworkManager</em></span> eller <span
              class="emphasis"><em>systemd-networkd</em></span>), henvis deretter til deres respektive dokumentasjon for å finne ut måter til å kjøre et skript, etter at grensesnittet har blitt tatt opp.
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="security.html"><strong>Forrige</strong>Kapittel 14. Sikkerhet</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Opp</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Hjem</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.supervision.html"><strong>Neste</strong>14.3. Overvåking: Forebygging, avdekking, avskrek...</a></li></ul></body></html>
