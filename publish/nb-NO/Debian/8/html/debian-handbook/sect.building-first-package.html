<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">15.2. Å bygge din første pakke</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-nb-NO-1.0-1" /><meta
        name="keywords"
        content="Bakdør, Gjenoppbygge, Kildepakke, Arkiv, Meta-pakke, Debian utvikler, Vedlikeholder" /><link
        rel="home"
        href="index.html"
        title="Håndbok for Debian-administratoren" /><link
        rel="up"
        href="debian-packaging.html"
        title="Kapittel 15. Å lage en Debian-pakke" /><link
        rel="prev"
        href="debian-packaging.html"
        title="Kapittel 15. Å lage en Debian-pakke" /><link
        rel="next"
        href="sect.setup-apt-package-repository.html"
        title="15.3. Creating a Package Repository for APT" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/nb-NO/stable/sect.building-first-package.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="debian-packaging.html"><strong>Forrige</strong></a></li><li
          class="home">Håndbok for Debian-administratoren</li><li
          class="next"><a
            accesskey="n"
            href="sect.setup-apt-package-repository.html"><strong>Neste</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.building-first-package"></a>15.2. Å bygge din første pakke</h2></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.18.5.2"></a>15.2.1. Meta-pakker eller falsk pakker</h3></div></div></div><div
            class="para">
				Falske pakker og meta-pakker er like, ved at de er tomme skall som bare eksisterer for effektene meta-dataene deres har på pakkehåndterings-stabelen.
			</div><div
            class="para">
				Formålet med en falsk pakke er å lure <code
              class="command">dpkg</code> og <code
              class="command">apt</code> til å tro at noen pakker er installert, selv om de bare er et tomt skall. Dette tillater å tilfredsstille avhengigheter i en pakke når den tilsvarende programvaren ble installert utenfor rammen av pakkesystemet. En slik metode fungerer, men bør likevel unngås når det er mulig, ettersom det ikke er noen garanti for at den manuelt installerte programvaren oppfører seg akkurat som den tilsvarende pakken ville ha gjort, og andre pakker som er avhengig av den, ikke vil fungere ordentlig.
			</div><div
            class="para">
				På den annen side foreligger det en meta-pakke oftest som en samling av avhengigheter, slik at montering av meta-pakken faktisk vil føre inn et sett av andre pakker i et enkelt trinn.
			</div><div
            class="para">
				Begge disse pakkesalgene kan lages av <code
              class="command">equivs-control</code> og <code
              class="command">equivs-build</code>-kommandoene (i <span
              class="pkg pkg">equivs</span>-pakken). <code
              class="command">equivs-control <em
                class="replaceable">file</em></code>-kommandoen oppretter en Debian-pakke topptekstfil som skal redigeres for å inneholde navnet på den forventede pakken, dens versjonsnummer, navnet på vedlikeholderen, avhengighetene, og beskrivelsen. Andre felt uten en standardverdi er valgfrie og kan slettes.<code
              class="literal">Copyright</code>, <code
              class="literal">Changelog</code>, <code
              class="literal">Readme</code> og <code
              class="literal">Extra-Files</code>-feltene er ikke standard felt i Debian-pakker; de bare gir mening innenfor rammen av <code
              class="command">equivs-build</code>, og de vil ikke bli beholdt i overskriftene til den genererte pakken.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.18.5.2.6"></a><p
              class="title"><strong>Eksempel 15.2. Topptekstfil for den falske pakken <span
                  class="emphasis"><em>libxml-libxml-perl</em></span></strong></p><div
              class="example-contents"><pre
                class="programlisting">
Section: perl
Priority: optional
Standards-Version: 3.9.6

Package: libxml-libxml-perl
Version: 2.0116-1
Maintainer: Raphael Hertzog &lt;hertzog@debian.org&gt;
Depends: libxml2 (&gt;= 2.7.4)
Architecture: all
Description: Fake package - module manually installed in site_perl
 This is a fake package to let the packaging system
 believe that this Debian package is installed. 
 .
 In fact, the package is not installed since a newer version
 of the module has been manually compiled &amp; installed in the
 site_perl directory.
</pre></div></div><div
            class="para">
				Det neste skrittet er å generere Debian-pakken med <code
              class="command">equivs-build <em
                class="replaceable">file</em></code>-kommandoen. Og plutselig er pakken opprettet i den gjeldende katalogen, og kan håndteres som en hver annen Debian-pakke ville blitt.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.18.5.3"></a>15.2.2. Et enkelt filarkiv</h3></div></div></div><div
            class="para">
				For å lette utplasseringen av et sett med dokumentasjon på et stort antall maskiner, trenger Falcot Corp administratorene å lage en Debian-pakke. Administratoren med ansvaret for denne oppgaven leser først “New Maintainer's Guide”, og begynner så å jobbe med sin første pakke. <div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="https://www.debian.org/doc/manuals/maint-guide/">https://www.debian.org/doc/manuals/maint-guide/</a></div>
			</div><div
            class="para">
				Det første skrittet er å lage en <code
              class="filename">falcot-data-1.0</code>-mappe som skal inneholde mål-kildepakken. Pakken vil logisk nok få navnet <code
              class="literal">falcot-data</code> og bære versjonsnummeret <code
              class="literal">1.0</code>. Adminisstratoren plasserer så dokumentaasjonsfilene i en <code
              class="filename">data</code>-undermappe. Så påkaller de <code
              class="command">dh_make</code>-kommandoen (fra <span
              class="pkg pkg">dh-make</span>-pakken) for å legge til filene som kreves for pakke-genereringsprosessen, - som alle blir lagret i en <code
              class="filename">debian</code>-undermappe:
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>cd falcot-data-1.0</code></strong>
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>dh_make --native</code></strong>
<code
              class="computeroutput">
Type of package: single binary, indep binary, multiple binary, library, kernel module, kernel patch?
 [s/i/m/l/k/n] </code><strong
              class="userinput"><code>i</code></strong>
<code
              class="computeroutput">
Maintainer name : Raphael Hertzog
Email-Address   : hertzog@debian.org
Date            : Fri, 04 Sep 2015 12:09:39 -0400
Package Name    : falcot-data
Version         : 1.0
License         : gpl3
Type of Package : Independent
Hit &lt;enter&gt; to confirm:
Currently there is no top level Makefile. This may require additional tuning.
Done. Please edit the files in the debian/ subdirectory now. You should also
check that the falcot-data Makefiles install into $DESTDIR and not in / .
$</code></pre><div
            class="para">
				Den valgte pakketypen (<span
              class="emphasis"><em>indep binary</em></span>) indikerer at denne kildepakken vil generere en enkelt binær pakke som kan deles på tvers av alle arkitekturer (<code
              class="literal">Architecture: all</code>). <span
              class="emphasis"><em>single binary</em></span> virker som en motpart, og fører til en enkelt binærpakke som er avhengig av målarkitekturen (<code
              class="literal">Architecture: any</code>). I dette tilfellet er valget mer relevant, siden pakken bare inneholder dokumentasjon og ingen binære programmer, slik at den kan brukes på samme måte på datamaskiner av alle arkitekturer.
			</div><a
            id="id-1.18.5.3.6"
            class="indexterm"></a><a
            id="id-1.18.5.3.7"
            class="indexterm"></a><div
            class="para">
				<span
              class="emphasis"><em>multiple binary</em></span>-typen svarer til en kildekodepakke som leder til forskjellige binærpakker. Et spesielt tilfelle, <span
              class="emphasis"><em>library</em></span>, er nyttig for delte biblioteker, siden de må følge strenge pakkeregler. På lignende måte skal <span
              class="emphasis"><em>kernel module</em></span> eller <span
              class="emphasis"><em>kernel patch</em></span> begrenses til pakker som inneholder kjernemoduler.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TIP</em></span> Vedlikeholders navn og e-post</strong></p></div></div></div><div
              class="para">
				De fleste programmene involvert i pakkevedlikeholdet vil søke etter ditt navn og e-postadresse i <code
                class="varname">DEBFULLNAME</code> og <code
                class="varname">DEBEMAIL</code> eller <code
                class="varname">EMAIL</code>-miljøvariabler. Ved å definere dem en gang for alle, vil du unngå å måtte sortere dem flere ganger. Hvis ditt vanlige skall er <code
                class="command">bash</code>, er det bare å legge til følgende to linjer i din <code
                class="filename">~/.bashrc</code>-file (du vil ganske sikkert erstatte verdiene med noen mer relevante!):
			</div><pre
              class="programlisting">
export EMAIL="hertzog@debian.org"
export DEBFULLNAME="Raphael Hertzog"
</pre></div><div
            class="para">
				<code
              class="command">dh_make</code>-kommandoen laget en <code
              class="filename">debian</code> undermappe med mange filer. Noen kreves, spesielt <code
              class="filename">rules</code>, <code
              class="filename">control</code>, <code
              class="filename">changelog</code> og <code
              class="filename">copyright</code>. Filer mede <code
              class="filename">.ex</code>-forlengelsen er eksempelfiler som kan brukes ved å modifisere dem (og fjerne forlengelsen) når det passer. Når de ikke er nødvendige, anbefales det å fjerne dem. <code
              class="filename">compat</code> bør beholdes, ettersom den er nødvendig for riktig funksjon av <span
              class="emphasis"><em>debhelper</em></span>-programpakken (som alle begynner med <code
              class="command">dh_</code>-forstavelsen), og som brukes på ulike stadier i pakkebyggingsprosessen.
			</div><div
            class="para">
				The <code
              class="filename">copyright</code> file must contain information about the authors of the documents included in the package, and the related license. In our case, these are internal documents and their use is restricted to within the Falcot Corp company. The default <code
              class="filename">changelog</code> file is generally appropriate; replacing the “Initial release” with a more verbose explanation and changing the distribution from <code
              class="literal">unstable</code> to <code
              class="literal">internal</code> is enough. The <code
              class="filename">control</code> file was also updated: the <code
              class="literal">Section</code> field has been changed to <span
              class="emphasis"><em>misc</em></span> and the <code
              class="literal">Homepage</code>, <code
              class="literal">Vcs-Git</code> and <code
              class="literal">Vcs-Browser</code> fields were removed. The <code
              class="literal">Depends</code> fields was completed with <code
              class="literal">iceweasel | www-browser</code> so as to ensure the availability of a web browser able to display the documents in the package.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.18.5.3.12"></a><p
              class="title"><strong>Eksempel 15.3. The <code
                  class="filename">control</code> file</strong></p><div
              class="example-contents"><pre
                class="programlisting">
Source: falcot-data
Section: misc
Priority: optional
Maintainer: Raphael Hertzog &lt;hertzog@debian.org&gt;
Build-Depends: debhelper (&gt;= 9)
Standards-Version: 3.9.5

Package: falcot-data
Architecture: all
Depends: iceweasel | www-browser, ${misc:Depends}
Description: Internal Falcot Corp Documentation
 This package provides several documents describing the internal
 structure at Falcot Corp.  This includes:
  - organization diagram
  - contacts for each department.
 .
 These documents MUST NOT leave the company.
 Their use is INTERNAL ONLY.
</pre></div></div><div
            class="example"><a
              xmlns=""
              id="id-1.18.5.3.13"></a><p
              class="title"><strong>Eksempel 15.4. The <code
                  class="filename">changelog</code> file</strong></p><div
              class="example-contents"><pre
                class="programlisting">
falcot-data (1.0) internal; urgency=low

  * Initial Release.
  * Let's start with few documents:
    - internal company structure;
    - contacts for each department.

 -- Raphael Hertzog &lt;hertzog@debian.org&gt;  Fri, 04 Sep 2015 12:09:39 -0400
</pre></div></div><div
            class="example"><a
              xmlns=""
              id="id-1.18.5.3.14"></a><p
              class="title"><strong>Eksempel 15.5. The <code
                  class="filename">copyright</code> file</strong></p><div
              class="example-contents"><pre
                class="programlisting">
Format: http://www.debian.org/doc/packaging-manuals/copyright-format/1.0/
Upstream-Name: falcot-data

Files: *
Copyright: 2004-2015 Falcot Corp
License: 
 All rights reserved.
</pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>BACK TO BASICS</em></span> <code
                        class="filename">Makefile</code> file</strong></p></div></div></div><a
              id="id-1.18.5.3.15.2"
              class="indexterm"></a><div
              class="para">
				A <code
                class="filename">Makefile</code> file is a script used by the <code
                class="command">make</code> program; it describes rules for how to build a set of files from each other in a tree of dependencies (for instance, a program can be built from a set of source files). The <code
                class="filename">Makefile</code> file describes these rules in the following format:
			</div><pre
              class="programlisting">
target: source1 source2 ...
        command1
        command2
</pre><div
              class="para">
				The interpretation of such a rule is as follows: if one of the <code
                class="literal">source*</code> files is more recent than the <code
                class="literal">target</code> file, then the target needs to be generated, using <code
                class="command">command1</code> and <code
                class="command">command2</code>.
			</div><div
              class="para">
				Note that the command lines must start with a tab character; also note that when a command line starts with a dash character (<code
                class="literal">-</code>), failure of the command does not interrupt the whole process.
			</div></div><div
            class="para">
				The <code
              class="filename">rules</code> file usually contains a set of rules used to configure, build and install the software in a dedicated subdirectory (named after the generated binary package). The contents of this subdirectory is then archived within the Debian package as if it were the root of the filesystem. In our case, files will be installed in the <code
              class="filename">debian/falcot-data/usr/share/falcot-data/</code> subdirectory, so that installing the generated package will deploy the files under <code
              class="filename">/usr/share/falcot-data/</code>. The <code
              class="filename">rules</code> file is used as a <code
              class="filename">Makefile</code>, with a few standard targets (including <code
              class="literal">clean</code> and <code
              class="literal">binary</code>, used respectively to clean the source directory and generate the binary package).
			</div><div
            class="para">
				Although this file is the heart of the process, it increasingly contains only the bare minimum for running a standard set of commands provided by the <code
              class="command">debhelper</code> tool. Such is the case for files generated by <code
              class="command">dh_make</code>. To install our files, we simply configure the behavior of the <code
              class="command">dh_install</code> command by creating the following <code
              class="filename">debian/falcot-data.install</code> file:
			</div><pre
            class="programlisting">
data/* usr/share/falcot-data/
</pre><div
            class="para">
				At this point, the package can be created. We will however add a lick of paint. Since the administrators want the documents to be easily accessed from the menus of graphical desktop environments, we add a <code
              class="filename">falcot-data.desktop</code> file and get it installed in <code
              class="filename">/usr/share/applications</code> by adding a second line to <code
              class="filename">debian/falcot-data.install</code>.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.18.5.3.20"></a><p
              class="title"><strong>Eksempel 15.6. The <code
                  class="filename">falcot-data.desktop</code> file</strong></p><div
              class="example-contents"><pre
                class="programlisting">
[Desktop Entry]
Name=Internal Falcot Corp Documentation
Comment=Starts a browser to read the documentation
Exec=x-www-browser /usr/share/falcot-data/index.html
Terminal=false
Type=Application
Categories=Documentation;
</pre></div></div><div
            class="para">
				The updated <code
              class="filename">debian/falcot-data.install</code> looks like this:
			</div><pre
            class="programlisting">
data/* usr/share/falcot-data/
falcot-data.desktop usr/share/applications/
</pre><div
            class="para">
				Vår kildepakke er nå klar. Alt som gjenstår å gjøre er å generere den binære pakken, med den samme metoden vi brukte tidligere for å bygge om pakker: vi kjører <code
              class="command">dpkg-buildpackage -us -uc</code>-kommandoen fra <code
              class="filename">falcot-data-1.0</code>-mappen.
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="debian-packaging.html"><strong>Forrige</strong>Kapittel 15. Å lage en Debian-pakke</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Opp</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Hjem</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.setup-apt-package-repository.html"><strong>Neste</strong>15.3. Creating a Package Repository for APT</a></li></ul></body></html>
