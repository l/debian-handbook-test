<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">12.4. Supervision</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-fr-FR-1.0-1" /><meta
        name="keywords"
        content="RAID, LVM, FAI, Preseeding, Supervision, Virtualisation, Xen, LXC" /><link
        rel="home"
        href="index.html"
        title="Le cahier de l'administrateur Debian" /><link
        rel="up"
        href="advanced-administration.html"
        title="Chapitre 12. Administration avancée" /><link
        rel="prev"
        href="sect.automated-installation.html"
        title="12.3. Installation automatisée" /><link
        rel="next"
        href="workstation.html"
        title="Chapitre 13. Station de travail" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/fr-FR/stable/sect.monitoring.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.automated-installation.html"><strong>Précédent</strong></a></li><li
          class="home">Le cahier de l'administrateur Debian</li><li
          class="next"><a
            accesskey="n"
            href="workstation.html"><strong>Suivant</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.monitoring"></a>12.4. Supervision</h2></div></div></div><div
          class="para">
			La supervision couvre plusieurs aspects et répond à plusieurs problématiques. D'une part, il s'agit de suivre dans le temps l'évolution de l'usage des ressources offertes par une machine donnée, afin d'anticiper la saturation et les besoins de mises à jour. D'autre part, il s'agit d'être alerté en cas d'indisponibilité ou de dysfonctionnement d'un service afin d'y remédier dans les plus brefs délais.
		</div><div
          class="para">
			<span
            class="emphasis"><em>Munin</em></span> répond très bien à la première problématique en proposant sous forme graphique des historiques de nombreux paramètres (usage mémoire vive, usage disque, charge processeur, trafic réseau, charge de Apache/MySQL, etc.). <span
            class="emphasis"><em>Nagios</em></span> répond à la seconde en vérifiant très régulièrement que les services sont fonctionnels et disponibles et en remontant les alertes par les canaux appropriés (souvent par le courrier électronique, parfois avec des SMS, etc.). Les deux logiciels sont conçus de manière modulaire : il est relativement aisé de créer de nouveaux greffons <span
            class="foreignphrase"><em
              class="foreignphrase">(plug-ins)</em></span> pour surveiller des services ou paramètres spécifiques.
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>ALTERNATIVE</em></span> Zabbix, un système de supervision intégré</strong></p></div></div></div><a
            id="id-1.15.7.4.2"
            class="indexterm"></a><div
            class="para">
			Bien que Munin et Nagios soient très répandus, ils ne sont pas les seuls logiciels permettant la supervision et ils ne traitent qu'une partie de la problématique (graphage ou alerte). On citera notamment Zabbix. Il intègre les deux activités en un seul logiciel et est pour partie configuré via une interface web. Il s'est grandement amélioré dans les dernières années et peut être considéré comme une alternative viable. Sur le serveur de supervision, il faut installer <span
              class="pkg pkg">zabbix-server-pgsql</span> (ou <span
              class="pkg pkg">zabbix-server-mysql</span>), la plupart du temps avec <span
              class="pkg pkg">zabbix-frontend-php</span> pour disposer d'une interface web. Sur les hôtes à superviser, il faut installer <span
              class="pkg pkg">zabbix-agent</span> afin qu'ils puissent remonter les informations pertinentes au serveur. <div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="http://www.zabbix.org/">http://www.zabbix.org/</a></div>
		</div></div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>ALTERNATIVE</em></span> Icinga, un fork de Nagios</strong></p></div></div></div><a
            id="id-1.15.7.5.2"
            class="indexterm"></a><div
            class="para">
			Suite à des divergences d'opinion concernant le développement de Nagios (qui est contrôlé par une entreprise), un certain nombre de développeurs ont créé Icinga en repartant de Nagios. Le logiciel reste compatible — pour le moment — avec les configurations et greffons Nagios, mais ajoute des fonctionnalités supplémentaires. <div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="http://www.icinga.org/">http://www.icinga.org/</a></div>
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.munin"></a>12.4.1. Mise en œuvre de Munin</h3></div></div></div><a
            id="id-1.15.7.6.2"
            class="indexterm"></a><div
            class="para">
				Ce logiciel permet de superviser de nombreuses machines ; il emploie donc fort logiquement une architecture client/serveur. Une machine centrale — le grapheur — va collecter les données exportées par tous les hôtes à superviser, pour en faire des graphiques historiques.
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.15.7.6.4"></a>12.4.1.1. Configuration des hôtes à superviser</h4></div></div></div><div
              class="para">
					La première étape consiste à installer le paquet <span
                class="pkg pkg">munin-node</span>. Ce dernier contient un démon qui écoute sur le port 4949 et qui renvoie toutes les valeurs collectées par l'ensemble des greffons actifs. Chaque greffon est un simple programme qui peut renvoyer une description des informations qu'il collecte ainsi que la dernière valeur constatée. Ils sont placés dans <code
                class="filename">/usr/share/munin/plugins/</code> mais seuls ceux qui sont liés dans <code
                class="filename">/etc/munin/plugins/</code> sont réellement employés.
				</div><div
              class="para">
					L'installation initiale du paquet préconfigure une liste de greffons actifs en fonction des logiciels disponibles et de la configuration actuelle de la machine. Ce paramétrage automatique dépend d'une fonctionnalité intégrée à chaque greffon et il n'est pas toujours judicieux d'en rester là. Il est intéressant de naviguer sur la <a
                href="http://gallery.munin-monitoring.org">galerie des greffons</a>, même si tous les greffons ne disposent pas d'une documentation complète. Cela dit, tous les greffons sont des scripts, souvent relativement simples et contenant quelques commentaires explicatifs. Il ne faut donc pas hésiter à faire le tour de <code
                class="filename">/etc/munin/plugins/</code> pour supprimer les greffons inutiles. De même, on peut activer un greffon intéressant repéré dans <code
                class="filename">/usr/share/munin/plugins/</code> avec une commande <code
                class="command">ln -sf /usr/share/munin/plugins/<em
                  class="replaceable">greffon</em> /etc/munin/plugins/</code>. Attention, les greffons dont le nom se termine par un tiret souligné (_) sont particuliers, ils ont besoin d'un paramètre. Celui-ci doit être intégré dans le nom du lien symbolique créé (par exemple le greffon <code
                class="filename">if_</code> sera installé avec un lien symbolique <code
                class="filename">if_eth0</code> pour surveiller le trafic sur l'interface réseau <code
                class="literal">eth0</code>).
				</div><div
              class="para">
					Une fois tous les greffons correctement mis en place, il faut paramétrer le démon pour indiquer qui a le droit de récupérer ces valeurs. Cela s'effectue dans le fichier <code
                class="filename">/etc/munin/munin-node.conf</code> avec une directive <code
                class="literal">allow</code>. Par défaut, on trouve <code
                class="literal">allow ^127\.0\.0\.1$</code> qui n'autorise l'accès qu'à l'hôte local. Il convient d'ajouter une ligne similaire contenant l'adresse IP de la machine qui va assumer le rôle de grapheur puis de relancer le démon avec <code
                class="command">service munin-node restart</code>.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>POUR ALLER PLUS LOIN</em></span> Créer ses propres greffons</strong></p></div></div></div><div
                class="para">
					Munin dispose d'une documentation conséquente sur le fonctionnement théorique de ces greffons et sur la manière d'en développer de nouveaux. <div
                  xmlns=""
                  class="url">→ <a
                    xmlns="http://www.w3.org/1999/xhtml"
                    href="http://munin-monitoring.org/wiki/plugins">http://munin-monitoring.org/wiki/plugins</a></div>
				</div><div
                class="para">
					Pour tester le greffon, il convient de le lancer dans les mêmes conditions que munin-node le ferait en exécutant <code
                  class="command">munin-run <em
                    class="replaceable">greffon</em></code> en tant qu'utilisateur root. Le deuxième paramètre éventuel (comme <code
                  class="literal">config</code>) est réemployé comme paramètre lors de l'exécution du greffon.
				</div><div
                class="para">
					Lorsque le greffon est appelé avec le paramètre <code
                  class="literal">config</code>, il doit renvoyer un ensemble de champs le décrivant, par exemple :
				</div><pre
                class="screen"><code
                  class="computeroutput">$ </code><strong
                  class="userinput"><code>sudo munin-run load config
</code></strong><code
                  class="computeroutput">graph_title Load average
graph_args --base 1000 -l 0
graph_vlabel load
graph_scale no
graph_category system
load.label load
graph_info The load average of the machine describes how many processes are in the run-queue (scheduled to run "immediately").
load.info 5 minute load average
</code></pre><div
                class="para">
					Les différents champs qu'il est possible de renvoyer sont décrits sur une page web décrivant le « protocole de configuration ». <div
                  xmlns=""
                  class="url">→ <a
                    xmlns="http://www.w3.org/1999/xhtml"
                    href="http://munin.readthedocs.org/en/latest/reference/plugin.html">http://munin.readthedocs.org/en/latest/reference/plugin.html</a></div>
				</div><div
                class="para">
					Lorsque le greffon est appelé sans paramètre, il renvoie simplement les dernières valeurs associées ; ainsi l'exécution de <code
                  class="command">sudo munin-run load</code> retourne par exemple <code
                  class="literal">load.value 0.12</code>.
				</div><div
                class="para">
					Enfin, lorsque le greffon est appelé avec <code
                  class="literal">autoconf</code> comme paramètre, il renvoie « yes » (avec un code retour à 0) ou « no » (avec un code de retour à 1) pour signifier si oui ou non le greffon devrait être activé sur cette machine.
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.15.7.6.5"></a>12.4.1.2. Configuration du grapheur</h4></div></div></div><div
              class="para">
					Par grapheur, on entend simplement la machine qui va collecter les données et générer les graphiques correspondants. Le paquet correspondant à installer est <span
                class="pkg pkg">munin</span>. La configuration initiale du paquet lance <code
                class="command">munin-cron</code> toutes les 5 minutes. Ce dernier collecte les données depuis toutes les machines listées dans <code
                class="filename">/etc/munin/munin.conf</code> (uniquement l'hôte local par défaut), stocke les historiques sous forme de fichiers RRD (<span
                class="foreignphrase"><em
                  class="foreignphrase">Round Robin Database</em></span> est un format de fichier adapté au stockage de données variant dans le temps) dans <code
                class="filename">/var/lib/munin/</code> et régénère une page HTML avec des graphiques dans <code
                class="filename">/var/cache/munin/www/</code>.
				</div><div
              class="para">
					Il faut donc éditer <code
                class="filename">/etc/munin/munin.conf</code> pour y ajouter toutes les machines à surveiller. Chaque machine se présente sous la forme d'une section complète portant son nom et contenant une entrée <code
                class="literal">address</code> qui indique l'adresse IP de la machine à superviser.
				</div><pre
              class="programlisting">
[ftp.falcot.com]
    address 192.168.0.12
    use_node_name yes
</pre><div
              class="para">
					Les sections peuvent être plus élaborées et décrire des graphiques supplémentaires à créer à partir de la combinaison de données provenant de plusieurs machines. On peut s'inspirer des exemples fournis dans le fichier de configuration.
				</div><div
              class="para">
					Enfin, la dernière étape consiste à publier les pages générées. Il faut configurer votre serveur web pour que l'on puisse accéder au contenu de <code
                class="filename">/var/cache/munin/www/</code> par l'intermédiaire d'un site web. On choisira généralement de restreindre l'accès soit à l'aide d'un système d'authentification, soit en fournissant une liste d'adresses IP autorisées à consulter ces informations. La <a
                class="xref"
                href="sect.http-web-server.html">Section 11.2, « Serveur web (HTTP) »</a> fournit les explications nécessaires.
				</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.nagios"></a>12.4.2. Mise en œuvre de Nagios</h3></div></div></div><a
            id="id-1.15.7.7.2"
            class="indexterm"></a><div
            class="para">
				Contrairement à Munin, Nagios ne nécessite pas forcément d'installer quoi que ce soit sur les machines à superviser. En effet, il est fréquemment employé simplement pour vérifier la disponibilité de certains services réseau. Par exemple, Nagios peut se connecter à un serveur web et vérifier qu'il peut récupérer une page web donnée dans un certain délai.
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.15.7.7.4"></a>12.4.2.1. Installation</h4></div></div></div><div
              class="para">
					La première étape est donc d'installer les paquets <span
                class="pkg pkg">nagios3</span>, <span
                class="pkg pkg">nagios-plugins</span> et <span
                class="pkg pkg">nagios3-doc</span>. Une fois cela effectué, l'interface web de Nagios est d'ores et déjà configurée et un premier utilisateur <code
                class="literal">nagiosadmin</code> (dont le mot de passe vient d'être saisi) peut y accéder. Il est possible d'ajouter d'autres utilisateurs en les insérant dans le fichier <code
                class="filename">/etc/nagios3/htpasswd.users</code> à l'aide de la commande <code
                class="command">htpasswd</code> de Apache. Si aucune question debconf n'est apparue au cours de l'installation, il est possible d'exécuter <code
                class="command">dpkg-reconfigure nagios3-cgi</code> pour définir le mot de passe de l'utilisateur <code
                class="literal">nagiosadmin</code>.
				</div><div
              class="para">
					En se connectant sur <code
                class="literal">http://<em
                  class="replaceable">serveur</em>/nagios3/</code>, on découvre l'interface web et l'on peut constater que Nagios surveille déjà certains paramètres de la machine sur laquelle il fonctionne. Cependant, en essayant d'utiliser certaines fonctionnalités interactives comme l'ajout de commentaires concernant un hôte, on constate qu'elles ne fonctionnent pas. Par défaut, Nagios est effectivement configuré de manière très restrictive (pour plus de sécurité) et ces fonctionnalités sont désactivées.
				</div><div
              class="para">
					En consultant <code
                class="filename">/usr/share/doc/nagios3/README.Debian</code> on comprend qu'il faut éditer <code
                class="filename">/etc/nagios3/nagios.cfg</code> et positionner le paramètre <code
                class="literal">check_external_commands</code> à « 1 ». Puis il faut changer les permissions d'écriture sur un répertoire employé par Nagios avec ces quelques commandes :
				</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>service nagios3 stop</code></strong>
<code
                class="computeroutput">[...]
# </code><strong
                class="userinput"><code>dpkg-statoverride --update --add nagios www-data 2710 /var/lib/nagios3/rw
</code></strong><code
                class="computeroutput"># </code><strong
                class="userinput"><code>dpkg-statoverride --update --add nagios nagios 751 /var/lib/nagios3
</code></strong><code
                class="computeroutput"># </code><strong
                class="userinput"><code>service nagios3 start</code></strong>
<code
                class="computeroutput">[...]</code></pre></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.15.7.7.5"></a>12.4.2.2. Configuration</h4></div></div></div><div
              class="para">
					L'interface web de Nagios est relativement plaisante, mais elle ne permet pas de le configurer. Il n'est pas possible d'ajouter des hôtes et des services à surveiller. Toute la configuration de ce logiciel s'effectue par un ensemble de fichiers référencés par le fichier de configuration central <code
                class="filename">/etc/nagios3/nagios.cfg</code>.
				</div><div
              class="para">
					Avant de plonger dans ces fichiers, il faut se familiariser avec les concepts de Nagios. La configuration liste un ensemble d'objets de différents types :
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							Un hôte <span
                      class="foreignphrase"><em
                        class="foreignphrase">(host)</em></span> est une machine du réseau que l'on souhaite surveiller;
						</div></li><li
                  class="listitem"><div
                    class="para">
							Un <span
                      class="foreignphrase"><em
                        class="foreignphrase">hostgroup</em></span> est un ensemble d'hôtes que l'on souhaite regrouper pour un affichage plus clair ou pour factoriser des éléments de configuration;
						</div></li><li
                  class="listitem"><div
                    class="para">
							Un <span
                      class="foreignphrase"><em
                        class="foreignphrase">service</em></span> est un élément à tester qui concerne un hôte ou un groupe d'hôtes. En général, il s'agit effectivement de vérifier le fonctionnement de « services » réseau, mais il peut s'agir de vérifier que des paramètres soient dans un intervalle acceptable (comme l'espace disque ou la charge CPU);
						</div></li><li
                  class="listitem"><div
                    class="para">
							Un <span
                      class="foreignphrase"><em
                        class="foreignphrase">servicegroup</em></span> est un ensemble de services que l'on souhaite regrouper dans l'affichage;
						</div></li><li
                  class="listitem"><div
                    class="para">
							Un <span
                      class="foreignphrase"><em
                        class="foreignphrase">contact</em></span> est une personne qui peut recevoir des alertes;
						</div></li><li
                  class="listitem"><div
                    class="para">
							Un <span
                      class="foreignphrase"><em
                        class="foreignphrase">contactgroup</em></span> est un ensemble de contacts à avertir;
						</div></li><li
                  class="listitem"><div
                    class="para">
							Une <span
                      class="foreignphrase"><em
                        class="foreignphrase">timeperiod</em></span> est une plage horaire pendant laquelle certains services doivent être vérifiés;
						</div></li><li
                  class="listitem"><div
                    class="para">
							Une commande <span
                      class="foreignphrase"><em
                        class="foreignphrase">(command)</em></span> est une ligne de commande à exécuter pour tester un service donné.
						</div></li></ul></div><div
              class="para">
					Chaque objet a un certain nombre de propriétés (selon son type) qu'il est possible de personnaliser. Une liste exhaustive serait trop longue, mais les relations entre ces objets sont les propriétés les plus importantes.
				</div><div
              class="para">
					Un <span
                class="emphasis"><em>service</em></span> emploie une <span
                class="emphasis"><em>commande</em></span> pour vérifier l'état d'une fonctionnalité sur un <span
                class="emphasis"><em>hôte</em></span> ou un <span
                class="emphasis"><em>groupe d'hôtes</em></span> dans une <span
                class="emphasis"><em>plage horaire</em></span> donnée. En cas de problèmes, Nagios envoie une alerte à tous les membres du <span
                class="emphasis"><em>contactgroup</em></span> associé au service défaillant. Chaque membre est alerté selon les modalités précisées dans son objet <span
                class="emphasis"><em>contact</em></span> correspondant.
				</div><div
              class="para">
					Une fonctionnalité d'héritage entre les objets permet de partager facilement un ensemble de propriétés entre un grand nombre d'objets, tout en évitant une duplication de l'information. Par ailleurs, la configuration initiale comporte un certain nombre d'objets standards et, dans la plupart des cas, il suffit de définir de nouveaux hôtes, services et contacts en héritant des objets génériques prédéfinis. La lecture des fichiers de <code
                class="filename">/etc/nagios3/conf.d/</code> permet de se familiariser avec ceux-ci.
				</div><div
              class="para">
					Voici la configuration employée par les administrateurs de Falcot :
				</div><div
              class="example"><a
                xmlns=""
                id="id-1.15.7.7.5.9"></a><p
                class="title"><strong>Exemple 12.3. Fichier <code
                    class="filename">/etc/nagios3/conf.d/falcot.cfg</code></strong></p><div
                class="example-contents"><pre
                  class="programlisting">
define contact{
    name                            generic-contact
    service_notification_period     24x7
    host_notification_period        24x7
    service_notification_options    w,u,c,r
    host_notification_options       d,u,r
    service_notification_commands   notify-service-by-email
    host_notification_commands      notify-host-by-email
    register                        0 ; Template only
}
define contact{
    use             generic-contact
    contact_name    rhertzog
    alias           Raphael Hertzog
    email           hertzog@debian.org
}
define contact{
    use             generic-contact
    contact_name    rmas
    alias           Roland Mas
    email           lolando@debian.org
}

define contactgroup{
    contactgroup_name     falcot-admins
    alias                 Falcot Administrators
    members               rhertzog,rmas
}

define host{
    use                   generic-host ; Name of host template to use
    host_name             www-host
    alias                 www.falcot.com
    address               192.168.0.5
    contact_groups        falcot-admins
    hostgroups            debian-servers,ssh-servers
}
define host{
    use                   generic-host ; Name of host template to use
    host_name             ftp-host
    alias                 ftp.falcot.com
    address               192.168.0.6
    contact_groups        falcot-admins
    hostgroups            debian-servers,ssh-servers
}

# commande 'check_ftp' avec paramètres personnalisés
define command{
    command_name          check_ftp2
    command_line          /usr/lib/nagios/plugins/check_ftp -H $HOSTADDRESS$ -w 20 -c 30 -t 35
}

# Service générique à Falcot
define service{
    name                  falcot-service
    use                   generic-service
    contact_groups        falcot-admins
    register              0
}
# Services à vérifier sur www-host
define service{
    use                   falcot-service
    host_name             www-host
    service_description   HTTP
    check_command         check_http
}
define service{
    use                   falcot-service
    host_name             www-host
    service_description   HTTPS
    check_command         check_https
}
define service{
    use                   falcot-service
    host_name             www-host
    service_description   SMTP
    check_command         check_smtp
}
# Services à vérifier sur ftp-host
define service{
    use                   falcot-service
    host_name             ftp-host
    service_description   FTP
    check_command         check_ftp2
}
</pre></div></div><div
              class="para">
					Ce fichier de configuration définit deux hôtes à surveiller. Le premier concerne le serveur web de Falcot ; on y surveille le fonctionnement du serveur web sur le port HTTP (80) et sur le port HTTP sécurisé (443). On vérifie également qu'un serveur SMTP est accessible sur son port 25. Le second concerne le serveur FTP et l'on vérifie qu'on obtient une réponse en moins de 20 secondes. Au-delà de ce délai, une mise en garde <span
                class="foreignphrase"><em
                  class="foreignphrase">(warning)</em></span> est générée et, au-delà de 30 secondes, une alerte critique. En se rendant sur l'interface web, on peut se rendre compte que le service SSH est également surveillé : cette surveillance est due à l'appartenance des hôtes au groupe <code
                class="literal">ssh-servers</code>. Le service standard correspondant est défini dans <code
                class="filename">/etc/nagios3/conf.d/services_nagios2.cfg</code>.
				</div><div
              class="para">
					On peut noter l'usage de l'héritage : pour hériter d'un autre objet, on emploie la propriété <code
                class="command">use <em
                  class="replaceable">nom-parent</em></code>. Pour identifier un objet dont on veut hériter, il faut lui attribuer une propriété <code
                class="command">name <em
                  class="replaceable">identifiant</em></code>. Si l'objet parent n'est pas un objet réel, mais est uniquement destiné à servir de rôle de parent, on lui ajoute la propriété <code
                class="command">register 0</code> qui indique à Nagios de ne pas le considérer et donc d'ignorer l'absence de certains paramètres normalement requis.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>DOCUMENTATION</em></span> Liste des propriétés des objets</strong></p></div></div></div><div
                class="para">
					Pour avoir une meilleure idée des nombreuses possibilités de paramétrage de Nagios, il faut consulter la documentation fournie par le paquet <span
                  class="pkg pkg">nagios3-doc</span>. Elle est directement accessible depuis l'interface web via le lien <span
                  class="guimenuitem"><strong>Documentation</strong></span> en haut à gauche. On y trouve notamment une liste exhaustive des différents types d'objets avec toutes les propriétés que l'on peut leur affecter. Il est également expliqué comment créer de nouveaux greffons.
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>POUR ALLER PLUS LOIN</em></span> Tests distants avec NRPE</strong></p></div></div></div><div
                class="para">
					De nombreux greffons de Nagios permettent de vérifier l'état de certains paramètres locaux d'une machine. Si l'on souhaite effectuer ces vérifications sur de nombreuses machines tout en centralisant les résultats sur une seule installation, il faut employer le greffon NRPE <span
                  class="foreignphrase"><em
                    class="foreignphrase">(Nagios Remote Plugin Executor)</em></span>. On installe <span
                  class="pkg pkg">nagios-nrpe-plugin</span> sur le serveur Nagios et <span
                  class="pkg pkg">nagios-nrpe-server</span> sur les machines sur lesquelles on veut exécuter certains tests locaux. Ce dernier se configure par le biais du fichier <code
                  class="filename">/etc/nagios/nrpe.cfg</code>. On y indique les tests que l'on peut démarrer à distance ainsi que les adresses IP des machines qui sont autorisées à les déclencher. Du côté de Nagios, il suffit d'ajouter les services correspondants en faisant appel à la nouvelle commande <span
                  class="emphasis"><em>check_nrpe</em></span>.
				</div></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.automated-installation.html"><strong>Précédent</strong>12.3. Installation automatisée</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Niveau supérieur</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Sommaire</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="workstation.html"><strong>Suivant</strong>Chapitre 13. Station de travail</a></li></ul></body></html>
