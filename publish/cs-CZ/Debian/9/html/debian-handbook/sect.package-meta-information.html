<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">5.2. Meta-informace balíčku</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-cs-CZ-1.0-1" /><meta
        name="keywords"
        content="Binární balíček, Zdrojový balíček, dpdg, závislosti, konflikt" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="packaging-system.html"
        title="Kapitola 5. Balíčkový systém: Nástroje a základní principy" /><link
        rel="prev"
        href="packaging-system.html"
        title="Kapitola 5. Balíčkový systém: Nástroje a základní principy" /><link
        rel="next"
        href="sect.source-package-structure.html"
        title="5.3. Structure of a Source Package" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/cs-CZ/stable/sect.package-meta-information.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="packaging-system.html"><strong>Předcházející</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.source-package-structure.html"><strong>Další</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.package-meta-information"></a>5.2. Meta-informace balíčku</h2></div></div></div><a
          id="id-1.8.6.2"
          class="indexterm"></a><a
          id="id-1.8.6.3"
          class="indexterm"></a><div
          class="para">
			Balíček Debianu není jen archiv souborů zamýšlených k instalaci. Je to součást většího celku a popisuje své vztahy s ostatními balíčky Debianu (závislosti, konflikty, návrhy). Obsahuje také skripty, které umožňují spuštění příkazů v různých stádiích životního cyklu balíčku (instalace, odebrání, upgrade). Tato data jsou použita nástroji pro správu balíčků, ale nejsou součástí zabaleného softwaru; jsou to, čemu se v rámci balíčku říká “meta-informace” (informace o dalších informacích).
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.control"></a>5.2.1. Popis: <code
                    class="filename">kontrolní</code> soubor</h3></div></div></div><a
            id="id-1.8.6.5.2"
            class="indexterm"></a><a
            id="id-1.8.6.5.3"
            class="indexterm"></a><a
            id="id-1.8.6.5.4"
            class="indexterm"></a><div
            class="para">
				Tento soubor používá podobnou strukturu jako emailové hlavičky (jak definuje RFC 2822). Kupříkladu, u <span
              class="pkg pkg">apt</span> <code
              class="filename">kontrolní</code> soubor vypadá takto:
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>apt-cache show apt</code></strong>
<code
              class="computeroutput">Package: apt
Version: 1.4.8
Installed-Size: 3539
Maintainer: APT Development Team &lt;deity@lists.debian.org&gt;
Architecture: amd64
Replaces: apt-utils (&lt;&lt; 1.3~exp2~)
Depends: adduser, gpgv | gpgv2 | gpgv1, debian-archive-keyring, init-system-helpers (&gt;= 1.18~), libapt-pkg5.0 (&gt;= 1.3~rc2), libc6 (&gt;= 2.15), libgcc1 (&gt;= 1:3.0), libstdc++6 (&gt;= 5.2)
Recommends: gnupg | gnupg2 | gnupg1
Suggests: apt-doc, aptitude | synaptic | wajig, dpkg-dev (&gt;= 1.17.2), powermgmt-base, python-apt
Breaks: apt-utils (&lt;&lt; 1.3~exp2~)
Description-en: commandline package manager
 This package provides commandline tools for searching and
 managing as well as querying information about packages
 as a low-level access to all features of the libapt-pkg library.
 .
 These include:
  * apt-get for retrieval of packages and information about them
    from authenticated sources and for installation, upgrade and
    removal of packages together with their dependencies
  * apt-cache for querying available information about installed
    as well as installable packages
  * apt-cdrom to use removable media as a source for packages
  * apt-config as an interface to the configuration settings
  * apt-key as an interface to manage authentication keys
Description-md5: 9fb97a88cb7383934ef963352b53b4a7
Tag: admin::package-management, devel::lang:ruby, hardware::storage,
 hardware::storage:cd, implemented-in::c++, implemented-in::perl,
 implemented-in::ruby, interface::commandline, network::client,
 protocol::ftp, protocol::http, protocol::ipv6, role::program,
 scope::application, scope::utility, sound::player, suite::debian,
 use::downloading, use::organizing, use::searching, works-with::audio,
 works-with::software:package, works-with::text
Section: admin
Priority: important
Filename: pool/main/a/apt/apt_1.4.8_amd64.deb
Size: 1231676
MD5sum: 4963240f23156b2dda3affc9c0d416a3
SHA256: bc319a3abaf98d76e7e13ac97ab0ee7c238a48e2d4ab85524be8b10cfd23d50d</code></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ZPĚT K ZÁKLADŮM</em></span> RFC — Internetové standardy</strong></p></div></div></div><a
              id="id-1.8.6.5.7.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.7.3"
              class="indexterm"></a><div
              class="para">
				RFC je zkratka pro “žádost o komentáře”. RFC je obecně technický dokument, který popisuje, co se stane standardem internetu. Než se standardy stanou standardizovanými a neměnnými, jsou podrobeny veřejnému přezkoumání (odtud jejich jméno).
			</div><div
              class="para">
				RFC 2026 definuje proces pro standardizaci internetových protokolů. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc2026.html">http://www.faqs.org/rfcs/rfc2026.html</a></div>
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.8"></a>5.2.1.1. Závislosti: pole <code
                      class="literal">Depends</code></h4></div></div></div><a
              id="id-1.8.6.5.8.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.8.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.8.4"
              class="indexterm"></a><div
              class="para">
					Závislosti jsou definovány v poli <code
                class="literal">Depends</code> balíčkové hlacičky. Toto je seznam podmínek, které mají být splněny, aby balíček správně pracoval — tyto informace používají nástroje jako <code
                class="command">apt</code> k instalaci požadovaných knihoven ve správných verzích a splnil tak závislosti balíčku k instalaci. Pro každou závislost je možné omezit rozsah verzí, které vyhovují této podmínce. Jinými slovy, je možné vyjádřit fakt, že potřebujeme balíček <span
                class="pkg pkg">libc6</span> ve stejné nebo vyšší verzi než “2.15” (psáno “<code
                class="command">libc6 (&gt;= 2.15)</code>”). Srovnávací operátory pro verze jsou tyto:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&lt;&lt;</code>: menší než;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&lt;=</code>: menší než nebo rovno;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">=</code>: rovno (všimněte si, že “<code
                      class="literal">2.6.1</code>” se nerovná “<code
                      class="literal">2.6.1-1</code>”);
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&gt;=</code>: větší nebo rovno;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&gt;&gt;</code>: větší než.
						</div></li></ul></div><div
              class="para">
					In a list of conditions to be met, the comma serves as a separator. It must be interpreted as a logical “and”. In conditions, the vertical bar (“|”) expresses a logical “or” (it is an inclusive “or”, not an exclusive “either/or”). Carrying greater priority than “and”, it can be used as many times as necessary. Thus, the dependency “(A or B) and C” is written <code
                class="command">A | B, C</code>. In contrast, the expression “A or (B and C)” should be written as “(A or B) and (A or C)”, since the <code
                class="literal">Depends</code> field does not tolerate parentheses that change the order of priorities between the logical operators “or” and “and”. It would thus be written <code
                class="command">A | B, A | C</code>. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="https://www.debian.org/doc/debian-policy/#document-ch-relationships">https://www.debian.org/doc/debian-policy/#document-ch-relationships</a></div>
				</div><a
              id="id-1.8.6.5.8.8"
              class="indexterm"></a><div
              class="para">
					Systém závislostí je dobrý mechanismus pro zaručení chodu programu, ale má další využití v rámci “meta-balíčků”. Existují prázdné balíčky, které pouze popisují závislosti. Usnadňují instalaci konzistentí skupiny programů předvybraných údržbářem balíčku; takže <code
                class="command">apt install <em
                  class="replaceable">meta-package</em></code> automaticky nainstaluje všechny tyto programy za užití závislostí meta-balíčku. Balíčky <span
                class="pkg pkg">gnome</span>, <span
                class="pkg pkg">kde-full</span> a <span
                class="pkg pkg">linux-image-amd64</span> jsou příklady meta-balíčků.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>POLITIKA DEBIANU</em></span> <code
                          class="literal">Pre-Depends</code>, náročnější <code
                          class="literal">Depends</code></strong></p></div></div></div><a
                id="id-1.8.6.5.8.10.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.8.10.3"
                class="indexterm"></a><div
                class="para">
					“Před-závislosti”, které jsou vyjmenovány v poli “<code
                  class="literal">Pre-Depends</code>” balíčkové hlavičky, doplňují normální závislosti; jejich syntax je identický. Normální závislost značí, že daný balíček musí být rozbalen a nastaven před nastavením balíčku, který deklaruje tuto závislost. Před-závislost říká, že daný balíček musí být rozbalen a nastaven před spuštěním předinstalačního skriptu balíčku deklarujícího tuto před-závislost, což je před jeho instalací.
				</div><div
                class="para">
					Před-závislost je velmi náročná pro <code
                  class="command">apt</code>, protože přidává přísné omezení na seřazení balíčků k instalaci. Z toho důvodu se od před-závislosti odrazuje, pokud nejsou nezbytně nutné. Spíše se doporučuje poradit se s ostaními vývojáři na <code
                  class="email"><a
                    class="email"
                    href="mailto:debian-devel@lists.debian.org">debian-devel@lists.debian.org</a></code> před tím, než před-závislost přidáte. Obyčejně je možné nalézt jiné řešení a problém obejít.
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>POLITIKA DEBIANU</em></span> pole <code
                          class="literal">Recommends</code>, <code
                          class="literal">Suggests</code>, a <code
                          class="literal">Enhances</code></strong></p></div></div></div><a
                id="id-1.8.6.5.8.11.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.8.11.3"
                class="indexterm"></a><div
                class="para">
					Pole <code
                  class="literal">Recommends</code> a <code
                  class="literal">Suggests</code> popisují závislosti, které nejsou nutné. Závislosti “recommended”, nejdůležitější, podstatně zdokonalují funkcionalitu, kterou balíček nabízí, ale nejsou nezbytné pro jeho operace. Závislosti “suggested”, s druhořadou důležitostí, označují, že jisté balíčky mohou doplnit a zvýšit svou příslušnou užitečnost, ale je naprosto bez problémů instalovat jeden bez druhého.
				</div><div
                class="para">
					Měli by jste vždycky instalovat balíčky “recommended”, pokud přesně nevíte, proč je nepotřebujete. A naopak, není nutné instalovat balíčky “suggested”, pokud nevíte, proč je potřebujete.
				</div><a
                id="id-1.8.6.5.8.11.6"
                class="indexterm"></a><div
                class="para">
					Pole <code
                  class="literal">Enhances</code> také popisuje návrh, ale v jiné souvislosti. Nalézá se to v navrhovaném balíčku a ne v balíčku, který z návrhu těží. Jeho zajímavost spočívá v tom, že je možné přidat návrh bez toho, aniž by bylo potřeba měnit daný balíček. To umožňuje, aby všechny doplňky, zásuvné moduly a další nástavby byly uvedeny v seznamu doporučení pro software. I když existuje již několik let, je toto pole stále do značné míry ignorováno programy jako <code
                  class="command">apt</code> nebo <code
                  class="command">synaptic</code>. Jeho účelem je ukázat uživateli návrh, který je na řádku <code
                  class="literal">Enhances</code>, kromě tradičních návrhů, které se nalézají v poli <code
                  class="literal">Suggests</code>.
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.9"></a>5.2.1.2. Konflikty: pole <code
                      class="literal">Conflicts</code></h4></div></div></div><a
              id="id-1.8.6.5.9.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.9.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.9.4"
              class="indexterm"></a><div
              class="para">
					Pole <code
                class="literal">Conflicts</code> poukazuje na to, pokud balíček nemůže být nainstalovaný zároveň s jiným. Nejčastějším důvodem bývá to, že oba balíčky obsahují soubor stejného jména nebo poskytují stejnou službu na stejném TCP portu nebo překáží jeden druhému v činnosti.
				</div><div
              class="para">
					<code
                class="command">dpkg</code> odmítne nainstalovat balíček, pokud to spustí konflikt s již nainstalovaným balíčkem, ledaže by nový balíček říkal, že “nahradí” nainstalovaný balíček, v tom případě <code
                class="command">dpkg</code> zvolí nahrazení starého balíčku za nový. <code
                class="command">apt</code> vždy následuje vaše instrukce: pokud zvolíte instalaci nového balíčku, automaticky nabídne odinstalování balíčku, který představuje problém.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.10"></a>5.2.1.3. Nekompatabilita: pole <code
                      class="literal">Breaks</code></h4></div></div></div><a
              id="id-1.8.6.5.10.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.10.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.10.4"
              class="indexterm"></a><div
              class="para">
					Pole <code
                class="literal">Breaks</code> má stejný účinek jako pole <code
                class="literal">Conflicts</code>, ale zvláštním způsobem. Signalizuje, že instalace balíčku “naruší” jiný balíček (nebo jeho konkrétní verzi). Obyčejně, tato nekompatabilita mezi balíčky je přechodná a vztah <code
                class="literal">Breaks</code> se konkrétně vzahuje na nekompatabilní verze.
				</div><div
              class="para">
					<code
                class="command">dpkg</code> odmítne nainstalovat balíček, který naruší již nainstalovaný balíček a <code
                class="command">apt</code> se pokusí vyřešit problém aktualizací balíčku, který by byl porušen, na novou verzi (u které se předpokládá, že bude opravena a takto znova kompatabilní).
				</div><div
              class="para">
					Podobná situace může nastat v případě aktualizace bez zpětné kompatability: to je případ, kdy nová verze již více nepracuje se starší verzí a zapříčiní selhání v jiném programu bez podniknutí zvláštních opatření. Pole <code
                class="literal">Breaks</code> zamezuje uživateli, aby se do těchto problémů dostal.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.11"></a>5.2.1.4. Poskytované položky: pole <code
                      class="literal">Provides</code></h4></div></div></div><a
              id="id-1.8.6.5.11.2"
              class="indexterm"></a><div
              class="para">
					Toto pole představuje velmi zajímavé pojetí “virtuálního balíčku”. Má mnoho funkcí, ale dvě jsou obzvláště důležité. První role spočívá v používání virtuálního balíčku k jeho vztažení se k obecným službám (balíček “poskytuje” službu). Druhá dává najevo, že balíček kompletně nahrazuje jiný a to za tím účelem, aby také uspokojoval závislosti, které by ten druhý také uspokojoval. Je tak možné vytvořit náhradní balíček bez nutnosti použití stejného balíčkového jména.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>SLOVNÍČEK</em></span> Meta-balíček a virtuální balíček</strong></p></div></div></div><a
                id="id-1.8.6.5.11.4.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.11.4.3"
                class="indexterm"></a><a
                id="id-1.8.6.5.11.4.4"
                class="indexterm"></a><div
                class="para">
					Je zcela nezbytné jasně odlišit meta-balíčky od virtuálních balíčků. Ty první jsou reálnými balíčky (včetně reálných souborů <code
                  class="filename">.deb</code>), jejichž jediným účelem je vyjadřovat závislosti.
				</div><div
                class="para">
					Virtuální balíčky nicméně neexistují fyzicky; jsou prostředkem k identifikaci opravdových balíčků na základě společných, logických kritérií (poskytovaných služeb, kompatability se standardním programem nebo předtím-existujícím balíčkem, apod.).
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.8.6.5.11.5"></a>5.2.1.4.1. Poskytování “služby”</h5></div></div></div><div
                class="para">
						Proberme nejdříve detailněji první případ: o všech poštovních serverech, jako je <span
                  class="pkg pkg">postfix</span> nebo <span
                  class="pkg pkg">sendmail</span> se říká, že “poskytují” virtuální balíček <span
                  class="pkg pkg">mail-transport-agent</span>. Takže, jakýkoli balíček, který potřebuje tuto službu musí být funkční (např. správce seznamu adresátů, jako je <span
                  class="pkg pkg">smartlist</span> nebo <span
                  class="pkg pkg">sympa</span>) jednoduše stanovuje ve svých závislostech, že vyžaduje <span
                  class="pkg pkg">mail-transport-agent</span> namísto specifikování dlouhého a stále ještě nekompletního seznamu možných řešení (např. <code
                  class="command">postfix | sendmail | exim4 | …</code>). Navíc, je zbytečné instalovat dva poštovní servery na to samé zařízení, což je důvod, proč každý z balíčků vykazuje konflikt s vyrtuálním balíčkem <span
                  class="pkg pkg">mail-transport-agent</span>. Konflikt mezi balíčkem a jím je systémem ignorován, ale tato technika zakáže instalaci dvou poštovních serverů bok po boku.
					</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>POLITIKA DEBIANU</em></span> Seznam virtuálních balíčků</strong></p></div></div></div><a
                  id="id-1.8.6.5.11.5.3.2"
                  class="indexterm"></a><div
                  class="para">
						Aby by byly virtuální balíčky použitelné, musí se všichni shodnout na jejich jménech. To je důvod, proč jsou standardizovány ve stanovách Debianu. Seznam mezi jinými obsahuje <span
                    class="pkg pkg">mail-transport-agent</span> pro poštovní servery, <span
                    class="pkg pkg">c-compiler</span> pro kompilátory programovacího jazyka C, <span
                    class="pkg pkg">www-browser</span> pro internetové prohlížeče, <span
                    class="pkg pkg">httpd</span> pro internetové servery, <span
                    class="pkg pkg">ftp-server</span> pro FTP servery, <span
                    class="pkg pkg">x-terminal-emulator</span> pro terminálové emulátory v grafickém módu (<code
                    class="command">xterm</code>), a <span
                    class="pkg pkg">x-window-manager</span> pro manažery oken.
					</div><div
                  class="para">
						Celý seznam můžete najít na internetové stránce <div
                    xmlns=""
                    class="url">→ <a
                      xmlns="http://www.w3.org/1999/xhtml"
                      href="http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt">http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt</a></div>
					</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.8.6.5.11.6"></a>5.2.1.4.2. Zaměnitelnost s jiným balíčkem</h5></div></div></div><div
                class="para">
						The <code
                  class="literal">Provides</code> field is also interesting when the content of a package is included in a larger package. For example, the <span
                  class="pkg pkg">libdigest-md5-perl</span> Perl module was an optional module in Perl 5.6, and has been integrated as standard in Perl 5.8 (and later versions, such as 5.24 present in <span
                  class="distribution distribution">Stretch</span>). As such, the package <span
                  class="pkg pkg">perl</span> has since version 5.8 declared <code
                  class="literal">Provides: libdigest-md5-perl</code> so that the dependencies on this package are met if the user has Perl 5.8 (or newer). The <span
                  class="pkg pkg">libdigest-md5-perl</span> package itself has eventually been deleted, since it no longer had any purpose when old Perl versions were removed.
					</div><div
                class="figure"><a
                  xmlns=""
                  id="id-1.8.6.5.11.6.3"></a><div
                  class="figure-contents"><div
                    class="mediaobject"><img
                      src="images/virtual-package.png"
                      alt="Použití pole Provides, aby se neporušily závislosti" /></div></div><p
                  class="title"><strong>Obrázek 5.1. Použití pole <code
                      class="literal">Provides</code>, aby se neporušily závislosti</strong></p></div><div
                class="para">
						Tato funkce je velice užitečná, protože se nikdy nedají předpovídat vrtochy vývoje a je nezbytné mít možnost přizpůsobit se přejmenovávání a jinému automatickému nahrazování starého softwaru.
					</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>ZPĚT K ZÁKLADŮM</em></span> Perl, programovací jazyk</strong></p></div></div></div><a
                  id="id-1.8.6.5.11.6.5.2"
                  class="indexterm"></a><a
                  id="id-1.8.6.5.11.6.5.3"
                  class="indexterm"></a><div
                  class="para">
						Perl (praktický extrakční a reportovací jazyk) je velmi populární programovací jazyk. Má mnoho modulů připravených k použití, které mají široké spektrum uplatnění a jsou distribuovány servery CPAN (všeobecné archivační sítě Perlu), vyčerpávající sítě balíčků Perlu. <div
                    xmlns=""
                    class="url">→ <a
                      xmlns="http://www.w3.org/1999/xhtml"
                      href="http://www.perl.org/">http://www.perl.org/</a></div> <div
                    xmlns=""
                    class="url">→ <a
                      xmlns="http://www.w3.org/1999/xhtml"
                      href="http://www.cpan.org/">http://www.cpan.org/</a></div>
					</div><div
                  class="para">
						Protože to je interpretovaný jazyk, program psaný v Perlu nevyžaduje kompilaci před spuštěním. To je důvod, proč se jim říká “Perlové skripty”.
					</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.8.6.5.11.7"></a>5.2.1.4.3. Minulá omezení</h5></div></div></div><div
                class="para">
						Virtuální balíčky trpěly některými omezeními, z nichž nejvýznamnějším byla absence čísla verze. Vraťme se k předcházejícímu příkladu, závislost jako je <code
                  class="literal">Depends: libdigest-md5-perl (&gt;= 1.6)</code>, navzdory přítomnosti Perl 5.10, nebude nikdy považována za splněnou balíčkovým systémem — i když je de facto pravděpodobně splněná. Neuvědomujíc si toto, balíčkový systém si vybere nejméně riskantní možnost, předpokládajíc, že verze neodpovídají.
					</div><div
                class="para">
						This limitation has been lifted in <span
                  class="pkg pkg">dpkg</span> 1.17.11, and is no longer relevant in Stretch. Packages can assign a version to the virtual packages they provide with a dependency such as <code
                  class="literal">Provides: libdigest-md5-perl (= 1.8)</code>.
					</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.12"></a>5.2.1.5. Nahrazení souborů: pole <code
                      class="literal">Replaces</code></h4></div></div></div><a
              id="id-1.8.6.5.12.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.12.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.12.4"
              class="indexterm"></a><div
              class="para">
					Pole <code
                class="literal">Replaces</code> značí, že balíček obsahuje soubory, které jsou také přítomny v jiném balíčku, ale balíček je legitimně oprávněn je nahradit. Bez tohoto přesného vymezení <code
                class="command">dpkg</code> selže, prohlašujíc, že nemůže přepsat soubory jiného balíčku (technicky vzato, je možné ho přinutit k této činnosti pomocí možnosti <code
                class="literal">--force-overwrite</code>, to ale není považováno za standardní operaci). To umožňuje identifikaci možných problémů a vyžaduje, aby správce záležitost prostudoval před tím, než zvolí, zda toto pole přidat.
				</div><div
              class="para">
					The use of this field is justified when package names change or when a package is included in another. This also happens when the maintainer decides to distribute files differently among various binary packages produced from the same source package: a replaced file no longer belongs to the old package, but only to the new one.
				</div><div
              class="para">
					If all of the files in an installed package have been replaced, the package is considered to be removed. Finally, this field also encourages <code
                class="command">dpkg</code> to remove the replaced package where there is a conflict.
				</div><div
              class="sidebar"><a
                xmlns=""
                id="sidebar.debtags"></a><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>GOING FURTHER</em></span> The <code
                          class="literal">Tag</code> field</strong></p></div></div></div><div
                class="para">
					In the <span
                  class="pkg pkg">apt</span> example above, we can see the presence of a field that we have not yet described, the <code
                  class="literal">Tag</code> field. This field does not describe a relationship between packages, but is simply a way of categorizing a package in a thematic taxonomy. This classification of packages according to several criteria (type of interface, programming language, domain of application, etc.) has been available for a long time. Despite this, not all packages have accurate tags and it is not yet integrated in all Debian tools; <code
                  class="command">aptitude</code> displays these tags, and allows them to be used as search criteria. For those who are repelled by <code
                  class="command">aptitude</code>'s search criteria, the following website allows navigation of the tag database: <div
                  xmlns=""
                  class="url">→ <a
                    xmlns="http://www.w3.org/1999/xhtml"
                    href="https://wiki.debian.org/Debtags">https://wiki.debian.org/Debtags</a></div>
				</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.configuration-scripts"></a>5.2.2. Configuration Scripts</h3></div></div></div><a
            id="id-1.8.6.6.2"
            class="indexterm"></a><a
            id="id-1.8.6.6.3"
            class="indexterm"></a><a
            id="id-1.8.6.6.4"
            class="indexterm"></a><a
            id="id-1.8.6.6.5"
            class="indexterm"></a><a
            id="id-1.8.6.6.6"
            class="indexterm"></a><div
            class="para">
				In addition to the <code
              class="filename">control</code> file, the <code
              class="filename">control.tar.gz</code> archive for each Debian package may contain a number of scripts, called by <code
              class="command">dpkg</code> at different stages in the processing of a package. The Debian Policy describes the possible cases in detail, specifying the scripts called and the arguments that they receive. These sequences may be complicated, since if one of the scripts fails, <code
              class="command">dpkg</code> will try to return to a satisfactory state by canceling the installation or removal in progress (insofar as it is possible).
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>GOING FURTHER</em></span> <code
                        class="command">dpkg</code>'s database</strong></p></div></div></div><a
              id="id-1.8.6.6.8.2"
              class="indexterm"></a><a
              id="id-1.8.6.6.8.3"
              class="indexterm"></a><div
              class="para">
				All of the configuration scripts for installed packages are stored in the <code
                class="filename">/var/lib/dpkg/info/</code> directory, in the form of a file prefixed with the package's name. This directory also includes a file with the <code
                class="filename">.list</code> extension for each package, containing the list of files that belong to that package.
			</div><div
              class="para">
				The <code
                class="filename">/var/lib/dpkg/status</code> file contains a series of data blocks (in the format of the famous mail headers, RFC 2822) describing the status of each package. The information from the <code
                class="filename">control</code> file of the installed packages is also replicated there.
			</div></div><div
            class="para">
				In general, the <code
              class="filename">preinst</code> script is executed prior to installation of the package, while the <code
              class="filename">postinst</code> follows it. Likewise, <code
              class="filename">prerm</code> is invoked before removal of a package and <code
              class="filename">postrm</code> afterwards. An update of a package is equivalent to removal of the previous version and installation of the new one. It is not possible to describe in detail all the possible scenarios here, but we will discuss the most common two: an installation/update and a removal.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CAUTION</em></span> Symbolic names of the scripts</strong></p></div></div></div><div
              class="para">
				The sequences described in this section call configuration scripts by specific names, such as <code
                class="command">old-prerm</code> or <code
                class="command">new-postinst</code>. They are, respectively, the <code
                class="command">prerm</code> script contained in the old version of the package (installed before the update) and the <code
                class="command">postinst</code> script contained in the new version (installed by the update).
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TIP</em></span> State diagrams</strong></p></div></div></div><div
              class="para">
				Manoj Srivastava made these diagrams explaining how the configuration scripts are called by <code
                class="command">dpkg</code>. Similar diagrams have also been developed by the Debian Women project; they are a bit simpler to understand, but less complete. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="https://people.debian.org/~srivasta/MaintainerScripts.html">https://people.debian.org/~srivasta/MaintainerScripts.html</a></div> <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="https://www.debian.org/doc/debian-policy/#maintainer-script-flowcharts">https://www.debian.org/doc/debian-policy/#maintainer-script-flowcharts</a></div>
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.6.12"></a>5.2.2.1. Installation and Upgrade</h4></div></div></div><a
              id="id-1.8.6.6.12.2"
              class="indexterm"></a><div
              class="para">
					Here is what happens during an installation (or an update):
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="orderedlist"><ol><li
                  class="listitem"><div
                    class="para">
							For an update, <code
                      class="command">dpkg</code> calls the <code
                      class="command">old-prerm upgrade <em
                        class="replaceable">new-version</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Still for an update, <code
                      class="command">dpkg</code> then executes <code
                      class="command">new-preinst upgrade <em
                        class="replaceable">old-version</em></code>; for a first installation, it executes <code
                      class="command">new-preinst install</code>. It may add the old version in the last parameter, if the package has already been installed and removed since (but not purged, the configuration files having been retained).
						</div></li><li
                  class="listitem"><div
                    class="para">
							The new package files are then unpacked. If a file already exists, it is replaced, but a backup copy is temporarily made.
						</div></li><li
                  class="listitem"><div
                    class="para">
							For an update, <code
                      class="command">dpkg</code> executes <code
                      class="command">old-postrm upgrade <em
                        class="replaceable">new-version</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> updates all of the internal data (file list, configuration scripts, etc.) and removes the backups of the replaced files. This is the point of no return: <code
                      class="command">dpkg</code> no longer has access to all of the elements necessary to return to the previous state.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> will update the configuration files, asking the user to decide if it is unable to automatically manage this task. The details of this procedure are discussed in <a
                      class="xref"
                      href="sect.package-meta-information.html#sect.conffiles">5.2.3 – „Checksums, List of Configuration Files“</a>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Finally, <code
                      class="command">dpkg</code> configures the package by executing <code
                      class="command">new-postinst configure <em
                        class="replaceable">last-version-configured</em></code>.
						</div></li></ol></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.6.13"></a>5.2.2.2. Package Removal</h4></div></div></div><div
              class="para">
					Here is what happens during a package removal:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="orderedlist"><ol><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> calls <code
                      class="command">prerm remove</code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> removes all of the package's files, with the exception of the configuration files and configuration scripts.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> executes <code
                      class="command">postrm remove</code>. All of the configuration scripts, except <code
                      class="filename">postrm</code>, are removed. If the user has not used the “purge” option, the process stops here.
						</div></li><li
                  class="listitem"><div
                    class="para">
							For a complete purge of the package (command issued with <code
                      class="command">dpkg --purge</code> or <code
                      class="command">dpkg -P</code>), the configuration files are also deleted, as well as a certain number of copies (<code
                      class="filename">*.dpkg-tmp</code>, <code
                      class="filename">*.dpkg-old</code>, <code
                      class="filename">*.dpkg-new</code>) and temporary files; <code
                      class="command">dpkg</code> then executes <code
                      class="command">postrm purge</code>.
						</div></li></ol></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>VOCABULARY</em></span> Purge, a complete removal</strong></p></div></div></div><a
                id="id-1.8.6.6.13.4.2"
                class="indexterm"></a><div
                class="para">
					When a Debian package is removed, the configuration files are retained in order to facilitate possible re-installation. Likewise, the data generated by a daemon (such as the content of an LDAP server directory, or the content of a database for an SQL server) are usually retained.
				</div><div
                class="para">
					To remove all data associated with a package, it is necessary to “purge” the package with the command, <code
                  class="command">dpkg -P <em
                    class="replaceable">package</em></code>, <code
                  class="command">apt-get remove --purge <em
                    class="replaceable">package</em></code> or <code
                  class="command">aptitude purge <em
                    class="replaceable">package</em></code>.
				</div><div
                class="para">
					Given the definitive nature of such data removals, a purge should not be taken lightly.
				</div></div><a
              id="id-1.8.6.6.13.5"
              class="indexterm"></a><div
              class="para">
					The four scripts detailed above are complemented by a <code
                class="filename">config</code> script, provided by packages using <code
                class="command">debconf</code> to acquire information from the user for configuration. During installation, this script defines in detail the questions asked by <code
                class="command">debconf</code>. The responses are recorded in the <code
                class="command">debconf</code> database for future reference. The script is generally executed by <code
                class="command">apt</code> prior to installing packages one by one in order to group all the questions and ask them all to the user at the beginning of the process. The pre- and post-installation scripts can then use this information to operate according to the user's wishes.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>TOOL</em></span> <code
                          class="command">debconf</code></strong></p></div></div></div><a
                id="id-1.8.6.6.13.7.2"
                class="indexterm"></a><div
                class="para">
					<code
                  class="command">debconf</code> was created to resolve a recurring problem in Debian. All Debian packages unable to function without a minimum of configuration used to ask questions with calls to the <code
                  class="command">echo</code> and <code
                  class="command">read</code> commands in <code
                  class="filename">postinst</code> shell scripts (and other similar scripts). But this also means that during a large installation or update the user must stay with their computer to respond to various questions that may arise at any time. These manual interactions have now been almost entirely dispensed with, thanks to the <code
                  class="command">debconf</code> tool.
				</div><div
                class="para">
					<code
                  class="command">debconf</code> has many interesting features: it requires the developer to specify user interaction; it allows localization of all the strings displayed to users (all translations are stored in the <code
                  class="filename">templates</code> file describing the interactions); it has different frontends to display the questions to the user (text mode, graphical mode, non-interactive); and it allows creation of a central database of responses to share the same configuration with several computers... but the most important is that it is now possible to present all of the questions in a row to the user, prior to starting a long installation or update process. The user can go about their business while the system handles the installation on its own, without having to stay there staring at the screen waiting for questions.
				</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.conffiles"></a>5.2.3. Checksums, List of Configuration Files</h3></div></div></div><a
            id="id-1.8.6.7.2"
            class="indexterm"></a><a
            id="id-1.8.6.7.3"
            class="indexterm"></a><a
            id="id-1.8.6.7.4"
            class="indexterm"></a><a
            id="id-1.8.6.7.5"
            class="indexterm"></a><a
            id="id-1.8.6.7.6"
            class="indexterm"></a><div
            class="para">
				In addition to the maintainer scripts and control data already mentioned in the previous sections, the <code
              class="filename">control.tar.gz</code> archive of a Debian package may contain other interesting files. The first, <code
              class="filename">md5sums</code>, contains the MD5 checksums for all of the package's files. Its main advantage is that it allows <code
              class="command">dpkg --verify</code> (which we will study in <a
              class="xref"
              href="sect.supervision.html#sect.dpkg-verify">14.3.3.1 – „Auditing Packages with <code
                class="command">dpkg --verify</code>“</a>) to check if these files have been modified since their installation. Note that when this file doesn't exist, <code
              class="command">dpkg</code> will generate it dynamically at installation time (and store it in the dpkg database just like other control files).
			</div><div
            class="para">
				<code
              class="filename">conffiles</code> lists package files that must be handled as configuration files. Configuration files can be modified by the administrator, and <code
              class="command">dpkg</code> will try to preserve those changes during a package update.
			</div><div
            class="para">
				In effect, in this situation, <code
              class="command">dpkg</code> behaves as intelligently as possible: if the standard configuration file has not changed between the two versions, it does nothing. If, however, the file has changed, it will try to update this file. Two cases are possible: either the administrator has not touched this configuration file, in which case <code
              class="command">dpkg</code> automatically installs the new version; or the file has been modified, in which case <code
              class="command">dpkg</code> asks the administrator which version they wish to use (the old one with modifications, or the new one provided with the package). To assist in making this decision, <code
              class="command">dpkg</code> offers to display a “<code
              class="command">diff</code>” that shows the difference between the two versions. If the user chooses to retain the old version, the new one will be stored in the same location in a file with the <code
              class="filename">.dpkg-dist</code> suffix. If the user chooses the new version, the old one is retained in a file with the <code
              class="filename">.dpkg-old</code> suffix. Another available action consists of momentarily interrupting <code
              class="command">dpkg</code> to edit the file and attempt to re-instate the relevant modifications (previously identified with <code
              class="command">diff</code>).
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.questions-conffiles"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>GOING FURTHER</em></span> Avoiding the configuration file questions</strong></p></div></div></div><div
              class="para">
				<code
                class="command">dpkg</code> handles configuration file updates, but, while doing so, regularly interrupts its work to ask for input from the administrator. This makes it less than enjoyable for those who wish to run updates in a non-interactive manner. This is why this program offers options that allow the system to respond automatically according to the same logic: <code
                class="command">--force-confold</code> retains the old version of the file; <code
                class="command">--force-confnew</code> will use the new version of the file (these choices are respected, even if the file has not been changed by the administrator, which only rarely has the desired effect). Adding the <code
                class="command">--force-confdef</code> option tells <code
                class="command">dpkg</code> to decide by itself when possible (in other words, when the original configuration file has not been touched), and only uses <code
                class="command">--force-confnew</code> or <code
                class="command">--force-confold</code> for other cases.
			</div><div
              class="para">
				These options apply to <code
                class="command">dpkg</code>, but most of the time the administrator will work directly with the <code
                class="command">aptitude</code> or <code
                class="command">apt-get</code> programs. It is, thus, necessary to know the syntax used to indicate the options to pass to the <code
                class="command">dpkg</code> command (their command line interfaces are very similar).
			</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt -o DPkg::options::="--force-confdef" -o DPkg::options::="--force-confold" full-upgrade</code></strong></pre><div
              class="para">
				These options can be stored directly in <code
                class="command">apt</code>'s configuration. To do so, simply write the following line in the <code
                class="filename">/etc/apt/apt.conf.d/local</code> file:
			</div><div
              class="informalexample"><pre
                class="programlisting">
DPkg::options { "--force-confdef"; "--force-confold"; }
</pre></div><div
              class="para">
				Including this option in the configuration file means that it will also be used in a graphical interface such as <code
                class="command">aptitude</code>.
			</div></div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.questions-conffiles-bis"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>GOING FURTHER</em></span> Force dpkg to ask configuration file questions</strong></p></div></div></div><div
              class="para">
				The <code
                class="command">--force-confask</code> option requires <code
                class="command">dpkg</code> to display the questions about the configuration files, even in cases where they would not normally be necessary. Thus, when reinstalling a package with this option, <code
                class="command">dpkg</code> will ask the questions again for all of the configuration files modified by the administrator. This is very convenient, especially for reinstalling the original configuration file if it has been deleted and no other copy is available: a normal re-installation won't work, because <code
                class="command">dpkg</code> considers removal as a form of legitimate modification, and, thus, doesn't install the desired configuration file.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="packaging-system.html"><strong>Předcházející</strong>Kapitola 5. Balíčkový systém: Nástroje a základní...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Nahoru</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Domů</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.source-package-structure.html"><strong>Další</strong>5.3. Structure of a Source Package</a></li></ul></body></html>
