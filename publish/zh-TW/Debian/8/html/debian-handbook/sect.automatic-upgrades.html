<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.8. 自動升級</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-zh-TW-1.0-1" /><meta
        name="keywords"
        content="apt, apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="apt.html"
        title="章 6. 維護與更新：APT 工具" /><link
        rel="prev"
        href="sect.regular-upgrades.html"
        title="6.7. 保持系統在最新狀態" /><link
        rel="next"
        href="sect.searching-packages.html"
        title="6.9. 搜尋套件" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/zh-TW/stable/sect.automatic-upgrades.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.regular-upgrades.html"><strong>前一頁</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.searching-packages.html"><strong>下一頁</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.automatic-upgrades"></a>6.8. 自動升級</h2></div></div></div><a
          id="id-1.9.17.2"
          class="indexterm"></a><a
          id="id-1.9.17.3"
          class="indexterm"></a><div
          class="para">
			因為 Falcot Corp 雖有多部電腦但功能陽春，其管理者試圖儘可能地自動升級。必須在無人為介入情況下處理升級事宜。
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.9.17.5"></a>6.8.1. 組態 <code
                    class="command">dpkg</code></h3></div></div></div><div
            class="para">
				如稍早提過的 (見專欄 <a
              class="xref"
              href="sect.package-meta-information.html#sidebar.questions-conffiles"><span
                class="emphasis"><em>進一步</em></span> 避免組態檔的問題</a>)，<code
              class="command">dpkg</code> 可在不必確認的情況下取代原來的組態檔 (以 <code
              class="literal">--force-confdef --force-confold</code> 選項執行該功能)。然而，有三個互動來源：有些來自 APT 自身、有些由 <code
              class="command">debconf</code> 處理、還有的是由套件組態腳本執行。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.9.17.6"></a>6.8.2. 組態 APT</h3></div></div></div><div
            class="para">
				APT 的例子很簡單：<code
              class="literal">-y</code> 選項 (或 <code
              class="literal">--assume-yes</code>) 告訴 APT 面對所有的問題時，答案都是 “yes”。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.9.17.7"></a>6.8.3. 組態 <code
                    class="command">debconf</code></h3></div></div></div><div
            class="para">
				<code
              class="command">debconf</code> 需要較詳細的說明。此程式原本的設計就是控制給使用者看到的相關性及數量，以及顯示的方法。問題需有最小的優先權；擁有最小優先權以上的問題才顯示。<code
              class="command">debconf</code> 預設的答案 (由套件維護者設定) 會略過。
			</div><div
            class="para">
				其他的相關組態元素是前端用到的介面。若選擇 <code
              class="literal">noninteractive</code>，就停用所有的使用者互動。若套件試圖顯示資訊性說明，則以電子郵件送給管理者。
			</div><div
            class="para">
				組態 <code
              class="command">debconf</code> 時，用到 <code
              class="command">dpkg-reconfigure</code> 工具，它是來自 <span
              class="pkg pkg">debconf</span> 套件；相關的命令是 <code
              class="command">dpkg-reconfigure debconf</code>。組態值可能是在需要時暫時取代的環境變數 (例如，<code
              class="varname">DEBIAN_FRONTEND</code> 控制介面，如同在 <span
              class="citerefentry"><span
                class="refentrytitle">debconf</span>(7)</span> 手冊頁面所述)。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.9.17.8"></a>6.8.4. 處理命令列介面</h3></div></div></div><div
            class="para">
				最後一個互動來源，以及最難擺脫的，是 <code
              class="command">dpkg</code> 執行的組態腳本。不幸的是，沒有標準的解法且沒有較佳的答案。
			</div><div
            class="para">
				通常的做法是，把標準的輸入由空白內容的 <code
              class="filename">/dev/null</code> 檔案轉向給 <code
              class="command"><em
                class="replaceable">命令</em> &lt;/dev/null</code>，或由新的鍵入字串取代。以上的方法都不是 100 % 可靠，但它們可以轉至預設的答案，因為大部份的腳本已考量到無預設值的答案。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.9.17.9"></a>6.8.5. 神奇的組合</h3></div></div></div><div
            class="para">
				把前述的元素組合起來，就可能設計出一個可處理自動升級的小而可靠腳本。
			</div><div
            class="example"><a
              xmlns=""
              id="example.non-interactive-upgrade"></a><p
              class="title"><strong>範例 6.4. 無互動升級腳本</strong></p><div
              class="example-contents"><pre
                class="programlisting">export DEBIAN_FRONTEND=noninteractive
yes '' | apt-get -y -o DPkg::options::="--force-confdef" -o DPkg::options::="--force-confold" dist-upgrade</pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>實務</em></span> Falcot Corp 個案</strong></p></div></div></div><div
              class="para">
				Falcot 公司採用異質系統電腦，執行多種功能。管理者必須為每部電腦挑選最適合的解決方案。
			</div><div
              class="para">
				事實上，安裝 <span
                class="distribution distribution">Jessie</span> 的伺服器腦採用上述的 “奇特組合”，並且自動更新。祗有最挑剔的伺服器 (如防火牆) 才以 <code
                class="command">apticron</code> 設定，所以總是在管理員的監控下更新。
			</div><div
              class="para">
				辦公室的桌機也可安裝 <span
                class="distribution distribution">Jessie</span>，但加裝 <span
                class="pkg pkg">gnome-packagekit</span>，所以使用者可以自行更新。沒有使用者介入的更新，電腦可能出現無預期的結果，可能讓使用者摸不清頭緒。
			</div><div
              class="para">
				在實驗室裡，有些安裝 <span
                class="distribution distribution">測試版</span> — 就是使用最新版的軟體 — 的電腦也不會自動更新。管理者必須組態 APT 才能更新它們；決定更新時 (手動)，列出重新載入套件清單並避免下載繁瑣的部件，管理者就能專注在真正有用的部件。
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.regular-upgrades.html"><strong>前一頁</strong>6.7. 保持系統在最新狀態</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一層</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始頁</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.searching-packages.html"><strong>下一頁</strong>6.9. 搜尋套件</a></li></ul></body></html>
