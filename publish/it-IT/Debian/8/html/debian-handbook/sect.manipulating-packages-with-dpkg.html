<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">5.4. Manipolazione dei pacchetti con dpkg</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-it-IT-1.0-1" /><meta
        name="keywords"
        content="Pacchetto binario, Pacchetto sorgente, dpkg, dipendenze, conflitto" /><link
        rel="home"
        href="index.html"
        title="Il Manuale dell'Amministratore Debian" /><link
        rel="up"
        href="packaging-system.html"
        title="Capitolo 5. Sistema dei pacchetti: strumenti e principi fondamentali" /><link
        rel="prev"
        href="sect.source-package-structure.html"
        title="5.3. Struttura di un pacchetto sorgente" /><link
        rel="next"
        href="sect.coexistence-with-other-packaging-systems.html"
        title="5.5. Coesistenza con Altri Sistemi di Pacchetti" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/it-IT/stable/sect.manipulating-packages-with-dpkg.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.source-package-structure.html"><strong>Indietro</strong></a></li><li
          class="home">Il Manuale dell'Amministratore Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.coexistence-with-other-packaging-systems.html"><strong>Avanti</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.manipulating-packages-with-dpkg"></a>5.4. Manipolazione dei pacchetti con <code
                  class="command">dpkg</code></h2></div></div></div><a
          id="id-1.8.8.2"
          class="indexterm"></a><div
          class="para">
			<code
            class="command">dpkg</code> è il comando di base per gestire i pacchetti Debian sul sistema. Se si hanno dei pacchetti <code
            class="filename">.deb</code>, è <code
            class="command">dpkg</code> che permette l'installazione o l'analisi del loro contenuto. Ma questo programma ha solo una visione parziale dell'universo Debian: conosce cosa è installato sul sistema e ciò che è dato sulla riga di comando, ma non conosce nulla degli altri pacchetti disponibili. Perciò, fallirà se una dipendenza non è soddisfatta. Strumenti come <code
            class="command">apt-get</code>, al contrario, creano un elenco di dipendenze da installare il più automaticamente possibile.
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>NOTA</em></span> <code
                      class="command">dpkg</code> o <code
                      class="command">apt-get</code>?</strong></p></div></div></div><div
            class="para">
			<code
              class="command">dpkg</code> dovrebbe esere visto come uno strumento di sistema (backend) e <code
              class="command">apt-get</code> come uno strumento più vicino all'utente, che supera le precedenti limitazioni. Questi strumenti lavorano insieme, ognuno con le proprie peculiarità, adatte a compiti specifici.
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.8.8.5"></a>5.4.1. Installazione dei pacchetti</h3></div></div></div><a
            id="id-1.8.8.5.2"
            class="indexterm"></a><a
            id="id-1.8.8.5.3"
            class="indexterm"></a><div
            class="para">
				<code
              class="command">dpkg</code> è, soprattutto, uno strumento per installare un pacchetto Debian già disponibile (perché non scarica niente). Per fare ciò, si usa la sua opzione <code
              class="literal">-i</code> oppure <code
              class="literal">--install</code>.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.8.8.5.5"></a><p
              class="title"><strong>Esempio 5.2. Installazione di un pacchetto con <code
                  class="command">dpkg</code></strong></p><div
              class="example-contents"><pre
                class="screen scale">
<code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>dpkg -i man-db_2.7.0.2-5_amd64.deb</code></strong>
<code
                  class="computeroutput">(Reading database... 86425 files and directories currently installed.)
Preparing to unpack man-db_2.7.0.2-5_amd64.deb ...
Unpacking man-db (2.7.0.2-5) over (2.7.0.2-4) ...
Setting up man-db (2.7.0.2-5) ...
Updating database of manual pages ...
Processing triggers for mime-support (3.58) ...</code></pre></div></div><div
            class="para">
				Si possono vedere i differenti passi eseguiti da <code
              class="command">dpkg</code>; si può sapere, perciò, a quale punto si è verificato un errore. L'installazione può anche essere effettuata in due stadi: prima lo spacchettamento, poi la configurazione. <code
              class="command">apt-get</code> si avvantaggia di ciò, limitando il numero di chiamate a <code
              class="command">dpkg</code> (dal momento che ogni chiamata è onerosa a causa del caricamento del database in memoria, specialmente l'elenco dei file già installati).
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.8.8.5.7"></a><p
              class="title"><strong>Esempio 5.3. Spacchettamento e configurazione separati</strong></p><div
              class="example-contents"><pre
                class="screen scale">
<code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>dpkg --unpack man-db_2.7.0.2-5_amd64.deb</code></strong>
<code
                  class="computeroutput">(Reading database ... 86425 files and directories currently installed.)
Preparing to unpack man-db_2.7.0.2-5_amd64.deb ...
Unpacking man-db (2.7.0.2-5) over (2.7.0.2-5) ...
Processing triggers for mime-support (3.58) ...
# </code><strong
                  class="userinput"><code>dpkg --configure man-db</code></strong>
<code
                  class="computeroutput">Setting up man-db (2.7.0.2-5) ...
Updating database of manual pages ...
</code></pre></div></div><a
            id="id-1.8.8.5.8"
            class="indexterm"></a><a
            id="id-1.8.8.5.9"
            class="indexterm"></a><div
            class="para">
				Talvolta <code
              class="command">dpkg</code> non riuscirà a installare un pacchetto e restituirà un errore; se l'utente ordina di ignorarlo, verrà emesso soltanto un avvertimento; è per questo motivo che esistono le diverse opzioni <code
              class="literal">--force-*</code>. Il comando <code
              class="command">dpkg --force-help</code>, o la documentazione di questo comando, dà un elenco completo di queste opzioni. L'errore più frequente, che prima o poi si incontrerà, è una collisione tra file. Quando un pacchetto contiene un file che è già installato da un altro pacchetto, <code
              class="command">dpkg</code> si rifiuterà di installarlo. Il seguente messaggio apparirà:
			</div><pre
            class="screen">
<code
              class="computeroutput">Unpacking libisc52 (from .../libisc52_1%3a9.6.ESV.R1+dfsg-0+lenny2_amd64.deb) ...
dpkg : error processing /var/cache/apt/archives/libisc52_1%3a9.6.ESV.R1+dfsg-0+lenny2_amd64.deb (--unpack) :
 trying to overwrite "/usr/lib/libisc.so.50", which is also in package libisc50 1:9.6.1.dfsg.P1-3</code></pre><div
            class="para">
				In questo caso, se si pensa che sostituire questo file non sia un rischio significativo per la stabilità del sistema (e solitamente è così), si può usare l'opzione <code
              class="literal">--force-overwrite</code>, che dice a <code
              class="command">dpkg</code> di ignorare questo errore e di sovrascrivere il file.
			</div><div
            class="para">
				Anche se ci sono molte opzioni <code
              class="literal">--force-*</code>, è probabile che solo <code
              class="literal">--force-overwrite</code> sia usata regolarmente. Queste opzioni esistono solamente per situazioni eccezionali ed è meglio lasciarle stare il più possibile per rispettare le regole imposte dal meccanismo dei pacchetti. Non si dimentichi che queste regole assicurano la coerenza e la stabilità del sistema.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ATTENZIONE</em></span> Uso efficace di <code
                        class="literal">--force-*</code></strong></p></div></div></div><a
              id="id-1.8.8.5.14.2"
              class="indexterm"></a><div
              class="para">
				Se non si presta attenzione, l'uso di un'opzione <code
                class="literal">--force-*</code> può condurre a un sistema in cui la famiglia di comandi APT si rifiuterà di funzionare. Infatti, alcune di queste opzioni permettono l'installazione di un pacchetto quando una dipendenza non è soddisfatta o quando c'è un conflitto. Il risultato è un sistema non coerente dal punto di vista delle dipendenze e i comandi APT si rifiuteranno di eseguire qualsiasi azione a meno che l'azione non permetta di tornare a uno stato coerente (questo spesso consiste nell'installazione della dipendenza mancante o nella rimozione di un pacchetto problematico). Questo spesso risulta in un messaggio come il seguente, ottenuto dopo l'installazione di una nuova versione di <span
                class="pkg pkg">rdesktop</span> ignorando la sua dipendenza da una nuova versione di <span
                class="pkg pkg">libc6</span>:
			</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt full-upgrade
</code></strong><code
                class="computeroutput">[...]
You might want to run 'apt-get -f install' to correct these.
The following packages have unmet dependencies:
  rdesktop: Depends: libc6 (&gt;= 2.5) but 2.3.6.ds1-13etch7 is installed
E: Unmet dependencies. Try using -f.</code></pre><div
              class="para">
				Un amministratore coraggioso che sia certo della correttezza della propria analisi può scegliere di ignorare una dipendenza o un conflitto e usare la corrispondente opzione <code
                class="literal">--force-*</code>. In questo caso, se si vuole continuare a usare <code
                class="command">apt-get</code> o <code
                class="command">aptitude</code>, bisogna modificare <code
                class="filename">/var/lib/dpkg/status</code> per eliminare o modificare la dipendenza, o il conflitto, che si è scelto di scavalcare.
			</div><div
              class="para">
				Questa manipolazione è una "porcheria" e non dovrebbe esser fatta, eccetto nei casi più estremi di necessità. Piuttosto di frequente, una soluzione più adatta è di ricompilare il pacchetto che sta causando il problema (consultare la <a
                class="xref"
                href="debian-packaging.html#sect.rebuilding-package">Sezione 15.1, «Rigenerare un pacchetto dai suoi sorgenti»</a>) o usare una nuova versione (potenzialmente corretta) da un sito come <code
                class="literal">backports.debian.org</code> (consultare la <a
                class="xref"
                href="apt.html#sect.backports">Sezione 6.1.2.4, «Backport per Stable»</a>).
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.8.8.6"></a>5.4.2. Rimozione di pacchetti</h3></div></div></div><a
            id="id-1.8.8.6.2"
            class="indexterm"></a><a
            id="id-1.8.8.6.3"
            class="indexterm"></a><a
            id="id-1.8.8.6.4"
            class="indexterm"></a><a
            id="id-1.8.8.6.5"
            class="indexterm"></a><div
            class="para">
				Invocare <code
              class="command">dpkg</code> con l'opzione <code
              class="literal">-r</code> o <code
              class="literal">--remove</code> seguita dal nome del pacchetto, rimuove tale pacchetto. Questa rimozione, comunque, non è completa: rimangono tutti i file di configurazione e gli script, i file di registro (registri di sistema) e altri dati dell'utente gestiti dal pacchetto. La ragione della loro conservazione è di disabilitare il programma disinstallandolo, preservando allo stesso tempo l'opzione di reinstallarlo velocemente e con la stessa configurazione. Per rimuovere completamente ogni cosa associata al pacchetto, usare l'opzione <code
              class="literal">-P</code> o <code
              class="literal">--purge</code> seguita dal nome del pacchetto.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.8.8.6.7"></a><p
              class="title"><strong>Esempio 5.4. Rimozione ed eliminazione completa del pacchetto <span
                  class="emphasis"><em>debian-cd</em></span></strong></p><div
              class="example-contents"><pre
                class="screen"><code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>dpkg -r debian-cd</code></strong>
<code
                  class="computeroutput">(Reading database... 14170 files and directories already installed.)
Removing debian-cd ...
# </code><strong
                  class="userinput"><code>dpkg -P debian-cd</code></strong>
<code
                  class="computeroutput">(Reading database... 13794 files and directories already installed.)
Removing debian-cd ...
Removing debian-cd configuration files...</code></pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.8.8.7"></a>5.4.3. Interrogazione del Database di <code
                    class="command">dpkg</code> ed Ispezione dei File <code
                    class="filename">.deb</code></h3></div></div></div><a
            id="id-1.8.8.7.2"
            class="indexterm"></a><a
            id="id-1.8.8.7.3"
            class="indexterm"></a><a
            id="id-1.8.8.7.4"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>FONDAMENTALI</em></span> Sintassi delle opzioni</strong></p></div></div></div><div
              class="para">
				La maggior parte delle opzioni è disponibile nella versione "lunga" (una o più parole precedute da due trattini) o nella versione "corta" (una singola lettera, spesso l'iniziale di una parola della versione lunga, preceduta da un singolo trattino). Questa convenzione è così comune che è uno standard POSIX.
			</div></div><div
            class="para">
				Prima di concludere questa sezione, si noti che alcune opzioni di <code
              class="command">dpkg</code> possono interrogare il database interno per ottenere informazioni. Mostrando prima le opzioni lunghe e poi le corrispondenti opzioni corte (che evidentemente accettano i soliti argomenti) we cite <code
              class="literal">--listfiles <em
                class="replaceable">pacchetto</em></code> (o <code
              class="literal">-L</code>), che elenca i file installati da questo pacchetto; <code
              class="literal">--search <em
                class="replaceable">file</em></code> (o <code
              class="literal">-S</code>), che trova il pacchetto da cui proviene il file; <code
              class="literal">--status <em
                class="replaceable">pacchetto</em></code> (o <code
              class="literal">-s</code>), che mostra le intestazioni di un pacchetto installato; <code
              class="literal">--list</code> (o <code
              class="literal">-l</code>), che mostra l'elenco dei pacchetti conosciuti dal sistema e il loro stato di installazione; <code
              class="literal">--contents <em
                class="replaceable">file.deb</em></code> (o <code
              class="literal">-c</code>), che elenca i file nel pacchetto Debian specificato; <code
              class="literal">--info<em
                class="replaceable"> file.deb </em></code> (o <code
              class="literal">-I</code>), che mostra le intestazioni del pacchetto Debian.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.8.8.7.7"></a><p
              class="title"><strong>Esempio 5.5. Varie richieste con <code
                  class="command">dpkg</code></strong></p><div
              class="example-contents"><pre
                class="screen scale"
                width="80">
<code
                  class="computeroutput">$ </code><strong
                  class="userinput"><code>dpkg -L base-passwd</code></strong>
<code
                  class="computeroutput">/.
/usr
/usr/sbin
/usr/sbin/update-passwd
/usr/share
/usr/share/lintian
/usr/share/lintian/overrides
/usr/share/lintian/overrides/base-passwd
/usr/share/doc-base
/usr/share/doc-base/users-and-groups
/usr/share/base-passwd
/usr/share/base-passwd/group.master
/usr/share/base-passwd/passwd.master
/usr/share/man
/usr/share/man/pl
/usr/share/man/pl/man8
/usr/share/man/pl/man8/update-passwd.8.gz
/usr/share/man/ru
/usr/share/man/ru/man8
/usr/share/man/ru/man8/update-passwd.8.gz
/usr/share/man/ja
/usr/share/man/ja/man8
/usr/share/man/ja/man8/update-passwd.8.gz
/usr/share/man/fr
/usr/share/man/fr/man8
/usr/share/man/fr/man8/update-passwd.8.gz
/usr/share/man/es
/usr/share/man/es/man8
/usr/share/man/es/man8/update-passwd.8.gz
/usr/share/man/de
/usr/share/man/de/man8
/usr/share/man/de/man8/update-passwd.8.gz
/usr/share/man/man8
/usr/share/man/man8/update-passwd.8.gz
/usr/share/doc
/usr/share/doc/base-passwd
/usr/share/doc/base-passwd/users-and-groups.txt.gz
/usr/share/doc/base-passwd/changelog.gz
/usr/share/doc/base-passwd/copyright
/usr/share/doc/base-passwd/README
/usr/share/doc/base-passwd/users-and-groups.html
$ </code><strong
                  class="userinput"><code>dpkg -S /bin/date</code></strong>
<code
                  class="computeroutput">coreutils: /bin/date
$ </code><strong
                  class="userinput"><code>dpkg -s coreutils</code></strong>
<code
                  class="computeroutput">Package: coreutils
Essential: yes
Status: install ok installed
Priority: required
Section: utils
Installed-Size: 13855
Maintainer: Michael Stone &lt;mstone@debian.org&gt;
Architecture: amd64
Multi-Arch: foreign
Version: 8.23-3
Replaces: mktemp, realpath, timeout
Pre-Depends: libacl1 (&gt;= 2.2.51-8), libattr1 (&gt;= 1:2.4.46-8), libc6 (&gt;= 2.17), libselinux1 (&gt;= 2.1.13)
Conflicts: timeout
Description: GNU core utilities
 This package contains the basic file, shell and text manipulation
 utilities which are expected to exist on every operating system.
 .
 Specifically, this package includes:
 arch base64 basename cat chcon chgrp chmod chown chroot cksum comm cp
 csplit cut date dd df dir dircolors dirname du echo env expand expr
 factor false flock fmt fold groups head hostid id install join link ln
 logname ls md5sum mkdir mkfifo mknod mktemp mv nice nl nohup nproc numfmt
 od paste pathchk pinky pr printenv printf ptx pwd readlink realpath rm
 rmdir runcon sha*sum seq shred sleep sort split stat stty sum sync tac
 tail tee test timeout touch tr true truncate tsort tty uname unexpand
 uniq unlink users vdir wc who whoami yes
Homepage: http://gnu.org/software/coreutils
$ </code><strong
                  class="userinput"><code>dpkg -l 'b*'</code></strong>
<code
                  class="computeroutput">Voluto=U (non noto)/I (installato)/R (rimosso)/P (rimosso totale)/H (in attesa)
| Stato=Not/Inst/Conf-files/Unpacked/halF-conf/Half-inst/trig-aWait/Trig-pend
|/ Err?=(nessuno)/R (reinstallazione richiesta) (Stato,Err: maiuscolo=grave)
||/ Nome                    Versione          Architettura     Descrizione
+++-=======================-================-================-====================================================
un  backupninja             &lt;nessuna&gt;           &lt;nessuna&gt;           (nessuna descrizione disponibile)
un  base                    &lt;nessuna&gt;           &lt;nessuna&gt;           (nessuna descrizione disponibile)
un  base-config             &lt;none&gt;           &lt;none&gt;           (nessuna descrizione disponibile)
ii  base-files              8+deb8u2                amd64            Debian base system miscellaneous files
ii  base-passwd             3.5.37           amd64            Debian base system master password and group files
[...]
$ </code><strong
                  class="userinput"><code>dpkg -c /var/cache/apt/archives/gnupg_1.4.18-6_amd64.deb</code></strong>
<code
                  class="computeroutput">drwxr-xr-x root/root         0 2014-12-04 23:03 ./
drwxr-xr-x root/root         0 2014-12-04 23:03 ./lib/
drwxr-xr-x root/root         0 2014-12-04 23:03 ./lib/udev/
drwxr-xr-x root/root         0 2014-12-04 23:03 ./lib/udev/rules.d/
-rw-r--r-- root/root      2711 2014-12-04 23:03 ./lib/udev/rules.d/60-gnupg.rules
drwxr-xr-x root/root         0 2014-12-04 23:03 ./usr/
drwxr-xr-x root/root         0 2014-12-04 23:03 ./usr/lib/
drwxr-xr-x root/root         0 2014-12-04 23:03 ./usr/lib/gnupg/
-rwxr-xr-x root/root     39328 2014-12-04 23:03 ./usr/lib/gnupg/gpgkeys_ldap
-rwxr-xr-x root/root     92872 2014-12-04 23:03 ./usr/lib/gnupg/gpgkeys_hkp
-rwxr-xr-x root/root     47576 2014-12-04 23:03 ./usr/lib/gnupg/gpgkeys_finger
-rwxr-xr-x root/root     84648 2014-12-04 23:03 ./usr/lib/gnupg/gpgkeys_curl
-rwxr-xr-x root/root      3499 2014-12-04 23:03 ./usr/lib/gnupg/gpgkeys_mailto
drwxr-xr-x root/root         0 2014-12-04 23:03 ./usr/bin/
-rwxr-xr-x root/root     60128 2014-12-04 23:03 ./usr/bin/gpgsplit
-rwxr-xr-x root/root   1012688 2014-12-04 23:03 ./usr/bin/gpg
[...]
$ </code><strong
                  class="userinput"><code>dpkg -I /var/cache/apt/archives/gnupg_1.4.18-6_amd64.deb</code></strong>
<code
                  class="computeroutput"> nuovo pacchetto debian, version 2.0.
 size 1148362 bytes: control archive=3422 bytes.
    1264 bytes,    26 lines      control              
    4521 bytes,    65 lines      md5sums              
     479 bytes,    13 lines   *  postinst             #!/bin/sh
     473 bytes,    13 lines   *  preinst              #!/bin/sh
 Package: gnupg
 Version: 1.4.18-6
 Architecture: amd64
 Maintainer: Debian GnuPG-Maintainers &lt;pkg-gnupg-maint@lists.alioth.debian.org&gt;
 Installed-Size: 4888
 Depends: gpgv, libbz2-1.0, libc6 (&gt;= 2.15), libreadline6 (&gt;= 6.0), libusb-0.1-4 (&gt;= 2:0.1.12), zlib1g (&gt;= 1:1.1.4)
 Recommends: gnupg-curl, libldap-2.4-2 (&gt;= 2.4.7)
 Suggests: gnupg-doc, libpcsclite1, parcimonie, xloadimage | imagemagick | eog
 Section: utils
 Priority: important
 Multi-Arch: foreign
 Homepage: http://www.gnupg.org
 Description: GNU privacy guard - a free PGP replacement
  GnuPG is GNU's tool for secure communication and data storage.
  It can be used to encrypt data and to create digital signatures.
  It includes an advanced key management facility and is compliant
  with the proposed OpenPGP Internet standard as described in RFC 4880.
[...]</code></pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>APPROFONDIMENTI</em></span> Confronto di versioni</strong></p></div></div></div><a
              id="id-1.8.8.7.8.2"
              class="indexterm"></a><a
              id="id-1.8.8.7.8.3"
              class="indexterm"></a><div
              class="para">
				Dal momento che <code
                class="command">dpkg</code> è il programma per gestire pacchetti Debian, fornisce anche l'implementazione tipo della logica di confronto dei numeri di versione. Questo è il motivo per cui ha un'opzione <code
                class="literal">--compare-versions</code> utilizzabile da programmi esterni (specialmente gli script di configurazione eseguiti dallo stesso <code
                class="command">dpkg</code>). Questa opzione richiede tre parametri: un numero di versione, un operatore di confronto e un secondo numero di versione. I diversi operatori possibili sono <code
                class="literal">lt</code> (strettamente minore), <code
                class="literal">le</code> (minore o uguale), <code
                class="literal">eq</code> (uguale), <code
                class="literal">ne</code> (diverso), <code
                class="literal">ge</code> (maggiore o uguale) e <code
                class="literal">gt</code> (strettamente maggiore). Se il confronto è corretto, <code
                class="command">dpkg</code> restituisce il codice di ritorno 0 (successo), altrimenti restituisce un valore di ritorno diverso da zero (che indica fallimento).
			</div><pre
              class="screen">
<code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg --compare-versions 1.2-3 gt 1.1-4</code></strong>
<code
                class="computeroutput">$ </code><strong
                class="userinput"><code>echo $?</code></strong>
<code
                class="computeroutput">0
$ </code><strong
                class="userinput"><code>dpkg --compare-versions 1.2-3 lt 1.1-4</code></strong>
<code
                class="computeroutput">$ </code><strong
                class="userinput"><code>echo $?</code></strong>
<code
                class="computeroutput">1
$ </code><strong
                class="userinput"><code>dpkg --compare-versions 2.6.0pre3-1 lt 2.6.0-1</code></strong>
<code
                class="computeroutput">$ </code><strong
                class="userinput"><code>echo $?</code></strong>
<code
                class="computeroutput">1</code></pre><div
              class="para">
				Si noti il fallimento inatteso dell'ultimo confronto: per <code
                class="command">dpkg</code>, <code
                class="literal">pre</code>, che normalmente indica un pre-rilascio, non ha alcun particolare significato e questo programma confronta i caratteri alfabetici nello stesso modo dei numeri (a &lt;b &lt;c ...) in ordine alfabetico. Questo è il motivo per cui "<code
                class="literal">0pre3</code>" è considerato maggiore di "<code
                class="literal">0</code>". Quando si vuole che un numero di versione di un pacchetto indichi che si tratta di un pre-rilascio, si deve usare il carattere tilde "<code
                class="literal">~</code>":
			</div><pre
              class="screen">
<code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg --compare-versions 2.6.0~pre3-1 lt 2.6.0-1</code></strong>
<code
                class="computeroutput">$ </code><strong
                class="userinput"><code>echo $?</code></strong>
<code
                class="computeroutput">0</code></pre></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.8.8.8"></a>5.4.4. File di registro di <code
                    class="command">dpkg</code></h3></div></div></div><div
            class="para">
				Una funzionalità introdotta recentemente in <code
              class="command">dpkg</code> è che mantiene un registro di tutte le proprie azioni in <code
              class="filename">/var/log/dpkg.log</code>. Questo registro è estremamente prolisso, dal momento che contiene dettagli di ciascun stato attraverso cui passano i pacchetti gestiti da <code
              class="command">dpkg</code>. Oltre a offrire un modo per tenere traccia del comportamento di dpkg, ciò aiuta, soprattutto, a mantenere una cronologia dello sviluppo del sistema: si può trovare il momento esatto in cui ciascun pacchetto è stato installato o aggiornato e queste informazioni possono essere estremamente utili nel comprendere un recente cambiamento di comportamento. Inoltre, siccome tutte le versioni sono registrate, è facile incrociare queste informazioni con il <code
              class="filename">changelog.Debian.gz</code> dei pacchetti in questione o anche con le segnalazioni di bug online.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.multi-arch"></a>5.4.5. Supporto Multi-Arch</h3></div></div></div><a
            id="id-1.8.8.9.2"
            class="indexterm"></a><a
            id="id-1.8.8.9.3"
            class="indexterm"></a><div
            class="para">
				Tutti i pacchetti Debian hanno un campo <code
              class="literal">Architecture</code> nelle loro informazioni di controllo. Questo campo può contenere tutti “<code
              class="literal">all</code>” (per i pacchetti indipendenti dalle architetture) oppure il nome dell'architettura per la quale è sviluppato il pacchetto (come “amd64”, “armhf”, …). In quest'ultimo caso, per impostazione predefinita, <code
              class="command">dpkg</code> accetterà di installare il pacchetto solo se la sua architettura corrisponde a quella dell'host come restituito da <code
              class="command">dpkg --print-architecture</code>.
			</div><div
            class="para">
				Questa restrizione assicura che gli utenti non finiscano con binari compilati per un'architettura sbagliata. Tutto sarebbe perfetto, se non fosse che (alcuni) i computer possono eseguire binari per architetture multiple, sia nativamente (un sistema "amd64" può eseguire binari "i386") che attraverso emulatori.
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.8.9.6"></a>5.4.5.1. Abilitazione Multi-Arch</h4></div></div></div><div
              class="para">
					Il supporto multi-arch di <code
                class="command">dpkg</code> consente agli utenti di definire le "architetture esterne" che possono essere installate sul sistema corrente. Questo può essere fatto semplicemnete con <code
                class="command">dpkg --add-architecture</code> come nell'esempio qui sotto. C'è un comando corrispondente per rimuovere il supporto ad un'architettura esterna che è <code
                class="command">dpkg --remove-architecture</code>, ma può essere utilizzato solo quando non rimangono pacchetti di questa archietttura.
				</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>dpkg --print-architecture</code></strong>
<code
                class="computeroutput">amd64
# </code><strong
                class="userinput"><code>dpkg --print-foreign-architectures</code></strong>
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>dpkg -i gcc-4.9-base_4.9.1-19_armhf.deb</code></strong>
<code
                class="computeroutput">dpkg: error processing archive gcc-4.9-base_4.9.1-19_armhf.deb (--install):
 package architecture (armhf) does not match system (amd64)
Errors were encountered while processing:
 gcc-4.9-base_4.9.1-19_armhf.deb
# </code><strong
                class="userinput"><code>dpkg --add-architecture armhf</code></strong>
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>dpkg --add-architecture armel</code></strong>
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>dpkg --print-foreign-architectures</code></strong>
<code
                class="computeroutput">armhf
armel
# </code><strong
                class="userinput"><code>dpkg -i gcc-4.9-base_4.9.1-19_armhf.deb</code></strong>
<code
                class="computeroutput">Selecting previously unselected package gcc-4.9-base:armhf.
(Reading database ... 86425 files and directories currently installed.)
Preparing to unpack gcc-4.9-base_4.9.1-19_armhf.deb ...
Unpacking gcc-4.9-base:armhf (4.9.1-19) ...
Setting up gcc-4.9-base:armhf (4.9.1-19) ...
# </code><strong
                class="userinput"><code>dpkg --remove-architecture armhf</code></strong>
<code
                class="computeroutput">dpkg: error: cannot remove architecture 'armhf' currently in use by the database
# </code><strong
                class="userinput"><code>dpkg --remove-architecture armel</code></strong>
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>dpkg --print-foreign-architectures</code></strong>
<code
                class="computeroutput">armhf</code></pre><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>SUGGERIMENTO</em></span> Diagrammi di stato</strong></p></div></div></div><div
                class="para">
					APT rileverà automaticamente quando dpkg è stato configurato per supportare architetture differenti ed inizierà a scaricare i corrispondenti file dei <code
                  class="filename">Pacchetti</code> durante il suo processo di aggiornamento.
				</div><div
                class="para">
					I pacchetti esterni possono essere installati con <code
                  class="command">apt install <em
                    class="replaceable">pacchetto</em>:<em
                    class="replaceable">architettura</em></code>.
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>IN PRATICA</em></span> Uso dei binari proprietari i386 su amd64</strong></p></div></div></div><div
                class="para">
					Ci sono diversi casi di utilizzo di multi-arch, ma il più popolare è la possibilità di eseguire binari a 32 bit (i386) su sistemi a 64 bit (amd64), in particolare poichè diverse applicazioni proprietarie popolari (come Skype) sono previste solo in versioni a 32 bit.
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.8.9.7"></a>5.4.5.2. Variazioni Relative a Multi-Arch</h4></div></div></div><div
              class="para">
					Per rendere multi-arch realmente utile ed utilizzabile, le librerie hanno dovuto essere riassemblate e spostate in una directory specifica per l' architettura in modo che possano essere installate più copie (per diverse architetture) contemporaneamente. Tali pacchetti aggiornati contengono il campo header “<code
                class="literal">Multi-Arch: same</code>” per dire al sistema dei pacchetti che le varie architetture possono essere installate insieme in sicurezza. (e che quei pacchetti possono di soddisfare in modo sicuro solo le dipendenze dei pacchetti della stessa architettura). Dal debutto di multi-arch in Debian <span
                class="distribution distribution">Wheezy</span>, non tutte le librerie sono state ancora convertite.
				</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg -s gcc-4.9-base
</code></strong><code
                class="computeroutput">dpkg-query: error: --status needs a valid package name but 'gcc-4.9-base' is not: ambiguous package name 'gcc-4.9-base' with more than one installed instance

Use --help for help about querying packages.
$ </code><strong
                class="userinput"><code>dpkg -s gcc-4.9-base:amd64 gcc-4.9-base:armhf | grep ^Multi
</code></strong><code
                class="computeroutput">Multi-Arch: same
Multi-Arch: same
$ </code><strong
                class="userinput"><code>dpkg -L libgcc1:amd64 |grep .so
</code></strong><code
                class="computeroutput">/lib/x86_64-linux-gnu/libgcc_s.so.1
$ </code><strong
                class="userinput"><code>dpkg -S /usr/share/doc/gcc-4.9-base/copyright
</code></strong><code
                class="computeroutput">gcc-4.9-base:amd64, gcc-4.9-base:armhf: /usr/share/doc/gcc-4.9-base/copyright
</code></pre><div
              class="para">
					Vale la pena notare che i pacchetti <code
                class="literal">Multi-Arch: same</code> devono avere i nomi che identificano le loro architetture per essere identificati senza ambiguità. Essi hanno anche la possibilità di condividere i file con altre istanze dello stesso pacchetto; <code
                class="command">dpkg</code> assicura che tutti i pacchetti abbiano dei file identici bit-per-bit quando sono condivisi. Infine, tutte le istanze di un pacchetto devono avere la stessa versione. Essi devono quindi essere aggiornati insieme.
				</div><div
              class="para">
					Il supporto multi-Arch portacon sè anche alcune sfide interessanti nel modo in cui sono gestite le dipendenze. Soddisfare una dipendenza richiede o un pacchetto contrassegnato come “<code
                class="literal">Multi-Arch: foreign</code>” o un pacchetto la cui architettura corrisponde a quella del pacchetto del quale dichiara la dipendenza (in questo processo di risoluzione delle dipendenze, i pacchetti architettura-indipendenti si presume che siano della stessa architettura dell'host). Una dipendenza può anche essere indebolita per consentire a qualsiasi architettura di soddisfarla, con la sintassi <code
                class="literal"><em
                  class="replaceable">package</em>:any</code>, ma i pacchetti esterni sono in grado di soddisfarla solo se sono contrassegnati come “<code
                class="literal">Multi-Arch: allowed</code>”.
				</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.source-package-structure.html"><strong>Indietro</strong>5.3. Struttura di un pacchetto sorgente</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Risali</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Partenza</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.coexistence-with-other-packaging-systems.html"><strong>Avanti</strong>5.5. Coesistenza con Altri Sistemi di Pacchetti</a></li></ul></body></html>
