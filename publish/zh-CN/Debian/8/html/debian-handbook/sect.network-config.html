<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">8.2. 配置网络</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-zh-CN-1.0-1" /><meta
        name="keywords"
        content="配置, 本地化, 地区设置, 网络, 名称解析, 用户, 用户组, 账户, 命令行解释器, Shell, 打印, Bootloader, 内核编译" /><link
        rel="home"
        href="index.html"
        title="Debian 管理员手册" /><link
        rel="up"
        href="basic-configuration.html"
        title="第 8 章 基础配置：网络，账户，打印……" /><link
        rel="prev"
        href="basic-configuration.html"
        title="第 8 章 基础配置：网络，账户，打印……" /><link
        rel="next"
        href="sect.hostname-name-service.html"
        title="8.3. 设置主机名称与配置名称服务" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/zh-CN/stable/sect.network-config.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="basic-configuration.html"><strong>上一页</strong></a></li><li
          class="home">Debian 管理员手册</li><li
          class="next"><a
            accesskey="n"
            href="sect.hostname-name-service.html"><strong>下一页</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.network-config"></a>8.2. 配置网络</h2></div></div></div><div
          class="sidebar"><a
            xmlns=""
            id="sidebar.networking-basics"></a><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>基本知识</em></span>必要的网络概念（以太网、IP地址、子网、广播）</strong></p></div></div></div><a
            id="id-1.11.6.2.2"
            class="indexterm"></a><a
            id="id-1.11.6.2.3"
            class="indexterm"></a><a
            id="id-1.11.6.2.4"
            class="indexterm"></a><a
            id="id-1.11.6.2.5"
            class="indexterm"></a><a
            id="id-1.11.6.2.6"
            class="indexterm"></a><a
            id="id-1.11.6.2.7"
            class="indexterm"></a><a
            id="id-1.11.6.2.8"
            class="indexterm"></a><div
            class="para">
			当代的网络多半使用 Ethernet 协定，数据分为小小的区块称为框并且一次发送一个框。发送的速度从旧型 Ethernet 卡的 10 Mb/s 至最新卡的 10 Gb/s (最常见的速度为 100 Mb/s 至 1 Gb/s)。最常见的缆线是 10BASE-T、100BASE-T、1000BASE-T 或 10GBASE-T，视需求而定 (T 是双绞线英文名称的第一个字母 “twisted pair”)；这些缆线以 RJ45 链接器相接。当然还有其他类型的缆线，通常供速度超过 1 Gb/s 以上的环境使用。
		</div><a
            id="id-1.11.6.2.10"
            class="indexterm"></a><a
            id="id-1.11.6.2.11"
            class="indexterm"></a><div
            class="para">
			IP 地址是一组数字用于辨识电脑在地区网络或互联网的接口。最常用的是 IP 版本是 (IPv4)，此组数字由 32 比特编成，通常以句点区隔的 4 个数字表示 (如 <code
              class="literal">192.168.0.1</code>)，使用 0 至 255 之间的数字 (含在内，对应于 8 比特的数据)。通信协定的下个版本是 IPv6，采用 128 比特表示一个地址，其地址以 16 进位表示，用冒号区隔 (如，2001:0db8:13bb:0002:0000:0000:0000:0020，或 2001:db8:13bb:2::20 简版表示)。
		</div><a
            id="id-1.11.6.2.13"
            class="indexterm"></a><a
            id="id-1.11.6.2.14"
            class="indexterm"></a><a
            id="id-1.11.6.2.15"
            class="indexterm"></a><div
            class="para">
			次网络遮罩 (网络遮罩) 设置对应于网络的 IP 地址二进位代码，其余的则有机器指定。在前述的固定 IPv4 地址中，次网络遮罩，<code
              class="literal">255.255.255.0</code> (以 2 进位表示，就是 24 个 “1” 之后接着 8 个 “0”) 表示 IP 地址前 24 比特对应至网络地址，且其余 8 个则指向机器。在 IPv6 里，为了方便阅读，祗表示数字 “1”；IPv6 网络的网络遮罩可以是 <code
              class="literal">64</code>。
		</div><div
            class="para">
			网络地址是一个 IP 地址，描述机器的号码是 0。IPv4 地址的范围是完成的网络以此语法表示，<span
              class="emphasis"><em>a.b.c.d/e</em></span>，<span
              class="emphasis"><em>a.b.c.d</em></span> 是网络地址，而 <span
              class="emphasis"><em>e</em></span> 是被影响的比特数。因此，此网络可写成：<code
              class="literal">192.168.0.0/24</code>。在 IPv6 的类似语法为：<code
              class="literal">2001:db8:13bb:2::/64</code>。
		</div><a
            id="id-1.11.6.2.18"
            class="indexterm"></a><a
            id="id-1.11.6.2.19"
            class="indexterm"></a><div
            class="para">
			路由器用于链接多个网络。进入路由器的信息被引导至正确的网络。所以，路由器分析进来的封包，根据其目的地址转送至其他地方。路由器通常称为网关；协助进入在地网络以外的地方 (互联网之类的外部网络)。
		</div><a
            id="id-1.11.6.2.21"
            class="indexterm"></a><div
            class="para">
			特定的广播地址链接网络内所有的站台。几乎不曾 “发送”，祗在网络内发送问题。就是说，经由广播发送的数据封包不会通常路由器。
		</div><div
            class="para">
			本章祗讨论 IPv4 地址，现在最常见的。IPv6 协定的详情在 <a
              class="xref"
              href="sect.ipv6.html">第 10.5 节 “IPV6”</a>，其概念是一样的。
		</div></div><div
          class="para">
			初始安装时会自动配置网络，<code
            class="filename">/etc/network/interfaces</code> 文件内已有完备的配置。以 <code
            class="literal">auto</code> 起头的数据在开机时自动被 <span
            class="pkg pkg">ifupdown</span> 配置，且配置它的 <code
            class="filename">/etc/init.d/networking</code> init 脚本。通常是 <code
            class="literal">eth0</code>，指向第一个 Ethernet 网卡。
		</div><a
          id="id-1.11.6.4"
          class="indexterm"></a><a
          id="id-1.11.6.5"
          class="indexterm"></a><a
          id="id-1.11.6.6"
          class="indexterm"></a><a
          id="id-1.11.6.7"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>其他</em></span> NetworkManager</strong></p></div></div></div><a
            id="id-1.11.6.8.2"
            class="indexterm"></a><div
            class="para">
			漫游设置推荐使用的网络管理器 (见 <a
              class="xref"
              href="sect.network-config.html#sect.roaming-network-config">第 8.2.4 节 “网络自动配置漫游用户”</a>)，同样适用于缺省的网络管理工具。启动电脑时以人工启用 <code
              class="filename">.ini</code> 之类的文件在 <code
              class="filename">/etc/NetworkManager/system-connections/</code> 之内或经由图形工具 (<code
              class="command">nm-connection-editor</code>)，可以同时添加 “系统链接”。想要网络管理器处理它们时，记得关闭 <code
              class="filename">/etc/network/interfaces</code> 内的所有条目。<div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="https://wiki.gnome.org/Projects/NetworkManager/SystemSettings/jessie">https://wiki.gnome.org/Projects/NetworkManager/SystemSettings/jessie</a></div> <div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="https://developer.gnome.org/NetworkManager/0.9/ref-settings.html">https://developer.gnome.org/NetworkManager/0.9/ref-settings.html</a></div>
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.interface-ethernet"></a>8.2.1. Ethernet 接口</h3></div></div></div><div
            class="para">
				电脑使用 Ethernet 网络卡时，必须以下列的方法之一配置 IP 网络。最简单的方式是以 DHCP 动态配置，需要在地网络的 DHCP 服务器。可以使用与下例 <code
              class="literal">hostname</code> 设置的主机名称。DHCP 服务器就会送出配置设置给适当的网络。
			</div><a
            id="id-1.11.6.9.3"
            class="indexterm"></a><a
            id="id-1.11.6.9.4"
            class="indexterm"></a><div
            class="example"><a
              xmlns=""
              id="example.config-dhcp"></a><p
              class="title"><strong>例 8.1. DHCP 配置</strong></p><div
              class="example-contents"><pre
                class="programlisting">
auto eth0
iface eth0 inet dhcp
  hostname arrakis</pre></div></div><div
            class="para">
				“静态” 配置必须以固定方式指明网络设置。至少包括 IP 网址及次网络遮罩；有时也列出网络及广播地址。必须以闸道指出链接外部的路由器。
			</div><div
            class="example"><a
              xmlns=""
              id="example.static-network"></a><p
              class="title"><strong>例 8.2. 静态配置</strong></p><div
              class="example-contents"><pre
                class="programlisting">
auto eth0
iface eth0 inet static
  address 192.168.0.3
  netmask 255.255.255.0
  broadcast 192.168.0.255
  network 192.168.0.0
  gateway 192.168.0.1</pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>说明</em></span> 多地址</strong></p></div></div></div><div
              class="para">
				在一个实体网络卡上可以链接多个接口，而且可以设置多个 IP 地址。IP 地址本身可以经由 DNS 对应至多个网域名称，名称本身可以对应至多个 IP 地址。
			</div><div
              class="para">
				如您所想，配置可以极为复杂，不过祗限于极为特殊的例子。此处引用的例子都是一般常见的配置。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.ppp-rtc"></a>8.2.2. 经由 PSTN 调制解调器的 PPP 链接</h3></div></div></div><a
            id="id-1.11.6.10.2"
            class="indexterm"></a><a
            id="id-1.11.6.10.3"
            class="indexterm"></a><a
            id="id-1.11.6.10.4"
            class="indexterm"></a><a
            id="id-1.11.6.10.5"
            class="indexterm"></a><div
            class="para">
				点对点 (PPP) 链接创建断续的链接；这是电话调制解调器最常见的链接方式 (“PSTN 调制解调器”，经由公共交换电话网络)。
			</div><div
            class="para">
				电话调制解调器需要帐号才能链接，包括电话号码、用户名、密码、以及认证协定。这种链接 Debian 同名套件内的使用 <code
              class="command">pppconfig</code> 工具。缺省使用的名称是 <code
              class="literal">提供者</code> (做为互联网服务提供者)。对认证协定有疑义时，选择 <span
              class="emphasis"><em>PAP</em></span>：大多数互联网服务提供者使用它。
			</div><a
            id="id-1.11.6.10.8"
            class="indexterm"></a><a
            id="id-1.11.6.10.9"
            class="indexterm"></a><div
            class="para">
				配置之后，就可以使用 <code
              class="command">pon</code> 命令 (<code
              class="literal">提供者</code> 的默认值不适用时，将链接的名称当成参数)。以 <code
              class="command">poff</code> 命令断线。这两个令可以被根用户运行，或位在 <code
              class="literal">dip</code> 群组的其他用户。
			</div><a
            id="id-1.11.6.10.11"
            class="indexterm"></a><a
            id="id-1.11.6.10.12"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.adsl"></a>8.2.3. 以 ADSL 数据链接</h3></div></div></div><a
            id="id-1.11.6.11.2"
            class="indexterm"></a><a
            id="id-1.11.6.11.3"
            class="indexterm"></a><a
            id="id-1.11.6.11.4"
            class="indexterm"></a><div
            class="para">
				“ADSL 调制解调器” 一辞包括不同功能的多种设备。使用 Linux 的调制解调器有 Ethernet 接口 (不祗是 USB 接口)。这是极为普遍的调制解调器；大部份的 ADSL 互联网服务商出借 (或出租) 一个含 Ethernet 接口的 “盒子”。视其类型而有不同的设置。
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.adsl-pppoe"></a>8.2.3.1. 支持 PPPOE 的调制解调器</h4></div></div></div><a
              id="id-1.11.6.11.6.2"
              class="indexterm"></a><a
              id="id-1.11.6.11.6.3"
              class="indexterm"></a><div
              class="para">
					部份 Ethernet 调制解调器使用 PPPOE 协定 (以太网上的对等协定，Point to Point Protocol over Ethernet)。<code
                class="command">pppoeconf</code> 工具 (位于同名套件内) 将配置其链接。修改 <code
                class="filename">/etc/ppp/peers/dsl-provider</code> 文件内容时，采用 <code
                class="filename">/etc/ppp/pap-secrets</code> 与 <code
                class="filename">/etc/ppp/chap-secrets</code> 文件的内容。建议全盘接纳所有的提议。
				</div><div
              class="para">
					配置完成之后，以命令 <code
                class="command">pon dsl-provider</code> 开启 ADSL 链接，并以命令 <code
                class="command">poff dsl-provider</code> 断线。
				</div><a
              id="id-1.11.6.11.6.6"
              class="indexterm"></a><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>秘诀</em></span>启动 <code
                          class="command">ppp</code> 于开机时</strong></p></div></div></div><a
                id="id-1.11.6.11.6.7.2"
                class="indexterm"></a><a
                id="id-1.11.6.11.6.7.3"
                class="indexterm"></a><div
                class="para">
					PPP 在 ADSL 上的链接，其本意是断断续续的。因为不是依照连接时间收费，所以不必随时打开它。标准的方法是使用 init 系统。
				</div><div
                class="para">
					在 <span
                  class="distribution distribution">Jessie</span> 缺省的 init 系统是 <code
                  class="command">systemd</code>。在 ADSL 链接自动重新启动很简单，添加一个像 <code
                  class="filename">/etc/systemd/system/adsl-connection.service</code> 之类的 “unit file” 就可以了，其内容类似以下的：
				</div><pre
                class="programlisting">[Unit]
Description=ADSL connection

[Service]
Type=forking
ExecStart=/usr/sbin/pppd call dsl-provider
Restart=always

[Install]
WantedBy=multi-user.target</pre><div
                class="para">
					设置这个 unit file 之后，还需以 <code
                  class="command">systemctl enable adsl-connection</code> 命令启动它。然后以手动方式，启动此命令 <code
                  class="command">systemctl start adsl-connection</code> 循环；然后就可在开机时自动启动。
				</div><div
                class="para">
					未使用 <code
                  class="command">systemd</code> 命令的系统 (包括 <span
                  class="distribution distribution">Wheezy</span> 及更早的 Debian 版本)，可使用标准的 SystemV init。在这种系统里，祗需在 <code
                  class="filename">/etc/inittab</code> 文件加入一行字；然后，在断线之后，运行 <code
                  class="command">init</code> 就可重新连接。
				</div><pre
                class="programlisting">
adsl:2345:respawn:/usr/sbin/pppd call dsl-provider</pre><div
                class="para">
					拨接后自动断线的 ADSL，这种方法减少中断的次数。
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.adsl-pptp"></a>8.2.3.2. 支持 PPTP 的调制解调器</h4></div></div></div><a
              id="id-1.11.6.11.7.2"
              class="indexterm"></a><div
              class="para">
					PPTP (点对点隧道协议，Point-to-Point Tunneling Protocol) 协定由微软创制。在 ADSL 的初期就已布置，取代 PPPOE。若被强迫使用此协定，参见 <a
                class="xref"
                href="sect.virtual-private-network.html#sect.pptp">第 10.2.4 节 “PPTP”</a>。
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.adsl-dhcp"></a>8.2.3.3. 支持 DHCP 调制解调器</h4></div></div></div><div
              class="para">
					以 Ethernet 缆线 (跳线) 连接电脑的调制解调器，可以在电脑以 DHCP 配置网络链接；调制解调器自动成为闸道且运行路由的功能 (就是管理电脑与互联网的流量)。
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>基本</em></span> 直接链接 Ethernet 的跳线</strong></p></div></div></div><a
                id="id-1.11.6.11.8.3.2"
                class="indexterm"></a><div
                class="para">
					电脑网络卡经由特定缆线接收数据，也从同样的管道送出数据。电脑连上地区网络后，通常以缆线 (直接连接或跳线) 链接网络上与中继器或交换器。若想直接链接两部电脑 (不经过交换器或中继器)，必须经由网络卡送出数据至接收端的另个网络卡，反之亦然。这就是跳线的作用，以及使用它的原因。
				</div><div
                class="para">
					此区别在现在的环境没有作用，现代的网络卡可以自动侦测缆线的类型并据以配合它，所以两种缆线都可运用自如。
				</div></div><div
              class="para">
					大部份的 “ADSL 路由器” 也能这么做，互联网服务供应商提供的 ADSL 调制解调器也具有此功能。
				</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.roaming-network-config"></a>8.2.4. 网络自动配置漫游用户</h3></div></div></div><a
            id="id-1.11.6.12.2"
            class="indexterm"></a><a
            id="id-1.11.6.12.3"
            class="indexterm"></a><div
            class="para">
				Falcot 公司的工程师拥有专业用的笔电，同时也在家里使用它。根据使用场所的不同，网络有不同的配置方式。在家里，可能使用 WiFi 网络 (以 WPA 钥保护)，在工作场合则使用较安全与带宽更充足的固接网络。
			</div><div
            class="para">
				为了避免人工链接与断线对应的网络接口，管理者在漫游机器安装 <span
              class="pkg pkg">network-manager</span> 套件。此软件可以让用户从图形桌面的小图标，在多个网络间切换。按下此图标即显示可用的网络 (固接与无线)，借以选择其中之一。此程序保存曾链接网络的配置，断线时自动选择最佳的网络。
			</div><div
            class="para">
				为了达到这个目的，程序分为两个部份：在根部运行后台进程并配置网络接口与用户接口控制该后台进程。PolicyKit 处理必要的权限以控制此程序，然后由 Debian 配置 PolicyKit 让 netdev 群组成员可以添加或修改 Network Manager 的链接。
			</div><div
            class="para">
				程序自身已配置后，网络管理器就能够处理多种类型的连接 (DHCP、手动配置、地区网络)。所以能够系统地忽略在 <code
              class="filename">/etc/network/interfaces</code> 里面不合适的网络接口。网络管理器无法提供未显示网络连接的详情，最简单的方法是删除 <code
              class="filename">/etc/network/interfaces</code> 内必须由网络管理器配置的所有接口。
			</div><div
            class="para">
				在初始安装阶段选择 “桌面环境”的工作，就能够缺省安装此程序。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>其他</em></span> 由“网络设置档”配置</strong></p></div></div></div><a
              id="id-1.11.6.12.9.2"
              class="indexterm"></a><div
              class="para">
				更高端的用户可能布望试用 <span
                class="pkg pkg">guessnet</span> 套件做为网络自动配置的工具。以一组测试脚本决定启用与配置的网络设置档。
			</div><div
              class="para">
				以人工选定网络设置的用户，将偏向使用在同名套件内找到的 <span
                class="pkg pkg">netenv</span> 程序。
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="basic-configuration.html"><strong>上一页</strong>第 8 章 基础配置：网络，账户，打印……</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一级</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始页</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.hostname-name-service.html"><strong>下一页</strong>8.3. 设置主机名称与配置名称服务</a></li></ul></body></html>
