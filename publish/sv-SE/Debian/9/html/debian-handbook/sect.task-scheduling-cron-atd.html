<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">9.7. Schemalägga uppgifter med cron and atd</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-sv-SE-1.0-1" /><meta
        name="keywords"
        content="System boot, Initskript, SSH, Telnet, Rättigheter, Behörigheter, Övervakning, Inetd, Cron, Säkerhetskopia, Inpluggninsbara, PCMCIA, APM, ACPI" /><link
        rel="home"
        href="index.html"
        title="Handbok för Debianadministratören" /><link
        rel="up"
        href="unix-services.html"
        title="Kapitel 9. Unixtjänster" /><link
        rel="prev"
        href="sect.inetd.html"
        title="9.6. Superservern inetd Super-Server" /><link
        rel="next"
        href="sect.asynchronous-task-scheduling-anacron.html"
        title="9.8. Schemaläggar asynkrona uppgifter: anacron" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/sv-SE/stable/sect.task-scheduling-cron-atd.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.inetd.html"><strong>Föregående</strong></a></li><li
          class="home">Handbok för Debianadministratören</li><li
          class="next"><a
            accesskey="n"
            href="sect.asynchronous-task-scheduling-anacron.html"><strong>Nästa</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.task-scheduling-cron-atd"></a>9.7. Schemalägga uppgifter med <code
                  class="command">cron</code> and <code
                  class="command">atd</code></h2></div></div></div><a
          id="id-1.12.10.2"
          class="indexterm"></a><a
          id="id-1.12.10.3"
          class="indexterm"></a><a
          id="id-1.12.10.4"
          class="indexterm"></a><a
          id="id-1.12.10.5"
          class="indexterm"></a><div
          class="para">
			<code
            class="command">cron</code> är demonen som är ansvarig för att exekvera schemaläggning och återkommando kommandon (varje dag, varje vecka och så vidare); <code
            class="command">atd</code> kan exekvera kommandon en enstaka gång, en specifik tid.
		</div><div
          class="para">
			I ett Unixsystem schemaläggs många uppgifter för återkommande körning:
		</div><div
          xmlns:d="http://docbook.org/ns/docbook"
          class="itemizedlist"><ul><li
              class="listitem"><div
                class="para">
					rotera loggarna;
				</div></li><li
              class="listitem"><div
                class="para">
					uppdatera databasen för programmet <code
                  class="command">locate</code>;
				</div></li><li
              class="listitem"><div
                class="para">
					säkerhetskopior;
				</div></li><li
              class="listitem"><div
                class="para">
					underhållningsskript (som att rensa bort tillfälliga filer).
				</div></li></ul></div><div
          class="para">
			Alla användare kan schemalägga exekveringen av uppgifter. Varje användare har sin egen <span
            class="emphasis"><em>crontab</em></span> i vilken de kan spara schemalagda kommandon. Den kan redigeras genom att köra <code
            class="command">crontab -e</code> (dess innehåll lagras i filen<code
            class="filename">/var/spool/cron/crontabs/<em
              class="replaceable">användare</em></code>).
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>SÄKERHET</em></span> Begränsa <code
                      class="command">cron</code> eller <code
                      class="command">atd</code></strong></p></div></div></div><div
            class="para">
			Du kan begränsa åtkoms till <code
              class="command">cron</code> genom att skapa en explicit autentiseringsfil (vitlista) i <code
              class="filename">/etc/cron.allow</code> i vilken du indikerar endast användare autentiserade till att schemalägga kommandon. Alla andra kommer automatiskt inte ha denna egenskap. Du kan också, för att stoppa några få bråkstakar, lägga till deras namn i den explicita filen för nekad åtkomst (svartlista), <code
              class="filename">/etc/cron.deny</code>. Samma egenskap är tillgänglig för <code
              class="command">atd</code>, med filerna <code
              class="filename">/etc/at.allow</code> och <code
              class="filename">/etc/at.deny</code>.
		</div></div><div
          class="para">
			Root-användaren har endast deras egna <span
            class="emphasis"><em>crontab</em></span>, men kan också använda filen <code
            class="filename">/etc/crontab</code> eller skriva ytterligare <span
            class="emphasis"><em>crontab</em></span>-filer i katalogen <code
            class="filename">/etc/cron.d</code>. Dessa två lösningar har fördelen med att kunna specificera användaridentiteten att använda då ett kommando exekveras.
		</div><div
          class="para">
			Paketet <span
            class="emphasis"><em>cron</em></span> innehåller några schemalagda kommandon som kan exekvera:
		</div><div
          xmlns:d="http://docbook.org/ns/docbook"
          class="itemizedlist"><ul><li
              class="listitem"><div
                class="para">
					program i katalogen<code
                  class="filename">/etc/cron.hourly/</code> en gång i timmen;
				</div></li><li
              class="listitem"><div
                class="para">
					program i katalogen <code
                  class="filename">/etc/cron.daily/</code> en gång per dag;
				</div></li><li
              class="listitem"><div
                class="para">
					program i <code
                  class="filename">/etc/cron.weekly/</code> en gång i veckan;
				</div></li><li
              class="listitem"><div
                class="para">
					program i <code
                  class="filename">/etc/cron.monthly/</code> en gång i månaden.
				</div></li></ul></div><div
          class="para">
			Många Debianpaket förlitar sig på denna tjänst: genom att lägga förvaltningskript i dessa kataloger försäkrar de sig om att deras tjänster är optimerade.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.format-crontab"></a>9.7.1. Format för <code
                    class="filename">crontab</code></h3></div></div></div><a
            id="id-1.12.10.15.2"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TIP</em></span> Textgenvägar för <code
                        class="command">cron</code></strong></p></div></div></div><div
              class="para">
				<code
                class="command">cron</code>känner igen några förkortningar som ersätter de fem första fälten i en <code
                class="filename">crontab</code>-post. De motsvarar de mest klassiska schemaläggaralternativen:
			</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
						<code
                      class="literal">@yearly</code>: en gång per år (Januari 1, vid 00:00);
					</div></li><li
                  class="listitem"><div
                    class="para">
						<code
                      class="literal">@monthly</code>:en gång i månaden (den 1:sta, vid 00:00);
					</div></li><li
                  class="listitem"><div
                    class="para">
						<code
                      class="literal">@weekly</code>: en gång i veckan (Söndag, vid 00:00);
					</div></li><li
                  class="listitem"><div
                    class="para">
						<code
                      class="literal">@daily</code>: en gång per dag (vid 00:00);
					</div></li><li
                  class="listitem"><div
                    class="para">
						<code
                      class="literal">@hourly</code>: en gång i timmen (vid varje timmes början).
					</div></li></ul></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SPECIALFALL</em></span> <code
                        class="command">cron</code> och sommar-/vintertid</strong></p></div></div></div><div
              class="para">
				I Debian räknar <code
                class="command">cron</code> med sommar-/vintertid, eller andra större ändringar i lokal tid så gott det kan. Därför kan kommandona som borde ha exekverats vid en tidpunkt som aldrig existerade (exempelvis uppgifter schemalagda 2.30 under sommartidsändringen i Sverige, eftersom 2.00 hoppar klockan fram tll direkt till 3.00) exekveras kort efter tidsändringen (ungefär 3.00). Å andra, vid vintertidsändringen när kommandon som skulle ha exekverats flera gånger (2.30 och sedan en timme senare 2.30, eftersom klockan ställs tillbaka en timme klockan 3.00) exekveras endast en gång.
			</div><div
              class="para">
				Om ordningen i hur de schemalagda uppgifterna och fördröjningen mellan deras respektive exekvering är viktig bör du vara försiktig och kontrollera kompatibiliteten för dessa villkor med <code
                class="command">cron</code>s beteende. Om nödvändigt så kan du förbereda ett speciellt schema för dessa två problematiska årliga nätter.
			</div></div><div
            class="para">
				Varje signifikat rad i <span
              class="emphasis"><em>crontab</em></span> beskriver ett schemalagt kommando med följande sex (eller sju) fält:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						värdet för minut (tal från 0 till 59);
					</div></li><li
                class="listitem"><div
                  class="para">
						värdet för timme (från 0 till 23);
					</div></li><li
                class="listitem"><div
                  class="para">
						värdet för dag i månaden (från 1 till 31);
					</div></li><li
                class="listitem"><div
                  class="para">
						värdet för månaden (från 1 till 12);
					</div></li><li
                class="listitem"><div
                  class="para">
						värdet för dag i veckan (från 0 till 7, där 1 motsvarar måndag. Söndag representeras av både 0 och 7; det är också möjligt att använda de tre första bokstäverna i dagens namn på engelska, som <code
                    class="literal">Sun</code>, <code
                    class="literal">Mon</code> och så vidare);
					</div></li><li
                class="listitem"><div
                  class="para">
						användarnamn under vars identitet kommandot ska exekveras (i filen <code
                    class="filename">/etc/crontab</code> och i fragmenten i <code
                    class="filename">/etc/cron.d/</code>, men inte användarens egna crontabfiler);
					</div></li><li
                class="listitem"><div
                  class="para">
						kommando att exekvera (när villkoren definierat i de första fem kolumnerna är uppfyllda).
					</div></li></ul></div><div
            class="para">
				Alla detaljer är dokumenterade i manualsidan <span
              class="citerefentry"><span
                class="refentrytitle">crontab</span>(5)</span>.
			</div><div
            class="para">
				Varje värde kan uttryckas i form av en list av möjliga värden (separerat av komman). Syntaxen x <code
              class="literal">a-b</code> beskriver intervallet av värden mellan <code
              class="literal">a</code> och <code
              class="literal">b</code>. Syntaxen <code
              class="literal">a-b/c</code> besskriver intervallet med en ökning<code
              class="literal">c</code> (exempel: <code
              class="literal">0-10/2</code> betyder <code
              class="literal">0,2,4,6,8,10</code>). En stjärna <code
              class="literal">*</code> är ett jokertecken, representerande alla möjliga värden.
			</div><div
            class="example"><a
              xmlns=""
              id="example.crontab"></a><p
              class="title"><strong>Exempel 9.2. Exempelfil för <code
                  class="filename">crontab</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">#Format
#min hour day mon dow  command

# Hämta data varje natt kl 7:25
 25  19   *   *   *    $HOME/bin/get.pl

# 8:00 varje veckodag (måndag till fredag)
 00  08   *   *   1-5  $HOME/bin/dosomething

# Starta om IRC-proxy efter varje omstart
@reboot /usr/bin/dircproxy</pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TIP</em></span> Exekvera ett kommando vid uppstart</strong></p></div></div></div><div
              class="para">
				För att exekvera ett kommando en enstaka gång efter att datorn ha startat upp kan du använda makrot <code
                class="literal">@reboot</code> (en omstart av <code
                class="command">cron</code> utlöser inte ett kommando schemalagt med <code
                class="literal">@reboot</code>). Makrot ersätter de första fem fälten i en post i <span
                class="emphasis"><em>crontab</em></span>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ALTERNATIV</em></span> Emulera <code
                        class="command">cron</code> med <code
                        class="command">systemd</code></strong></p></div></div></div><div
              class="para">
				Det är möjligt att emulera delar av beteendet i <code
                class="command">cron</code>'s med tidmekanismen i <code
                class="command">systemd</code> (se <a
                class="xref"
                href="unix-services.html#sect.systemd">Avsnitt 9.1.1, ”Systemds init-system”</a>).
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.at-command"></a>9.7.2. Använda kommandot <code
                    class="command">at</code></h3></div></div></div><a
            id="id-1.12.10.16.2"
            class="indexterm"></a><div
            class="para">
				<code
              class="command">at</code> exekverar ett kommando vid en specifik tidpunkt i framtiden. Det tar önskad tid och datum som kommnadoradsparametrar samt kommando att köra i sin indata. Kommando kommer att exekverar som om det hade angetts i aktuellt skal. <code
              class="command">at</code> återställer bevarar även aktuell miljö för att kunna återskapa samma villkor när den kör kommandot. Tiden indikeras genom att följa de vanliga konventionerna: <code
              class="literal">16:12</code> eller <code
              class="literal">4:12pm</code> betyder 16:12. Datumet kan specificeras i flera europeiska och västerländska format, inklusive <code
              class="literal">DD.MM.YY</code> (<code
              class="literal">27.07.15</code> som representerar 27:e juli 2015).
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>at 09:00 27.07.15 &lt;&lt;END</code></strong>
<code
              class="computeroutput">&gt; </code><strong
              class="userinput"><code>echo "Glöm inte att grattulera Raphaël! på födelsedagen" \</code></strong>
<code
              class="computeroutput">&gt; </code><strong
              class="userinput"><code>  | mail lolando@debian.org</code></strong>
<code
              class="computeroutput">&gt; </code><strong
              class="userinput"><code>END</code></strong>
<code
              class="computeroutput">varning: kommandon kommer exekveras /bin/sh
job 31 at Mon Jul 27 09:00:00 2015</code></pre><div
            class="para">
				En alternativ syntax fördröjer exekveringen för en given tid: <code
              class="command">at now + <em
                class="replaceable">siffra</em> <em
                class="replaceable">period</em></code>. <em
              class="replaceable">period</em> kan vara <code
              class="literal">minuter</code>, <code
              class="literal">timmar</code>, <code
              class="literal">dagar</code>, eller <code
              class="literal">weeks</code>. <em
              class="replaceable">siffra</em> är talet av nämnda tidsenhet som måste ha passerats innan exekvering av kommandot.
			</div><div
            class="para">
				För att avsluta en uppgift schemalagd av <code
              class="command">cron</code>, kör <code
              class="command">crontab</code> och ta bort motsvarande rad i filen <span
              class="emphasis"><em>crontab</em></span>. För <code
              class="command">at</code>-uppgifterna är det nästan lika lätt: kör <code
              class="command">atrm <em
                class="replaceable">uppgiftnummer</em></code>. Uppgiftsnumret indikeras av kommandot <code
              class="command">at</code> när du schemalägger det, men du kan finna det igen med kommandot <code
              class="command">atq</code> som visar aktuell lista av schemalagda uppgifter.
			</div><a
            id="id-1.12.10.16.7"
            class="indexterm"></a><a
            id="id-1.12.10.16.8"
            class="indexterm"></a></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.inetd.html"><strong>Föregående</strong>9.6. Superservern inetd Super-Server</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Upp</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Hem</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.asynchronous-task-scheduling-anacron.html"><strong>Nästa</strong>9.8. Schemaläggar asynkrona uppgifter: anacron</a></li></ul></body></html>
