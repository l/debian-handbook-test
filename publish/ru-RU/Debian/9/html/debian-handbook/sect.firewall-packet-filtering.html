<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">14.2. Сетевой экран или Фильтрация пакетов</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-ru-RU-1.0-1" /><meta
        name="keywords"
        content="Сетевой экран, Межсетевой экран, IDS/NIDS" /><link
        rel="home"
        href="index.html"
        title="Настольная книга администратора Debian" /><link
        rel="up"
        href="security.html"
        title="Глава 14. Безопасность" /><link
        rel="prev"
        href="security.html"
        title="Глава 14. Безопасность" /><link
        rel="next"
        href="sect.supervision.html"
        title="14.3. Supervision: Prevention, Detection, Deterrence" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/ru-RU/stable/sect.firewall-packet-filtering.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="security.html"><strong>Пред.</strong></a></li><li
          class="home">Настольная книга администратора Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.supervision.html"><strong>След.</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.firewall-packet-filtering"></a>14.2. Сетевой экран или Фильтрация пакетов</h2></div></div></div><a
          id="id-1.17.5.2"
          class="indexterm"></a><a
          id="id-1.17.5.3"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>Вернуться к началу</em></span> Сетевой экран</strong></p></div></div></div><a
            id="id-1.17.5.4.2"
            class="indexterm"></a><div
            class="para">
			<span
              class="emphasis"><em>Сетевой экран</em></span> является частью компьютерного оборудования с аппаратным или программным обеспечением, который фильтрует входящие и исходящие сетевые пакеты (исходящие из/в локальную сеть) и при совпадении некоторых условий выполняет действия.
		</div></div><div
          class="para">
			Брандмауэр является фильтрующим сетевым шлюзом и влияет только на пакеты, которые должны пройти через него. Таким образом, безопасность может быть эффективной только когда путь через брандмауэр является единственным для этих пакетов.
		</div><div
          class="para">
			Отсутствие стандартной конфигурации (и девиз «процесс, не продукт») объясняет отсутствие решения под ключ. Однако, существуют инструменты, которые делают проще настройку брандмауэра <span
            class="emphasis"><em>netfilter</em></span> с графическим представлением правил фильтрации. <code
            class="command">fwbuilder</code>, несомненно, является одним из лучших среди них.
		</div><a
          id="id-1.17.5.7"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>КОНКРЕТНЫЕ СЛУЧАИ</em></span> Локальный сетевой экран</strong></p></div></div></div><div
            class="para">
			Брандмауэр может быть предназначен для одной конкретной машины (в отличие от полной сети), в этом случае его роль заключается в фильтрации или ограничения доступа к некоторым сервисам или возможно для предотвращения исходящих соединений мошеннического программного обеспечения, которое пользователь может, вольно или невольно, установить.
		</div></div><div
          class="para">
			Ядро Linux содержит брандмауэр<span
            class="emphasis"><em>netfilter</em></span>. Управлять им можно из пространства пользователя с помощью команд <code
            class="command">iptables</code> и <code
            class="command">ip6tables</code>. Разница между этими двумя командами состоит в том, что первая работает в сети IPv4, тогда как последняя предназначена для IPv6. Поскольку оба стека сетевых протоколов, вероятно, будут использоваться на протяжении многих лет, оба средства нужно будет использовать параллельно.
		</div><a
          id="id-1.17.5.10"
          class="indexterm"></a><a
          id="id-1.17.5.11"
          class="indexterm"></a><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.netfilter"></a>14.2.1. Описание Netfilter</h3></div></div></div><div
            class="para">
				<span
              class="emphasis"><em>Netfilter</em></span> использует четыре различных таблицы, которые хранят правила, регулирующие три вида операций над пакетами:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">filter</code> касается правил фильтрации (прием, отказ или игнорирование пакета);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">NAT</code> касается перевода источника или назначения адресов и портов пакетов;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">mangle</code> касается других изменений IP пакетов (включая ToS — <span
                    class="emphasis"><em>Type of Service</em></span> — поля и параметры);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">raw</code> позволяет производить над пакетами другие изменения вручную прежде чем они достигнут системы отслеживания соединений.
					</div></li></ul></div><div
            class="para">
				Каждая таблица содержит списки правил под названием <span
              class="emphasis"><em>chains</em></span> (цепочки). Брандмауэр использует стандартные цепочки для обработки пакетов, основанные на стандартных условиях. Администратор может создавать другие цепочки, которые будут использоваться только когда на них ссылается одна из стандартных сетей (прямо или косвенно).
			</div><a
            id="id-1.17.5.12.5"
            class="indexterm"></a><a
            id="id-1.17.5.12.6"
            class="indexterm"></a><div
            class="para">
				Таблица <code
              class="literal">фильтров</code> имеет три стандартных цепи:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">INPUT</code>: касается пакетов, пунктом назначения которых является брандмауэр;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">OUTPUT</code>: касается пакетов, отправляемых брандмауэром;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">FORWARD</code>: касается транзитных пакетов, проходящих через брандмауэр (который не является ни их источником, ни их пунктом назначения).
					</div></li></ul></div><div
            class="para">
				Таблица <code
              class="literal">nat</code> также имеет три стандартных цепи:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">PREROUTING</code>: для изменения пребывающих пакетов;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">POSTROUTING</code>: для изменения отправляемых пакетов, перед отправкой;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">OUTPUT</code>: для изменения пакетов, сгенерированных брандмауэром.
					</div></li></ul></div><div
            class="figure"><a
              xmlns=""
              id="figure.chaines-netfilter"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/netfilter.png"
                  alt="Как называются цепи netfilter" /></div></div><p
              class="title"><strong>Рисунок 14.1. Как называются цепи <span
                  class="emphasis"><em>netfilter</em></span></strong></p></div><div
            class="para">
				Каждая цепочка является списком правил; каждое правило имеет набор условий и действий, выполяемых при выполнении условий. При обработке пакета, брандмауэр проверяет соответствующую цепочку, правила один за другим; когда будут выполнены условия для одного правила, он «прыгает» (отсюда <code
              class="literal">-j</code> - англ. jumps - параметр в командах) на указанное действие для продолжения обработки. Наиболее распространенные варианты поведения стандартизированы и для них существует предопределённые действия. Срабатывание одного из этих стандартных действий прерывает обработку цепи, так как судьба пакета уже предрешена (за исключением исключение упомянутых ниже):
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>НАЗАД К ОСНОВАМ</em></span> ICMP</strong></p></div></div></div><div
              class="para">
				ICMP (<span
                class="emphasis"><em>протокол межсетевых управляющих сообщений</em></span>) используется для передачи дополнительной информации о соединении. Он используется для теста соединений в сети командой <code
                class="command">ping</code> (которая посылает ICMP <span
                class="emphasis"><em>эхо-запросы</em></span>, на которые ожидается ответ в виде ICMP <span
                class="emphasis"><em>эхо-ответа</em></span>), для сообщения при блокировании пакета межсетевым экраном, для сообщений о переполнении буфера приёма, для предложения лучшего маршрута для следующий пакетов в соединении и т. п. Он стандартизирован в нескольким документах, изначальные RFC777 и RFC792 были вскоре дополнены и расширены. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc777.html">http://www.faqs.org/rfcs/rfc777.html</a></div><div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc792.html">http://www.faqs.org/rfcs/rfc792.html</a></div>
			</div><div
              class="para">
				Например, буфер приёма это небольшая область памяти для хранения данных после их получения по сети и до их обработки ядром. Если эта область полностью заполнена, то новые данные не могут быть приняты и ICMP сигнализирует о проблеме, чтобы источник данных мог снизить скорость передачи данных (в идеале, через некоторое время должен быть достигнут баланс между источником и приёмником).
			</div><a
              id="id-1.17.5.12.13.4"
              class="indexterm"></a><a
              id="id-1.17.5.12.13.5"
              class="indexterm"></a><a
              id="id-1.17.5.12.13.6"
              class="indexterm"></a><a
              id="id-1.17.5.12.13.7"
              class="indexterm"></a><a
              id="id-1.17.5.12.13.8"
              class="indexterm"></a><div
              class="para">
				Несмотря на то, что IPv4 сеть может работать без ICMP, ICMPv6 необходима для сетей IPv6, т. к. она совмещает несколько функций, разделённых в IPv4 сетях между ICMPv4, IGMP (<span
                class="emphasis"><em>протокол управления группами Интернета</em></span>) и ARP(<span
                class="emphasis"><em>протокол определения адреса</em></span>). ICMPv6 определён в RFC4443. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc4443.html">http://www.faqs.org/rfcs/rfc4443.html</a></div>
			</div></div><div
            class="para">
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ACCEPT</code>: разрешить пакету следовать своим путём;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">REJECT</code>: отбросить пакет с пакетом-ошибкой ICMP (параметр <code
                    class="literal">--reject-with <em
                      class="replaceable">тип</em></code> команды <code
                    class="command">iptables</code> позволяет указать тип ошибки);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">DROP</code>: удалить (игнорировать) пакет;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">LOG</code>: записать в журнал (посредством <code
                    class="command">syslogd</code>) сообщение с описанием пакета; учтите, что данное действие не прерывает обработку и выполнение цепочки продолжится следующим правилом, поэтому журналирование отброшенных пакетов требует и правило LOG, и правило REJECT/DROP;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ULOG</code>: записать сообщение в журнал посредством команды <code
                    class="command">ulogd</code>, которая может быть более эффективна и адаптируема чем <code
                    class="command">syslogd</code> для обработки большого количества сообщений; заметьте, что данное действие, как и LOG, также передаёт обработку следующему правилу в вызываемой цепи;
					</div></li><li
                class="listitem"><div
                  class="para">
						<em
                    class="replaceable">chain_name</em>: jump to the given chain and evaluate its rules;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">RETURN</code>: interrupt processing of the current chain, and return to the calling chain; in case the current chain is a standard one, there's no calling chain, so the default action (defined with the <code
                    class="literal">-P</code> option to <code
                    class="command">iptables</code>) is executed instead;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">SNAT</code> (only in the <code
                    class="literal">nat</code> table): apply <span
                    class="emphasis"><em>Source NAT</em></span> (extra options describe the exact changes to apply);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">DNAT</code> (only in the <code
                    class="literal">nat</code> table): apply <span
                    class="emphasis"><em>Destination NAT</em></span> (extra options describe the exact changes to apply);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">MASQUERADE</code> (only in the <code
                    class="literal">nat</code> table): apply <span
                    class="emphasis"><em>masquerading</em></span> (a special case of <span
                    class="emphasis"><em>Source NAT</em></span>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">REDIRECT</code> (only in the <code
                    class="literal">nat</code> table): redirect a packet to a given port of the firewall itself; this can be used to set up a transparent web proxy that works with no configuration on the client side, since the client thinks it connects to the recipient whereas the communications actually go through the proxy.
					</div></li></ul></div><div
            class="para">
				Other actions, particularly those concerning the <code
              class="literal">mangle</code> table, are outside the scope of this text. The <span
              class="citerefentry"><span
                class="refentrytitle">iptables</span>(8)</span> and <span
              class="citerefentry"><span
                class="refentrytitle">ip6tables</span>(8)</span> have a comprehensive list.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.iptables"></a>14.2.2. Синтаксис <code
                    class="command">iptables</code> и <code
                    class="command">ip6tables</code></h3></div></div></div><div
            class="para">
				The <code
              class="command">iptables</code> and <code
              class="command">ip6tables</code> commands allow manipulating tables, chains and rules. Their <code
              class="literal">-t <em
                class="replaceable">table</em></code> option indicates which table to operate on (by default, <code
              class="literal">filter</code>).
			</div><a
            id="id-1.17.5.13.3"
            class="indexterm"></a><a
            id="id-1.17.5.13.4"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.iptables-command"></a>14.2.2.1. Команды</h4></div></div></div><div
              class="para">
					The <code
                class="literal">-N <em
                  class="replaceable">chain</em></code> option creates a new chain. The <code
                class="literal">-X <em
                  class="replaceable">chain</em></code> deletes an empty and unused chain. The <code
                class="literal">-A <em
                  class="replaceable">chain</em> <em
                  class="replaceable">rule</em></code> adds a rule at the end of the given chain. The <code
                class="literal">-I <em
                  class="replaceable">chain</em> <em
                  class="replaceable">rule_num</em> <em
                  class="replaceable">rule</em></code> option inserts a rule before the rule number <em
                class="replaceable">rule_num</em>. The <code
                class="literal">-D <em
                  class="replaceable">chain</em> <em
                  class="replaceable">rule_num</em></code> (or <code
                class="literal">-D <em
                  class="replaceable">chain</em> <em
                  class="replaceable">rule</em></code>) option deletes a rule in a chain; the first syntax identifies the rule to be deleted by its number, while the latter identifies it by its contents. The <code
                class="literal">-F <em
                  class="replaceable">chain</em></code> option flushes a chain (deletes all its rules); if no chain is mentioned, all the rules in the table are deleted. The <code
                class="literal">-L <em
                  class="replaceable">chain</em></code> option lists the rules in the chain. Finally, the <code
                class="literal">-P <em
                  class="replaceable">chain</em> <em
                  class="replaceable">action</em></code> option defines the default action, or “policy”, for a given chain; note that only standard chains can have such a policy.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.iptables-rules"></a>14.2.2.2. Правила</h4></div></div></div><a
              id="id-1.17.5.13.6.2"
              class="indexterm"></a><div
              class="para">
					Each rule is expressed as <code
                class="literal"><em
                  class="replaceable">conditions</em> -j <em
                  class="replaceable">action</em> <em
                  class="replaceable">action_options</em></code>. If several conditions are described in the same rule, then the criterion is the conjunction (logical <span
                class="emphasis"><em>and</em></span>) of the conditions, which is at least as restrictive as each individual condition.
				</div><div
              class="para">
					The <code
                class="literal">-p <em
                  class="replaceable">protocol</em></code> condition matches the protocol field of the IP packet. The most common values are <code
                class="literal">tcp</code>, <code
                class="literal">udp</code>, <code
                class="literal">icmp</code>, and <code
                class="literal">icmpv6</code>. Prefixing the condition with an exclamation mark negates the condition, which then becomes a match for “any packets with a different protocol than the specified one”. This negation mechanism is not specific to the <code
                class="literal">-p</code> option and it can be applied to all other conditions too.
				</div><div
              class="para">
					The <code
                class="literal">-s <em
                  class="replaceable">address</em></code> or <code
                class="literal">-s <em
                  class="replaceable">network/mask</em></code> condition matches the source address of the packet. Correspondingly, <code
                class="literal">-d <em
                  class="replaceable">address</em></code> or <code
                class="literal">-d <em
                  class="replaceable">network/mask</em></code> matches the destination address.
				</div><div
              class="para">
					The <code
                class="literal">-i <em
                  class="replaceable">interface</em></code> condition selects packets coming from the given network interface. <code
                class="literal">-o <em
                  class="replaceable">interface</em></code> selects packets going out on a specific interface.
				</div><div
              class="para">
					There are more specific conditions, depending on the generic conditions described above. For instance, the <code
                class="literal">-p tcp</code> condition can be complemented with conditions on the TCP ports, with clauses such as <code
                class="literal">--source-port <em
                  class="replaceable">port</em></code> and <code
                class="literal">--destination-port <em
                  class="replaceable">port</em></code>.
				</div><div
              class="para">
					The <code
                class="literal">--state <em
                  class="replaceable">state</em></code> condition matches the state of a packet in a connection (this requires the <code
                class="command">ipt_conntrack</code> kernel module, for connection tracking). The <code
                class="literal">NEW</code> state describes a packet starting a new connection; <code
                class="literal">ESTABLISHED</code> matches packets belonging to an already existing connection, and <code
                class="literal">RELATED</code> matches packets initiating a new connection related to an existing one (which is useful for the <code
                class="literal">ftp-data</code> connections in the “active” mode of the FTP protocol).
				</div><div
              class="para">
					Предыдущий раздел перечисляет доступные действия, но не их параметры. Например, действие <code
                class="literal">LOG</code> имеет следующие параметры:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-level</code>, со значением по умолчанию <code
                      class="literal">warning</code>, указывает уровень серьёзности <code
                      class="command">syslog</code>;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-prefix</code> позволяет задать текстовый префикс для различия между несколькими сообщениями журнала;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="literal">--log-tcp-sequence</code>, <code
                      class="literal">--log-tcp-options</code> and <code
                      class="literal">--log-ip-options</code> indicate extra data to be integrated into the message: respectively, the TCP sequence number, TCP options, and IP options.
						</div></li></ul></div><div
              class="para">
					The <code
                class="literal">DNAT</code> action provides the <code
                class="literal">--to-destination <em
                  class="replaceable">address</em>:<em
                  class="replaceable">port</em></code> option to indicate the new destination IP address and/or port. Similarly, <code
                class="literal">SNAT</code> provides <code
                class="literal">--to-source <em
                  class="replaceable">address</em>:<em
                  class="replaceable">port</em></code> to indicate the new source IP address and/or port.
				</div><div
              class="para">
					The <code
                class="literal">REDIRECT</code> action (only available if NAT is available) provides the <code
                class="literal">--to-ports <em
                  class="replaceable">port(s)</em></code> option to indicate the port, or port range, where the packets should be redirected.
				</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.creating-rules"></a>14.2.3. Creating Rules</h3></div></div></div><div
            class="para">
				Each rule creation requires one invocation of <code
              class="command">iptables</code>/<code
              class="command">ip6tables</code>. Typing these commands manually can be tedious, so the calls are usually stored in a script so that the same configuration is set up automatically every time the machine boots. This script can be written by hand, but it can also be interesting to prepare it with a high-level tool such as <code
              class="command">fwbuilder</code>.
			</div><pre
            class="screen">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>apt install fwbuilder</code></strong></pre><div
            class="para">
				The principle is simple. In the first step, one needs to describe all the elements that will be involved in the actual rules:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						the firewall itself, with its network interfaces;
					</div></li><li
                class="listitem"><div
                  class="para">
						the networks, with their corresponding IP ranges;
					</div></li><li
                class="listitem"><div
                  class="para">
						the servers;
					</div></li><li
                class="listitem"><div
                  class="para">
						the ports belonging to the services hosted on the servers.
					</div></li></ul></div><div
            class="para">
				The rules are then created with simple drag-and-drop actions on the objects. A few contextual menus can change the condition (negating it, for instance). Then the action needs to be chosen and configured.
			</div><div
            class="para">
				As far as IPv6 is concerned, one can either create two distinct rulesets for IPv4 and IPv6, or create only one and let <code
              class="command">fwbuilder</code> translate the rules according to the addresses assigned to the objects.
			</div><div
            class="figure"><a
              xmlns=""
              id="figure.fwbuilder"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/fwbuilder.png"
                  alt="Fwbuilder's main window" /></div></div><p
              class="title"><strong>Рисунок 14.2. Fwbuilder's main window</strong></p></div><a
            id="id-1.17.5.14.9"
            class="indexterm"></a><div
            class="para">
				<code
              class="command">fwbuilder</code> can then generate a script configuring the firewall according to the rules that have been defined. Its modular architecture gives it the ability to generate scripts targeting different systems (<code
              class="command">iptables</code> for Linux, <code
              class="command">ipf</code> for FreeBSD and <code
              class="command">pf</code> for OpenBSD).
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.install-rules-at-boot"></a>14.2.4. Installing the Rules at Each Boot</h3></div></div></div><div
            class="para">
				In other cases, the recommended way is to register the configuration script in an <code
              class="literal">up</code> directive of the <code
              class="filename">/etc/network/interfaces</code> file. In the following example, the script is stored under <code
              class="filename">/usr/local/etc/arrakis.fw</code>.
			</div><div
            class="example"><a
              xmlns=""
              id="example.network-interfaces-firewall"></a><p
              class="title"><strong>Пример 14.1. <code
                  class="filename">interfaces</code> file calling firewall script</strong></p><div
              class="example-contents"><pre
                class="programlisting">auto eth0
iface eth0 inet static
    address 192.168.0.1
    network 192.168.0.0
    netmask 255.255.255.0
    broadcast 192.168.0.255
    up /usr/local/etc/arrakis.fw
</pre></div></div><div
            class="para">
				This obviously assumes that you are using <span
              class="pkg pkg">ifupdown</span> to configure the network interfaces. If you are using something else (like <span
              class="emphasis"><em>NetworkManager</em></span> or <span
              class="emphasis"><em>systemd-networkd</em></span>), then refer to their respective documentation to find out ways to execute a script after the interface has been brought up.
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="security.html"><strong>Пред.</strong>Глава 14. Безопасность</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Наверх</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Начало</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.supervision.html"><strong>След.</strong>14.3. Supervision: Prevention, Detection, Deterre...</a></li></ul></body></html>
