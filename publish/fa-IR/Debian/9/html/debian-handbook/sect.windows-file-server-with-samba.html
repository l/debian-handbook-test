<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.5. راه‌اندازی اشتراک‌های ویندوز با Samba</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-fa-IR-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="راهنمای جامع دبیان" /><link
        rel="up"
        href="network-services.html"
        title="فصل 11. سرویس‌های شبکه: Postfix، Apache، NFS، Samba، Squid، LDAP، SIP، XMPP، Turn" /><link
        rel="prev"
        href="sect.nfs-file-server.html"
        title="11.4. سرور فایل NFS" /><link
        rel="next"
        href="sect.http-ftp-proxy.html"
        title="11.6. پروکسی HTTP/FTP" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/fa-IR/stable/sect.windows-file-server-with-samba.html" /></head><body
      dir="rtl"><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.nfs-file-server.html"><strong>قبلی</strong></a></li><li
          class="home">راهنمای جامع دبیان</li><li
          class="next"><a
            accesskey="n"
            href="sect.http-ftp-proxy.html"><strong>بعدی</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.windows-file-server-with-samba"></a>11.5. راه‌اندازی اشتراک‌های ویندوز با Samba</h2></div></div></div><div
          class="para">
			سامبا مجموعه ابزاری است که پروتکل SMB را (که بنام “CIFS” نیز شناخته می‌شود) در لینوکس مدیریت می‌کند. این پروتکل توسط ویندوز برای اشتراک‌های شبکه و چاپگرهای اشتراکی استفاده می‌شود.
		</div><a
          id="id-1.14.8.3"
          class="indexterm"></a><a
          id="id-1.14.8.4"
          class="indexterm"></a><a
          id="id-1.14.8.5"
          class="indexterm"></a><a
          id="id-1.14.8.6"
          class="indexterm"></a><a
          id="id-1.14.8.7"
          class="indexterm"></a><div
          class="para">
			سامبا همچنین می‌تواند به عنوان یک کنترل‌کننده دامنه ویندوز نیز کار کند. این یک ابزار فوق‌العاده برای یکپارچه‌سازی سرورهای لینوکس و رایانه‌های رومیزی ویندوز به حساب می‌آید.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.8.9"></a>11.5.1. سرور سامبا</h3></div></div></div><div
            class="para">
				بسته <span
              class="pkg pkg">samba</span> شامل دو سرور اصلی از نسخه ۴ سامبا است، <code
              class="command">smbd</code> و <code
              class="command">nmbd</code>.
			</div><a
            id="id-1.14.8.9.3"
            class="indexterm"></a><a
            id="id-1.14.8.9.4"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>مستندات</em></span> مطالعه بیشتر</strong></p></div></div></div><div
              class="para">
				سرور سامبا به شدت قابل پیکربندی و همه فن حریف است، که می‌توانند کاربردهای بسیار زیادی را منطبق با نیازمندی‌های شبکه و معماری آن داشته باشد. این کتاب تنها به شیوه استفاده از سامبا به عنوان یک سرور منفرد اشاره می‌کند، اما سامبا می‌تواند به عنوان یک کنترل‌کننده دامنه NT4 یا Active Directory یا یک عضو ساده از یک گروه موجود عمل کند (که توسط یک سرور ویندوزی مدیریت می‌شود).
			</div><a
              id="id-1.14.8.9.5.3"
              class="indexterm"></a><a
              id="id-1.14.8.9.5.4"
              class="indexterm"></a><div
              class="para">
				بسته <span
                class="pkg pkg">samba-doc</span> شامل تعداد بیشماری فایل‌های نمونه در <code
                class="filename">/usr/share/doc/samba-doc/examples/</code> است.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ابزار</em></span> احرازهویت با یک سرور ویندوز</strong></p></div></div></div><div
              class="para">
				مدیرسیستم‌ها با استفاده از Winbind می‌توانند از یک سرور ویندوز به عنوان احرازهویت استفاده کنند. این ابزار به خوبی با PAM و NSS یکپارچه می‌شود. اینکار امکان راه‌اندازی رایانه‌های لینوکس که حساب‌ کاربری آن‌ها به صورت خودکار از دامنه ویندوز می‌آید را ممکن می‌سازد.
			</div><a
              id="id-1.14.8.9.6.3"
              class="indexterm"></a><div
              class="para">
				اطلاعات بیشتر می‌تواند در دایرکتوری <code
                class="filename">/usr/share/doc/samba-doc/examples/pam_winbind/</code> پیدا شود.
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.9.7"></a>11.5.1.1. پیکربندی با <code
                      class="command">debconf</code></h4></div></div></div><div
              class="para">
					بسته‌ها هنگام نصب اولیه شامل پیکربندی حداقل می‌باشند، اما شما باید با اجرای دستور <code
                class="command">dpkg-reconfigure samba-common</code> نسبت به انطباق آن نیازهای خود اقدام کنید:
				</div><div
              class="para">
					اولین قطعه اطلاعات مورد نیاز نام workgroup است که سرور سامبا به آن تعلق دارد (در این مورد پاسخ <code
                class="literal">FALCOTNET</code> است).
				</div><div
              class="para">
					بسته همچنین با اطلاعات بدست آمده از فرآیند پس‌زمینه DHCP اقدام به شناسایی سرور WINS می‌کند. مدیرسیستم‌های شرکت فالکوت این گزینه را نادیده گرفته‌اند، چرا که قصد دارند از خود سرور سامبا به عنوان WINS استفاده کنند.
				</div><a
              id="id-1.14.8.9.7.5"
              class="indexterm"></a></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.9.8"></a>11.5.1.2. پیکربندی دستی</h4></div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.14.8.9.8.2"></a>11.5.1.2.1. تغییرات در <code
                        class="filename">smb.conf</code></h5></div></div></div><div
                class="para">
						نیازمندی‌های فالکوت مستلزم تغییر در فایل پیکربندی <code
                  class="filename">/etc/samba/smb.conf</code> است. گزیده زیر خلاصه‌ای از تغییرات اعمال شده در قسمت <code
                  class="literal">[global]</code> را شامل می‌شود.
					</div><pre
                class="programlisting">
[global]

## Browsing/Identification ###

# Change this to the workgroup/NT-domain name your Samba server will part of
   workgroup = FALCOTNET

# Windows Internet Name Serving Support Section:
# WINS Support - Tells the NMBD component of Samba to enable its WINS Server
   wins support = yes <span
                  id="smb.conf.wins"><img
                    class="callout"
                    src="Common_Content/images/1.png"
                    alt="1" /></span>

[...]

####### Authentication #######

# Server role. Defines in which mode Samba will operate. Possible
# values are "standalone server", "member server", "classic primary
# domain controller", "classic backup domain controller", "active
# directory domain controller". 
#
# Most people will want "standalone sever" or "member server".
# Running as "active directory domain controller" will require first
# running "samba-tool domain provision" to wipe databases and create a
# new domain.
   server role = standalone server

# "security = user" is always a good idea. This will require a Unix account
# in this server for every user accessing the server.
   security = user <span
                  id="smb.conf.security"><img
                    class="callout"
                    src="Common_Content/images/2.png"
                    alt="2" /></span>

[...]</pre><div
                class="calloutlist"><table
                  border="0"
                  summary="Callout list"><tr><td
                      width="5%"
                      valign="top"
                      align="right"><p><a
                          href="#smb.conf.wins"><img
                            class="callout"
                            src="Common_Content/images/1.png"
                            alt="1" /></a> </p></td><td
                      valign="top"
                      align="right"><div
                        class="para">
								نشان می‌دهد که سامبا باید به عنوان یک سرور نام Netbios یا همان WINS برای شبکه محلی عمل کند.
							</div></td></tr><tr><td
                      width="5%"
                      valign="top"
                      align="right"><p><a
                          href="#smb.conf.security"><img
                            class="callout"
                            src="Common_Content/images/2.png"
                            alt="2" /></a> </p></td><td
                      valign="top"
                      align="right"><div
                        class="para">
								این مقدار پیشفرض برای پارامتر است؛ با این حال، از آنجا که در مرکز پیکربندی سامبا قرار دارد، درج آن به صورت صریح توصیه می‌شود. هر کاربر قبل از دسترسی به اشتراک ابتدا باید احرازهویت شود.
							</div></td></tr></table></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.14.8.9.8.3"></a>11.5.1.2.2. افزودن کاربران</h5></div></div></div><div
                class="para">
						هر کاربر سامبا به یک حساب کاربری در سرور نیاز دارد؛ به منظور ثبت کاربران در پایگاه‌داده سامبا، ابتدا باید این حساب‌های کاربری یونیکس تولید شوند. اینکار به صورت نرمال توسط دستور <code
                  class="command">adduser</code> انجام می‌شود.
					</div><div
                class="para">
						افزودن یک کاربر موجود به پایگاه‌داده سامبا به سادگی اجرای دستور <code
                  class="command">smbpasswd -a <em
                    class="replaceable">user</em></code> است؛ این دستور گذرواژه را به صورت تعاملی هنگام اجرای خود می‌پرسد.
					</div><div
                class="para">
						یک کاربر می‌تواند با استفاده از دستور <code
                  class="command">smbpasswd -x <em
                    class="replaceable">user</em></code> حذف گردد. همچنین حساب کاربری سامبا به صورت موقت می‌تواند با دستور <code
                  class="command">smbpasswd -d <em
                    class="replaceable">user</em></code> غیرفعال یا با دستور <code
                  class="command">smbpasswd -e <em
                    class="replaceable">user</em></code> فعال‌سازی مجدد گردد.
					</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.8.10"></a>11.5.2. برنامه سامبا</h3></div></div></div><div
            class="para">
				ویژگی‌های این برنامه در سامبا به رایانه‌های لینوکس اجازه می‌دهد که از اشتراک‌های فایل و چاپگر در ویندوز استفاده کنند. برنامه‌های مورد آن در بسته‌های <span
              class="pkg pkg">cifs-utils</span> و <span
              class="pkg pkg">smbclient</span> قرار دارند.
			</div><a
            id="id-1.14.8.10.3"
            class="indexterm"></a><a
            id="id-1.14.8.10.4"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.5"></a>11.5.2.1. برنامه <code
                      class="command">smbclient</code></h4></div></div></div><div
              class="para">
					برنامه <code
                class="command">smbclient</code> از سرورهای SMB پرس و جو می‌کند. یک گزینه <code
                class="literal">-U <em
                  class="replaceable">user</em></code> را به منظور اتصال به سرور با یک شناسه خاص می‌پذیرد. <code
                class="command">smbclient //<em
                  class="replaceable">server</em>/<em
                  class="replaceable">share</em></code> به شیوه‌ای تعاملی و مشابه با FTP در خط فرمان به فضای اشتراکی یک سرور دسترسی می‌یابد. <code
                class="command">smbclient -L <em
                  class="replaceable">server</em></code> تمام اشتراک‌های موجود (و قابل مشاهده) در یک سرور را فهرست می‌کند.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.6"></a>11.5.2.2. اتصال اشتراک‌های ویندوز</h4></div></div></div><div
              class="para">
					دستور <code
                class="command">mount</code> اجازه اتصال اشتراک‌های ویندوز به ساختار فایل‌سیستم لینوکس را می‌دهد (با کمک <code
                class="command">mount.cifs</code> که توسط <span
                class="pkg pkg">cifs-utils</span> فراهم شده است).
				</div><a
              id="id-1.14.8.10.6.3"
              class="indexterm"></a><a
              id="id-1.14.8.10.6.4"
              class="indexterm"></a><div
              class="example"><a
                xmlns=""
                id="id-1.14.8.10.6.5"></a><p
                class="title"><strong>
      مثال 11.24. اتصال یک اشتراک ویندوز</strong></p><div
                class="example-contents"><pre
                  class="programlisting">
mount -t cifs //arrakis/shared /shared \
      -o credentials=/etc/smb-credentials</pre></div></div><div
              class="para">
					فایل <code
                class="filename">/etc/smb-credentials</code> (که نباید توسط کاربران خواندنی باشد) شامل قالب زیر است:
				</div><pre
              class="programlisting">
username = <em
                class="replaceable">user</em>
password = <em
                class="replaceable">password</em></pre><div
              class="para">
					سایر گزینه‌ها نیز در خط-فرمان می‌توانند قرار گیرند؛ فهرست کامل آن‌ها در صفحه راهنمای <span
                class="citerefentry"><span
                  class="refentrytitle">mount.cifs</span>(1)</span> قرار دارد. دو گزینه از اهمیت خاصی برخوردار هستند: <code
                class="literal">uid</code> و <code
                class="literal">gid</code> که اجازه استفاده فایل‌های کاربر و گروه مشخص شده در نقطه اتصال را می‌دهند، به این منظور که تمام دسترسی‌ها در اختیار root نباشد.
				</div><div
              class="para">
					اتصال یک اشتراک ویندوز می‌توانند در <code
                class="filename">/etc/fstab</code> به صورت زیر پیکربندی شود:
				</div><pre
              class="programlisting">
//<em
                class="replaceable">server</em>/shared /shared cifs credentials=/etc/smb-credentials</pre><div
              class="para">
					قطع اتصال یک اشتراک SMB/CIFS توسط دستور استاندارد <code
                class="command">umount</code> صورت می‌گیرد:
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.7"></a>11.5.2.3. چاپ با استفاده از چاپگر اشتراکی</h4></div></div></div><div
              class="para">
					CUPS یک راهکار زیبا برای عملیات چاپ از لینوکس با استفاده از چاپگر موجود در ویندوز است. زمانی که <span
                class="pkg pkg">smbclient</span> نصب شود، CUPS اجازه نصب چاپگرهای اشتراکی ویندوز را به صورت خودکار فراهم می‌کند.
				</div><a
              id="id-1.14.8.10.7.3"
              class="indexterm"></a><div
              class="para">
					گام‌های مورد نیاز عبارتند از:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							رابط پیکربندی CUPS را وارد کنید: <code
                      class="literal">http://localhost:631/admin</code>
						</div></li><li
                  class="listitem"><div
                    class="para">
							روی “Add Printer” کلیک کنید.
						</div></li><li
                  class="listitem"><div
                    class="para">
							دستگاه چاپگر را انتخاب کنید، برای نمونه: “Windows Printer via SAMBA”.
						</div></li><li
                  class="listitem"><div
                    class="para">
							نشانی ارتباطی برای چاپگر شبکه را وارد کنید. باید مشابه زیر باشد:
						</div><div
                    class="para">
							<code
                      class="literal">smb://<em
                        class="replaceable">user</em>:<em
                        class="replaceable">password</em>@<em
                        class="replaceable">server</em>/<em
                        class="replaceable">printer</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							نامی که به صورت اختصاصی چاپگر را مشخص می‌کند، وارد کنید. سپس توضیحات و مکان چاپگر را وارد کنید. این‌ها رشته‌هایی هستند که برای کمک به کاربران نهایی در استفاده از چاپگر نمایش داده می‌شوند.
						</div></li><li
                  class="listitem"><div
                    class="para">
							تولیدکننده و مدل چاپگر، یا به صورت مستقیم یک فایل توضحیات چاپگر یا PPD را مشخص کنید.
						</div></li></ul></div><div
              class="para">
					بسیار عالی، چاپگر آماده استفاده است!
				</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.nfs-file-server.html"><strong>قبلی</strong>11.4. سرور فایل NFS</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>بالا</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>خانه</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.http-ftp-proxy.html"><strong>بعدی</strong>11.6. پروکسی HTTP/FTP</a></li></ul></body></html>
