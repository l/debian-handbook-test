<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">فصل 10. زیرساخت شبکه</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-fa-IR-1.0-1" /><meta
        name="keywords"
        content="شبکه, Gateway, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link
        rel="home"
        href="index.html"
        title="راهنمای جامع دبیان" /><link
        rel="up"
        href="index.html"
        title="راهنمای جامع دبیان" /><link
        rel="prev"
        href="sect.power-management.html"
        title="9.12. Power Management: Advanced Configuration and Power Interface (ACPI)" /><link
        rel="next"
        href="sect.virtual-private-network.html"
        title="10.2. شبکه خصوصی مجازی" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/fa-IR/stable/network-infrastructure.html" /></head><body
      dir="rtl"><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>قبلی</strong></a></li><li
          class="home">راهنمای جامع دبیان</li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>بعدی</strong></a></li></ul><div
        xml:lang="fa-IR"
        class="chapter"
        lang="fa-IR"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  xmlns=""
                  id="network-infrastructure"></a>
      فصل 10. زیرساخت شبکه</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="network-infrastructure.html#sect.gateway">10.1. Gateway</a></span></dt><dt><span
                class="section"><a
                  href="sect.virtual-private-network.html">10.2. شبکه خصوصی مجازی</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.openvpn">10.2.1. OpenVPN</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ssh-vpn">10.2.2. VPN به همراه SSH</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ipsec">10.2.3. IPsec</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.pptp">10.2.4. PPTP</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.quality-of-service.html">10.3. کیفیت سرویس</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-principe">10.3.1. Principle and Mechanism</a></span></dt><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-config">10.3.2. پیکربندی و پیاده‌سازی</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dynamic-routing.html">10.4. مسیریابی پویا</a></span></dt><dt><span
                class="section"><a
                  href="sect.ipv6.html">10.5. IPv6</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.ipv6.html#sect.ipv6-tunneling">10.5.1. تونل‌زنی</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.domain-name-servers.html">10.6. سرورهای نام دامنه (DNS)</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-principe">10.6.1. Principle and Mechanism</a></span></dt><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-config">10.6.2. پیکربندی</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dhcp.html">10.7. DHCP</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-config">10.7.1. پیکربندی</a></span></dt><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-dns">10.7.2. DHCP و DNS</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.network-diagnosis-tools.html">10.8. ابزار بررسی شبکه</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.netstat">10.8.1. بررسی محلی: <code
                        class="command">netstat</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.nmap">10.8.2. بررسی راه‌دور: <code
                        class="command">nmap</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.sniffers">10.8.3. اسنیفرها: <code
                        class="command">tcpdump</code> و <code
                        class="command">wireshark</code></a></span></dt></dl></dd></dl></div><div
          class="highlights"><div
            class="para">
		لینوکس از میراث شبکه یونیکس پشتیبانی می‌کند و دبیان مجموعه کاملی از ابزارها را برای ایجاد و مدیریت آن فراهم می‌آورد. این فصل به بررسی این ابزار می‌پردازد.
	</div></div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    xmlns=""
                    id="sect.gateway"></a>10.1. Gateway</h2></div></div></div><div
            class="para">
			یک gateway رایانه‌ای است که چندین شبکه را به یکدیگر متصل می‌کند. این عبارت اغلب به “نقطه خروجی” یک شبکه محلی به تمام نشانی‌های IP ضروری حارجی اشاره دارد. gateway به هر کدام از شبکه‌هایی که پیوند می‌دهد، متصل است و به عنوان یک مسیریاب کار تبدیل بسته‌های IP را بر عهده دارد.
		</div><a
            id="id-1.13.4.3"
            class="indexterm"></a><a
            id="id-1.13.4.4"
            class="indexterm"></a><a
            id="id-1.13.4.5"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>بازگشت به مقدمات</em></span> بسته IP</strong></p></div></div></div><a
              id="id-1.13.4.6.2"
              class="indexterm"></a><div
              class="para">
			امروزه اکثر شبکه‌ها از پروتکل IP یا <span
                class="emphasis"><em>Internet Protocol</em></span> استفاده می‌کنند. این پروتکل داده انتقالی را به بسته‌هایی با اندازه کوچک تبدیل می‌کند. هر بسته علاوه بر داده مذکور، شامل جزئیاتی برای مسیریابی صحیح خود می‌باشد.
		</div></div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.tcp-udp"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>بازگشت به مقدمات</em></span> TCP/UDP</strong></p></div></div></div><a
              id="id-1.13.4.7.2"
              class="indexterm"></a><a
              id="id-1.13.4.7.3"
              class="indexterm"></a><a
              id="id-1.13.4.7.4"
              class="indexterm"></a><a
              id="id-1.13.4.7.5"
              class="indexterm"></a><div
              class="para">
			بسیاری برنامه‌ها خود به مدیریت بسته‌ها نمی‌پردازند، با اینکه داده انتقالی آن‌‌ها از طریق IP منتقل می‌شود؛ آن‌ها اغلب از TCP یا <span
                class="emphasis"><em>Transmission Control Protocol</em></span> استفاده می‌کنند. TCP لایه‌ای بر فراز IP است که امکان برقراری ارتباط برای جریان داده‌ای بین دو نقطه را برقرار می‌کند. برنامه‌ها تنها یک نقطه ورودی برای ارسال داده‌ها می‌دانند که ضمانت از بین نرفتن داده را دارد و به همان ترتیب که فرستاده می‌شود در نقطه خروجی نیز دریافت می‌گردد. با اینکه انواع گوناگونی از خطا در لایه‌های پایینی ممکن است اتفاق بیفتد، توسط TCP جبران می‌شوند: بسته‌های گم شده دوباره ارسال می‌گردند و بسته‌هایی که خارج از ترتیب دریافت می‌شوند (برای نمونه، اگر از مسیرهای مختلف استفاده کرده باشند) به صورت مناسبی شماره‌گذاری مجدد می‌شوند.
		</div><div
              class="para">
			پروتکل دیگری که به IP وابسته است UDP یا <span
                class="emphasis"><em>User Datagram Protocol</em></span> نام دارد. بر خلاف TCP، مبتنی بر بسته و اهداف این پروتکل متفاوت است: هدف UDP تنها انتقال یک بسته از یک برنامه به دیگری است. پروتکل نه تنها جبران بسته‌های گم شده در مسیر را نمی‌کند بلکه در رابطه با ترتیب ارسال و دریافت آن‌ها نیز کاری انجام نمی‌دهد. مزیت اصلی آن در این است که تاخیر به میزان کمی وجود دارد، از آنجا که گم شدن یک بسته منجر به تاخیر در کل فرآیند ارسال مجدد آن نمی‌گردد.
		</div><div
              class="para">
			TCP و UDP هر دو شامل درگاه هستند، که در حقیقت “شماره‌های اضافی” برای برقراری ارتباط با یک برنامه روی یک رایانه هستند. این مفهوم امکان برقراری چند ارتباط هم‌زمان با یک مخاطب را فراهم می‌سازد، از آنجا که این ارتباطات از طریق شماره درگاه قابل شناسایی هستند.
		</div><div
              class="para">
			برخی از این شماره‌های درگاه - که توسط IANA یا <span
                class="emphasis"><em>Internet Assigned Numbers Authority</em></span> استانداردسازی شده‌اند - به صورت “شناخته-شده” برای سرویس‌های شبکه هستند. برای نمونه، درگاه ۲۵ از TCP معمولا توسط سرور ایمیل استفاده می‌شود. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.iana.org/assignments/port-numbers">http://www.iana.org/assignments/port-numbers</a></div>
		</div></div><div
            class="para">
			زمانی که یک شبکه محلی از یک بازه نشانی خصوصی (که به اینترنت مسیریابی نمی‌شوند) استفاده می‌کند، gateway نیاز به پیاده‌سازی <span
              class="emphasis"><em>address masquerading</em></span> دارد تا رایانه‌های داخل شبکه بتوانند با دنیای خارج ارتباط برقرار کنند. عملیات ماسک‌گذاری نوعی پروکسی در شبکه به حساب می‌آیند: هر ارتباط خارجی از یک رایانه داخلی توسط نشانی gateway جایگزین می‌شود (چرا که gateway خود یک نشانی خارجی و قابل‌مسیریابی دارد)، داده‌ای که از طریق ارتباط ماسک‌گذاری شده عبور می‌کند نیز به این ارتباط ارسال می‌شود و داده‌ی بازگشتی نیز به ترتیب عکس به رایانه داخلی فرستاده می‌شود. gateway از بازه درگاه‌های اختصاصی TCP به این منظور استفاده می‌کند، معمولا با اعداد خیلی بالا (بیش از ۶۰۰۰۰). هر ارتباطی ارسالی از رایانه‌های داخلی به مانند یک ارتباط حارجی با استفاده از این درگاه‌های رزرو شده نمایش می‌یابد.
		</div><a
            id="id-1.13.4.9"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>فرهنگ</em></span> بازه خصوصی نشانی</strong></p></div></div></div><a
              id="id-1.13.4.10.2"
              class="indexterm"></a><a
              id="id-1.13.4.10.3"
              class="indexterm"></a><div
              class="para">
			RFC 1918 سه بازه اختصاصی برای نشانی‌های IPv4 تعریف می‌کند که در اینترنت قابل مسیریابی نیستند اما می‌توانند در شبکه‌های محلی استفاده شوند. اولی، <code
                class="literal">10.0.0.0/8</code> (نوارکناری <a
                class="xref"
                href="sect.network-config.html#sidebar.networking-basics"><span
                  class="emphasis"><em>بازگشت به مقدمات</em></span> مفاهیم ضروری شبکه (Ethernet, IP address, subnet, broadcast)</a> را مشاهده کنید) یک بازه کلاش A است (با ۲<sup>۲۴</sup> نشانی IP). دومی، <code
                class="literal">172.16.0.0/12</code> شامل ۱۶ بازه کلاس B است (<code
                class="literal">172.16.0.0/16</code> تا <code
                class="literal">172.31.0.0/16</code>) که هر یک شامل ۲<sup>۱۶</sup> نشانی IP هستند. سومی، <code
                class="literal">192.168.0.0/16</code> یک بازه کلاس B است (که ۲۵۶ بازه کلاس C از <code
                class="literal">192.168.0.0/24</code> تا <code
                class="literal">192.168.255.0/24</code> را گروه‌بندی می‌کند که هر کدام شامل ۲۵۶ نشانی IP هستند). <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc1918.html">http://www.faqs.org/rfcs/rfc1918.html</a></div>
		</div></div><div
            class="para">
			gateway می‌تواند دو نوع NAT یا <span
              class="emphasis"><em>Network Address Translation</em></span> اجرا کند. نوع اول، DNAT یا <span
              class="emphasis"><em>Destination NAT</em></span> تکنیکی برای تغییر نشانی IP (و/یا درگاه TCP یا UDP) مقصد برای یک ارتباط ورودی است. مکانیزم رهگیری ارتباط نیز بسته‌های موجود را برای تضمین تداوم ارتباط تغییر می‌دهد. نوع دوم، SNAT یا <span
              class="emphasis"><em>Source NAT</em></span> است که <span
              class="emphasis"><em>ماسک‌گذاری</em></span> یک حالت ویژه آن به حساب می‌آید؛ SNAT تکنیکی برای تغییر نشانی IP (و/یا درگاه TCP یا UDP) مبدا برای یک ارتباط خروجی است. همانند DNAT، تمام بسته‌های موجود از طریق مکانیزم رهگیری ارتباط تغییر داده می‌شوند. نکته اینکه NAT تنها برای نشانی‌های IPv4 و فضای محدود نشانی‌دهی آن کاربرد دارد؛ در IPv6، بازه بسیار گسترده نشانی‌دهی کاربرد NAT را از بین می‌برد چرا که هر نشانی “داخلی” امکان مسیریابی روی اینترنت را دارد (این به معنای در دسترس بودن رایانه‌های داخلی نیست، چرا که فایروال‌های میانی می‌توانند ترافیک را فیلتر کنند).
		</div><a
            id="id-1.13.4.12"
            class="indexterm"></a><a
            id="id-1.13.4.13"
            class="indexterm"></a><a
            id="id-1.13.4.14"
            class="indexterm"></a><a
            id="id-1.13.4.15"
            class="indexterm"></a><a
            id="id-1.13.4.16"
            class="indexterm"></a><a
            id="id-1.13.4.17"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>بازگشت به مقدمات</em></span> ارسال درگاه</strong></p></div></div></div><a
              id="id-1.13.4.18.2"
              class="indexterm"></a><div
              class="para">
			یکی از کاربردهای DNAT <span
                class="emphasis"><em>ارسال درگاه</em></span> است. ارتباطات ورودی به یک درگاه مشخص از یک رایانه به یک درگاه در رایانه دیگری ارسال می‌شوند. راهکارهای دیگری نیز برای دستیابی به این هدف وجود دارد، مانند، به خصوص در سطح برنامه‌ای با <code
                class="command">ssh</code> یا <code
                class="command">ssh</code> (قسمت <a
                class="xref"
                href="sect.remote-login.html#sect.ssh-port-forwarding">
      قسمت 9.2.1.3, “Creating Encrypted Tunnels with Port Forwarding”
    </a> را مشاهده کنید).
		</div></div><div
            class="para">
			مباحث نظری کافی است، بیایید دست بکار شویم. تبیدل یک سیستم دبیان به یک gateway به سادگی فعال‌کردن چند گزینه در کرنل است که از طریق فایل‌سیستم مجازی <code
              class="filename">/proc/</code> صورت می‌گیرند.
		</div><pre
            class="screen">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>echo 1 &gt; /proc/sys/net/ipv4/conf/default/forwarding</code></strong></pre><div
            class="para">
			این گزینه به صورت خودکار نیز دز زمان راه‌اندازی اولیه می‌تواند فعال شود اگر فایل <code
              class="filename">/etc/sysctl.conf</code> گزینه <code
              class="literal">net.ipv4.conf.default.forwarding</code> را به <code
              class="literal">1</code> تنظیم کند.
		</div><div
            class="example"><a
              xmlns=""
              id="example.sysctl.conf"></a><p
              class="title"><strong>
      مثال 10.1. فایل <code
                  class="filename">/etc/sysctl.conf</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">
net.ipv4.conf.default.forwarding = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.tcp_syncookies = 1</pre></div></div><div
            class="para">
			این مجموعه عملیات را برای IPv6 نیز می‌توان انجام داد، تنها کافی است <code
              class="literal">ipv4</code> را با <code
              class="literal">ipv4</code> جایگزین کنیم یا خط <code
              class="literal">net.ipv6.conf.all.forwarding</code> را در فایل <code
              class="filename">/etc/sysctl.conf</code> قرار دهیم.
		</div><div
            class="para">
			فعال‌سازی ماسک‌گذاری IPv4 عملیات کمی پیچیده‌تری است چرا که باید فایروال <span
              class="emphasis"><em>netfilter</em></span> را پیکربندی کرد.
		</div><div
            class="para">
			به طور مشابه، استفاده از NAT برای IPv4 نیازمند پیکربندی <span
              class="emphasis"><em>netfilter</em></span> است. از آنجا که هدف اصلی این قسمت فیلترکردن بسته‌ها است، جزئیات آن در <a
              class="xref"
              href="security.html">
      فصل 14: “<em>امنیت</em>”</a> آمده است (قسمت <a
              class="xref"
              href="sect.firewall-packet-filtering.html">
      قسمت 14.2, “فایروال یا فیلترینگ بسته”
    </a> را مشاهده کنید).
		</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>قبلی</strong>9.12. Power Management: Advanced Configuration an...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>بالا</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>خانه</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>بعدی</strong>10.2. شبکه خصوصی مجازی</a></li></ul></body></html>
