<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">Bab 10. Network Infrastructure</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-id-ID-1.0-1" /><meta
        name="keywords"
        content="Network, Gateway, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link
        rel="home"
        href="index.html"
        title="Buku Panduan Administrator Debian" /><link
        rel="up"
        href="index.html"
        title="Buku Panduan Administrator Debian" /><link
        rel="prev"
        href="sect.power-management.html"
        title="9.12. Power Management: Advanced Configuration and Power Interface (ACPI)" /><link
        rel="next"
        href="sect.virtual-private-network.html"
        title="10.2. Virtual Private Network" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/id-ID/stable/network-infrastructure.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>Sebelumnya</strong></a></li><li
          class="home">Buku Panduan Administrator Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>Lanjut</strong></a></li></ul><div
        xml:lang="id-ID"
        class="chapter"
        lang="id-ID"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  xmlns=""
                  id="network-infrastructure"></a>Bab 10. Network Infrastructure</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="network-infrastructure.html#sect.gateway">10.1. Gateway</a></span></dt><dt><span
                class="section"><a
                  href="sect.virtual-private-network.html">10.2. Virtual Private Network</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.openvpn">10.2.1. OpenVPN</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ssh-vpn">10.2.2. Virtual Private Network with SSH</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ipsec">10.2.3. IPsec</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.pptp">10.2.4. PPTP</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.quality-of-service.html">10.3. Quality of Service</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-principe">10.3.1. Principle and Mechanism</a></span></dt><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-config">10.3.2. Configuring and Implementing</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dynamic-routing.html">10.4. Dynamic Routing</a></span></dt><dt><span
                class="section"><a
                  href="sect.ipv6.html">10.5. IPv6</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.ipv6.html#sect.ipv6-tunneling">10.5.1. Tunneling</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.domain-name-servers.html">10.6. Domain Name Servers (DNS)</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-principe">10.6.1. Principle and Mechanism</a></span></dt><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-config">10.6.2. Configuring</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dhcp.html">10.7. DHCP</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-config">10.7.1. Configuring</a></span></dt><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-dns">10.7.2. DHCP and DNS</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.network-diagnosis-tools.html">10.8. Network Diagnosis Tools</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.netstat">10.8.1. Local Diagnosis: <code
                        class="command">netstat</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.nmap">10.8.2. Remote Diagnosis: <code
                        class="command">nmap</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.sniffers">10.8.3. Sniffers: <code
                        class="command">tcpdump</code> and <code
                        class="command">wireshark</code></a></span></dt></dl></dd></dl></div><div
          class="highlights"><div
            class="para">
		Linux sports the whole Unix heritage for networking, and Debian provides a full set of tools to create and manage them. This chapter reviews these tools.
	</div></div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    xmlns=""
                    id="sect.gateway"></a>10.1. Gateway</h2></div></div></div><div
            class="para">
			A gateway is a system linking several networks. This term often refers to a local network's “exit point” on the mandatory path to all external IP addresses. The gateway is connected to each of the networks it links together, and acts as a router to convey IP packets between its various interfaces.
		</div><a
            id="id-1.13.4.3"
            class="indexterm"></a><a
            id="id-1.13.4.4"
            class="indexterm"></a><a
            id="id-1.13.4.5"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>BACK TO BASICS</em></span> IP packet</strong></p></div></div></div><a
              id="id-1.13.4.6.2"
              class="indexterm"></a><div
              class="para">
			Most networks nowadays use the IP protocol (<span
                class="emphasis"><em>Internet Protocol</em></span>). This protocol segments the transmitted data into limited-size packets. Each packet contains, in addition to its payload data, a number of details required for its proper routing.
		</div></div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.tcp-udp"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>BACK TO BASICS</em></span> TCP/UDP</strong></p></div></div></div><a
              id="id-1.13.4.7.2"
              class="indexterm"></a><a
              id="id-1.13.4.7.3"
              class="indexterm"></a><a
              id="id-1.13.4.7.4"
              class="indexterm"></a><a
              id="id-1.13.4.7.5"
              class="indexterm"></a><div
              class="para">
			Many programs do not handle the individual packets themselves, even though the data they transmit does travel over IP; they often use TCP (<span
                class="emphasis"><em>Transmission Control Protocol</em></span>). TCP is a layer over IP allowing the establishment of connections dedicated to data streams between two points. The programs then only see an entry point into which data can be fed with the guarantee that the same data exits without loss (and in the same sequence) at the exit point at the other end of the connection. Although many kinds of errors can happen in the lower layers, they are compensated by TCP: lost packets are retransmitted, and packets arriving out of order (for example, if they used different paths) are re-ordered appropriately.
		</div><div
              class="para">
			Another protocol relying on IP is UDP (<span
                class="emphasis"><em>User Datagram Protocol</em></span>). In contrast to TCP, it is packet-oriented. Its goals are different: the purpose of UDP is only to transmit one packet from an application to another. The protocol does not try to compensate for possible packet loss on the way, nor does it ensure that packets are received in the same order as were sent. The main advantage to this protocol is that the latency is greatly improved, since the loss of a single packet does not delay the receiving of all following packets until the lost one is retransmitted.
		</div><div
              class="para">
			TCP and UDP both involve ports, which are “extension numbers” for establishing communication with a given application on a machine. This concept allows keeping several different communications in parallel with the same correspondent, since these communications can be distinguished by the port number.
		</div><div
              class="para">
			Some of these port numbers — standardized by the IANA (<span
                class="emphasis"><em>Internet Assigned Numbers Authority</em></span>) — are “well-known” for being associated with network services. For instance, TCP port 25 is generally used by the email server. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.iana.org/assignments/port-numbers">http://www.iana.org/assignments/port-numbers</a></div>
		</div></div><div
            class="para">
			When a local network uses a private address range (not routable on the Internet), the gateway needs to implement <span
              class="emphasis"><em>address masquerading</em></span> so that the machines on the network can communicate with the outside world. The masquerading operation is a kind of proxy operating on the network level: each outgoing connection from an internal machine is replaced with a connection from the gateway itself (since the gateway does have an external, routable address), the data going through the masqueraded connection is sent to the new one, and the data coming back in reply is sent through to the masqueraded connection to the internal machine. The gateway uses a range of dedicated TCP ports for this purpose, usually with very high numbers (over 60000). Each connection coming from an internal machine then appears to the outside world as a connection coming from one of these reserved ports.
		</div><a
            id="id-1.13.4.9"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CULTURE</em></span> Private address range</strong></p></div></div></div><a
              id="id-1.13.4.10.2"
              class="indexterm"></a><a
              id="id-1.13.4.10.3"
              class="indexterm"></a><div
              class="para">
			RFC 1918 defines three ranges of IPv4 addresses not meant to be routed on the Internet but only used in local networks. The first one, <code
                class="literal">10.0.0.0/8</code> (see sidebar <a
                class="xref"
                href="sect.network-config.html#sidebar.networking-basics"><span
                  class="emphasis"><em>BACK TO BASICS</em></span> Essential network concepts (Ethernet, IP address, subnet, broadcast)</a>), is a class-A range (with 2<sup>24</sup> IP addresses). The second one, <code
                class="literal">172.16.0.0/12</code>, gathers 16 class-B ranges (<code
                class="literal">172.16.0.0/16</code> to <code
                class="literal">172.31.0.0/16</code>), each containing 2<sup>16</sup> IP addresses. Finally, <code
                class="literal">192.168.0.0/16</code> is a class-B range (grouping 256 class-C ranges, <code
                class="literal">192.168.0.0/24</code> to <code
                class="literal">192.168.255.0/24</code>, with 256 IP addresses each). <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc1918.html">http://www.faqs.org/rfcs/rfc1918.html</a></div>
		</div></div><div
            class="para">
			The gateway can also perform two kinds of <span
              class="emphasis"><em>network address translation</em></span> (or NAT for short). The first kind, <span
              class="emphasis"><em>Destination NAT</em></span> (DNAT) is a technique to alter the destination IP address (and/or the TCP or UDP port) for a (generally) incoming connection. The connection tracking mechanism also alters the following packets in the same connection to ensure continuity in the communication. The second kind of NAT is <span
              class="emphasis"><em>Source NAT</em></span> (SNAT), of which <span
              class="emphasis"><em>masquerading</em></span> is a particular case; SNAT alters the source IP address (and/or the TCP or UDP port) of a (generally) outgoing connection. As for DNAT, all the packets in the connection are appropriately handled by the connection tracking mechanism. Note that NAT is only relevant for IPv4 and its limited address space; in IPv6, the wide availability of addresses greatly reduces the usefulness of NAT by allowing all “internal” addresses to be directly routable on the Internet (this does not imply that internal machines are accessible, since intermediary firewalls can filter traffic).
		</div><a
            id="id-1.13.4.12"
            class="indexterm"></a><a
            id="id-1.13.4.13"
            class="indexterm"></a><a
            id="id-1.13.4.14"
            class="indexterm"></a><a
            id="id-1.13.4.15"
            class="indexterm"></a><a
            id="id-1.13.4.16"
            class="indexterm"></a><a
            id="id-1.13.4.17"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>BACK TO BASICS</em></span> Port forwarding</strong></p></div></div></div><a
              id="id-1.13.4.18.2"
              class="indexterm"></a><div
              class="para">
			A concrete application of DNAT is <span
                class="emphasis"><em>port forwarding</em></span>. Incoming connections to a given port of a machine are forwarded to a port on another machine. Other solutions may exist for achieving a similar effect, though, especially at the application level with <code
                class="command">ssh</code> (see <a
                class="xref"
                href="sect.remote-login.html#sect.ssh-port-forwarding">Bagian 9.2.1.3, “Creating Encrypted Tunnels with Port Forwarding”</a>) or <code
                class="command">redir</code>.
		</div></div><div
            class="para">
			Enough theory, let's get practical. Turning a Debian system into a gateway is a simple matter of enabling the appropriate option in the Linux kernel, by way of the <code
              class="filename">/proc/</code> virtual filesystem:
		</div><pre
            class="screen">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>echo 1 &gt; /proc/sys/net/ipv4/conf/default/forwarding</code></strong></pre><div
            class="para">
			This option can also be automatically enabled on boot if <code
              class="filename">/etc/sysctl.conf</code> sets the <code
              class="literal">net.ipv4.conf.default.forwarding</code> option to <code
              class="literal">1</code>.
		</div><div
            class="example"><a
              xmlns=""
              id="example.sysctl.conf"></a><p
              class="title"><strong>Contoh 10.1. The <code
                  class="filename">/etc/sysctl.conf</code> file</strong></p><div
              class="example-contents"><pre
                class="programlisting">
net.ipv4.conf.default.forwarding = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.tcp_syncookies = 1
</pre></div></div><div
            class="para">
			The same effect can be obtained for IPv6 by simply replacing <code
              class="literal">ipv4</code> with <code
              class="literal">ipv6</code> in the manual command and using the <code
              class="literal">net.ipv6.conf.all.forwarding</code> line in <code
              class="filename">/etc/sysctl.conf</code>.
		</div><div
            class="para">
			Enabling IPv4 masquerading is a slightly more complex operation that involves configuring the <span
              class="emphasis"><em>netfilter</em></span> firewall.
		</div><div
            class="para">
			Similarly, using NAT (for IPv4) requires configuring <span
              class="emphasis"><em>netfilter</em></span>. Since the primary purpose of this component is packet filtering, the details are listed in <a
              class="xref"
              href="security.html">Bab 14: “<em>Keamanan</em>”</a> (see <a
              class="xref"
              href="sect.firewall-packet-filtering.html">Bagian 14.2, “Firewall or Packet Filtering”</a>).
		</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>Sebelumnya</strong>9.12. Power Management: Advanced Configuration an...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Induk</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Depan</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>Lanjut</strong>10.2. Virtual Private Network</a></li></ul></body></html>
