<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.5. Configurare condivisioni Windows con Samba</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-it-IT-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="Il Manuale dell'Amministratore Debian" /><link
        rel="up"
        href="network-services.html"
        title="Capitolo 11. Servizi di rete: Postfix, Apache, NFS, Samba, Squid, LDAP, SIP, XMPP, TURN" /><link
        rel="prev"
        href="sect.nfs-file-server.html"
        title="11.4. Server di file NFS" /><link
        rel="next"
        href="sect.http-ftp-proxy.html"
        title="11.6. Proxy HTTP/FTP" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/it-IT/stable/sect.windows-file-server-with-samba.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.nfs-file-server.html"><strong>Indietro</strong></a></li><li
          class="home">Il Manuale dell'Amministratore Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.http-ftp-proxy.html"><strong>Avanti</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.windows-file-server-with-samba"></a>11.5. Configurare condivisioni Windows con Samba</h2></div></div></div><div
          class="para">
			Samba è una raccolta di strumenti per gestire il protocollo SMB (chiamato anche "CIFS") su Linux. Questo protocollo è utilizzato da Windows per le condivisioni di rete e le stampanti condivise.
		</div><a
          id="id-1.14.8.3"
          class="indexterm"></a><a
          id="id-1.14.8.4"
          class="indexterm"></a><a
          id="id-1.14.8.5"
          class="indexterm"></a><a
          id="id-1.14.8.6"
          class="indexterm"></a><a
          id="id-1.14.8.7"
          class="indexterm"></a><div
          class="para">
			Samba può anche agire come un controller di dominio Windows. Questo è un ottimo strumento per garantire l'integrazione dei server Linux con le macchine desktop dell'ufficio che continuano ad utilizzare Windows.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.8.9"></a>11.5.1. Server Samba</h3></div></div></div><div
            class="para">
				Il pacchetto <span
              class="pkg pkg">samba</span> contiene i due server principali di Samba 4, <code
              class="command">smbd</code> e <code
              class="command">nmbd</code>.
			</div><a
            id="id-1.14.8.9.3"
            class="indexterm"></a><a
            id="id-1.14.8.9.4"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DOCUMENTAZIONE</em></span> Andiamo oltre</strong></p></div></div></div><div
              class="para">
				Il server Samba è estremamente configurabile e versatile, e può assolvere efficacemente a molti casi d'utilizzo che corrispondono ad esigenze ed architetture di rete molto differenti. Questo libro si focalizza sull'utilizzo di Samba come server standalone, ma può anche essere impiegato come Controller di Dominio NT4 o come full Controller di un Dominio Active Directory, o come semplice membro di un dominio esistente (che potrebbe essere gestito da un server Windows).
			</div><a
              id="id-1.14.8.9.5.3"
              class="indexterm"></a><a
              id="id-1.14.8.9.5.4"
              class="indexterm"></a><div
              class="para">
				Il pacchetto <span
                class="pkg pkg">samba-doc</span> contiene una grande quantitàdi file di esempio commentati in <code
                class="filename">/usr/share/doc/samba-doc/examples/</code>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>STRUMENTO</em></span> Autenticarsi con un Server Windows</strong></p></div></div></div><div
              class="para">
				Winbind fornisce agli amministratori di sistema l'opzione per utilizzare un server Windows NT come server d'autenticazione. Inoltre Winbind si integra bene con PAM e NSS. Questo permette di configurare postazioni Linux dove tutti gli utenti di un dominio Windows ottengono automaticamente un account.
			</div><a
              id="id-1.14.8.9.6.3"
              class="indexterm"></a><div
              class="para">
				Maggiori informazioni possono essere trovate nella directory <code
                class="filename">/usr/share/doc/samba-doc/examples/pam_winbind/</code>.
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.9.7"></a>11.5.1.1. Configurare con <code
                      class="command">debconf</code></h4></div></div></div><div
              class="para">
					Il pacchetto imposta una configurazione minimale durante l'installazione iniziale ma in realtà si dovrebbe eseguire <code
                class="command">dpkg-reconfigure samba-common</code>per adattarlo:
				</div><div
              class="para">
					Il primo pezzo di informazioni richieste è il nome del gruppo di lavoro a cui apparterrà il server Samba (la risposta nel nostro caso è <code
                class="literal">FALCOTNET</code>).
				</div><div
              class="para">
					Il pacchetto propone inoltre di identificare il server WINS attraverso le informazioni fornite dal demone DHCP. Gli amministratori della Falcot Corporation rifiutano questa opzione, poiché intendono utilizzare lo stesso server Samba come server WINS.
				</div><a
              id="id-1.14.8.9.7.5"
              class="indexterm"></a></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.9.8"></a>11.5.1.2. Configurazione manuale</h4></div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.14.8.9.8.2"></a>11.5.1.2.1. Modifiche a <code
                        class="filename">smb.conf</code></h5></div></div></div><div
                class="para">
						Le necessità della Falcot richiedono che altre opzioni siano modificate nel file di configurazione <code
                  class="filename">/etc/samba/smb.conf</code>. Gli estratti seguenti riassumono le modifiche applicate alla sezione <code
                  class="literal">[global]</code>.
					</div><pre
                class="programlisting">
[global]

## Browsing/Identification ###

# Change this to the workgroup/NT-domain name your Samba server will part of
   workgroup = FALCOTNET

# Windows Internet Name Serving Support Section:
# WINS Support - Tells the NMBD component of Samba to enable its WINS Server
   wins support = yes <span
                  id="smb.conf.wins"><img
                    class="callout"
                    src="Common_Content/images/1.png"
                    alt="1" /></span>

[...]

####### Authentication #######

# Server role. Defines in which mode Samba will operate. Possible
# values are "standalone server", "member server", "classic primary
# domain controller", "classic backup domain controller", "active
# directory domain controller". 
#
# Most people will want "standalone sever" or "member server".
# Running as "active directory domain controller" will require first
# running "samba-tool domain provision" to wipe databases and create a
# new domain.
   server role = standalone server

# "security = user" is always a good idea. This will require a Unix account
# in this server for every user accessing the server.
   security = user <span
                  id="smb.conf.security"><img
                    class="callout"
                    src="Common_Content/images/2.png"
                    alt="2" /></span>

[...]</pre><div
                class="calloutlist"><table
                  border="0"
                  summary="Callout list"><tr><td
                      width="5%"
                      valign="top"
                      align="left"><p><a
                          href="#smb.conf.wins"><img
                            class="callout"
                            src="Common_Content/images/1.png"
                            alt="1" /></a> </p></td><td
                      valign="top"
                      align="left"><div
                        class="para">
								Indica che Samba agirà come name server Netbios (WINS) per la rete locale.
							</div></td></tr><tr><td
                      width="5%"
                      valign="top"
                      align="left"><p><a
                          href="#smb.conf.security"><img
                            class="callout"
                            src="Common_Content/images/2.png"
                            alt="2" /></a> </p></td><td
                      valign="top"
                      align="left"><div
                        class="para">
								Questo è il valore predefinito per questo parametro. Ad ogni modo, poiché è un punto chiave per la configurazione di Samba, è raccomandato indicare esplicitamente la propria scelta. Ogni utente deve autenticarsi prima di accedere a qualsiasi condivisione.
							</div></td></tr></table></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.14.8.9.8.3"></a>11.5.1.2.2. Aggiungere utenti</h5></div></div></div><div
                class="para">
						Ogni utente Samba necessita di un account sul server. L'account Unix dev'essere creato per primo, quindi l'utente dev'essere registrato nel database di Samba. La creazione dell'account Unix viene eseguita normalmente (utilizzando per esempio <code
                  class="command">adduser</code>).
					</div><div
                class="para">
						Un utente esistente viene aggiunto al database di Samba con il comando <code
                  class="command">smbpasswd -a <em
                    class="replaceable">utente</em></code>: questo comando chiede di inserire la password in modalità interattiva.
					</div><div
                class="para">
						Un utente può essere cancellato con il comando <code
                  class="command">smbpasswd -x <em
                    class="replaceable">utente</em></code>. Un account Samba può anche essere disabilitato temporaneamente con <code
                  class="command">smbpasswd -d <em
                    class="replaceable">utente</em></code> ed essere riabilitato in seguito con <code
                  class="command">smbpasswd -e <em
                    class="replaceable">utente</em></code>.
					</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.8.10"></a>11.5.2. Client Samba</h3></div></div></div><div
            class="para">
				Le funzionalità client in Samba permettono ad una macchina Linux di accedere alle condivisioni Windows ed alle stampanti condivise. I programmi richiesti sono disponibili nei pacchetti <span
              class="pkg pkg">cifs-utils</span> e <span
              class="pkg pkg">smbclient</span>.
			</div><a
            id="id-1.14.8.10.3"
            class="indexterm"></a><a
            id="id-1.14.8.10.4"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.5"></a>11.5.2.1. Il programma <code
                      class="command">smbclient</code></h4></div></div></div><div
              class="para">
					Il programma <code
                class="command">smbclient</code> interroga i server SMB. Accetta una opzione <code
                class="literal">-U <em
                  class="replaceable">utente</em></code> per connettersi al server attraverso una specifica identità. <code
                class="command">smbclient //<em
                  class="replaceable">server</em>/<em
                  class="replaceable">condivisione</em></code> accede alla condivisione con una modalità interattiva simile alla riga di comando dei client FTP. <code
                class="command">smbclient -L <em
                  class="replaceable">server</em></code> elenca tutte le condivisioni disponibili (e visibili) sul server.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.6"></a>11.5.2.2. Montare le condivisioni Windows</h4></div></div></div><div
              class="para">
					Il comando <code
                class="command">mount</code> permette di montare una condivisione Windows all'interno della gerarchia di un filesystem Linux (con l'aiuto di <code
                class="command">mount.cifs</code> fornito da <span
                class="pkg pkg">cifs-utils</span>).
				</div><a
              id="id-1.14.8.10.6.3"
              class="indexterm"></a><a
              id="id-1.14.8.10.6.4"
              class="indexterm"></a><div
              class="example"><a
                xmlns=""
                id="id-1.14.8.10.6.5"></a><p
                class="title"><strong>Esempio 11.24. Montare una condivisione Windows</strong></p><div
                class="example-contents"><pre
                  class="programlisting">
mount -t cifs //arrakis/shared /shared \
      -o credentials=/etc/smb-credentials</pre></div></div><div
              class="para">
					Il file <code
                class="filename">/etc/smb-credentials</code> (che non dev'essere leggibile dagli utenti) ha il seguente formato:
				</div><pre
              class="programlisting">
username = <em
                class="replaceable">utente</em>
password = <em
                class="replaceable">password</em></pre><div
              class="para">
					Altre opzioni possono essere specificate dalla riga di comando. La lista completa è disponibile nella pagina di manuale <span
                class="citerefentry"><span
                  class="refentrytitle">smbmount</span>(1)</span>. Due opzioni in particolare possono risultare interessanti: <code
                class="literal">uid</code> e <code
                class="literal">gid</code> consentono di forzare l'assegnazione del proprietario ed del gruppo dei file disponibili al mount, così da non limitare l'accesso a root.
				</div><div
              class="para">
					Il montaggio (mount) di una condivisione Windows può anche essere configurato in <code
                class="filename">/etc/fstab</code>:
				</div><pre
              class="programlisting">
//<em
                class="replaceable">server</em>/shared /shared cifs credentials=/etc/smb-credentials</pre><div
              class="para">
					Lo smontaggio di una condivisione SMB/CIFS è fatto con il comando standard <code
                class="command">umount</code>.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.7"></a>11.5.2.3. Stampare su una stampante condivisa</h4></div></div></div><div
              class="para">
					CUPS è una soluzione elegante per stampare da una workstation Linux su di una stampante condivisa da una macchina Windows. Quando il <span
                class="pkg pkg">smbclient</span> è installato, CUPS consente l'installazione automatica delle stampanti Windows condivise.
				</div><a
              id="id-1.14.8.10.7.3"
              class="indexterm"></a><div
              class="para">
					Seguono i passi richiesti:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							Accesso all'interfaccia di configurazione di CUPS: <code
                      class="literal">http://localhost:631/admin</code>
						</div></li><li
                  class="listitem"><div
                    class="para">
							Clicca su "Add Printer".
						</div></li><li
                  class="listitem"><div
                    class="para">
							Scegliere la stampante, selezionare “Windows Printer via SAMBA”.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Inserire l'URI per la stampante di rete. Dovrebbe essere simile al seguente:
						</div><div
                    class="para">
							<code
                      class="literal">smb://<em
                        class="replaceable">utente</em>:<em
                        class="replaceable">password</em>@<em
                        class="replaceable">server</em>/<em
                        class="replaceable">stampante</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Inserire il nome che identificherà in modo univoco questa stampante. Quindi inserire la descrizione e la posizione della stampante. Queste sono le stringhe che verranno mostrate agli utenti finali per aiutarli ad identificare le stampanti.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Identificare il produttore/modello della stampante, ofornire direttamente un file di descrizione della stampante di lavoro (PPD).
						</div></li></ul></div><div
              class="para">
					Voilà, la stampante è operativa!
				</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.nfs-file-server.html"><strong>Indietro</strong>11.4. Server di file NFS</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Risali</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Partenza</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.http-ftp-proxy.html"><strong>Avanti</strong>11.6. Proxy HTTP/FTP</a></li></ul></body></html>
