<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">Bab 11. Layanan Jaringan: Postfix, Apache, NFS, Samba, Squid, LDAP, SIP, XMPP, TURN</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-id-ID-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="Buku Panduan Administrator Debian" /><link
        rel="up"
        href="index.html"
        title="Buku Panduan Administrator Debian" /><link
        rel="prev"
        href="sect.network-diagnosis-tools.html"
        title="10.8. Alat Diagnosis Jaringan" /><link
        rel="next"
        href="sect.http-web-server.html"
        title="11.2. Server Web (HTTP)" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/id-ID/stable/network-services.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.network-diagnosis-tools.html"><strong>Sebelumnya</strong></a></li><li
          class="home">Buku Panduan Administrator Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.http-web-server.html"><strong>Lanjut</strong></a></li></ul><div
        xml:lang="id-ID"
        class="chapter"
        lang="id-ID"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  xmlns=""
                  id="network-services"></a>Bab 11. Layanan Jaringan: Postfix, Apache, NFS, Samba, Squid, LDAP, SIP, XMPP, TURN</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="network-services.html#sect.smtp-mail-server">11.1. Server Mail</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="network-services.html#id-1.14.4.7">11.1.1. Instalasi Postfix</a></span></dt><dt><span
                    class="section"><a
                      href="network-services.html#sect.configuring-virtual-domains">11.1.2. Mengkonfigurasi Domain Virtual</a></span></dt><dt><span
                    class="section"><a
                      href="network-services.html#sect.restrictions-for-receiving-and-sending">11.1.3. Pembatasan Penerimaan dan Pengiriman</a></span></dt><dt><span
                    class="section"><a
                      href="network-services.html#sect.setting-up-greylisting">11.1.4. Menyiapkan <span
                        class="foreignphrase"><em
                          class="foreignphrase">greylisting</em></span></a></span></dt><dt><span
                    class="section"><a
                      href="network-services.html#id-1.14.4.11">11.1.5. Customizing Filters Based On the Recipient</a></span></dt><dt><span
                    class="section"><a
                      href="network-services.html#sect.postfix-antivirus">11.1.6. Mengintegrasikan Antivirus</a></span></dt><dt><span
                    class="section"><a
                      href="network-services.html#sect.authenticated-smtp">11.1.7. SMTP Terotentikasi</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.http-web-server.html">11.2. Server Web (HTTP)</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.http-web-server.html#id-1.14.5.9">11.2.1. Memasang Apache</a></span></dt><dt><span
                    class="section"><a
                      href="sect.http-web-server.html#id-1.14.5.10">11.2.2. Mengkonfigurasi Host Virtual</a></span></dt><dt><span
                    class="section"><a
                      href="sect.http-web-server.html#id-1.14.5.11">11.2.3. Direktif Umum</a></span></dt><dt><span
                    class="section"><a
                      href="sect.http-web-server.html#id-1.14.5.12">11.2.4. Penganalisis Log</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.ftp-file-server.html">11.3. Server Berkas FTP</a></span></dt><dt><span
                class="section"><a
                  href="sect.nfs-file-server.html">11.4. Server Berkas NFS</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.nfs-file-server.html#id-1.14.7.10">11.4.1. Mengamankan NFS</a></span></dt><dt><span
                    class="section"><a
                      href="sect.nfs-file-server.html#id-1.14.7.11">11.4.2. Server NFS</a></span></dt><dt><span
                    class="section"><a
                      href="sect.nfs-file-server.html#id-1.14.7.12">11.4.3. Klien NFS</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.windows-file-server-with-samba.html">11.5. Setting Up Windows Shares with Samba</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.windows-file-server-with-samba.html#id-1.14.8.9">11.5.1. Server Samba</a></span></dt><dt><span
                    class="section"><a
                      href="sect.windows-file-server-with-samba.html#id-1.14.8.10">11.5.2. Klien Samba</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.http-ftp-proxy.html">11.6. Proksi HTTP/FTP</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.http-ftp-proxy.html#id-1.14.9.8">11.6.1. Memasang</a></span></dt><dt><span
                    class="section"><a
                      href="sect.http-ftp-proxy.html#id-1.14.9.9">11.6.2. Mengkonfigurasi sebuah Singgahan</a></span></dt><dt><span
                    class="section"><a
                      href="sect.http-ftp-proxy.html#id-1.14.9.10">11.6.3. Mengkonfigurasi suatu Penyaring</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.ldap-directory.html">11.7. Direktori LDAP</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.ldap-directory.html#id-1.14.10.7">11.7.1. Memasang</a></span></dt><dt><span
                    class="section"><a
                      href="sect.ldap-directory.html#id-1.14.10.8">11.7.2. Mengisi Direktori</a></span></dt><dt><span
                    class="section"><a
                      href="sect.ldap-directory.html#id-1.14.10.9">11.7.3. Mengelola akun dengan LDAP</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.rtc-services.html">11.8. Layanan Komunikasi Real-Time</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.rtc-services.html#sect.rtc-dns-settings">11.8.1. Pengaturan DNS untuk layanan RTC</a></span></dt><dt><span
                    class="section"><a
                      href="sect.rtc-services.html#sect.turn-server">11.8.2. Server TURN</a></span></dt><dt><span
                    class="section"><a
                      href="sect.rtc-services.html#sect.sip-server">11.8.3. Server Proksi SIP</a></span></dt><dt><span
                    class="section"><a
                      href="sect.rtc-services.html#sect.xmpp-server">11.8.4. Server XMPP</a></span></dt><dt><span
                    class="section"><a
                      href="sect.rtc-services.html#sect.rtc-port-443">11.8.5. Menjalankan layanan pada port 443</a></span></dt><dt><span
                    class="section"><a
                      href="sect.rtc-services.html#sect.rtc-webrtc">11.8.6. Menambahkan WebRTC</a></span></dt></dl></dd></dl></div><div
          class="highlights"><div
            class="para">
		Layanan jaringan adalah program-program yang berinteraksi secara langsung dengan para pengguna dalam pekerjaan mereka sehari-hari. Mereka adalah puncak gunung es sistem informasi, dan bab ini akan memfokuskan pada mereka; bagian tak terlihat tempat mereka bertumpu adalah infrastruktur yang sudah kita terangkan sebelumnya.
	</div><div
            class="para">
		Kebanyakan layanan jaringan moderm memerlukan teknologi enkripsi agar beroperasi secara aman dan terpercaya, khususnya ketika digunakan pada internet publik. Sertifikat X.509 (yang mana dapat direferensikan sebagai Sertifikat SSL atau Sertifikat TLS) sering digunakan untuk tujuan ini. Sebuah sertifikat untuk domain tertentu seringkali dapat berbagi antara lebih dari satu layanan dibahas pada bagian ini.
	</div><a
            id="id-1.14.3.3"
            class="indexterm"></a><a
            id="id-1.14.3.4"
            class="indexterm"></a><a
            id="id-1.14.3.5"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    xmlns=""
                    id="sect.smtp-mail-server"></a>11.1. Server Mail</h2></div></div></div><div
            class="para">
			Administrator Falcot Corp memilih Postfix untuk server surel elektroniknya, karena keandalan dan kemudahan konfigurasinya. Memang, desainnya memberlakukan bahwa setiap tugas diimplementasikan dalam sebuah proses dengan seperangkat izin minimum yang dibutuhkan, yang merupakan langkah mitigasi yang besar terhadap masalah keamanan.
		</div><a
            id="id-1.14.4.3"
            class="indexterm"></a><a
            id="id-1.14.4.4"
            class="indexterm"></a><a
            id="id-1.14.4.5"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ALTERNATIF</em></span> Server Exim4</strong></p></div></div></div><a
              id="id-1.14.4.6.2"
              class="indexterm"></a><div
              class="para">
			Debian menggunakan Exim4 sebagai peladen posel bawaan (instalasi awal menyertakan Exim4). Konfigurasi disediakan oleh paket yang terpisah, <span
                class="pkg pkg">exim4-config</span>, dan diatur secara otomatis berdasarkan jawaban dari pertanyaan Debconf yang mirip dengan pertanyaan yang diajukan oleh paket <span
                class="pkg pkg">postfix</span>.
		</div><div
              class="para">
			Konfigurasi dapat berupa berkas tunggal (<code
                class="filename">/etc/exim4/exim4.conf.template</code>) atau terpecah dalam beberapa potongan konfigurasi tersimpan di bawah <code
                class="filename">/etc/exim4/conf.d/</code>. Keduanya, berkas tersebut digunakan olehperintah <code
                class="command">update-exim4.conf</code> sebagai palet untuk menghasilkan <code
                class="filename">/var/lib/exim4/config.autogenerated</code>. Yang terakhir adalah berkas yang digunakan oleh Exim4. Berkat mekanisme ini, nilai yang dihasilkan melalui konfigurasi debconf Exim --yang tersimpan dalam <code
                class="filename">/etc/exim4/update-exim4.conf.conf</code>-- dapat disuntikkan ke dalam berkas konfigurasi Exim, bahkan ketika administrator atau paket lain telah mengubah konfigurasi bawaan Exim.
		</div><div
              class="para">
			Sintaks berkas konfigurasi Exim4 memiliki kekhasan dan kurva belajarnya; namun, begitu keanehan ini dipahami, Exim4 merupakan peladen surel yang sangat lengkap dan hebat, yang dibuktikan dengan puluhan halaman dokumentasi. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.exim.org/docs.html">http://www.exim.org/docs.html</a></div>
		</div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      xmlns=""
                      id="id-1.14.4.7"></a>11.1.1. Instalasi Postfix</h3></div></div></div><div
              class="para">
				Paket <span
                class="pkg pkg">postfix</span> menyertakan daemon SMTP utama. Paket lain (seperti <span
                class="pkg pkg">postfix-ldap</span> dan <span
                class="pkg pkg">postfix-pgsql</span>) menambahkan fungsionalitas tambahakan ke Postfix, termasuk mengakses basisdata terpetakan. Anda hanya perlu menginstallnya jika Anda tahu Anda memerlukannya.
			</div><div
              class="sidebar"><a
                xmlns=""
                id="sidebar.smtp"></a><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>KEMBALI KE DASAR</em></span> SMTP</strong></p></div></div></div><a
                id="id-1.14.4.7.3.2"
                class="indexterm"></a><a
                id="id-1.14.4.7.3.3"
                class="indexterm"></a><a
                id="id-1.14.4.7.3.4"
                class="indexterm"></a><div
                class="para">
				SMTP (<span
                  class="emphasis"><em>Simple Mail Transfer Protocol</em></span>) protokol yang digunakan oleh peladen posel untuk bertukar dan mengarahkan posel.
			</div></div><div
              class="para">
				Beberapa pertanyaan Debconf ditanyakan saat instalasi paket tersebut. Jawabannya memungkinkan menghasilkan versi pertama berkas konfigurasi <code
                class="filename">/etc/postfix/main.cf</code>.
			</div><div
              class="para">
				Pertanyaan pertama berkaitan dengan jenis pengaturan. Hanya dua jawaban relevan yang diajukan jika ada server yang tersambung ke internet, "situs internet" dan "internet dengan smarthost". Yang pertama sesuai untuk server yang menerima email masuk dan mengirim email keluar langsung ke penerimanya, dan karenanya cocok untuk kasus Falcot Corp. Yang terakhir ini sesuai untuk server yang menerima email masuk secara normal, namun mengirimkan email keluar melalui server SMTP menengah — ”smarthost” — bukan langsung ke server penerima. Ini sangat berguna bagi individu dengan alamat IP dinamis, karena banyak server email menolak pesan yang datang langsung dari alamat IP semacam itu. Dalam kasus ini, smarthost biasanya adalah SMTP server milik ISP, yang selalu dikonfigurasi untuk menerima email dari pelanggan ISP dan meneruskannya dengan tepat. Pengaturan ini (dengan smarthost) selalu relevan untuk server yang tidak terhubung secara permanen ke internet, karena menghindari harus mengatur antrian pesan tidak terkirim yang perlu dicoba ulang di waktu yang lain.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>KOSAKATA</em></span> ISP</strong></p></div></div></div><a
                id="id-1.14.4.7.6.2"
                class="indexterm"></a><div
                class="para">
				ISP merupakan akronim dari "Internet Service Provider" (penyedia layanan internet). Sebuah entitas, seringkali berupa perusaan komersial, yang menyediakan koneksi internet dan layanan dasar yang sesuai (email, berita, dan lain-lain).
			</div><div
                class="para">
			</div></div><div
              class="para">
				Pertanyaan kedua berkaitan dengan nama lengkap mesin, digunakan untuk menghasilkan alamat email dari nama pengguna lokal; nama lengkap mesin sebagai bagian setelah simbol-at ("@"). Dalam kasus Falcot, jawabannya seharusnya <code
                class="literal">mail.falcot.com</code>. Pertanyaan ini yang diajukan secara default, namun konfigurasi yang diembannya tidak cukup lengkap untuk kebutuhan Falcot, karenanya administrator menjalankan perintah <code
                class="command">dpkg-reconfigure postfix</code> agar dapat menyesuaikan lebih banyak parameter.
			</div><div
              class="para">
				Salah satu pertanyaan tambahan yang diajukan untuk semua nama domain yang berhubungan dengan mesin. Daftar bawaan yang menyertakan nama lengkapnya sebagaimana sedikit padanan untuk <code
                class="literal">localhost</code>, namun domain utama <code
                class="literal">falcot.com</code> perlu ditambahkan sendiri. Lebih umumnya, pertanyaan ini seharusnya biasanya dijawab dengan seluruh nama domain yang mana mesin ini seharusnya melayani sebagai sebuah MX server; dengan kata lain, seluruh nama domain yang mana disebutkan DNS bahwa mesin ini akan menerima surel. Informasi ini berpangkal pada variabel <code
                class="literal">mydestination</code> pada berkas konfigurasi Postfix — <code
                class="filename">/etc/postfix/main.cf</code>.
			</div><a
              id="id-1.14.4.7.9"
              class="indexterm"></a><a
              id="id-1.14.4.7.10"
              class="indexterm"></a><div
              class="figure"><a
                xmlns=""
                id="id-1.14.4.7.11"></a><div
                class="figure-contents"><div
                  class="mediaobject"><img
                    src="images/mail-server.png"
                    alt="Aturan record DNS MX saat mengirimkan surel" /></div></div><p
                class="title"><strong>Gambar 11.1. Aturan record DNS <span
                    class="emphasis"><em>MX</em></span> saat mengirimkan surel</strong></p></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>EXTRA</em></span> Query record MX</strong></p></div></div></div><div
                class="para">
				Ketika DNS tidak memilik record MX untuk sebuah domain, peladen surel akan mencoba mengirim pesan ke host-nya sendiri, dengan menggunakan record A (atau AAAA dalam IPv6).
			</div></div><div
              class="para">
				Dalam beberapa kasus, instalasi juga dapat meminta jaringan apa yang harus diperbolehkan untuk mengirim surel melalui mesin. Dengan konfigurasi default, Postfix hanya menerima surel yang datang dari mesin itu sendiri; jaringan lokal biasanya akan ditambahkan. Administrator Falcot Corp menambahkan <code
                class="literal">192.168.0.0/16</code> ke jawaban default. Jika pertanyaan itu tidak muncul, variabel yang relevan dalam berkas konfigurasi adalah <code
                class="literal">mynetworks</code>, seperti yang terlihat dalam contoh di bawah ini.
			</div><div
              class="para">
				Surel lokal juga dapat dikirimkan melalui <code
                class="command">procmail</code>. Alat ini memungkinkan pengguna untuk memilah surel masuk mereka menurut aturan yang disimpan dalam berkas <code
                class="filename">~/.procmailrc</code> mereka.
			</div><a
              id="id-1.14.4.7.15"
              class="indexterm"></a><a
              id="id-1.14.4.7.16"
              class="indexterm"></a><a
              id="id-1.14.4.7.17"
              class="indexterm"></a><div
              class="para">
				Setelah langkah pertama ini, para administrator mendapat berkas konfigurasi berikut; ini akan digunakan sebagai titik awal untuk menambahkan beberapa fungsi tambahan di bagian berikutnya.
			</div><div
              class="example"><a
                xmlns=""
                id="id-1.14.4.7.19"></a><p
                class="title"><strong>Contoh 11.1. Berkas<code
                    class="filename">/etc/postfix/main.cf</code> awal</strong></p><div
                class="example-contents"><pre
                  class="programlisting">
# See /usr/share/postfix/main.cf.dist for a commented, more complete version


# Debian specific:  Specifying a file name will cause the first
# line of that file to be used as the name.  The Debian default
# is /etc/mailname.
#myorigin = /etc/mailname

smtpd_banner = $myhostname ESMTP $mail_name (Debian/GNU)
biff = no

# appending .domain is the MUA's job.
append_dot_mydomain = no

# Uncomment the next line to generate "delayed mail" warnings
#delay_warning_time = 4h

readme_directory = no

# TLS parameters
smtpd_tls_cert_file=/etc/ssl/certs/ssl-cert-snakeoil.pem
smtpd_tls_key_file=/etc/ssl/private/ssl-cert-snakeoil.key
smtpd_use_tls=yes
smtpd_tls_session_cache_database = btree:${data_directory}/smtpd_scache
smtp_tls_session_cache_database = btree:${data_directory}/smtp_scache

# See /usr/share/doc/postfix/TLS_README.gz in the postfix-doc package for
# information on enabling SSL in the smtp client.

smtpd_relay_restrictions = permit_mynetworks permit_sasl_authenticated defer_unauth_destination
myhostname = mail.falcot.com
alias_maps = hash:/etc/aliases
alias_database = hash:/etc/aliases
myorigin = /etc/mailname
mydestination = mail.falcot.com, falcot.com, localhost.localdomain, localhost
relayhost = 
mynetworks = 127.0.0.0/8 [::ffff:127.0.0.0]/104 [::1]/128 192.168.0.0/16
mailbox_command = procmail -a "$EXTENSION"
mailbox_size_limit = 0
recipient_delimiter = +
inet_interfaces = all
inet_protocols = all</pre></div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>KEAMANAN</em></span> Sertifikat SSL <span
                          class="emphasis"><em>Snake oil</em></span></strong></p></div></div></div><div
                class="para">
				Sertifikat <span
                  class="emphasis"><em>minyak ular</em></span>, seperti "obat" <span
                  class="emphasis"><em>minyak ular</em></span> yang dijual oleh dukun palsu di jaman dahulu, benar-benar tidak memiliki nilai: Anda tidak dapat mengandalkan mereka untuk mengotentikasi server karena mereka sertifikat yang ditandatangani sendiri yang dihasilkan secara otomatis. Namun mereka sangat berguna untuk meningkatkan privasi pertukaran.
			</div><div
                class="para">
				Pada umumnya mereka hanya boleh digunakan untuk tujuan pengujian, dan layanan normal harus menggunakan sertifikat nyata; ini dapat dihasilkan dengan prosedur yang dijelaskan dalam <a
                  class="xref"
                  href="sect.virtual-private-network.html#sect.easy-rsa">Bagian 10.2.1.1, “Infrastruktur Kunci Publik: <span
                    class="emphasis"><em>easy-rsa</em></span>”</a>.
			</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      xmlns=""
                      id="sect.configuring-virtual-domains"></a>11.1.2. Mengkonfigurasi Domain Virtual</h3></div></div></div><a
              id="id-1.14.4.8.2"
              class="indexterm"></a><a
              id="id-1.14.4.8.3"
              class="indexterm"></a><div
              class="para">
				Server surat dapat menerima surel yang ditujukan kepada domain lain selain domain utama; ini kemudian dikenal sebagai domain virtual. Dalam kebanyakan kasus di mana hal ini terjadi, surel pada akhirnya tidak ditujukan ke pengguna lokal. Postfix menyediakan dua fitur menarik untuk menangani virtual domain.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>HATI-HATI</em></span> Domain virtual dan domain kanonik</strong></p></div></div></div><div
                class="para">
				Tak satu pun dari domain virtual boleh dirujuk dalam variabel <code
                  class="literal">mydestination</code>; variabel ini hanya berisi nama-nama domain "kanonik" yang secara langsung terkait dengan mesin dan pengguna lokal.
			</div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.8.6"></a>11.1.2.1. Domain Alias Virtual</h4></div></div></div><a
                id="id-1.14.4.8.6.2"
                class="indexterm"></a><a
                id="id-1.14.4.8.6.3"
                class="indexterm"></a><div
                class="para">
					Suatu domain alias virtual hanya berisi alias, yaitu alamat-alamat yang hanya meneruskan surel ke alamat lain.
				</div><div
                class="para">
					Domain seperti itu diaktifkan dengan menambahkan nama ke variabel <code
                  class="literal">virtual_alias_domains</code>, dan mereferensi berkas pemetaan alamat dalam variabel <code
                  class="literal">virtual_alias_maps</code>.
				</div><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.8.6.6"></a><p
                  class="title"><strong>Contoh 11.2. Direktif yang ditambahkan dalam berkas <code
                      class="filename">/etc/postfix/main.cf</code></strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
virtual_alias_domains = falcotsbrand.com
virtual_alias_maps = hash:/etc/postfix/virtual</pre></div></div><div
                class="para">
					Berkas <code
                  class="filename">/etc/postfix/virtual</code> menjelaskan pemetaan dengan sintaks yang agak sederhana: setiap baris berisi dua field yang dipisahkan oleh spasi; field pertama adalah nama alias, field kedua adalah daftar alamat surel tujuan pengalihan. Sintaks khusus <code
                  class="literal">@domain.com</code> mencakup semua sisa alias dalam suatu domain.
				</div><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.8.6.8"></a><p
                  class="title"><strong>Contoh 11.3. Contoh berkas <code
                      class="filename">/etc/postfix/virtual</code></strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
webmaster@falcotsbrand.com  jean@falcot.com
contact@falcotsbrand.com    laure@falcot.com, sophie@falcot.com
# The alias below is generic and covers all addresses within 
# the falcotsbrand.com domain not otherwise covered by this file.
# These addresses forward email to the same user name in the
# falcot.com domain.
@falcotsbrand.com           @falcot.com</pre></div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.8.7"></a>11.1.2.2. Domain Kotak Surat Virtual</h4></div></div></div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>HATI-HATI</em></span> Gabungan domain virtual?</strong></p></div></div></div><div
                  class="para">
					Postfix tidak mengizinkan menggunakan domain yang sama sekaligus di <code
                    class="literal">virtual_alias_domains</code> dan <code
                    class="literal">virtual_mailbox_domains</code>. Namun, setiap domain <code
                    class="literal">virtual_mailbox_domains</code> secara implisit dimasukkan ke dalam <code
                    class="literal">virtual_alias_domains</code>, yang memungkinkan untuk mencampur alias dan kotak surat dalam suatu domain virtual.
				</div></div><a
                id="id-1.14.4.8.7.3"
                class="indexterm"></a><a
                id="id-1.14.4.8.7.4"
                class="indexterm"></a><div
                class="para">
					Pesan-pesan yang ditujukan ke kotak surat domain virtual disimpan dalam kotak surat yang tidak ditugaskan ke pengguna sistem lokal.
				</div><div
                class="para">
					Memfungsikan kotak surat domain virtual memerlukan menamai domain ini dalam variabel <code
                  class="literal">virtual_mailbox_domains</code>, dan mereferensi ke berkas pemetaan kotak surat di <code
                  class="literal">virtual_mailbox_maps</code>. Parameter <code
                  class="literal">virtual_mailbox_base</code> berisi direktori di mana kotak pesan akan disimpan.
				</div><div
                class="para">
					Parameter <code
                  class="literal">virtual_uid_maps</code> (dan <code
                  class="literal">virtual_gid_maps</code>) mengacu ke berkas yang berisi pemetaan antara alamat surel dan sistem pengguna (dan kelompok) yang "memiliki" kotak surat yang sesuai. Agar semua kotak surat dimiliki oleh pemilik/kelompok yang sama, sintaks <code
                  class="literal">static:5000</code> menetapkan UID/GID tertentu (yang bernilai 5000 di sini).
				</div><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.8.7.8"></a><p
                  class="title"><strong>Contoh 11.4. Direktif yang ditambahkan dalam berkas <code
                      class="filename">/etc/postfix/main.cf</code></strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
virtual_mailbox_domains = falcot.org
virtual_mailbox_maps = hash:/etc/postfix/vmailbox
virtual_mailbox_base = /var/mail/vhosts</pre></div></div><div
                class="para">
					Sekali lagi, sintaks berkas <code
                  class="filename">/etc/postfix/vmailbox</code> cukup sederhana: dua field dipisahkan dengan spasi. Field pertama adalah alamat surel dalam salah satu domain virtual, dan field kedua adalah lokasi kotak surat yang terkait (relatif terhadap direktori yang ditentukan dalam <span
                  class="emphasis"><em>virtual_mailbox_base</em></span>). Jika nama kotak surat berakhir dengan garis miring (<code
                  class="literal">/</code>), surel akan disimpan dalam format <span
                  class="emphasis"><em>maildir</em></span>; jika tidak, format tradisional <span
                  class="emphasis"><em>mbox</em></span> akan digunakan. Format <span
                  class="emphasis"><em>maildir</em></span> menggunakan seluruh direktori untuk menyimpan kotak surat, masing-masing pesan disimpan dalam berkas terpisah. Dalam format <span
                  class="emphasis"><em>mbox</em></span>, seluruh kotak surat disimpan dalam satu berkas, dan setiap baris yang dimulai dengan "<code
                  class="literal">From </code>" (<code
                  class="literal">From</code> diikuti dengan spasi) menandai awal pesan baru.
				</div><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.8.7.10"></a><p
                  class="title"><strong>Contoh 11.5. Berkas <code
                      class="filename">/etc/postfix/vmailbox</code></strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
# Surel Jean disimpan sebagai maildir, dengan
# satu berkas per surel dalam suatu direktori
# terdedikasi
jean@falcot.org falcot.org/jean/
# Surel Sophie's disimpan dalam suatu berkas "mbox"
# tradisional dengan semua surel disambung ke dalam
# satu berkas tunggal
sophie@falcot.org falcot.org/sophie</pre></div></div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      xmlns=""
                      id="sect.restrictions-for-receiving-and-sending"></a>11.1.3. Pembatasan Penerimaan dan Pengiriman</h3></div></div></div><div
              class="para">
				Meningkatnya jumlah surel massal yang tidak diminta (<span
                class="emphasis"><em>spam</em></span>) memerlukan menjadi semakin ketat ketika memutuskan surel mana yang mesti diterima oleh server. Bagian ini menyajikan beberapa strategi yang termasuk dalam Postfix.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>KULTUR</em></span> Masalah spam</strong></p></div></div></div><a
                id="id-1.14.4.9.3.2"
                class="indexterm"></a><div
                class="para">
				"Spam" adalah istilah umum yang digunakan untuk menamai semua surel komersial yang tidak diinginkan (juga dikenal sebagai UCE) yang membanjiri kotak surat elektronik kita; individu-individu yang tidak bermoral yang mengirim mereka dikenal sebagai spammer. Mereka tidak peduli tentang gangguan yang mereka sebabkan, karena mengirimkan surel biayanya sangat rendah, dan hanya persentase yang sangat kecil dari penerima yang perlu tertarik dengan tawaran agar operasi spam menghasilkan lebih daripada biaya. Prosesnya kebanyakan otomatis, dan alamat surel yang dibuat publik (misalnya, di forum web, atau di arsip milis, atau di blog, dan sebagainya) akan ditemukan oleh robot spammer, dan menjadi sasaran pesan tak diharapkan yang tidak pernah berakhir.
			</div><div
                class="para">
				Semua administrator sistem mencoba untuk menghadapi gangguan dengan filter spam, tapi tentu saja spammer terus menyesuaikan diri dengan mencoba menghindari filter ini. Beberapa bahkan menyewa jaringan mesin yang terkompromi oleh worm dari berbagai sindikat kejahatan. Statistik baru-baru ini memperkirakan bahwa hingga 95% dari semua surel yang beredar di Internet adalah spam!
			</div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.9.4"></a>11.1.3.1. Pembatasan Akses Berbasis IP</h4></div></div></div><div
                class="para">
					Direktif <code
                  class="literal">smtpd_client_restrictions</code> mengendalikan mesin mana yang diperbolehkan untuk berkomunikasi dengan server surel.
				</div><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.9.4.3"></a><p
                  class="title"><strong>Contoh 11.6. Pembatasan Berbasis Alamat Klien</strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
smtpd_client_restrictions = permit_mynetworks,
    warn_if_reject reject_unknown_client,
    check_client_access hash:/etc/postfix/access_clientip,
    reject_rbl_client sbl-xbl.spamhaus.org,
    reject_rbl_client list.dsbl.org</pre></div></div><div
                class="para">
					Ketika suatu variabel berisi daftar aturan, seperti pada contoh di atas, aturan-aturan ini dievaluasi berurutan, dari pertama sampai terakhir. Setiap aturan dapat menerima pesan, menolak, atau menyerahkan keputusan ke aturan berikutnya. Sebagai akibatnya, urutan penting, dan sekedar mempertukarkan dua aturan dapat menyebabkan perilaku yang sangat berbeda.
				</div><div
                class="para">
					The <code
                  class="literal">permit_mynetworks</code> directive, used as the first rule, accepts all emails coming from a machine in the local network (as defined by the <span
                  class="emphasis"><em>mynetworks</em></span> configuration variable).
				</div><div
                class="para">
					The second directive would normally reject emails coming from machines without a completely valid DNS configuration. Such a valid configuration means that the IP address can be resolved to a name, and that this name, in turn, resolves to the IP address. This restriction is often too strict, since many email servers do not have a reverse DNS for their IP address. This explains why the Falcot administrators prepended the <code
                  class="literal">warn_if_reject</code> modifier to the <code
                  class="literal">reject_unknown_client</code> directive: this modifier turns the rejection into a simple warning recorded in the logs. The administrators can then keep an eye on the number of messages that would be rejected if the rule were actually enforced, and make an informed decision later if they wish to enable such enforcement.
				</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>TIP</em></span> tabel <span
                            class="emphasis"><em>access</em></span></strong></p></div></div></div><div
                  class="para">
					The restriction criteria include administrator-modifiable tables listing combinations of senders, IP addresses, and allowed or forbidden hostnames. These tables can be created from an uncompressed copy of the <code
                    class="filename">/usr/share/doc/postfix-doc/examples/access.gz</code> file. This model is self-documented in its comments, which means each table describes its own syntax.
				</div><div
                  class="para">
					The <code
                    class="filename">/etc/postfix/access_clientip</code> table lists IP addresses and networks; <code
                    class="filename">/etc/postfix/access_helo</code> lists domain names; <code
                    class="filename">/etc/postfix/access_sender</code> contains sender email addresses. All these files need to be turned into hash-tables (a format optimized for fast access) after each change, with the <code
                    class="command">postmap /etc/postfix/<em
                      class="replaceable">file</em></code> command.
				</div></div><div
                class="para">
					The third directive allows the administrator to set up a blacklist and a whitelist of email servers, stored in the <code
                  class="filename">/etc/postfix/access_clientip</code> file. Servers in the whitelist are considered as trusted, and the emails coming from there therefore do not go through the following filtering rules.
				</div><div
                class="para">
					The last two rules reject any message coming from a server listed in one of the indicated blacklists. RBL is an acronym for <span
                  class="emphasis"><em>Remote Black List</em></span>; there are several such lists, but they all list badly configured servers that spammers use to relay their emails, as well as unexpected mail relays such as machines infected with worms or viruses.
				</div><a
                id="id-1.14.4.9.4.10"
                class="indexterm"></a><a
                id="id-1.14.4.9.4.11"
                class="indexterm"></a><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>TIPS</em></span> Daftar putih dan RBL</strong></p></div></div></div><div
                  class="para">
					Blacklists sometimes include a legitimate server that has been suffering an incident. In these situations, all emails coming from one of these servers would be rejected unless the server is listed in a whitelist defined by <code
                    class="filename">/etc/postfix/access_clientip</code>.
				</div><div
                  class="para">
					Prudence therefore recommends including in the whitelist all the trusted servers from which many emails are usually received.
				</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.9.5"></a>11.1.3.2. Checking the Validity of the <code
                        class="literal">EHLO</code> or <code
                        class="literal">HELO</code> Commands</h4></div></div></div><div
                class="para">
					Each SMTP exchange starts with a <code
                  class="literal">HELO</code> (or <code
                  class="literal">EHLO</code>) command, followed by the name of the sending email server; checking the validity of this name can be interesting.
				</div><a
                id="id-1.14.4.9.5.3"
                class="indexterm"></a><a
                id="id-1.14.4.9.5.4"
                class="indexterm"></a><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.9.5.5"></a><p
                  class="title"><strong>Contoh 11.7. Restrictions on the name announced in <code
                      class="literal">EHLO</code></strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
smtpd_helo_restrictions = permit_mynetworks,
    reject_invalid_hostname,
    check_helo_access hash:/etc/postfix/access_helo,
    reject_non_fqdn_hostname,
    warn_if_reject reject_unknown_hostname</pre></div></div><div
                class="para">
					The first <code
                  class="literal">permit_mynetworks</code> directive allows all machines on the local network to introduce themselves freely. This is important, because some email programs do not respect this part of the SMTP protocol adequately enough, and they can introduce themselves with nonsensical names.
				</div><div
                class="para">
					The <code
                  class="literal">reject_invalid_hostname</code> rule rejects emails when the <code
                  class="literal">EHLO</code> announce lists a syntactically incorrect hostname. The <code
                  class="literal">reject_non_fqdn_hostname</code> rule rejects messages when the announced hostname is not a fully-qualified domain name (including a domain name as well as a host name). The <code
                  class="literal">reject_unknown_hostname</code> rule rejects messages if the announced name does not exist in the DNS. Since this last rule unfortunately leads to too many rejections, the administrators turned its effect to a simple warning with the <code
                  class="literal">warn_if_reject</code> modifier as a first step; they may decide to remove this modifier at a later stage, after auditing the results of this rule.
				</div><div
                class="para">
					Using <code
                  class="literal">permit_mynetworks</code> as the first rule has an interesting side effect: the following rules only apply to hosts outside the local network. This allows blacklisting all hosts that announce themselves as part of the <code
                  class="literal">falcot.com</code>, for instance by adding a <code
                  class="literal">falcot.com REJECT You are not in our network!</code> line to the <code
                  class="filename">/etc/postfix/access_helo</code> file.
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.9.6"></a>11.1.3.3. Accepting or Refusing Based on the Announced Sender</h4></div></div></div><div
                class="para">
					Every message has a sender, announced by the <code
                  class="literal">MAIL FROM</code> command of the SMTP protocol; again, this information can be validated in several different ways.
				</div><a
                id="id-1.14.4.9.6.3"
                class="indexterm"></a><a
                id="id-1.14.4.9.6.4"
                class="indexterm"></a><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.9.6.5"></a><p
                  class="title"><strong>Contoh 11.8. Sender checks</strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
smtpd_sender_restrictions = 
    check_sender_access hash:/etc/postfix/access_sender,
    reject_unknown_sender_domain, reject_unlisted_sender,
    reject_non_fqdn_sender</pre></div></div><div
                class="para">
					Tabel <code
                  class="filename">/etc/postfix/access_sender</code> memetakan beberapa perlakuan khusus untuk beberapa pengirim. Ini biasanya berarti memasukkan beberapa pengirim ke daftar putih atau daftar hitam.
				</div><div
                class="para">
					The <code
                  class="literal">reject_unknown_sender_domain</code> rule requires a valid sender domain, since it is needed for a valid address. The <code
                  class="literal">reject_unlisted_sender</code> rule rejects local senders if the address does not exist; this prevents emails from being sent from an invalid address in the <code
                  class="literal">falcot.com</code> domain, and messages emanating from <code
                  class="literal">joe.bloggs@falcot.com</code> are only accepted if such an address really exists.
				</div><div
                class="para">
					Finally, the <code
                  class="literal">reject_non_fqdn_sender</code> rule rejects emails purporting to come from addresses without a fully-qualified domain name. In practice, this means rejecting emails coming from <code
                  class="literal">user@machine</code>: the address must be announced as either <code
                  class="literal">user@machine.example.com</code> or <code
                  class="literal">user@example.com</code>.
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.9.7"></a>11.1.3.4. Accepting or Refusing Based on the Recipient</h4></div></div></div><div
                class="para">
					Each email has at least one recipient, announced with the <code
                  class="literal">RCPT TO</code> command in the SMTP protocol. These addresses also warrant validation, even if that may be less relevant than the checks made on the sender address.
				</div><a
                id="id-1.14.4.9.7.3"
                class="indexterm"></a><a
                id="id-1.14.4.9.7.4"
                class="indexterm"></a><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.9.7.5"></a><p
                  class="title"><strong>Contoh 11.9. Pemeriksaan penerima</strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
smtpd_recipient_restrictions = permit_mynetworks, 
    reject_unauth_destination, reject_unlisted_recipient, 
    reject_non_fqdn_recipient</pre></div></div><div
                class="para">
					<code
                  class="literal">reject_unauth_destination</code> is the basic rule that requires outside messages to be addressed to us; messages sent to an address not served by this server are rejected. Without this rule, a server becomes an open relay that allows spammers to send unsolicited emails; this rule is therefore mandatory, and it will be best included near the beginning of the list, so that no other rules may authorize the message before its destination has been checked.
				</div><div
                class="para">
					The <code
                  class="literal">reject_unlisted_recipient</code> rule rejects messages sent to non-existing local users, which makes sense. Finally, the <code
                  class="literal">reject_non_fqdn_recipient</code> rule rejects non-fully-qualified addresses; this makes it impossible to send an email to <code
                  class="literal">jean</code> or <code
                  class="literal">jean@machine</code>, and requires using the full address instead, such as <code
                  class="literal">jean@machine.falcot.com</code> or <code
                  class="literal">jean@falcot.com</code>.
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.9.8"></a>11.1.3.5. Restrictions Associated with the <code
                        class="literal">DATA</code> Command</h4></div></div></div><div
                class="para">
					The <code
                  class="literal">DATA</code> command of SMTP is emitted before the contents of the message. It doesn't provide any information per se, apart from announcing what comes next. It can still be subjected to checks.
				</div><a
                id="id-1.14.4.9.8.3"
                class="indexterm"></a><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.9.8.4"></a><p
                  class="title"><strong>Contoh 11.10. Pemeriksaan <code
                      class="literal">DATA</code></strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
smtpd_data_restrictions = reject_unauth_pipelining</pre></div></div><div
                class="para">
					The <code
                  class="literal">reject_unauth_pipelining</code> directives causes the message to be rejected if the sending party sends a command before the reply to the previous command has been sent. This guards against a common optimization used by spammer robots, since they usually don't care a fig about replies and only focus on sending as many emails as possible in as short a time as possible.
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.9.9"></a>11.1.3.6. Menerapkan Pembatasan</h4></div></div></div><div
                class="para">
					Although the above commands validate information at various stages of the SMTP exchange, Postfix only sends the actual rejection as a reply to the <code
                  class="literal">RCPT TO</code> command.
				</div><div
                class="para">
					This means that even if the message is rejected due to an invalid <code
                  class="literal">EHLO</code> command, Postfix knows the sender and the recipient when announcing the rejection. It can then log a more explicit message than it could if the transaction had been interrupted from the start. In addition, a number of SMTP clients do not expect failures on the early SMTP commands, and these clients will be less disturbed by this late rejection.
				</div><div
                class="para">
					A final advantage to this choice is that the rules can accumulate information during the various stages of the SMTP exchange; this allows defining more fine-grained permissions, such as rejecting a non-local connection if it announces itself with a local sender.
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h4
                      class="title"><a
                        xmlns=""
                        id="id-1.14.4.9.10"></a>11.1.3.7. Penyaringan Berdasarkan Isi Pesan</h4></div></div></div><div
                class="para">
					The validation and restriction system would not be complete without a way to apply checks to the message contents. Postfix differentiates the checks applying to the email headers from those applying to the email body.
				</div><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.9.10.3"></a><p
                  class="title"><strong>Contoh 11.11. Memfungsikan penyaring berbasis konten</strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
header_checks = regexp:/etc/postfix/header_checks
body_checks = regexp:/etc/postfix/body_checks</pre></div></div><a
                id="id-1.14.4.9.10.4"
                class="indexterm"></a><div
                class="para">
					Kedua berkas berisi daftar ekspresi reguler (umumnya dikenal sebagai <span
                  class="emphasis"><em>regexps</em></span> atau <span
                  class="emphasis"><em>regexes</em></span>) dan tindakan menjadi dipicu ketika header surel (atau tubuh) cocok dengan ekspresi yang terkait.
				</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>LIHAT CEPAT</em></span> Tabel regex</strong></p></div></div></div><div
                  class="para">
					Berkas <code
                    class="filename">/usr/share/doc/postfix-doc/examples/header_checks.gz</code> berisi banyak komentar penjelasan dan dapat digunakan sebagai titik awal untuk membuat berkas <code
                    class="filename">/etc/postfix/header_checks</code> dan <code
                    class="filename">/etc/postfix /body_checks</code>.
				</div></div><div
                class="example"><a
                  xmlns=""
                  id="id-1.14.4.9.10.7"></a><p
                  class="title"><strong>Contoh 11.12. Berkas contoh <code
                      class="filename">/etc/postfix/header_checks</code></strong></p><div
                  class="example-contents"><pre
                    class="programlisting">
/^X-Mailer: GOTO Sarbacane/ REJECT I fight spam (GOTO Sarbacane)
/^Subject: *Your email contains VIRUSES/ DISCARD virus notification</pre></div></div><div
                class="sidebar"><a
                  xmlns=""
                  id="sidebar.regexp"></a><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>KEMBALI KE DASAR</em></span> Ekspresi reguler</strong></p></div></div></div><div
                  class="para">
					The <span
                    class="emphasis"><em>regular expression</em></span> term (shortened to <span
                    class="emphasis"><em>regexp</em></span> or <span
                    class="emphasis"><em>regex</em></span>) references a generic notation for expressing a description of the contents and/or structure of a string of characters. Certain special characters allow defining alternatives (for instance, <code
                    class="literal">foo|bar</code> matches either “foo” or “bar”), sets of allowed characters (for instance, <code
                    class="literal">[0-9]</code> means any digit, and <code
                    class="literal">.</code> — a dot — means any character), quantifications (<code
                    class="literal">s?</code> matches either <code
                    class="literal">s</code> or the empty string, in other words 0 or 1 occurrence of <code
                    class="literal">s</code>; <code
                    class="literal">s+</code> matches one or more consecutive <code
                    class="literal">s</code> characters; and so on). Parentheses allow grouping search results.
				</div><div
                  class="para">
					The precise syntax of these expressions varies across the tools using them, but the basic features are similar. <div
                    xmlns=""
                    class="url">→ <a
                      xmlns="http://www.w3.org/1999/xhtml"
                      href="http://en.wikipedia.org/wiki/Regular_expression">http://en.wikipedia.org/wiki/Regular_expression</a></div>
				</div></div><div
                class="para">
					The first one checks the header mentioning the email software; if <code
                  class="literal">GOTO Sarbacane</code> (a bulk email software) is found, the message is rejected. The second expression controls the message subject; if it mentions a virus notification, we can decide not to reject the message but to discard it immediately instead.
				</div><div
                class="para">
					Using these filters is a double-edged sword, because it is easy to make the rules too generic and to lose legitimate emails as a consequence. In these cases, not only the messages will be lost, but their senders will get unwanted (and annoying) error messages.
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      xmlns=""
                      id="sect.setting-up-greylisting"></a>11.1.4. Menyiapkan <span
                      class="foreignphrase"><em
                        class="foreignphrase">greylisting</em></span></h3></div></div></div><a
              id="id-1.14.4.10.2"
              class="indexterm"></a><div
              class="para">
				“Greylisting” is a filtering technique according to which a message is initially rejected with a temporary error code, and only accepted on a further try after some delay. This filtering is particularly efficient against spam sent by the many machines infected by worms and viruses, since this software rarely acts as a full SMTP agent (by checking the error code and retrying failed messages later), especially since many of the harvested addresses are really invalid and retrying would only mean losing time.
			</div><div
              class="para">
				Postfix doesn't provide greylisting natively, but there is a feature by which the decision to accept or reject a given message can be delegated to an external program. The <span
                class="pkg pkg">postgrey</span> package contains just such a program, designed to interface with this access policy delegation service.
			</div><div
              class="para">
				Once <span
                class="pkg pkg">postgrey</span> is installed, it runs as a daemon and listens on port 10023. Postfix can then be configured to use it, by adding the <code
                class="literal">check_policy_service</code> parameter as an extra restriction:
			</div><pre
              class="programlisting">
smtpd_recipient_restrictions = permit_mynetworks,
    [...]
    check_policy_service inet:127.0.0.1:10023</pre><div
              class="para">
				Each time Postfix reaches this rule in the ruleset, it will connect to the <code
                class="command">postgrey</code> daemon and send it information concerning the relevant message. On its side, Postgrey considers the IP address/sender/recipient triplet and checks in its database whether that same triplet has been seen recently. If so, Postgrey replies that the message should be accepted; if not, the reply indicates that the message should be temporarily rejected, and the triplet gets recorded in the database.
			</div><div
              class="para">
				The main disadvantage of greylisting is that legitimate messages get delayed, which is not always acceptable. It also increases the burden on servers that send many legitimate emails.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>DALAM PRAKTEK</em></span> Kekurangan dari greylisting</strong></p></div></div></div><div
                class="para">
				Theoretically, greylisting should only delay the first mail from a given sender to a given recipient, and the typical delay is in the order of minutes. Reality, however, can differ slightly. Some large ISPs use clusters of SMTP servers, and when a message is initially rejected, the server that retries the transmission may not be the same as the initial one. When that happens, the second server gets a temporary error message due to greylisting too, and so on; it may take several hours until transmission is attempted by a server that has already been involved, since SMTP servers usually increase the delay between retries at each failure.
			</div><div
                class="para">
				As a consequence, the incoming IP address may vary in time even for a single sender. But it goes further: even the sender address can change. For instance, many mailing-list servers encode extra information in the sender address so as to be able to handle error messages (known as <span
                  class="emphasis"><em>bounces</em></span>). Each new message sent to a mailing-list may then need to go through greylisting, which means it has to be stored (temporarily) on the sender's server. For very large mailing-lists (with tens of thousands of subscribers), this can soon become a problem.
			</div><div
                class="para">
				To mitigate these drawbacks, Postgrey manages a whitelist of such sites, and messages emanating from them are immediately accepted without going through greylisting. This list can easily be adapted to local needs, since it is stored in the <code
                  class="filename">/etc/postgrey/whitelist_clients</code> file.
			</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>LEBIH LANJUT</em></span> Greylisting selektif dengan <span
                          class="pkg pkg">milter-greylist</span></strong></p></div></div></div><div
                class="para">
				The drawbacks of greylisting can be mitigated by only using greylisting on the subset of clients that are already considered as probable sources of spam (because they are listed in a DNS blacklist). This is not possible with <span
                  class="pkg pkg">postgrey</span> but <span
                  class="pkg pkg">milter-greylist</span> can be used in such a way.
			</div><div
                class="para">
				In that scenario, since DNS blacklists never triggers a definitive rejection, it becomes reasonable to use aggressive blacklists, including those listing all dynamic IP addresses from ISP clients (such as <code
                  class="literal">pbl.spamhaus.org</code> or <code
                  class="literal">dul.dnsbl.sorbs.net</code>).
			</div><div
                class="para">
				Since milter-greylist uses Sendmail's milter interface, the postfix side of its configuration is limited to “<code
                  class="literal">smtpd_milters = unix:/var/run/milter-greylist/milter-greylist.sock</code>”. The <span
                  class="citerefentry"><span
                    class="refentrytitle">greylist.conf</span>(5)</span> manual page documents <code
                  class="filename">/etc/milter-greylist/greylist.conf</code> and the numerous ways to configure milter-greylist. You will also have to edit <code
                  class="filename">/etc/default/milter-greylist</code> to actually enable the service.
			</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      xmlns=""
                      id="id-1.14.4.11"></a>11.1.5. Customizing Filters Based On the Recipient</h3></div></div></div><div
              class="para">
				<a
                class="xref"
                href="network-services.html#sect.restrictions-for-receiving-and-sending">Bagian 11.1.3, “Pembatasan Penerimaan dan Pengiriman”</a> and <a
                class="xref"
                href="network-services.html#sect.setting-up-greylisting">Bagian 11.1.4, “Menyiapkan <span
                  class="foreignphrase"><em
                    class="foreignphrase">greylisting</em></span>”</a> reviewed many of the possible restrictions. They all have their use in limiting the amount of received spam, but they also all have their drawbacks. It is therefore more and more common to customize the set of filters depending on the recipient. At Falcot Corp, greylisting is interesting for most users, but it hinders the work of some users who need low latency in their emails (such as the technical support service). Similarly, the commercial service sometimes has problems receiving emails from some Asian providers who may be listed in blacklists; this service asked for a non-filtered address so as to be able to correspond.
			</div><div
              class="para">
				Postfix provides such a customization of filters with a “restriction class” concept. The classes are declared in the <code
                class="literal">smtpd_restriction_classes</code> parameter, and defined the same way as <code
                class="literal">smtpd_recipient_restrictions</code>. The <code
                class="literal">check_recipient_access</code> directive then defines a table mapping a given recipient to the appropriate set of restrictions.
			</div><div
              class="example"><a
                xmlns=""
                id="id-1.14.4.11.4"></a><p
                class="title"><strong>Contoh 11.13. Defining restriction classes in <code
                    class="filename">main.cf</code></strong></p><div
                class="example-contents"><pre
                  class="programlisting">smtpd_restriction_classes = greylisting, aggressive, permissive

greylisting = check_policy_service inet:127.0.0.1:10023
aggressive = reject_rbl_client sbl-xbl.spamhaus.org,
        check_policy_service inet:127.0.0.1:10023
permissive = permit

smtpd_recipient_restrictions = permit_mynetworks,
        reject_unauth_destination,
        check_recipient_access hash:/etc/postfix/recipient_access</pre></div></div><div
              class="example"><a
                xmlns=""
                id="id-1.14.4.11.5"></a><p
                class="title"><strong>Contoh 11.14. Berkas <code
                    class="filename">/etc/postfix/recipient_access</code></strong></p><div
                class="example-contents"><pre
                  class="programlisting">
# Unfiltered addresses
postmaster@falcot.com  permissive
support@falcot.com     permissive
sales-asia@falcot.com  permissive

# Aggressive filtering for some privileged users
joe@falcot.com         aggressive

# Special rule for the mailing-list manager
sympa@falcot.com       reject_unverified_sender

# Greylisting by default
falcot.com             greylisting</pre></div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      xmlns=""
                      id="sect.postfix-antivirus"></a>11.1.6. Mengintegrasikan Antivirus</h3></div></div></div><a
              id="id-1.14.4.12.2"
              class="indexterm"></a><div
              class="para">
				The many viruses circulating as attachments to emails make it important to set up an antivirus at the entry point of the company network, since despite an awareness campaign, some users will still open attachments from obviously shady messages.
			</div><div
              class="para">
				Para administrator Falcot memilih <code
                class="command">clamav</code> untuk antivirus gratis mereka. Paket utama adalah <span
                class="pkg pkg">clamav</span>, tetapi mereka juga memasang beberapa paket tambahan seperti <span
                class="pkg pkg">arj</span>, <span
                class="pkg pkg">unzoo</span>, <span
                class="pkg pkg">unrar</span>, dan <span
                class="pkg pkg">lha</span>, karena mereka diperlukan oleh antivirus untuk menganalisis lampiran yang diarsipkan dalam salah satu format ini.
			</div><a
              id="id-1.14.4.12.5"
              class="indexterm"></a><a
              id="id-1.14.4.12.6"
              class="indexterm"></a><div
              class="para">
				The task of interfacing between antivirus and the email server goes to <code
                class="command">clamav-milter</code>. A <span
                class="emphasis"><em>milter</em></span> (short for <span
                class="emphasis"><em>mail filter</em></span>) is a filtering program specially designed to interface with email servers. A milter uses a standard application programming interface (API) that provides much better performance than filters external to the email servers. Milters were initially introduced by <span
                class="emphasis"><em>Sendmail</em></span>, but <span
                class="emphasis"><em>Postfix</em></span> soon followed suit.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>LIHAT SEKILAS</em></span> Milter untuk Spamassassin</strong></p></div></div></div><a
                id="id-1.14.4.12.8.2"
                class="indexterm"></a><div
                class="para">
				The <span
                  class="pkg pkg">spamass-milter</span> package provides a milter based on <span
                  class="emphasis"><em>SpamAssassin</em></span>, the famous unsolicited email detector. It can be used to flag messages as probable spams (by adding an extra header) and/or to reject the messages altogether if their “spamminess” score goes beyond a given threshold.
			</div></div><div
              class="para">
				Once the <span
                class="pkg pkg">clamav-milter</span> package is installed, the milter should be reconfigured to run on a TCP port rather than on the default named socket. This can be achieved with <code
                class="command">dpkg-reconfigure clamav-milter</code>. When prompted for the “Communication interface with Sendmail”, answer “<code
                class="literal">inet:10002@127.0.0.1</code>”.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>CATATAN</em></span> Port TCP nyata vs soket bernama</strong></p></div></div></div><div
                class="para">
				The reason why we use a real TCP port rather than the named socket is that the postfix daemons often run chrooted and do not have access to the directory hosting the named socket. You could also decide to keep using a named socket and pick a location within the chroot (<code
                  class="filename">/var/spool/postfix/</code>).
			</div></div><div
              class="para">
				The standard ClamAV configuration fits most situations, but some important parameters can still be customized with <code
                class="command">dpkg-reconfigure clamav-base</code>.
			</div><div
              class="para">
				The last step involves telling Postfix to use the recently-configured filter. This is a simple matter of adding the following directive to <code
                class="filename">/etc/postfix/main.cf</code>:
			</div><pre
              class="programlisting">
# Virus check with clamav-milter
smtpd_milters = inet:[127.0.0.1]:10002</pre><div
              class="para">
				If the antivirus causes problems, this line can be commented out, and <code
                class="command">service postfix reload</code> should be run so that this change is taken into account.
			</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>DALAM PRAKTEK</em></span> Menguji antivirus</strong></p></div></div></div><div
                class="para">
				Once the antivirus is set up, its correct behavior should be tested. The simplest way to do that is to send a test email with an attachment containing the <code
                  class="filename">eicar.com</code> (or <code
                  class="filename">eicar.com.zip</code>) file, which can be downloaded online: <div
                  xmlns=""
                  class="url">→ <a
                    xmlns="http://www.w3.org/1999/xhtml"
                    href="http://www.eicar.org/86-0-Intended-use.html">http://www.eicar.org/86-0-Intended-use.html</a></div>
			</div><div
                class="para">
				This file is not a true virus, but a test file that all antivirus software on the market diagnose as a virus to allow checking installations.
			</div></div><div
              class="para">
				Semua pesan yang ditangani oleh Postfix sekarang pergi melalui saringan antivirus.
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h3
                    class="title"><a
                      xmlns=""
                      id="sect.authenticated-smtp"></a>11.1.7. SMTP Terotentikasi</h3></div></div></div><div
              class="para">
				Being able to send emails requires an SMTP server to be reachable; it also requires said SMTP server to send emails through it. For roaming users, this may need regularly changing the configuration of the SMTP client, since Falcot's SMTP server rejects messages coming from IP addresses apparently not belonging to the company. Two solutions exist: either the roaming user installs an SMTP server on their computer, or they still use the company server with some means of authenticating as an employee. The former solution is not recommended since the computer won't be permanently connected, and it won't be able to retry sending messages in case of problems; we will focus on the latter solution.
			</div><div
              class="para">
				SMTP authentication in Postfix relies on SASL (<span
                class="emphasis"><em>Simple Authentication and Security Layer</em></span>). It requires installing the <span
                class="pkg pkg">libsasl2-modules</span> and <span
                class="pkg pkg">sasl2-bin</span> packages, then registering a password in the SASL database for each user that needs authenticating on the SMTP server. This is done with the <code
                class="command">saslpasswd2</code> command, which takes several parameters. The <code
                class="literal">-u</code> option defines the authentication domain, which must match the <code
                class="literal">smtpd_sasl_local_domain</code> parameter in the Postfix configuration. The <code
                class="literal">-c</code> option allows creating a user, and <code
                class="literal">-f</code> allows specifying the file to use if the SASL database needs to be stored at a different location than the default (<code
                class="filename">/etc/sasldb2</code>).
			</div><pre
              class="screen scale">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>saslpasswd2 -u `postconf -h myhostname` -f /var/spool/postfix/etc/sasldb2 -c jean</code></strong>
<code
                class="computeroutput">[... ketikkan kata sandi jean dua kali ...]</code></pre><div
              class="para">
				Note that the SASL database was created in Postfix's directory. In order to ensure consistency, we also turn <code
                class="filename">/etc/sasldb2</code> into a symbolic link pointing at the database used by Postfix, with the <code
                class="command">ln -sf /var/spool/postfix/etc/sasldb2 /etc/sasldb2</code> command.
			</div><div
              class="para">
				Now we need to configure Postfix to use SASL. First the <code
                class="literal">postfix</code> user needs to be added to the <code
                class="literal">sasl</code> group, so that it can access the SASL account database. A few new parameters are also needed to enable SASL, and the <code
                class="literal">smtpd_recipient_restrictions</code> parameter needs to be configured to allow SASL-authenticated clients to send emails freely.
			</div><div
              class="example"><a
                xmlns=""
                id="id-1.14.4.13.7"></a><p
                class="title"><strong>Contoh 11.15. Memfungsikan SASL di <code
                    class="filename">/etc/postfix/main.cf</code></strong></p><div
                class="example-contents"><pre
                  class="programlisting">
# Memfungsikan otentikasi SASL
smtpd_sasl_auth_enable = yes
# Define the SASL authentication domain to use
smtpd_sasl_local_domain = $myhostname
[...]
# Menambahkan permit_sasl_authenticated before reject_unauth_destination
# mengizinkan merelay surel yang dikirim oleh pengguna SASL-authenticated
smtpd_recipient_restrictions = permit_mynetworks,
    permit_sasl_authenticated,
    reject_unauth_destination,
[...]</pre></div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>EKSTRA</em></span> Klien SMTP terotentikasi</strong></p></div></div></div><div
                class="para">
				Most email clients are able to authenticate to an SMTP server before sending outgoing messages, and using that feature is a simple matter of configuring the appropriate parameters. If the client in use does not provide that feature, the workaround is to use a local Postfix server and configure it to relay email via the remote SMTP server. In this case, the local Postfix itself will be the client that authenticates with SASL. Here are the required parameters:
			</div><pre
                class="programlisting">
smtp_sasl_auth_enable = yes
smtp_sasl_password_maps = hash:/etc/postfix/sasl_passwd
relay_host = [mail.falcot.com]</pre><div
                class="para">
				The <code
                  class="filename">/etc/postfix/sasl_passwd</code> file needs to contain the username and password to use for authenticating on the <code
                  class="literal">mail.falcot.com</code> server. Here is an example:
			</div><pre
                class="programlisting">
[mail.falcot.com]   joe:LyinIsji</pre><div
                class="para">
				As for all Postfix maps, this file must be turned into <code
                  class="filename">/etc/postfix/sasl_passwd.db</code> with the <code
                  class="command">postmap</code> command.
			</div></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.network-diagnosis-tools.html"><strong>Sebelumnya</strong>10.8. Alat Diagnosis Jaringan</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Induk</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Depan</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.http-web-server.html"><strong>Lanjut</strong>11.2. Server Web (HTTP)</a></li></ul></body></html>
