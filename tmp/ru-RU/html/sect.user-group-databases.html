<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">8.4. Базы данных пользователей и групп</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-ru-RU-1.0-1" /><meta
        name="keywords"
        content="Конфигурация, Локализация, Локали, Сеть, Разрешение имён, Пользователи, Группы, Аккаунты, Интерпретатор командной строки, Оболочка, Печать, Загрузчик, Компиляция ядра" /><link
        rel="home"
        href="index.html"
        title="Настольная книга администратора Debian" /><link
        rel="up"
        href="basic-configuration.html"
        title="Глава 8. Базовая конфигурация: Сеть, Аккаунты, Печать..." /><link
        rel="prev"
        href="sect.hostname-name-service.html"
        title="8.3. Присваивание Имени Компьютеру (Hostname) и Настройка Службы Имен" /><link
        rel="next"
        href="sect.creating-accounts.html"
        title="8.5. Создание Учетных Записей" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/ru-RU/stable/sect.user-group-databases.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.hostname-name-service.html"><strong>Пред.</strong></a></li><li
          class="home">Настольная книга администратора Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.creating-accounts.html"><strong>След.</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.user-group-databases"></a>8.4. Базы данных пользователей и групп</h2></div></div></div><a
          id="id-1.11.8.2"
          class="indexterm"></a><a
          id="id-1.11.8.3"
          class="indexterm"></a><a
          id="id-1.11.8.4"
          class="indexterm"></a><a
          id="id-1.11.8.5"
          class="indexterm"></a><div
          class="para">
			Список пользователей обычно хранится в файле <code
            class="filename">/etc/passwd</code>, а пароли в зашифрованном виде хранятся в файле <code
            class="filename">/etc/shadow</code>. Оба этих файла являются текстовыми, в относительно простом формате, который может быть прочитан и изменен с помощью текстового редактора. Каждому пользователю, упомянутому там, отводится для описания одна строка, включающая в себя несколько полей, разделенных двоеточием (“<code
            class="literal">:</code>”).
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>ЗАМЕТКА</em></span> Редактирование системных файлов</strong></p></div></div></div><div
            class="para">
			Все системные файлы, упоминаемые в этой главе, являются текстовыми и могут быть отредактированы с помощью текстового редактора. Так как эти файлы очень важны для функциональности ядра системы, хорошим решением будет принять дополнительные меры предосторожности до начала их редактирования. Во-первых, всегда делайте копию (этих файлов) или резервную копию файловой системы перед открытием или внесением изменений в них. Во вторых, на серверах и машинах, где более чем один человек может потенциально иметь доступ к одинаковым файлам в одно и то же время, необходимо предпринять дополнительные меры для предотвращения повреждения файлов.
		</div><div
            class="para">
			Для редактирования важнейших файлов системы достаточно использовать команды <code
              class="command">vipw</code> - внести изменения в файл <code
              class="filename">/etc/passwd</code>, или <code
              class="command">vigr</code> - для редактирования файла <code
              class="filename">/etc/group</code>. Эти команды блокируют файл и предлагают выбрать текстовый редактор, ранее по умолчанию была программа (<code
              class="command">vi</code> (а в Debian 9.2 программа "vipw" предлагает на выбор 4 программы для редактирования - nano, emacs24, mcedit, vim.tiny), кроме случаев, когда переменная окружения <code
              class="varname">EDITOR</code> была изменена). Параметр <code
              class="literal">-s</code> в этих командах позволит редактировать соответствующий файл <span
              class="foreignphrase"><em
                class="foreignphrase">shadow</em></span>.
		</div></div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>К ОСНОВАМ</em></span> Шифрование, односторонняя функция</strong></p></div></div></div><a
            id="id-1.11.8.8.2"
            class="indexterm"></a><div
            class="para">
			Команда <code
              class="command">crypt</code> - это односторонняя функция, которая преобразует строку (<code
              class="varname">A</code>) в другую строку (<code
              class="varname">B</code>) таким образом, что <code
              class="varname">A</code> нельзя извлечь из <code
              class="varname">B</code>. Единственный путь, чтобы идентифицировать <code
              class="varname">A</code> - это тестировать все возможные варианты, проверив каждое из них - определяя, будет ли при преобразовании через функцию создано <code
              class="varname">B</code> или нет. Программа использует до 8 символов на входе (строка <code
              class="varname">A</code>) и производит строку из 13-ти, годную для печати, ASCII символы (строка <code
              class="varname">B</code>).
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-passwd"></a>8.4.1. Список пользователей: <code
                    class="filename">/etc/passwd</code></h3></div></div></div><div
            class="para">
				Здесь можно увидеть список полей, что используются в файле <code
              class="filename">/etc/passwd</code>:
			</div><a
            id="id-1.11.8.9.3"
            class="indexterm"></a><a
            id="id-1.11.8.9.4"
            class="indexterm"></a><a
            id="id-1.11.8.9.5"
            class="indexterm"></a><a
            id="id-1.11.8.9.6"
            class="indexterm"></a><a
            id="id-1.11.8.9.7"
            class="indexterm"></a><a
            id="id-1.11.8.9.8"
            class="indexterm"></a><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						login - имя для входа, например <code
                    class="literal">rhertzog</code>;
					</div></li><li
                class="listitem"><div
                  class="para">
						password - пароль: пароль зашифрован односторонней функцией (<code
                    class="command">crypt</code>), опираясь на <code
                    class="literal">DES</code>, <code
                    class="literal">MD5</code>, <code
                    class="literal">SHA-256</code> или <code
                    class="literal">SHA-512</code>. Специальное обозначение “<code
                    class="literal">x</code>” показывает, что зашифрованный пароль сохранён в файле <code
                    class="filename">/etc/shadow</code>;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">uid</code>: уникальный номер, идентифицирующий каждого пользователя (например номер 1002 присвоен пользователю rhertzog);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">gid</code>: уникальный номер главной группы данного пользователя (Debian создает особенную группу для каждого пользователя по умолчанию, например, номер 1002 присвоен группе rhertzog, которая является главной для пользователя rhertzog);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">GECOS</code>: данные этого заголовка обычно содержат полное имя пользователя (в данном примере - это GECOS, или фамилия-имя-отчество, через запятую);
					</div></li><li
                class="listitem"><div
                  class="para">
						login directory - каталог пользователя (совпадает с именем для входа), предназначенный для того, чтобы пользователь хранил свои персональные файлы (переменная окружения <code
                    class="varname">$HOME</code> обычно указывается здесь);
					</div></li><li
                class="listitem"><div
                  class="para">
						program to execute upon login - первая программа, выполненная сразу после входа пользователя в систему. Обычно это командный интерпретатор (shell), например "/bin/bash", дающий пользователю возможность управления (в объеме его прав). Если указать специальное значение <code
                    class="command">/bin/false</code> (которое ничего не делает и возвращает контроль системе немедленно), то пользователь не сможет войти в систему.
					</div></li></ul></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>К ОСНОВАМ</em></span> Группа в Unix-системе</strong></p></div></div></div><a
              id="id-1.11.8.9.10.2"
              class="indexterm"></a><div
              class="para">
				Группа в Unix-системе включает в себя несколько пользователей, которые могут легко обмениваться между собою файлами. Эта группа пользуется системой комплексных разрешений прав доступа (получая выгоду от одинаковых прав). Вы можете также запретить использование определенных программ для конкретных групп.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-shadow"></a>8.4.2. Скрытый и Зашифрованный Файл Паролей: <code
                    class="filename">/etc/shadow</code></h3></div></div></div><a
            id="id-1.11.8.10.2"
            class="indexterm"></a><a
            id="id-1.11.8.10.3"
            class="indexterm"></a><div
            class="para">
				Файл <code
              class="filename">/etc/shadow</code> содержит следующие поля:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						login - имя входа пользователя в систему;
					</div></li><li
                class="listitem"><div
                  class="para">
						зашифрованный пароль;
					</div></li><li
                class="listitem"><div
                  class="para">
						несколько полей относятся к окончанию срока действия пароля.
					</div></li></ul></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ДОКУМЕНТАЦИЯ</em></span> Формат файлов <code
                        class="filename">/etc/passwd</code>, <code
                        class="filename">/etc/shadow</code> and <code
                        class="filename">/etc/group</code></strong></p></div></div></div><div
              class="para">
				Документацию по этим программах расположена в следующих страницах руководства (man) : <span
                class="citerefentry"><span
                  class="refentrytitle">passwd</span>(5)</span>, <span
                class="citerefentry"><span
                  class="refentrytitle">shadow</span>(5)</span>, и <span
                class="citerefentry"><span
                  class="refentrytitle">group</span>(5)</span>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>БЕЗОПАСНОСТЬ</em></span> Файл <code
                        class="filename">/etc/shadow</code> относится к безопасности системы</strong></p></div></div></div><div
              class="para">
				Файл <code
                class="filename">/etc/shadow</code>, непохож на своего алтер-эго (_лат. "второе я", т.е. дубликат) <code
                class="filename">/etc/passwd</code>. Он не может быть прочитан обычными пользователями. Если в системе не применяется защита паролей через shadow, то любой сможет прочитать пароль, сохраненный в файле <code
                class="filename">/etc/passwd</code>. Взломщик может попытаться “расколоть” (или вскрыть) его одним из нескольких способов “грубой силы”, когда берут последовательность символов, которые надо опознать и, с помощью специальных программ, делают простой перебор часто используемых комбинаций символов. Этот тип нападения на систему называется "атака по словарю" — и сейчас его уже невозможно применять на системах, которые используют <code
                class="filename">/etc/shadow</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.account-modification"></a>8.4.3. Изменение существующей учетной записи или пароля</h3></div></div></div><a
            id="id-1.11.8.11.2"
            class="indexterm"></a><a
            id="id-1.11.8.11.3"
            class="indexterm"></a><a
            id="id-1.11.8.11.4"
            class="indexterm"></a><a
            id="id-1.11.8.11.5"
            class="indexterm"></a><a
            id="id-1.11.8.11.6"
            class="indexterm"></a><div
            class="para">
				Следующие команды позволяют изменять информацию, размещенную в конкретных полях базы данных пользователей. Команда <code
              class="command">passwd</code> позволяет обычному пользователю изменять их пароль, в этом случае сразу происходит изменение и обновление файла <code
              class="filename">/etc/shadow</code>. Команда <code
              class="command">chfn</code> (CHange Full Name - Изменить Полное Имя), зарезервирована для администратора (super-user, root), изменяет поле <code
              class="literal">GECOS</code>. Команда <code
              class="command">chsh</code> (CHange SHell - Изменить командный интерпретатор) позволяет пользователю изменить свой первоначальный командный интерпретатор во время входа в систему, однако доступный выбор будет ограничен только теми, что расположены в файле <code
              class="filename">/etc/shells</code>. На администратора это ограничение не распространяется и он может установить себе любую программу, по своему выбору.
			</div><div
            class="para">
				И наконец, команда <code
              class="command">chage</code> (CHange AGE - Изменить возраст) позволит администратору изменить пароль с истекающим сроком действия (Параметр <code
              class="literal">-l <em
                class="replaceable">user</em></code> покажет настоящие значения). Вы можете также принудительно завершить срок действия пароля для пользователя используя команду <code
              class="command">passwd -e <em
                class="replaceable">user</em></code>. В этом случае при следующем входе пользователя в систему ему будет предложено заменить существующий пароль (принудительно, без всяких "хочу" или "не хочу").
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.disabling-account"></a>8.4.4. Отключение учетной записи</h3></div></div></div><a
            id="id-1.11.8.12.2"
            class="indexterm"></a><a
            id="id-1.11.8.12.3"
            class="indexterm"></a><div
            class="para">
				Вам может понадобиться “отключить учетную запись” (заблокировать пользователя), в качестве дисциплинарной меры, для целей расследования, или просто в случае длительного или окончательного отсутствия пользователя. Отключённая учетная запись означает, что пользователь не может войти или получить доступ к машине. Учетная запись остается неизменной на машине и никаких файлов или данных не удаляется, запись просто становится недоступна. Для этого надо применить команду <code
              class="command">passwd -l <em
                class="replaceable">user</em></code> (блокировать). Снять блокировку учетной записи можно похожим способом, с параметром <code
              class="literal">-u</code> (разблокировать).
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.intro-nss"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>УГЛУБЛЯЕМСЯ</em></span> NSS и база данных системы</strong></p></div></div></div><a
              id="id-1.11.8.12.5.2"
              class="indexterm"></a><a
              id="id-1.11.8.12.5.3"
              class="indexterm"></a><div
              class="para">
				Взамен использования обычных файлов, управляющих списком пользователей и групп, вы можете использовать другие типы базы данных, такие как LDAP или <code
                class="command">db</code>, используя соответствующий модуль NSS (Диспетчер службы имен). Используемые модули можно просмотреть в файле <code
                class="filename">/etc/nsswitch.conf</code>, в местах расположения <code
                class="literal">passwd</code>, <code
                class="literal">shadow</code> и <code
                class="literal">group</code>. Смотри <a
                class="xref"
                href="sect.ldap-directory.html#sect.config-nss">Раздел 11.7.3.1, «Configuring NSS»</a> для конкретных примеров использования модулей NSS через LDAP.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-group"></a>8.4.5. Список групп: <code
                    class="filename">/etc/group</code></h3></div></div></div><div
            class="para">
				Группы, существующие в системе, перечислены в файле <code
              class="filename">/etc/group</code>, простая текстовая база данных в формате, похожем на тот, что используется в файле <code
              class="filename">/etc/passwd</code>, со следующими полями:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						имя группы;
					</div></li><li
                class="listitem"><div
                  class="para">
						пароль (необязательно): это поле используется в случаях, если необходимо присоединить кого-то к группе, при этом, не давать ему те же права, как у других членов этой группы (с командами <code
                    class="command">newgrp</code> или <code
                    class="command">sg</code>, смотри вставку <a
                    class="xref"
                    href="sect.user-group-databases.html#sidebar.working-with-several-groups"><span
                      class="emphasis"><em>К ОСНОВАМ</em></span> Работа с несколькими группами</a>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">gid</code>: уникальный идентификационный номер группы;
					</div></li><li
                class="listitem"><div
                  class="para">
						список участников (данной группы): перечень имен пользователей, которые являются членами указанной группы, разделенные запятыми.
					</div></li></ul></div><div
            class="para">
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.working-with-several-groups"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>К ОСНОВАМ</em></span> Работа с несколькими группами</strong></p></div></div></div><a
              id="id-1.11.8.13.5.2"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.3"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.4"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.5"
              class="indexterm"></a><div
              class="para">
				Каждый пользователь может быть включён сразу в несколько групп, Одной их них является “главная группа”. Она появляется в момент создания нового пользователя в системе и в дальнейшем считается для него "группой по умолчанию" (главной группой). Каждому файлу, создаваемому пользователю, тут же присваивается та группа, которая является главной для него. Однако не всегда это желательно, например, когда пользователь вынужден работать в каталоге, который является разделяемым с пользователями других групп, отличной от его главной группы. В этом случае, пользователь вынужден временно изменить свою главную группу используя одну из следующих команд: <code
                class="command">newgrp</code>, когда запускается новый командный интерпретатор, или <code
                class="command">sg</code>, которая просто выполняется с использованием предоставленной ей альтернативной группы. Эти команды также позволят пользователю присоединиться к группе, к которой они не принадлежат. Если группа защищена паролем, необходимо будет ввести пароль до того, как команда будет выполнена.
			</div><div
              class="para">
				Другой вариант - пользователь может установить бит <code
                class="literal">setgid</code> на каталог, который при вызове файла, созданного в том каталоге автоматически присвоит ему корректную группу. Для больших деталей, смотри вкладку <a
                class="xref"
                href="sect.rights-management.html#sidebar.setgid-dir"><span
                  class="emphasis"><em>SECURITY</em></span> <code
                  class="literal">setgid</code> directory and <span
                  class="emphasis"><em>sticky bit</em></span></a>.
			</div><div
              class="para">
				Команда <code
                class="command">id</code> отобразит настоящее состояние пользователя, с персональным идентификатором (<code
                class="varname">uid</code> variable), действующей главной группой (<code
                class="varname">gid</code> variable), и перечень групп, в которые он включен (<code
                class="varname">groups</code> variable).
			</div></div><a
            id="id-1.11.8.13.6"
            class="indexterm"></a><a
            id="id-1.11.8.13.7"
            class="indexterm"></a><div
            class="para">
				The <code
              class="command">addgroup</code> and <code
              class="command">delgroup</code> commands add or delete a group, respectively. The <code
              class="command">groupmod</code> command modifies a group's information (its <code
              class="literal">gid</code> or identifier). The command <code
              class="command">gpasswd <em
                class="replaceable">group</em></code> changes the password for the group, while the <code
              class="command">gpasswd -r <em
                class="replaceable">group</em></code> command deletes it.
			</div><a
            id="id-1.11.8.13.9"
            class="indexterm"></a><a
            id="id-1.11.8.13.10"
            class="indexterm"></a><a
            id="id-1.11.8.13.11"
            class="indexterm"></a><a
            id="id-1.11.8.13.12"
            class="indexterm"></a><a
            id="id-1.11.8.13.13"
            class="indexterm"></a><a
            id="id-1.11.8.13.14"
            class="indexterm"></a><a
            id="id-1.11.8.13.15"
            class="indexterm"></a><a
            id="id-1.11.8.13.16"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>СОВЕТ</em></span> Команда <code
                        class="command">getent</code></strong></p></div></div></div><a
              id="id-1.11.8.13.17.2"
              class="indexterm"></a><div
              class="para">
				Команда <code
                class="command">getent</code> (получить записи) проверяет системные базы данных стандартным способом, используя соответствующие библиотечные функции, которые в свою очередь вызывают модули, сконфигурированне в файле <code
                class="filename">/etc/nsswitch.conf</code>. Команда принимает один или два аргумента: имя базы данных для проверки, и ключ, по которому будет выполнен поиск. Таким образом, команда <code
                class="command">getent passwd rhertzog</code> предоставит информацию из базы данных, касающуюся пользователя <code
                class="literal">rhertzog</code>.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.hostname-name-service.html"><strong>Пред.</strong>8.3. Присваивание Имени Компьютеру (Hostname) и Н...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Наверх</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Начало</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.creating-accounts.html"><strong>След.</strong>8.5. Создание Учетных Записей</a></li></ul></body></html>
