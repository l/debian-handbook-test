<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">10.8. ابزار بررسی شبکه</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-fa-IR-1.0-1" /><meta
        name="keywords"
        content="شبکه, Gateway, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link
        rel="home"
        href="index.html"
        title="راهنمای جامع دبیان" /><link
        rel="up"
        href="network-infrastructure.html"
        title="فصل 10. زیرساخت شبکه" /><link
        rel="prev"
        href="sect.dhcp.html"
        title="10.7. DHCP" /><link
        rel="next"
        href="network-services.html"
        title="فصل 11. سرویس‌های شبکه: Postfix، Apache، NFS، Samba، Squid، LDAP، SIP، XMPP، Turn" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/fa-IR/stable/sect.network-diagnosis-tools.html" /></head><body
      dir="rtl"><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.dhcp.html"><strong>قبلی</strong></a></li><li
          class="home">راهنمای جامع دبیان</li><li
          class="next"><a
            accesskey="n"
            href="network-services.html"><strong>بعدی</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.network-diagnosis-tools"></a>10.8. ابزار بررسی شبکه</h2></div></div></div><div
          class="para">
			زمانی که یک برنامه تحت شبکه درست کار نمی‌کند، بسیار مهم است که از شیوه فعالیت آن اطلاع داشته باشیم. حتی در زمانی که همه چیزی بخوبی کار می‌کند، بررسی شبکه ما را از عملکرد صحیح آن با خبر می‌سازد. چندین ابزار مختلف در این زمینه وجود دارد که هر کدام در سطح جداگانه‌ای فعالیت می‌کند.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.netstat"></a>10.8.1. بررسی محلی: <code
                    class="command">netstat</code></h3></div></div></div><a
            id="id-1.13.11.3.2"
            class="indexterm"></a><div
            class="para">
				بیایید ابتدا دستور <code
              class="command">netstat</code> را بررسی کنیم (در بسته <span
              class="pkg pkg">net-tools</span>)؛ این ابزار یک خلاصه وضعیت لحظه‌ای از فعالیت شبکه نمایش می‌دهد. زمانی که بدون آرگومان فراخوانی شود، این دستور فهرستی از تمام ارتباطات باز را نمایش می‌دهد؛ این فهرست می‌تواند بسیار طولانی باشد چرا که شامل بسیاری از سوکت‌های یونیکس (مورد استفاده فرآیندهای پس‌زمینه) است که اصلا کاری با شبکه ندارند (برای نمونه، ارتباطات <code
              class="literal">dbus</code> یا ترافیک <code
              class="literal">X11</code> ارتباطات بین فایل‌سیستم‌های مجازی و محیط گرافیکی هستند).
			</div><div
            class="para">
				فراخوانی‌های متداول شامل گزینه‌هایی است که عملکرد <code
              class="command">netstat</code> را تغییر می‌دهند. متداول‌ترین گزینه‌ها عبارتند از:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">-t</code>، که با فیلترکردن خروجی تنها ارتباطات TCP را شامل می‌شود؛
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">-u</code>، که به شیوه‌ای مشابه برای ارتباطات UDP استفاده می‌شود؛ این گزینه‌ها با یکدیکر سازگار نبوده و استفاده یکی از آن‌ها کافی است تا ارتباطات دامنه یونیکس نمایش داده نشوند؛
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">-a</code>، برای فهرست کردن سوکت‌های منتظر (آن‌هایی که برای ارتباط دریافتی انتظار می‌کشند)؛
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">-n</code>، برای نمایش نتایج به صورت عددی: نشانی‌های IP (بدون دخالت DNS)، شماره‌های درگاه (بدون نام مستعار تعریف شده در <code
                    class="filename">/etc/services</code>) و شناسه‌های کاربری (بدون نام کاربری)؛
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">-p</code>، برای فهرست‌کردن فرآیندهای درگیر؛ این گزینه زمانی مفید است که <code
                    class="command">netstat</code> به عنوان root اجرا شود، چرا که کاربران عادی تنها می‌توانند فرآیندهای خود را مشاهده کنند؛
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">-c</code>، برای تازه‌سازی فهرست خروجی به صورت مداوم.
					</div></li></ul></div><div
            class="para">
				سایر گزینه‌ها که در صفحه راهنمای <span
              class="citerefentry"><span
                class="refentrytitle">netstat</span>(8)</span> مستندسازی شده‌اند، کنترل بسیار بیشتری را فراهم می‌کنند. در عمل، پنج گزینه اول به اندازه‌ای پرکاربرد هستند که مدیران شبکه و سیستم از عبارت <code
              class="command">netstat -tupan</code> برای اشاره به آن‌ها استفاده می‌کنند. به طور معمول، نتایج قابل مشاهده در یک رایانه معمولی مانند زیر هستند:
			</div><pre
            class="screen scale">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>netstat -tupan</code></strong>
<code
              class="computeroutput">Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name
tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      397/rpcbind     
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      431/sshd        
tcp        0      0 0.0.0.0:36568           0.0.0.0:*               LISTEN      407/rpc.statd   
tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      762/exim4       
tcp        0    272 192.168.1.242:22        192.168.1.129:44452     ESTABLISHED 1172/sshd: roland [
tcp6       0      0 :::111                  :::*                    LISTEN      397/rpcbind     
tcp6       0      0 :::22                   :::*                    LISTEN      431/sshd        
tcp6       0      0 ::1:25                  :::*                    LISTEN      762/exim4       
tcp6       0      0 :::35210                :::*                    LISTEN      407/rpc.statd   
udp        0      0 0.0.0.0:39376           0.0.0.0:*                           916/dhclient    
udp        0      0 0.0.0.0:996             0.0.0.0:*                           397/rpcbind     
udp        0      0 127.0.0.1:1007          0.0.0.0:*                           407/rpc.statd   
udp        0      0 0.0.0.0:68              0.0.0.0:*                           916/dhclient    
udp        0      0 0.0.0.0:48720           0.0.0.0:*                           451/avahi-daemon: r
udp        0      0 0.0.0.0:111             0.0.0.0:*                           397/rpcbind     
udp        0      0 192.168.1.242:123       0.0.0.0:*                           539/ntpd        
udp        0      0 127.0.0.1:123           0.0.0.0:*                           539/ntpd        
udp        0      0 0.0.0.0:123             0.0.0.0:*                           539/ntpd        
udp        0      0 0.0.0.0:5353            0.0.0.0:*                           451/avahi-daemon: r
udp        0      0 0.0.0.0:39172           0.0.0.0:*                           407/rpc.statd   
udp6       0      0 :::996                  :::*                                397/rpcbind     
udp6       0      0 :::34277                :::*                                407/rpc.statd   
udp6       0      0 :::54852                :::*                                916/dhclient    
udp6       0      0 :::111                  :::*                                397/rpcbind     
udp6       0      0 :::38007                :::*                                451/avahi-daemon: r
udp6       0      0 fe80::5054:ff:fe99::123 :::*                                539/ntpd        
udp6       0      0 2001:bc8:3a7e:210:a:123 :::*                                539/ntpd        
udp6       0      0 2001:bc8:3a7e:210:5:123 :::*                                539/ntpd        
udp6       0      0 ::1:123                 :::*                                539/ntpd        
udp6       0      0 :::123                  :::*                                539/ntpd        
udp6       0      0 :::5353                 :::*                                451/avahi-daemon: r
</code></pre><div
            class="para">
				همانطور که انتظار می‌رفت، این فهرست شامل ارتباطات جاری سیستم است از جمله دو ارتباط SSH و برنامه‌هایی که منتظر دریافت ارتباطات هستند (که به عنوان <code
              class="literal">LISTEN</code> آمده‌اند)، مانند سرور ایمیل Exim4 که به درگاه ۲۵ گوش می‌کند.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.nmap"></a>10.8.2. بررسی راه‌دور: <code
                    class="command">nmap</code></h3></div></div></div><a
            id="id-1.13.11.4.2"
            class="indexterm"></a><div
            class="para">
				<code
              class="command">nmap</code> (در بسته‌ای با همین نام) به نوعی معادل راه‌دور <code
              class="command">netstat</code> به حساب می‌آید. می‌تواند به پویش مجموعه‌ای از درگاه‌های “شناخته-شده” برای یک یا چند سرور راه‌دور بپردازد و درگاه‌هایی که برنامه‌های مختلف به آن‌ها پاسخ می‌دهند را نمایش می‌دهد. علاوه بر این، <code
              class="command">nmap</code> می‌تواند برخی از این برنامه‌ها را نیز تشخیص دهد، گاهی اوقات حتی نسخه‌های آنان را. از آنجا که این ابزار به صورت راه‌دور کار می‌کند، نمی‌تواند اطلاعات مربوط به فرآیندها یا کاربران را نمایش دهد؛ با این حال می‌تواند به صورت همزمان روی چندین هدف اجرا شود.
			</div><div
            class="para">
				یک فراخوانی معمول <code
              class="command">nmap</code> تنها از گزینه <code
              class="literal">-A</code> استفاده می‌کند (به منظور یافتن نسخه نرم‌افزار سرور که روی آن اجرا می‌شود) به همراه یک یا چند نشانی IP یا نام‌های DNS رایانه‌هایی که قصد پویش آن‌ها را دارد. بسیاری گزینه‌های مختلف وجود دارد که به کنترل بیشتر عملکرد <code
              class="command">nmap</code> کمک می‌کنند؛ لطفا به مستندات صفحه راهنمای <span
              class="citerefentry"><span
                class="refentrytitle">nmap</span>(1)</span> مراجعه کنید.
			</div><pre
            class="screen scale"
            width="80">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>nmap mirtuel</code></strong>
<code
              class="computeroutput">
Starting Nmap 6.47 ( http://nmap.org ) at 2015-03-09 16:46 CET
Nmap scan report for mirtuel (192.168.1.242)
Host is up (0.000013s latency).
rDNS record for 192.168.1.242: mirtuel.internal.placard.fr.eu.org
Not shown: 998 closed ports
PORT    STATE SERVICE
22/tcp  open  ssh
111/tcp open  rpcbind

Nmap done: 1 IP address (1 host up) scanned in 2.41 seconds
# </code><strong
              class="userinput"><code>nmap -A localhost</code></strong>
<code
              class="computeroutput">
Starting Nmap 6.47 ( http://nmap.org ) at 2015-03-09 16:46 CET
Nmap scan report for localhost (127.0.0.1)
Host is up (0.000013s latency).
Other addresses for localhost (not scanned): 127.0.0.1
Not shown: 997 closed ports
PORT    STATE SERVICE VERSION
22/tcp  open  ssh     OpenSSH 6.7p1 Debian 3 (protocol 2.0)
|_ssh-hostkey: ERROR: Script execution failed (use -d to debug)
25/tcp  open  smtp    Exim smtpd 4.84
| smtp-commands: mirtuel Hello localhost [127.0.0.1], SIZE 52428800, 8BITMIME, PIPELINING, HELP, 
|_ Commands supported: AUTH HELO EHLO MAIL RCPT DATA NOOP QUIT RSET HELP 
111/tcp open  rpcbind 2-4 (RPC #100000)
| rpcinfo: 
|   program version   port/proto  service
|   100000  2,3,4        111/tcp  rpcbind
|   100000  2,3,4        111/udp  rpcbind
|   100024  1          36568/tcp  status
|_  100024  1          39172/udp  status
Device type: general purpose
Running: Linux 3.X
OS CPE: cpe:/o:linux:linux_kernel:3
OS details: Linux 3.7 - 3.15
Network Distance: 0 hops
Service Info: Host: mirtuel; OS: Linux; CPE: cpe:/o:linux:linux_kernel

OS and Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.54 seconds
</code></pre><div
            class="para">
				همانطور که انتظار می‌رفت، برنامه‌های SSH و Exim4 فهرست شده‌اند. نکته اینکه همه برنامه‌ها به همه نشانی‌های IP گوش فرا نمی‌دهند؛ از آنجا که Exim4 تنها از طریق رابط <code
              class="literal">lo</code> قابل دسترس است، تنها زمانی نمایش می‌یابد که تحلیل <code
              class="literal">localhost</code> صورت بگیرد و نه تحلیل <code
              class="literal">mirtuel</code> (که به رابط <code
              class="literal">eth0</code> در همان رایانه نگاشت شده است).
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.sniffers"></a>10.8.3. اسنیفرها: <code
                    class="command">tcpdump</code> و <code
                    class="command">wireshark</code></h3></div></div></div><div
            class="para">
				بعضی وقت‌ها، نیاز است بدانیم چه چیزی به صورت بسته به بسته از شبکه عبور می‌کند. این موارد شامل یک “تحلیلگر فریم” هستند که به صورت کلی‌تر با نام <span
              class="emphasis"><em>sniffer</em></span> شناخته می‌شوند. چنین ابزاری به مشاهده بسته‌های عبوری از یک رابط شبکه می‌پردازد و آن‌ها را به شیوه‌ای مرتب و خودمانی نمایش می‌دهد.
			</div><a
            id="id-1.13.11.5.3"
            class="indexterm"></a><div
            class="para">
				ابزار قدرتمند در این زمینه <code
              class="command">tcpdump</code> است که به عنوان یک ابزار استاندارد در طیف گسترده‌ای از پلتفرم‌ها موجود است. این ابزار امکان بسیاری از فرآیندهای مرتبط با شبکه را می‌دهد، اما شیوه نمایش این ترافیک کمی عجیب و غریب است. بنابراین به توضیح بیشتر آن نمی‌پردازیم.
			</div><a
            id="id-1.13.11.5.5"
            class="indexterm"></a><div
            class="para">
				یک ابزار جدیدتر، <code
              class="command">wireshark</code> (در بسته <span
              class="pkg pkg">wireshark</span>) به عنوان مرجع تحلیل ترافیک شبکه به دلیل ماژول‌های بسیاری که در فرآیند تحلیل بسته‌ها کمک می‌کنند، تبدیل شده است. بسته‌ها به صورت گرافیکی و به ترتیب قرار گرفتن در لایه‌های مختلف شبکه نمایش داده می‌شوند. این امر به کاربر کمک می‌کند تا به صورت بصری به بررسی بسته‌ها بپردازد. برای نمونه، بسته‌ای که شامل درخواست HTTP است، <code
              class="command">wireshark</code> آن را به صورت جداگانه به همراه اطلاعات مرتبط با هر لایه شبکه نمایش می‌دهد و در نهایت به نمایش خود درخواست HTTP می‌رسد.
			</div><div
            class="figure"><a
              xmlns=""
              id="figure.wireshark"></a><div
              class="figure-contents"><div
                class="mediaobject"><img
                  src="images/wireshark.png"
                  alt="تحلیلگر ترافیک شبکه wireshark" /></div></div><p
              class="title"><strong>
      شكل 10.1. تحلیلگر ترافیک شبکه <code
                  class="command">wireshark</code></strong></p></div><div
            class="para">
				در نمونه ما، بسته‌هایی که از طریق SSH انتقال می‌یابند فیلتر شده‌اند (با استفاده از فیلتر <code
              class="literal">!tcp.port == 22</code>). بسته‌ای که هم اکنون نمایش یافت در لایه HTTP قرار داشت.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>نکته</em></span> <code
                        class="command">wireshark</code> بدون هیچ رابط گرافیکی: <code
                        class="command">tshark</code></strong></p></div></div></div><a
              id="id-1.13.11.5.9.2"
              class="indexterm"></a><div
              class="para">
				که زمانی امکان اجرای محیط گرافیکی نباشد، یا علاقه‌ای به اینکار وجود نداشته باشد، یک نسخه فقط-متنی از <code
                class="command">wireshark</code> به نام <code
                class="command">tshark</code> وجود دارد (در بسته <span
                class="pkg pkg">tshark</span>). اکثر قابلیت‌های دریافت و رمزگشایی بسته‌ها هم‌اکنون وجود دارد، اما عدم وجود رابط گرافیکی کار با برنامه‌ را کمی دشوار می‌سازد (فیلترکردن بسته‌ها پس از اینکه ضبط شدند، ردیابی یک ارتباط مشخص و از این قبیل). به عنوان یک رویکرد اولیه می‌تواند مورد استفاده قرار گیرد. اگر تغییرات بعدی مستلزم وجود رابط گرافیکی بود، بسته‌ها می‌توانند در یک فایل ذخیره شده و آن فایل در <code
                class="command">wireshark</code> گرافیکی رایانه‌ای دیگر اجرا گردد.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.dhcp.html"><strong>قبلی</strong>10.7. DHCP</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>بالا</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>خانه</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="network-services.html"><strong>بعدی</strong>
      فصل 11. سرویس‌های شبکه: Postfix، Apache، N...</a></li></ul></body></html>
