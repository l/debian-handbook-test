<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.4. سرور فایل NFS</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-fa-IR-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="راهنمای جامع دبیان" /><link
        rel="up"
        href="network-services.html"
        title="فصل 11. سرویس‌های شبکه: Postfix، Apache، NFS، Samba، Squid، LDAP، SIP، XMPP، Turn" /><link
        rel="prev"
        href="sect.ftp-file-server.html"
        title="11.3. سرور فایل FTP" /><link
        rel="next"
        href="sect.windows-file-server-with-samba.html"
        title="11.5. راه‌اندازی اشتراک‌های ویندوز با Samba" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/fa-IR/stable/sect.nfs-file-server.html" /></head><body
      dir="rtl"><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.ftp-file-server.html"><strong>قبلی</strong></a></li><li
          class="home">راهنمای جامع دبیان</li><li
          class="next"><a
            accesskey="n"
            href="sect.windows-file-server-with-samba.html"><strong>بعدی</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.nfs-file-server"></a>11.4. سرور فایل NFS</h2></div></div></div><div
          class="para">
			NFS یا <span
            class="emphasis"><em>Network File System</em></span> پروتکلی است که اجازه دسترسی راه‌دور به فایل‌سیستم را از طریق شبکه می‌دهد. تمام سیستم‌های یونیکس می‌توانند با این پروتکل کار کنند؛ زمانی که سیستم‌های ویندوز در میان باشند، باید از Samba استفاده شود.
		</div><a
          id="id-1.14.7.3"
          class="indexterm"></a><a
          id="id-1.14.7.4"
          class="indexterm"></a><a
          id="id-1.14.7.5"
          class="indexterm"></a><a
          id="id-1.14.7.6"
          class="indexterm"></a><a
          id="id-1.14.7.7"
          class="indexterm"></a><div
          class="para">
			NFS ابزار بسیار مفیدی است، اما در گذر زمان از محدودیت‌های بسیاری رنج می‌برد، که اکثر آن‌ها با نسخه ۴ پروتکل برطرف شده‌اند. نقطه ضعف آن در پیکربندی آخرین نسخه است چرا که برای استفاده از ویژگی‌های پایه در امنیت مانند احرازهویت و رمزنگاری باید از ابزار Kerberos به این منظور استفاده شود و بدون استفاده از آن‌ها نباید این پروتکل را خارج از شبکه محلی استفاده کرد چرا که داده به صورت رمزنگاری نشده منتقل می‌شود (یک <span
            class="emphasis"><em>sniffer</em></span> می‌تواند داده را رهگیری کند) و دسترسی‌ها نیز مبتنی بر نشانی IP درخواست‌کننده صادر می‌شود (که می‌توانند مورد سوءاستفاده قرار بگیرند).
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>مستندات</em></span> راهنمای استفاده NFS</strong></p></div></div></div><div
            class="para">
			مستندات خوبی که به شیوه پیکربندی NFSv4 اشاره می‌کند کم پیدا می‌شود. در اینجا چند پیوند مرتبط با مستندات مرتبط با آن را به عنوان نقطه شروعی برای پیکربندی ذکر می‌کنیم. <div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="https://help.ubuntu.com/community/NFSv4Howto">https://help.ubuntu.com/community/NFSv4Howto</a></div> <div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="http://wiki.linux-nfs.org/wiki/index.php/Nfsv4_configuration">http://wiki.linux-nfs.org/wiki/index.php/Nfsv4_configuration</a></div>
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.7.10"></a>11.4.1. ایمن‌سازی NFS</h3></div></div></div><a
            id="id-1.14.7.10.2"
            class="indexterm"></a><div
            class="para">
				اگر از ویژگی‌های امنیتی مبتنی بر Kerberos استفاده نمی‌کنید، این نکته حیاتی است که تنها رایانه‌هایی که اجازه استفاده از NFS را دارند بتوانند به سرورهای درخواست RPC متصل شوند، چرا که پروتکل اولیه به داده دریافتی از شبکه اعتماد می‌کند. فایروال نیز باید <span
              class="emphasis"><em>IP spoofing</em></span> را مسدود سازد تا رایانه‌ای خارج از شبکه نتواند خود را بجای یکی از اعضای شبکه معرفی کند، همچنین دسترسی به برخی درگاه‌ها نیز باید فقط به رایانه‌های قابل دسترس در NFS محدود شود.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>بازگشت به مقدمات</em></span> RPC</strong></p></div></div></div><div
              class="para">
				RPC یا <span
                class="emphasis"><em>Remote Procedure Call</em></span> یک استاندارد یونیکس برای سرویس‌های راه‌دور است. NFS یکی از این سرویس‌ها است.
			</div><a
              id="id-1.14.7.10.4.3"
              class="indexterm"></a><a
              id="id-1.14.7.10.4.4"
              class="indexterm"></a><div
              class="para">
				سرویس‌های RPC به یک دایرکتوری بنام <span
                class="emphasis"><em>portmapper</em></span> متصل می‌شوند. برنامه‌ای که قصد پرس و جوی NFS را دارد ابتدا با <span
                class="emphasis"><em>portmapper</em></span> تماس می‌گیرد (درگاه ۱۱۱ خواه TCP یا UDP) و به دنبال سرور NFS می‌گردد؛ پاسخ معمولا شامل درگاه ۲۰۴۹ (پیشفرض برای NFS) است. همه سرویس‌های RPC الزاما از یک درگاه ثابت استفاده نمی‌کنند.
			</div></div><div
            class="para">
				نسخه‌های قدیمی‌تر پروتکل به سرویس‌های دیگری از RPC نیاز دارند که از درگاه‌های انتساب پویا استفاده می‌کنند. خوشبختانه، با نسخه ۴ از NFS، تنها درگاه‌های ۲۰۴۹ (برای NFS) و ۱۱۱ (برای portmapper) مورد نیاز هستند که به سادگی توسط فایروال کنترل می‌شوند.
			</div><a
            id="id-1.14.7.10.6"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.7.11"></a>11.4.2. سرور NFS</h3></div></div></div><div
            class="para">
				سرور NFS بخشی از کرنل لینوکس است؛ در کرنل‌های فراهم شده توسط دبیان به صورت یک افزونه کرنل درآمده است. اگر سرور NFS در زمان راه‌اندازی به صورت خودکار باید اجرا گردد، بسته <span
              class="pkg pkg">nfs-kernel-server</span> باید نصب گردد؛ این بسته شامل اسکریپت‌های راه‌اندازی اولیه است.
			</div><div
            class="para">
				فایل پیکربندی سرور NFS، <code
              class="filename">/etc/exports</code>، دایرکتوری‌های قابل دسترس در شبکه را فهرست می‌کند (<span
              class="emphasis"><em>exported</em></span>). برای هر اشتراک NFS، تنها فهرست مشخص شده از رایانه‌ها قادر به دسترسی هستند. کنترل دسترسی بهتری با استفاده از گزینه‌های پیکربندی آن ممکن است. شیوه نگارش این فایل بسیار ساده است:
			</div><a
            id="id-1.14.7.11.4"
            class="indexterm"></a><a
            id="id-1.14.7.11.5"
            class="indexterm"></a><pre
            class="programlisting">
/directory/to/share machine1(option1,option2,...) machine2(...) ...</pre><div
            class="para">
				نکته اینکه در NFSv4، تمام دایرکتوری‌های صادر شده باید بخشی از یک ساختار سلسله‌مراتبی باشند که ریشه آن باید توسط گزینه‌های <code
              class="literal">fsid=0</code> و <code
              class="literal">fsid=root</code> صادر و شناسایی شده باشد.
			</div><div
            class="para">
				هر رایانه می‌تواند با استفاده از نام DNS یا نشانی IP شناسایی شود. مجموعه‌ای از رایانه‌ها نیز می‌توانند یا با شیوه نگارش <code
              class="literal">*.falcot.com</code> یا با محدوده نشانی IP به صورت <code
              class="literal">192.168.0.0/255.255.255.0</code> یا <code
              class="literal">192.168.0.0/24</code> شناسایی شوند.
			</div><div
            class="para">
				دایرکتوری‌های به صورت فقط-خواندنی در حالت پیشفرض قرار می‌گیرند (یا با گزینه <code
              class="literal">ro</code>). گزینه <code
              class="literal">rw</code> اجازه دسترسی خواندنی-نوشتنی را می‌دهد. برنامه‌های NFS معمولا از درگاه مختص به root استفاده می‌کنند (به عبارت دیگر، زیر ۱۰۲۴)؛ این محدودیت با استفاده از گزینه <code
              class="literal">insecure</code> می‌تواند برداشته شود (گزینه <code
              class="literal">secure</code> به صورت ضمنی درج می‌شود اما برای خوانایی بیشتر می‌تواند استفاده شود).
			</div><a
            id="id-1.14.7.11.10"
            class="indexterm"></a><div
            class="para">
				به صورت پیشفرض، سرور تنها زمانی به پرس و جوی NFS پاسخ می‌دهد که عملیات فعلی دیسک تمام شده باشد (گزینه <code
              class="literal">sync</code>)؛ این کار می‌تواند با استفاده از گزینه <code
              class="literal">async</code> غیرفعال گردد. نوشتن‌های غیر-همزمان می‌تواند اندکی عملکرد کلی را بهبود ببخشد، اما قابلیت اعتماد را نیز کاهش می‌دهند چرا که خطر از دست دادن داده زمانی که سرور بین فعالیت‌های تایید نوشتن روی دیسک و انجام واقعی آن متوقف شود، وجود دارد. از زمانی که مقدار پیشفرض آن اخیرا تغییر کرده است (در مقایسه با مقداری قدیمی آن در NFS) تنظیم صریح آن توصیه می‌شود.
			</div><div
            class="para">
				به منظور حذف دسترسی root به فایل‌سیستم اشتراکی از طرف NFS، تمام پرس و جوهایی که از طرف کاربر root دریافت شوند به عنوان کاربر <code
              class="literal">nobody</code> در نظر گرفته می‌شوند. این عملکرد مبتنی بر گزینه <code
              class="literal">root_squash</code> است، که به صورت پیشفرض فعال می‌باشد. گزینه <code
              class="literal">no_root_squash</code>، که این عملکرد را غیرفعال می‌کند، خطرناک بوده و تنها در محیط‌های کنترل شده باید استفاده گردد. گزینه‌های <code
              class="literal">anonuid=<em
                class="replaceable">uid</em></code> و <code
              class="literal">anongid=<em
                class="replaceable">gid</em></code> امکان استفاده از یک کاربر و گروه ساختگی را بجای شناسه‌کاربری/گروه ۶۵۵۳۴ را می‌دهند (که منطبق با کاربر <code
              class="literal">nobody</code> و گروه <code
              class="literal">nogroup</code> است).
			</div><div
            class="para">
				در NFSv4، شما می‌تواند با استفاده از گزینه <code
              class="literal">sec</code> سطح امنیتی مورد نظر خود را مشخص کنید: <code
              class="literal">sec=sys</code> گزینه پیشفرض است که ویژگی خاصی را شامل نمی‌شود، <code
              class="literal">sec=krb5</code> تنها احرازهویت را فعال می‌کند، <code
              class="literal">sec=krb5i</code> محافظت از جامعیت داده را می‌افزاید و <code
              class="literal">sec=krb5p</code> کامل‌ترین سطح امنیتی است که شامل محافظت از حریم شخصی می‌باشد (همراه با رمزنگاری). برای این منظور نیاز به یک راه‌اندازی آماده از Kerberos دارد (این سرویس در این کتاب پوشش داده نمی‌شود).
			</div><div
            class="para">
				گزینه‌های دیگری نیز وجود دارند؛ آن‌ها در صفحه راهنمای <span
              class="citerefentry"><span
                class="refentrytitle">exports</span>(5)</span> مستندسازی شده‌اند.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>احتیاط</em></span> اولین نصب</strong></p></div></div></div><div
              class="para">
				اسکریپت راه‌اندازی <code
                class="filename">/etc/init.d/nfs-kernel-server</code> تنها زمانی سرور را راه‌اندازی می‌کند که فایل <code
                class="filename">/etc/exports</code> فهرستی از اشتراک‌های معتبر NFS را فهرست کرده باشد. در پیکربندی اولیه، زمانی که این فایل به منظور درج مدخل‌های معتبر ویرایش می‌شود، سرور NFS با استفاده از دستور زیر باید راه‌اندازی شود:
			</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>service nfs-kernel-server start</code></strong></pre></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.7.12"></a>11.4.3. برنامه NFS</h3></div></div></div><a
            id="id-1.14.7.12.2"
            class="indexterm"></a><a
            id="id-1.14.7.12.3"
            class="indexterm"></a><div
            class="para">
				مانند سایر فایل‌سیستم‌ها، یکپارچه‌سازی یک اشتراک NFS درون یک فایل‌سیستم نیازمند اتصال آن است. از آنجا که این فایل‌سیستم ویژگی‌های خود را دارد، برخی تنظیمات در رابطه با دستور <code
              class="command">mount</code> و فایل <code
              class="filename">/etc/fstab</code> مورد نیاز هستند.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.14.7.12.5"></a><p
              class="title"><strong>
      مثال 11.22. اتصال دستی با استفاده از دستور <code
                  class="command">mount</code></strong></p><div
              class="example-contents"><pre
                class="screen">
          <code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>mount -t nfs4 -o rw,nosuid arrakis.internal.falcot.com:/shared /srv/shared</code></strong></pre></div></div><div
            class="example"><a
              xmlns=""
              id="id-1.14.7.12.6"></a><p
              class="title"><strong>
      مثال 11.23. اتصال خودکار با درج در فایل <code
                  class="filename">/etc/fstab</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">
arrakis.internal.falcot.com:/shared /srv/shared nfs4 rw,nosuid 0 0</pre></div></div><div
            class="para">
				دستور بالا، هنگام راه‌اندازی سیستم، دایرکتوری NFS <code
              class="filename">/shared/</code> را از سرور <code
              class="literal">arrakis</code> به دایرکتوری محلی <code
              class="filename">/srv/shared/</code> متصل می‌کند. دسترسی خواندنی-نوشتنی درخواست شده است (پارامتر <code
              class="literal">rw</code>). گزینه <code
              class="literal">nosuid</code> یک مقیاس امنیتی است که بیت <code
              class="literal">setuid</code> یا <code
              class="literal">setgid</code> را از برنامه‌های اجرایی در محل اشتراک حذف می‌کند. اگر قرار بود از اشتراک NFS تنها برای ذخیره‌سازی اسناد استفاده می‌شد، گزینه توصیه شده دیگر <code
              class="literal">noexec</code> است، که از اجرای برنامه‌ها در فضای اشتراکی جلوگیری می‌کند. نکته اینکه در سرور، دایرکتوری <code
              class="filename">shared</code> زیر دایرکتوری اصلی NFSv4 (برای نمونه، <code
              class="filename">/export/shared</code>) قرار دارد، از این رو یک دایکتوری سطح-بالا به حساب نمی‌آید.
			</div><div
            class="para">
				صفحه راهنمای <span
              class="citerefentry"><span
                class="refentrytitle">nfs</span>(5)</span> به توضیح تمام گزینه‌های بکار رفته در آن می‌پردازد.
			</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.ftp-file-server.html"><strong>قبلی</strong>11.3. سرور فایل FTP</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>بالا</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>خانه</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.windows-file-server-with-samba.html"><strong>بعدی</strong>11.5. راه‌اندازی اشتراک‌های ویندوز با Samba</a></li></ul></body></html>
