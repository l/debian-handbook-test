<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.2. سرور وب (HTTP)</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-fa-IR-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="راهنمای جامع دبیان" /><link
        rel="up"
        href="network-services.html"
        title="فصل 11. سرویس‌های شبکه: Postfix، Apache، NFS، Samba، Squid، LDAP، SIP، XMPP، Turn" /><link
        rel="prev"
        href="network-services.html"
        title="فصل 11. سرویس‌های شبکه: Postfix، Apache، NFS، Samba، Squid، LDAP، SIP، XMPP، Turn" /><link
        rel="next"
        href="sect.ftp-file-server.html"
        title="11.3. سرور فایل FTP" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/fa-IR/stable/sect.http-web-server.html" /></head><body
      dir="rtl"><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="network-services.html"><strong>قبلی</strong></a></li><li
          class="home">راهنمای جامع دبیان</li><li
          class="next"><a
            accesskey="n"
            href="sect.ftp-file-server.html"><strong>بعدی</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.http-web-server"></a>11.2. سرور وب (HTTP)</h2></div></div></div><div
          class="para">
			مدیرسیستم‌های شرکت فالکوت تصمیم گرفته‌اند که از سرور وب آپاچی، که در دبیان <span
            class="distribution distribution">Jessie</span> با نسخه ۲.۴.۱۰ قرار دارد، استفاده کنند.
		</div><a
          id="id-1.14.5.3"
          class="indexterm"></a><a
          id="id-1.14.5.4"
          class="indexterm"></a><a
          id="id-1.14.5.5"
          class="indexterm"></a><a
          id="id-1.14.5.6"
          class="indexterm"></a><a
          id="id-1.14.5.7"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>جایگزین</em></span> سایر سرورهای وب</strong></p></div></div></div><div
            class="para">
			آپاچی تقریبا شناخته شده‌ترین (و پرکاربردترین) سرور وب موجود است، اما گزینه‌های دیگری نیز وجود دارد؛ آن‌ها می‌توانند تحت شرایط خاص عملکرد بهتری داشته باشند اما با در نظر گرفتن ویژگی‌های و افزونه‌های کمتر نسبت به آپاچی. با این حال، زمانی که از سرور وب برای میزبانی فایل‌های ایستا یا کاربرد به عنوان یک پروکسی استفاده گردد، گزینه‌های جایگزین مانند <span
              class="pkg pkg">nginx</span> و <span
              class="pkg pkg">lighttpd</span> قابل توجه هستند.
		</div><a
            id="id-1.14.5.8.3"
            class="indexterm"></a><a
            id="id-1.14.5.8.4"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.5.9"></a>11.2.1. نصب آپاچی</h3></div></div></div><div
            class="para">
				نصب بسته <span
              class="pkg pkg">apache2</span> شامل تمام ویژگی‌های مورد نظر است. این بسته شامل تمام افزونه‌ها، از جمله <span
              class="emphasis"><em>Multi-Processing Modules</em></span> یا MPM است که در شیوه تصمیم‌گیری آپاچی برای پردازش موازی درخواست‌های دریافتی تاثیر می‌گذارد (آن‌هایی که سابق بر این در بسته‌های <span
              class="pkg pkg">apache2-mpm-*</span> فراهم می‌شدند). این بسته همچنین اقدام به نصب <span
              class="pkg pkg">apache2-utils</span> می‌کند که شامل ابزارهای خط فرمان است، در مورد آن‌ها صحبت خواهیم کرد.
			</div><div
            class="para">
				استفاده از MPM تاثیر بسزایی در عملکرد آپاچی برای مدیریت درخواست‌های هم‌زمان دارد. با افزونه‌های چند-پردازشی <span
              class="emphasis"><em>worker</em></span> از <span
              class="emphasis"><em>threads</em></span> (فرآیندهای سبک) و افزونه‌های چند-پردازشی <span
              class="emphasis"><em>prefork</em></span> از مجموعه فرآیندهای گردآوری شده از قبل استفاده می‌کند. با افزونه‌های چند-پردازشی <span
              class="emphasis"><em>event</em></span> همچنین از threads استفاده می‌کند، اما ارتباطات غیرفعال (آن‌هایی که توسط ویژگی <span
              class="emphasis"><em>keep-alive</em></span> در HTTP باز نگه داشته شده‌اند) به یک thread مدیریتی انحصاری بازگردانده می‌شوند.
			</div><div
            class="para">
				مدیرسیستم‌های فالکوت همچنین بسته <span
              class="pkg pkg">libapache2-mod-php5</span> را نصب کرده‌اند تا پشتیبانی PHP در آپاچی فعال گردد. این عمل منجر به غیرفعال شدن افزونه‌های چند-پردازشی <span
              class="emphasis"><em>event</em></span> می‌گردد و <span
              class="emphasis"><em>prefork</em></span> جایگزین آن می‌شود چرا که PHP تنها در این حالت می‌تواند با آپاچی کار کند.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>امنیت</em></span> اجرا به عنوان کاربر <code
                        class="literal">www-data</code></strong></p></div></div></div><a
              id="id-1.14.5.9.5.2"
              class="indexterm"></a><a
              id="id-1.14.5.9.5.3"
              class="indexterm"></a><div
              class="para">
				به صورت پیشفرض، آپاچی درخواست‌های دریافتی را با استفاده از کاربر <code
                class="literal">www-data</code> مدیریت می‌کند. به این معنی که در صورت بروز یک آسیب‌پذیری امنیتی در یک اسکریپت CGI اجرا شده توسط آپاچی (برای یک صفحه پویا) کل سیستم به خطر نمی‌افتد، بلکه تنهای فایل‌های مرتبط با این کاربر خاص.
			</div><div
              class="para">
				استفاده از افزونه‌های <span
                class="emphasis"><em>suexec</em></span> اجازه دور زدن این قانون را می‌دهد به طوری که برخی اسکریپت‌های CGI بتوانند به عنوان کاربر دیگری اجرا شوند. اینکار با استفاده از عبارت <code
                class="literal">SuexecUserGroup <em
                  class="replaceable">user</em><em
                  class="replaceable">group</em></code> در پیکربندی آپاچی صورت می‌گیرد.
			</div><a
              id="id-1.14.5.9.5.6"
              class="indexterm"></a><div
              class="para">
				حالت دیگر استفاده از یک افزونه چند-پردازشی اختصاصی است که توسط <span
                class="pkg pkg">libapache2-mpm-itk</span> فراهم می‌شود. این افزونه بخصوص عملکرد متفاوتی دارد: امکان “ایزوله‌کردن” گروه‌های مجازی (در حقیقت مجموعه‌ای از صفحات) را می‌دهد به گونه‌ای که هر کدام به عنوان کاربر جداگانه‌ای اجرا شوند. یک آسیب‌پذیری در یک وبسایت منجر نمی‌شود که فایل‌های مرتبط با وبسایت دیگر به خطر بیفتد.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>نگاه سریع</em></span> فهرستی از افزونه‌ها</strong></p></div></div></div><div
              class="para">
				فهرست کامل افزونه‌های استاندارد آپاچی می‌تواند به صورت آنلاین پیدا شود. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://httpd.apache.org/docs/2.4/mod/index.html">http://httpd.apache.org/docs/2.4/mod/index.html</a></div>
			</div></div><div
            class="para">
				آپاچی یک سرور ماژولار است و بسیاری ویژگی‌های آن با استفاده از افزونه‌های خارجی که برنامه اصلی هنگام فرآیند راه‌اندازی اولیه فراخوانی می‌کند، پیاده‌سازی شده است. پیکربندی پیشفرض تنها متداول‌ترین افزونه‌ها را فعال می‌سازد، اما فعال‌سازی یک افزونه جدید به سادگی اجرای دستور <code
              class="command">a2enmod <em
                class="replaceable">module</em></code> است؛ برای غیرفعال‌سازی یک افزونه، دستور <code
              class="command">a2dismod <em
                class="replaceable">module</em></code> استفاده می‌شود. این برنامه‌ها در حقیقت اقدام به ایجاد (یا حذف) پیوندهای نمادین از <code
              class="filename">/etc/apache2/mods-enabled/</code> به فایل‌های واقعی موجود در <code
              class="filename">/etc/apache2/mods-available/</code> می‌کنند.
			</div><div
            class="para">
				با پیکربندی پیشفرض خود، سرور وب به درگاه ۸۰ گوش داده (پیکربندی شده در <code
              class="filename">/etc/apache2/ports.conf</code>) و صفحات موجود در دایرکتوری <code
              class="filename">/var/www/html/</code> را فراهم می‌کند (پیکربندی شده در <code
              class="filename">/etc/apache2/sites-enabled/000-default.conf</code>).
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>مطالعه بیشتر</em></span> افزودن پشتیبانی برای SSL</strong></p></div></div></div><a
              id="id-1.14.5.9.9.2"
              class="indexterm"></a><a
              id="id-1.14.5.9.9.3"
              class="indexterm"></a><div
              class="para">
				آپاچی ۲.۴ شامل افزونه SSL مورد نیاز HTTP ایمن یا HTTPS است. تنها کافی است با دستور <code
                class="command">a2enmod ssl</code> فعال‌سازی شده و عبارت‌های مورد نیاز آن در فایل‌های پیکربندی قرار بگیرند. یک نمونه پیکربندی در فایل <code
                class="filename">/etc/apache2/sites-available/default-ssl.conf</code> قرار دارد. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://httpd.apache.org/docs/2.4/mod/mod_ssl.html">http://httpd.apache.org/docs/2.4/mod/mod_ssl.html</a></div>
			</div><div
              class="para">
				اگر قصد استفاده از <span
                class="emphasis"><em>Perfect Forward Secrecy</em></span> همراه با ارتباطات SSL را دارید مراقبت‌های بیشتری باید صورت پذیرد (این ارتباطات از کلیدهای نشست موقتی استفاده می‌کنند به طوری که لو رفتن کلید خصوصی سرور منجر به لو رفتن ترافیک رمزگذاری شده از قدیم نشود که می‌توانست هنگام گوش کردن به شبکه در جایی ذخیره شده باشد). نگاهی به توصیه‌های موزیلا در این مورد خاص بیندازید: <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="https://wiki.mozilla.org/Security/Server_Side_TLS#Apache">https://wiki.mozilla.org/Security/Server_Side_TLS#Apache</a></div>
			</div><a
              id="id-1.14.5.9.9.6"
              class="indexterm"></a></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.5.10"></a>11.2.2. پیکربندی گروه‌های مجازی</h3></div></div></div><div
            class="para">
				یک گروه مجازی مانند یک شناسه جدید برای سرور وب است.
			</div><a
            id="id-1.14.5.10.3"
            class="indexterm"></a><div
            class="para">
				آپاچی دو نوع متفاوت از گروه مجازی را در نظر می‌گیرد: آن‌هایی که مبتنی بر نشانی IP (یا درگاه) و آن‌هایی که مبتنی بر نام دامنه سرور وب هستند. روش اول نیازمند اختصاص یک نشانی IP (یا درگاه) به هر سایت است در صورتی که روش دوم می‌تواند با یک نشانی IP (یا درگاه) کار کند و سایت‌ها با توجه به نام میزبان که توسط برنامه HTTP ارسال می‌شود، تشخیص داده می‌شوند (که تنها در نسخه ۱.۱ از پروتکل HTTP کار می‌کند - خوشبختانه این نسخه به قدری قدیمی است که تقریبا تمام برنامه‌ها از آن استفاده می‌کنند).
			</div><div
            class="para">
				کمبود (رو به افزایش) نشانی‌های IPv4 معمولا منجر به استفاده از شیوه دوم می‌گردد؛ اگرچه، در صورت استفاده گروه‌های مجازی از HTTP، این فرآیند دشوارتر نیز می‌گردد، چرا که پروتکل SSL تا اکنون پشتیبانی از گروه مجازی نام-محور را فراهم نکرده است؛ افزونه <span
              class="emphasis"><em>Server Name Indication</em></span> یا SNI که امکان چنین ترکیبی را می‌دهد توسط تمام مرورگرها پشتیبانی نمی‌شود. زمانی که نیاز به اجرای چندین سایت HTTPS روی یک سرور باشد، آن‌ها معمولا با اجرا روی یک درگاه جداگانه یا یک نشانی IP جداگانه (که IPv6 می‌تواند کمک کند) تشخیص داده می‌شوند.
			</div><div
            class="para">
				پیکربندی پیشفرض آپاچی ۲ منجر به فعال‌سازی گروه‌های مجازی نام-محور می‌گردد. به علاوه، یک گروه مجازی پیشفرض در فایل <code
              class="literal">/etc/apache2/sites-enabled/000-default.conf</code> قرار دارد: از این گروه مجازی در صورتی که هیچ گروه دیگری متناسب با درخواست پیدا نشود استفاده می‌گردد.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>احتیاط</em></span> اولین گروه مجازی</strong></p></div></div></div><div
              class="para">
				درخواست‌هایی که به گروه‌های مجازی ناشناخته می‌شود همیشه توسط اولین گروه مجازی تعریف شده مدیریت می‌گردند، به همین دلیل است که ابتدا گروه مجازی <code
                class="literal">www.falcot.com</code> را تعریف کردیم.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>نگاه سریع</em></span> آپاچی از SNI پشتبانی می‌کند</strong></p></div></div></div><a
              id="id-1.14.5.10.8.2"
              class="indexterm"></a><div
              class="para">
				سرور آپاچی از یک افزونه پروتکل SSL بنام <span
                class="emphasis"><em>Server Name Indication</em></span> یا SNI پشتیبانی می‌کند. این افزونه به مرورگر اجازه می‌دهد هنگام برقراری ارتباط SSL نام میزبان سرور وب را ارسال کند، درست قبل از خود درخواست HTTP، که سابق بر این برای تشخیص گروه مجازی درخواستی از میان میزبان‌های موجود در همان سرور استفاده می‌شد (با نشانی IP و درگاه یکسان). اینکار به آپاچی اجازه می‌دهد تا مناسب‌ترین گواهینامه SSL را برای تراکنش پیش روی خود انتخاب کند.
			</div><div
              class="para">
				قبل از SNI، آپاچی از گواهینامه تعریف شده در گروه مجازی پیشفرض استفاده می‌کرد. برنامه‌هایی که قصد دسترسی به گروه مجازی دیگری را داشتند، با اخطار رو به رو می‌شدند چرا که گواهینامه‌های دریافتی آنان با وبسایتی که قصد دسترسی آن را داشتند تطابق نداشت. خوشبختانه، اکنون اکثر مرورگرها با SNI کار می‌کنند؛ از جمله مایکروسافت اینترنت اکسپلورر از نسخه ۷.۰ (شروع در ویستا)، موزیلا فایرفاکس از نسخه ۲.۰، اپل سافاری از نسخه ۳.۲.۱ و تمام نسخه‌های گوگل کروم.
			</div><div
              class="para">
				بسته آپاچی که در دبیان قرار دارد همراه با پشتیبانی SNI ساخته شده است؛ بنابراین پیکربندی خاصی مورد نیاز نیست.
			</div><div
              class="para">
				هنگام پیکربندی اولین گروه مجازی (که به صورت پیشفرض استفاده می‌شود) برای اطمینان از فعال‌سازی TLSv1 باید دقت عمل به خرج داد، چرا که آپاچی از پارامترهای این اولین گروه مجازی به منظور برقراری ارتباط‌های ایمن استفاده می‌کند و بهتر است که این اجازه صادر شده باشد!
			</div></div><div
            class="para">
				هر گروه مجازی اضافی درون فایل جداگانه‌ای در مسیر <code
              class="filename">/etc/apache2/sites-available/</code> قرار می‌گیرد. برپایی یک وبسایت برای دامنه <code
              class="literal">falcot.org</code> به سادگی ایجاد فایل پیکربندی آن و فعال‌سازی گروه مجازی با استفاده از <code
              class="command">a2ensite www.falcot.org</code> است.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.14.5.10.10"></a><p
              class="title"><strong>
      مثال 11.16. فایل <code
                  class="filename">/etc/apache2/sites-available/www.falcot.org.conf</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">
&lt;VirtualHost *:80&gt;
ServerName www.falcot.org
ServerAlias falcot.org
DocumentRoot /srv/www/www.falcot.org
&lt;/VirtualHost&gt;</pre></div></div><div
            class="para">
				سرور آپاچی که تاکنون پیکربندی شده است، از فایل‌های گزارش یکسانی برای تمام گروه‌های مجازی استفاده می‌کند (اگرچه این عمل می‌تواند با افزودن عبارت <code
              class="literal">CustomLog</code> در تعریف هر گروه مجازی تغییر کند). پس منطقی به نظر می‌رسد به منظور درج نام گروه مجازی در گزارش‌ها، اقدام به سفارشی‌سازی قالب آن کرد. اینکار با استفاده از ایجاد یک فایل <code
              class="filename">/etc/apache2/conf-available/customlog.conf</code> انجام می‌شود که قالب جدیدی برای تمام فایل‌های گزارش تعریف می‌کند (با عبارت <code
              class="literal">LogFormat</code>) و فعال‌سازی آن با استفاده از <code
              class="command">a2enconf customlog</code> خط <code
              class="literal">CustomLog</code> باید از فایل <code
              class="filename">/etc/apache2/sites-available/000-default.conf</code> حذف (یا مخفی) شود.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.14.5.10.12"></a><p
              class="title"><strong>
      مثال 11.17. فایل <code
                  class="filename">/etc/apache2/conf.d/customlog.conf</code></strong></p><div
              class="example-contents"><pre
                class="programlisting scale">
# New log format including (virtual) host name
LogFormat "%v %h %l %u %t \"%r\" %&gt;s %b \"%{Referer}i\" \"%{User-Agent}i\"" vhost

# Now let's use this "vhost" format by default
CustomLog /var/log/apache2/access.log vhost</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.5.11"></a>11.2.3. عبارت‌های متداول</h3></div></div></div><div
            class="para">
				این قسمت به بررسی برخی از متداول‌ترین عبارت‌های پیکربندی در آپاچی می‌پردازد.
			</div><a
            id="id-1.14.5.11.3"
            class="indexterm"></a><a
            id="id-1.14.5.11.4"
            class="indexterm"></a><div
            class="para">
				فایل پیکربندی اصلی معمولا شامل چندین بلاک <code
              class="literal">Directory</code> است؛ آن‌ها اجازه تعریف عملکردهای متفاوت برای سرور نسبت به محل قرارگیری فایل‌های ارائه شده را می‌دهند. چنین بلاکی معمولا شامل عبارت‌های <code
              class="literal">Options</code> و <code
              class="literal">AllowOverride</code> است.
			</div><a
            id="id-1.14.5.11.6"
            class="indexterm"></a><a
            id="id-1.14.5.11.7"
            class="indexterm"></a><div
            class="example"><a
              xmlns=""
              id="id-1.14.5.11.8"></a><p
              class="title"><strong>
      مثال 11.18. بلاک Directory</strong></p><div
              class="example-contents"><pre
                class="programlisting">
&lt;Directory /var/www&gt;
Options Includes FollowSymlinks
AllowOverride All
DirectoryIndex index.php index.html index.htm
&lt;/Directory&gt;</pre></div></div><div
            class="para">
				عبارت <code
              class="literal">DirectoryIndex</code> شامل فهرستی از فایل‌ها است که هنگام درخواست برنامه به سرور بررسی می‌شوند. اولین فایل موجود در فهرست استفاده شده و به عنوان پاسخ فرستاده می‌شود.
			</div><a
            id="id-1.14.5.11.10"
            class="indexterm"></a><div
            class="para">
				عبارت <code
              class="literal">Options</code> به همراه فهرستی از گزینه‌های قابل فعال‌سازی می‌آید. مقدار <code
              class="literal">None</code> تمام گزینه‌ها را غیرفعال می‌کند؛ به همین شکل <code
              class="literal">All</code> همه را فعال‌سازی می‌کند بجز <code
              class="literal">MultiViews</code>. گزینه‌های موجود عبارتند از:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ExecCGI</code> نشان می‌دهد که اسکریپت‌های CGI می‌توانند اجرا شوند. <a
                    id="id-1.14.5.11.12.1.1.2"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">FollowSymlinks</code> به سرور می‌گوید که می‌توان از پیوندهای نمادین استفاده کرد، و برای آن‌ها پاسخ باید شامل محتوای اصلی فایل باشد. <a
                    id="id-1.14.5.11.12.2.1.2"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">SymlinksIfOwnerMatch</code> نیز به سرور می‌گوید که می‌توان از پیوندهای نمادین استفاده کرد اما تنها زمانی که پیوند و هدف آن به یک کاربر متعلق باشند. <a
                    id="id-1.14.5.11.12.3.1.2"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">Includes</code> منجر به فعال‌سازی <span
                    class="emphasis"><em>Server Side Includes</em></span> یا <span
                    class="emphasis"><em>SSI</em></span> می‌شود. این‌ها عبارت‌هایی هستند که درون صفحات HTML قرار دارند و برای هر درخواست به صورت جداگانه اجرا می‌شوند. <a
                    id="id-1.14.5.11.12.4.1.4"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">Indexes</code> به سرور می‌گوید که محتوای یک دایرکتوری را به صورت فهرست‌وار نمایش دهد اگر درخواست HTTP ارسال شده توسط برنامه به یک دایرکتوری بدون فایل اندیس اشاره کند (زمانی که هیچ فایلی توسط عبارت <code
                    class="literal">DirectoryIndex</code> در دایرکتوری موجود نباشد). <a
                    id="id-1.14.5.11.12.5.1.3"
                    class="indexterm"></a>
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">MultiViews</code> قابلیت تعامل محتوایی را فعال‌سازی می‌کند؛ این قابلیت می‌تواند توسط سرور به منظور ارسال صفحه‌ای به زبان تنظیم شده از طرف مرورگر مورد استفاده قرار گیرد. <a
                    id="id-1.14.5.11.12.6.1.2"
                    class="indexterm"></a>
					</div></li></ul></div><div
            class="para">
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>بازگشت به مقدمات</em></span> فایل <code
                        class="filename">.htaccess</code></strong></p></div></div></div><div
              class="para">
				فایل <code
                class="filename">.htaccess</code> شامل عبارت‌های پیکربندی آپاچی است که با هر مرتبه درخواست از یک دایرکتوری که در آن ذخیره شده است، فراخوانی می‌گردد. حوزه این عبارت‌ها به دایرکتوری‌های فرزند آن نیز ادامه می‌یابد.
			</div><a
              id="id-1.14.5.11.14.3"
              class="indexterm"></a><div
              class="para">
				اکثر عبارت‌هایی که می‌توانند درون یک بلاک <code
                class="literal">Directory</code> قرار گیرند در یک فایل <code
                class="filename">.htaccess</code> نیز مجاز هستند.
			</div></div><div
            class="para">
				عبارت <code
              class="literal">AllowOverride</code> تمام گزینه‌هایی که می‌توانند توسط فایل <code
              class="filename">.htaccess</code> فعال یا غیرفعال شوند را فهرست می‌کند. یک کاربرد متداول این عبارت محدودکردن دسترسی به <code
              class="literal">ExecCGI</code> است، به طوری که مدیرسیستم تصمیم می‌گیرد کدام کاربران مجاز به اجرای برنامه با هویت سرور وب هستند (کاربر <code
              class="literal">www-data</code>).
			</div><a
            id="id-1.14.5.11.16"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.5.11.17"></a>11.2.3.1. الزامی ساختن احرازهویت</h4></div></div></div><a
              id="id-1.14.5.11.17.2"
              class="indexterm"></a><div
              class="para">
					در برخی موارد، دسترسی به قسمت‌های یک وبسایت باید محدود شود، به طوری که تنها کاربران مجاز با داشتن نام کاربری و گذرواژه بتوانند به آن دسترسی یابند.
				</div><div
              class="example"><a
                xmlns=""
                id="id-1.14.5.11.17.4"></a><p
                class="title"><strong>
      مثال 11.19. فایل <code
                    class="filename">.htaccess</code> که احرازهویت را لازم می‌داند</strong></p><div
                class="example-contents"><pre
                  class="programlisting">
Require valid-user
AuthName "Private directory"
AuthType Basic
AuthUserFile /etc/apache2/authfiles/htpasswd-private</pre></div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>امنیت</em></span> بدون امنیت</strong></p></div></div></div><div
                class="para">
					سیستم احرازهویت استفاده شده در نمونه بالا (<code
                  class="literal">Basic</code>) دارای حداقل امنیت لازم است چرا که گذرواژه بدون رمزنگاری ارسال می‌شود (تنها با استفاده از کدگذاری <span
                  class="emphasis"><em>base64</em></span> ارسال می‌شود و نه یک شیوه معمول رمزنگاری). شایان ذکر است که اسناد “محافظت‌شده” با این مکانیزم، درون شبکه بدون رمزنگاری ارسال می‌شوند. اگر امنیت مد نظر باشد، تمام ارتباط HTTP باید توسط SSL رمزنگاری گردد.
				</div></div><div
              class="para">
					فایل <code
                class="filename">/etc/apache2/authfiles/htpasswd-private</code> شامل فهرستی از کاربران و گذرواژه‌ها است؛ این فایل معمولا با دستور <code
                class="command">htpasswd</code> ویرایش می‌گردد. برای نمونه، دستور زیر برای افزودن یک کاربر یا تغییر گذرواژه آن استفاده می‌شود: <a
                id="id-1.14.5.11.17.6.3"
                class="indexterm"></a>
				</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>htpasswd /etc/apache2/authfiles/htpasswd-private <em
                    class="replaceable">user</em>
</code></strong><code
                class="computeroutput">New password:
Re-type new password:
Adding password for user <em
                  class="replaceable">user</em>
</code></pre></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.5.11.18"></a>11.2.3.2. محدود کردن دسترسی</h4></div></div></div><a
              id="id-1.14.5.11.18.2"
              class="indexterm"></a><div
              class="para">
					عبارت <code
                class="literal">Require</code> شامل محدودیت‌های دسترسی برای یک دایرکتوری است (و دایرکتوری‌های فرزند آن به صورت بازگشتی).
				</div><a
              id="id-1.14.5.11.18.4"
              class="indexterm"></a><a
              id="id-1.14.5.11.18.5"
              class="indexterm"></a><a
              id="id-1.14.5.11.18.6"
              class="indexterm"></a><div
              class="para">
					می‌تواند به منظور محدود کردن دسترسی با شرایط گوناگون بکار رود؛ ما تنها به بررسی محدودیت برای نشانی IP برنامه درخواست کننده می‌پردازیم، اما می‌تواند کارهای قدرتمندتری نسبت به آن را انجام دهد، بخصوص زمانی که چندین عبارت <code
                class="literal">Require</code> درون یک بلاک <code
                class="literal">RequireAll</code> قرار می‌گیرند.
				</div><div
              class="example"><a
                xmlns=""
                id="id-1.14.5.11.18.8"></a><p
                class="title"><strong>
      مثال 11.20. فقط به شبکه محلی اجازه دسترسی بده</strong></p><div
                class="example-contents"><pre
                  class="programlisting">Require ip 192.168.0.0/16</pre></div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>جایگزین</em></span> شیوه نگارش قدیمی</strong></p></div></div></div><div
                class="para">
					شیوه نگارش <code
                  class="literal">Require</code> تنها در آپاچی ۲.۴ موجود است (نسخه موجود در <span
                  class="distribution distribution">Jessie</span>). برای کاربران <span
                  class="distribution distribution">Wheezy</span>، شیوه نگارش آپاچی ۲.۲ متفاوت است و در اینجا فقط به عنوان ارجاع اشاره می‌شود، با اینکه در آپاچی ۲.۴ و با استفاده از افزونه <code
                  class="literal">mod_access_compat</code> می‌تواند قابل دسترس شود.
				</div><div
                class="para">
					عبارت‌های <code
                  class="literal">Allow from</code> و <code
                  class="literal">Deny from</code> محدودیت‌های دسترسی به یک دایرکتوری را کنترل می‌کنند (و دایرکتوری‌های فرزند آن به صورت بازگشتی).
				</div><a
                id="id-1.14.5.11.18.9.4"
                class="indexterm"></a><a
                id="id-1.14.5.11.18.9.5"
                class="indexterm"></a><a
                id="id-1.14.5.11.18.9.6"
                class="indexterm"></a><div
                class="para">
					عبارت <code
                  class="literal">Order</code> به سرور می‌گوید به چه ترتیب عبارت‌های <code
                  class="literal">Allow from</code> و <code
                  class="literal">Deny from</code> را اعمال کند؛ آخرین عبارتی که منطبق باشد، انتخاب می‌شود. به عبارتی، <code
                  class="literal">Order deny,allow</code> تنها در صورتی اجازه دسترسی می‌دهد که هیچ عبارت <code
                  class="literal">Deny from</code> موجود نباشد یا یک عبارت <code
                  class="literal">Allow from</code> موجود باشد. برعکس آن، <code
                  class="literal">Order allow,deny</code> تنها در صورتی دسترسی را محدود می‌کند که هیچ عبارت <code
                  class="literal">Allow from</code> موجود نباشد یا یک عبارت <code
                  class="literal">Deny from</code> موجود باشد.
				</div><div
                class="para">
					عبارت‌های <code
                  class="literal">Allow from</code> و <code
                  class="literal">Deny from</code> می‌توانند همراه با یک نشانی IP، یک شبکه (از جمله <code
                  class="literal">192.168.0.0/255.255.255.0</code>، <code
                  class="literal">192.168.0.0/24</code> یا حتی <code
                  class="literal">192.168.0</code>)، یک نام میزبان یا دامنه یا کلیدواژه <code
                  class="literal">all</code> که نشانگر همه است، قرار گیرند.
				</div><div
                class="para">
					برای نمونه، به منظور محدود کردن ارتباطات تنها به شبکه محلی می‌توان از عبارت‌های زیر استفاده کرد:
				</div><pre
                class="programlisting">
Order deny,allow
Allow from 192.168.0.0/16
Deny from all</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.5.12"></a>11.2.4. تحلیلگرهای گزارش</h3></div></div></div><div
            class="para">
				یک تحلیلگر گزارش معمولا در یک سرور وب نصب می‌شود؛ چرا که با اینکار الگوهای مصرف منابع در سرور در اختیار مدیرسیستم‌ها قرار می‌گیرد.
			</div><div
            class="para">
				مدیرسیستم‌های شرکت فالکوت <span
              class="emphasis"><em>AWStats</em></span> یا <span
              class="emphasis"><em>Advanced Web Statistics</em></span> را برای تحلیل فایل‌های گزارش آپاچی انتخاب کرده‌اند.
			</div><a
            id="id-1.14.5.12.4"
            class="indexterm"></a><a
            id="id-1.14.5.12.5"
            class="indexterm"></a><a
            id="id-1.14.5.12.6"
            class="indexterm"></a><a
            id="id-1.14.5.12.7"
            class="indexterm"></a><div
            class="para">
				اولین گام پیکربندی، سفارشی‌کردن فایل <code
              class="filename">/etc/awstats/awstats.conf</code> است. مدیرسیستم‌های فالکوت بجز پارامترهای زیر، تغییری در آن ایجاد نکرده‌اند:
			</div><pre
            class="programlisting">
LogFile="/var/log/apache2/access.log"
LogFormat = "%virtualname %host %other %logname %time1 %methodurl %code %bytesd %refererquot %uaquot"
SiteDomain="www.falcot.com"
HostAliases="falcot.com REGEX[^.*\.falcot\.com$]"
DNSLookup=1
LoadPlugin="tooltips"</pre><div
            class="para">
				تمام این پارامترها توسط توضیحات موجود در فایل اولیه مستندسازی شده‌اند. به طور خاص، پارامترهای <code
              class="varname">LogFile</code> و <code
              class="varname">LogFormat</code> مکان و قالب فایل گزارش و اطلاعات موجود در آن را مشخص می‌کنند؛ <code
              class="varname">SiteDomain</code> و <code
              class="varname">HostAliases</code> فهرستی از تمام نام‌های شناخته شده که وبسایت با آن‌ها کار می‌کند را فهرست می‌کنند.
			</div><div
            class="para">
				برای سایت‌های پرترافیک، <code
              class="varname">DNSLookup</code> معمولا نباید به <code
              class="literal">1</code> تنظیم شود؛ برای سایت‌های کوچکتر، از جمله فالکوت که در بالا مطرح شد، این تنظیم امکان گزارش‌های خواناتری را فراهم می‌کند که شامل نام کامل رایانه بجای نشانی IP آن است.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>امنیت</em></span> دسترسی به آمار</strong></p></div></div></div><div
              class="para">
				AWStats به صورت پیشفرض آمار خود را بدون هیچ محدودیتی در وبسایت قرار می‌دهد، اما امکان محدود کردن آن وجود دارد به طوری که تنها تعدادی نشانی‌های IP (شاید محلی) بتوانند به آن دسترسی داشته باشند؛ فهرست نشانی‌های IP مجاز می‌توانند درون پارامتر <code
                class="varname">AllowAccessFromWebToFollowingIPAddresses</code> قرار بگیرند.
			</div></div><div
            class="para">
				AWStats همچنین برای سایر گروه‌های مجازی نیر فعال می‌شود؛ هر گروه مجازی به فایل پیکربندی خود نیاز دارد، از جمله <code
              class="filename">/etc/awstats/awstats.www.falcot.org.conf</code>.
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.14.5.12.14"></a><p
              class="title"><strong>
      مثال 11.21. فایل پیکربندی AWStats برای یک گروه مجازی</strong></p><div
              class="example-contents"><pre
                class="programlisting">
Include "/etc/awstats/awstats.conf"
SiteDomain="www.falcot.org"
HostAliases="falcot.org"</pre></div></div><div
            class="para">
				AWStats از شمایل‌های گوناگونی واقع در دایکتوری <code
              class="filename">/usr/share/awstats/icon/</code> استفاده می‌کند. به منظور قابل دسترس بودن این شمایل‌ها در وبسایت، پیکربندی آپاچی باید با استفاده از عبارت زیر تغییر کند:
			</div><pre
            class="programlisting">
Alias /awstats-icon/ /usr/share/awstats/icon/</pre><div
            class="para">
				پس از چند دقیقه (و زمانی که اسکریپت چندین بار اجرا شود)، نتایج به صورت آنلاین قابل مشاهده هستند: <div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="http://www.falcot.com/cgi-bin/awstats.pl">http://www.falcot.com/cgi-bin/awstats.pl</a></div><div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="http://www.falcot.org/cgi-bin/awstats.pl">http://www.falcot.org/cgi-bin/awstats.pl</a></div>
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>احتیاط</em></span> چرخش فایل گزارش</strong></p></div></div></div><div
              class="para">
				به منظور اینکه تمام فایل‌های گزارش مورد استفاده قرار گیرند، <span
                class="emphasis"><em>AWStats</em></span> نیاز دارد که قبل از چرخش فایل‌های گزارش آپاچی اجرا گردد. با نگاه به عبارت <code
                class="literal">prerotate</code> از فایل <code
                class="filename">/etc/logrotate.d/apache2</code>، اینکار با قرار دادن یک پیوند نمادین به <code
                class="filename">/usr/share/awstats/tools/update.sh</code> در <code
                class="filename">/etc/logrotate.d/httpd-prerotate</code> انجام می‌شود.
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>cat /etc/logrotate.d/apache2
</code></strong><code
                class="computeroutput">/var/log/apache2/*.log {
  daily
  missingok
  rotate 14
  compress
  delaycompress
  notifempty
  create 644 root adm
  sharedscripts
  postrotate
    if /etc/init.d/apache2 status &gt; /dev/null ; then \
      /etc/init.d/apache2 reload &gt; /dev/null; \
    fi;
  endscript
  prerotate
    if [ -d /etc/logrotate.d/httpd-prerotate ]; then \
      run-parts /etc/logrotate.d/httpd-prerotate; \
    fi; \
  endscript
}
$ </code><strong
                class="userinput"><code>sudo mkdir -p /etc/logrotate.d/httpd-prerotate
</code></strong><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>sudo ln -sf /usr/share/awstats/tools/update.sh \
  /etc/logrotate.d/httpd-prerotate/awstats
</code></strong></pre><div
              class="para">
				نکته اینکه فایل‌های گزارش ایجاد شده توسط <code
                class="command">logrotate</code> باید توسط همگان قابل خواندن باشند، بخصوص AWStats. در نمونه بالا، اینکار با خط <code
                class="literal">create 644 root adm</code> تضمین شده است (بجای مجوزهای پیشفرض <code
                class="literal">640</code>).
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="network-services.html"><strong>قبلی</strong>
      فصل 11. سرویس‌های شبکه: Postfix، Apache، N...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>بالا</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>خانه</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.ftp-file-server.html"><strong>بعدی</strong>11.3. سرور فایل FTP</a></li></ul></body></html>
