<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
]>
<chapter id="existing-setup" lang="fa-IR">
	<chapterinfo>
		 <keywordset>
			<keyword>پیکربندی موجود</keyword>
			 <keyword>استفاده مجدد</keyword>
			 <keyword>مهاجرت</keyword>

		</keywordset>

	</chapterinfo>
	 <title>بررسی ابزار نصب‌شده موجود و مهاجرت</title>
	 <highlights> <para>
		بازبینی مجدد هر سامانه رایانه‌ای نیاز به در نظر گرفتن ابزار موجود در سامانه دارد. این امر، امکان استفاده مجدد از منابع موجود را فراهم می‌آورد و همکاری بین قسمت‌های مختلف یک سامانه را تسهیل می‌بخشد. این مطالعه یک چارچوب عمومی برای مهاجرت زیرساخت محاسباتی موجود بر روی لینوکس را معرفی می‌کند.
	</para>
	 </highlights> <section id="sect.heterogeneous-environments">
		<title>همزیستی در محیط‌های ناهمگون</title>
		 <indexterm>
			<primary>محیط</primary>
			<secondary>محیط ناهمگون</secondary>
		</indexterm>
		 <para>
			دبیان در تمام محیط‌های موجود به خوبی ادغام شده و به راحتی با تمام سیستم عامل‌ها ارتباط برقرار می‌کند. این هارمونی نسبتاً کامل از فشار بازار روی تولیدکنندگان نرم‌افزار ناشی می‌شود که آن‌ها را مجبور به استفاده از استانداردهای خاصی می‌نماید. انطباق با استانداردها به مدیران این امکان را می‌دهد که برنامه‌های گوناگون را تعویض کنند: سمت کاربر یا سمت سرور، آزاد یا غیر آزاد.
		</para>
		 <section>
			<title>ادغام با ماشین‌های ویندوز</title>
			 <para>
				پشتیبانی سامبا از SMB/CIFS ارتباط عالی در یک محیط ویندوزی را تضمین می‌کند. این ابزار، فایل‌ها و چاپگرها را در اختیار کاربران ویندوز می‌گذارد و شامل نرم‌افزاری است که به یک ماشین لینوکس اجازه می‌دهد تا از منابع موجود در یک سرور ویندوز استفاده نماید.
			</para>
			 <sidebar> <title><emphasis>ابزار</emphasis> Samba</title>
			 <indexterm>
				<primary>Samba</primary>
			</indexterm>
			 <para>
				آخرین نسخه از سامبا می‌تواند اکثر قابلیت‌های ویندوز را جایگزین نماید: از قابلیت‌های ساده سرور ویندوز NT گرفته (احراز هویت، فایل‌ها، چاپگرها، دانلود درایور چاپگر‌ها و ...) تا پیشرفته‌ترین آن‌ها (کنترلر دامنه سازگار با اکتیو دایرکتوری).
			</para>
			 </sidebar>
		</section>
		 <section>
			<title>ادغام با ماشین‌های OS X</title>
			 <indexterm>
				<primary>Zeroconf</primary>
			</indexterm>
			 <indexterm>
				<primary>Bonjour</primary>
			</indexterm>
			 <indexterm>
				<primary>Avahi</primary>
			</indexterm>
			 <para>
				ماشین‌های OS X امکان استفاده و اشتراک‌گذاری خدمات شبکه مانند سرورهای فایل و چاپگر را فراهم می‌کنند. این خدمات در شبکه محلی انتشار می‌یابند که به سایر ماشین‌ها اجازه می‌دهد بدون تنظمیات جداگانه خاصی از آن‌ها استفاده نمایند، با استفاده از پیاده‌سازی Bonjour از بسته پروتکل Zeroconf. دبیان نیز شامل یک پیاده‌سازی دیگر از آن به نام Avahi است که تقریباً همان قابلیت‌ها را در اختیار می‌گذارد.
			</para>
			 <indexterm>
				<primary>AFP</primary>
			</indexterm>
			 <indexterm>
				<primary>AppleShare</primary>
			</indexterm>
			 <para>
				در جهت دیگر، Netatalk امکان استفاده از سرورهای فایل را به ماشین‌های OS X در شبکه می‌دهد. این ابزار، پروتکل AppleShare را پیاده‌سازی می‌کند به همراه اطلاعات مورد نیاز برای شناسانده شدن این سرورها به ماشین‌های OS X.
			</para>
			 <indexterm>
				<primary>AppleTalk</primary>
			</indexterm>
			 <para>
				شبکه‌های قدیمی‌تر Mac OS (قبل از OS X) از پروتکل دیگری بنام AppleTalk استفاده می‌کردند. برای محیط‌هایی که شامل ماشین‌های استفاده‌کننده از این پروتکل است، Netatalk همچنین شامل پروتکل AppleTalk نیز می‌شود (در حقیقت، به عنوان یک پیاده‌سازی مجدد از آن). این پیاده‌سازی، عملکرد صحیح سرور فایل و چاپگر را تضمین می‌کند، همچنین سرور زمان (همگام‌سازی ساعت). تابع مسیریاب آن امکان ارتباط داخلی با شبکه‌های AppleTalk را می‌دهد.
			</para>

		</section>
		 <section>
			<title>ادغام با سایر ماشین‌های لینوکس/یونیکس</title>
			 <para>
				در نهایت، NFS و NIS ارتباط با سایر سامانه‌های یونیکس را تضمین می‌کنند. اولی عملکرد فایل سرور را تضمین می‌کند، در حالی که دومی به ساخت دایرکتوری برای کاربران می‌پردازد. لایه چاپ در BSD، که توسط اکثر سامانه‌های یونیکس استفاده می‌شود، امکان به اشتراک‌گذاری چاپگر را می‌دهد.
			</para>
			 <figure>
				<title>همزیستی دبیان با سامانه‌های OS X، ویندوز و یونیکس</title>
				 <mediaobject>
					<imageobject>
						<imagedata fileref="images/existing-setup-1.png" format="PNG" width="25%" />
					</imageobject>

				</mediaobject>

			</figure>

		</section>

	</section>
	 <section id="sect.how-to-migrate">
		<title>چگونگی مهاجرت</title>
		 <indexterm>
			<primary>مهاجرت</primary>
		</indexterm>
		 <para>
			به منظور تضمین ادامه این خدمات، مهاجرت هر رایانه باید با برنامه‌ریزی و زمان‌بندی طبق طرح اصلی باشد. این اصول اولیه در مورد هر سیستم عاملی صدق می‌کند.
		</para>
		 <section>
			<title>نظرسنجی و شناسایی خدمات</title>
			 <para>
				این گام با اینکه ساده به نظر می‌رسد، اما ضروری است. یک مدیر سیستم جدی نقش تمام سرورهای تحت کنترلش را می‌داند، اما این نقش‌ها می‌توانند تغییر یابند و گاهی اوقات کاربران باتجربه ممکن است خدمات “عجیب و غریب” را اضافه کنند. اطلاع از وجود این خدمات به شما اجازه تصمیم‌گیری می‌دهد تا اینکه به طور اتفاقی همه را پاک کنید.
			</para>
			 <para>
				به همین منظور، بهتر است که کاربران خود را قبل از مهاجرت آگاه سازید. برای مشارکت آن‌ها در پروژه، نصب اکثر برنامه‌های آزاد روی میزکارشان قبل از مهاجرت کار خوبی بنظر می‌رسد، برنامه‌هایی که بعداً با آن‌ها سر و کار خواهند داشت پس از مهاجرت به دبیان؛ بهترین نمونه‌ها عبارتند از لیبره آفیس و مجموعه موزیلا.
			</para>
			 <section>
				<title>شبکه و فرآیندها</title>
				 <indexterm>
					<primary><command>nmap</command></primary>
				</indexterm>
				 <para>
					ابزار <command>nmap</command> (در بسته‌ای با همین نام) به سرعت سرویس‌ها اینترنتی موجود در یک شبکه توسط ماشین‌های مختلف را شناسایی می‌کند بدون آنکه نیاز باشد به این ماشین‌ها وارد شویم. تنها کافی است دستور زیر را روی ماشین دیگری از همان شبکه اجرا کنید:
				</para>
				 
<screen>
<computeroutput>$ </computeroutput><userinput>nmap mirwiz</userinput>
<computeroutput>Starting Nmap 6.47 ( http://nmap.org ) at 2015-03-24 11:34 CET
Nmap scan report for mirwiz (192.168.1.104)
Host is up (0.0037s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
22/tcp open  ssh

Nmap done: 1 IP address (1 host up) scanned in 0.13 seconds</computeroutput></screen>
				 <sidebar> <title><emphasis>جایگزین</emphasis> از <command>netstat</command> برای جستجوی فهرستی از سرویس‌های موجود استفاده کنید</title>
				 <para>
					در یک ماشین لینوکس، دستور <command>netstat -tupan</command> فهرستی از اتصال‌های فعال یا غیرفعال TCP را نمایش می‌دهد، به همراه پورت‌های UDP که روی آن‌ها برنامه‌ها در انتظار دریافت داده هستند. این ابزار، به شناسایی سرویس‌ها ارائه شده در شبکه کمک بسیاری می‌کند.
				</para>
				 </sidebar> <sidebar> <title><emphasis>مطالعه بیشتر</emphasis> IPv6</title>
				 <para>
					برخی دستورات شبکه ممکن است تنها با IPv4 (گزینه پیش‌فرض) یا IPv6 کار کنند که از میان آن‌ها می‌توان به دستورات <command>nmap</command> و <command>netstat</command> اشاره کرد، اما دستورات دیگر نیز مانند <command>route</command> یا <command>ip</command> این قابلیت را دارند. قرارداد اولیه این است که این قابلیت با استفاده از گزینه خط‌فرمان <parameter>-6</parameter> فعال می‌شود.
				</para>
				 </sidebar> <para>
					اگر سرور یک ماشین یونیکس باشد که حساب‌کاربری شل در اختیار کاربرانش می‌گذارد، شناسایی اینکه فرآیندها در پیش‌زمینه در غیاب مالکشان اجرا می‌شوند، امر جالبی است. دستور <command>ps auxw</command> فهرستی از تمام فرآیندها به همراه هویت کاربرشان ارائه می‌دهد. با بررسی اطلاعات خروجی با دستور <command>who</command>، که فهرستی از کاربران وارد شده را نمایش می‌دهد، شناسایی سرورها و برنامه‌هایی که بدون نام در پیش‌زمینه اجرا شده‌اند، ممکن می‌شود. نگاهی بر <filename>crontabs</filename> (جدولی که رویدادهای خودکار را در بازه‌ای از زمان برای کاربر اجرا می‌کند) معمولاً اطلاعات جالبی در شیوه استفاده از سرور در اختیار می‌گذارد (توضیح کامل <command>cron</command> در <xref linkend="sect.task-scheduling-cron-atd" /> موجود است).
				</para>
				 <para>
					در هر صورت، پشتیبان‌گیری از سرور امری ضروری است: این عملیات امکان بازیابی اطلاعات سرور پس از یک گزارش بروز مشکل در عملیات مهاجرت را فراهم می‌سازد.
				</para>

			</section>

		</section>
		 <section>
			<title>پشتیبان‌گیری از فایل‌های پیکربندی</title>
			 <para>
				منطقی است که از فایل‌های پیکربندی سرویس موجود که قصد جایگزین کردن آن با سرویس جدیدی را داریم، پشتیبان تهیه کنیم. حداقل می‌توان یک کپی از تمام فایل‌های پیکربندی برای هر سرویس را تهیه کرد.
			</para>
			 <para>
				برای ماشین‌های یونیکس، فایل‌های پیکربندی معمولاً در مسیر <filename>/etc/</filename> قرار دارند، اما ممکن است در یک زیرمجموعه از <filename>/usr/local/</filename> نیز قرار بگیرند. این مورد از برنامه‌هایی که مستقیماً از سورس کامپایل می‌شوند صدق می‌کند، جدای از بسته‌های موجود. در بعضی موارد، ممکن است این فایل‌ها را در <filename>/opt/</filename> نیز پیدا کنید.
			</para>
			 <para>
				برای سرویس‌هایی که با مدیریت داده سروکار دارند (مانند پایگاه‌داده‌ها)، به شدت توصیه می‌شود که تمام داده موجود در یک قالب استاندارد که توسط نرم‌افزار جدید خوانده خواهد شد، خروجی گرفته شود. چنین قالبی معمولاً به صورت متنی و مستندسازی شده است؛ برای نمونه، ممکن است یک فایل SQL از پایگاه‌داده یا یک فایل LDIF از سرور LDAP باشد.
			</para>
			 <figure>
				<title>پشتیبان‌گیری از پایگاه‌داده</title>
				 <mediaobject>
					<imageobject>
						<imagedata fileref="images/existing-setup-2.png" format="PNG" width="50%" />
					</imageobject>

				</mediaobject>

			</figure>
			 <para>
				هر نرم‌افزار سرور متفاوت است و عملاً ممکن نیست که بتوان به تمام جزیئات این نرم‌افزارها اشاره کرد. به مستندات نرم‌افزار موجود و جدید جهت درک درستی از قالب‌های استاندارد ورودی و خروجی مراجعه کنید و آن‌هایی که نیاز به تغییرات دستی دارند. مطالعه این کتاب پیکربندی برنامه‌های اصلی سرور در لینوکس را برای شما روشن می‌سازد.
			</para>

		</section>
		 <section>
			<title>سازوکار در اختیار گرفتن یک سرور دبیان موجود</title>
			 <indexterm>
				<primary>بازیابی یک ماشین دبیان</primary>
			</indexterm>
			 <indexterm>
				<primary>کاوش یک ماشین دبیان</primary>
			</indexterm>
			 <indexterm>
				<primary>بر عهده گرفتن یک سرور دبیان</primary>
			</indexterm>
			 <para>
				برای نگهداری موثر آن، کسی ممکن است ماشین موجود که دبیان روی آن نصب شده است را تحلیل کند.
			</para>
			 <para>
				اولین فایلی که باید بررسی شود <filename>/etc/debian_version</filename> است، که معمولاً نسخه دبیان نصب شده روی سیستم را نشان می‌دهد (که جزو بسته <emphasis>base-files</emphasis> است). اگر نشانه‌هایی از <literal><replaceable>codename</replaceable>/sid</literal> بود بدین معنی است که سیستم با استفاده از بسته‌های موجود در توزیع در حال توسعه (خواه تحت‌آزمون یا ناپایدار) بروزرسانی شده است.
			</para>
			 <para>
				برنامه <command>apt-show-versions</command> (از بسته دبیان با همین نام) فهرست بسته‌های نصب شده را بررسی کرده و نسخه‌های موجود را شناسایی می‌کند. برای این منظور، از <command>aptitude</command> نیز می‌توان استفاده کرد، البته به شکل دیگری.
			</para>
			 <para>
				نگاهی بر فایل <filename>/etc/apt/sources.list</filename> (و دایرکتوری <filename>/etc/apt/sources.list.d/</filename>) نشان می‌دهد که بسته‌های نصب شده از چه منبعی می‌آیند. اگر منابع نامشخص فراوانی در این فایل وجود داشت، مدیر سیستم می‌تواند سیستم را از دوباره نصب کرده تا با اینکار حداکثر سازگاری نرم‌افزاری با دبیان را ممکن سازد.
			</para>
			 <para>
				فایل <filename>/sources.list</filename> یک نشانگر خوب است: اکثر مدیر سیستم‌ها، به صورت توضیحات متنی، فهرستی از منابع APT که در گذشته استفاده می‌کردند را در آن ذخیره می‌کنند. اما نباید فراموش کنید که منابع گذشته ممکن است حذف شده باشند، و بسته‌های دلخواهی که به صورت دستی از اینترنت دریافت شده‌اند، ممکن است روی سیستم نصب باشند (با استفاده از دستور <command>dpkg</command>). در این مورد، ماشین از هدف اصلی در “استاندارد” دبیان دور شده است. اینجاست که باید به هر نشانه از وجود بسته‌های خارج از سیستم دبیان توجه کنید (وجود فایل‌های <filename>deb</filename> در مسیرهای نامتعارف، شماره نسخه‌ بسته با یک پسوند اضافی نشانگر وجود بسته از جارج از چارچوب دبیان می‌دهد مانند <literal>ubuntu</literal> یا <literal>lmde</literal>).
			</para>
			 <para>
				در همین راستا، بررسی محتوای دایرکتوری <filename>/usr/local/</filename> نیز جالب بنظر می‌رسد، که هدفش نگهداری از برنامه‌هایی است که به صورت دستی کامپایل و نصب شده‌اند. فهرست نرم‌افزارهای نصب‌شده در این روش آموزنده است، چراکه نشان می‌دهد چرا از بسته‌های موجود در سیستم دبیان استفاده نشده است، اگر چنین بسته‌ای وجود داشته باشد.
			</para>
			 <sidebar> <title><emphasis>نگاه سریع</emphasis> <emphasis role="pkg">cruft</emphasis></title>
			 <para>
				بسته <emphasis role="pkg">cruft</emphasis> فهرستی از فایل‌های موجود که در اختیار هیچ بسته‌ای نیستند را نمایش می‌دهد. شامل فیلترهایی است (کم و بیش موثر و بروز) که فایل‌های اصلی سیستم را گزارش نکند (فایل‌هایی که توسط بسته‌های دبیان ایجاد می‌گردند، یا فایل‌های پیکربندی که توسط <command>dpkg</command> مدیریت نمی‌شوند و از این قبیل).
			</para>
			 <para>
				مواظب باشید که هر فایل گزارش شده توسط <command>cruft</command> را ندانسته پاک نکنید!
			</para>
			 </sidebar>
		</section>
		 <section>
			<title>نصب دبیان</title>
			 <para>
				زمانی که تمام اطلاعات مورد نیاز درباره سرور کنونی بدست آمد، می‌توانیم آن را خاموش کرده و فرآیند نصب دبیان را أغاز نماییم.
			</para>
			 <indexterm>
				<primary>معماری</primary>
			</indexterm>
			 <para>
				برای انتخاب نسخه مناسب، باید از معماری رایانه خبر داشته باشیم. اگر یک رایانه رومیزی استاندارد است، به احتمال زیاد از amd64 (یا i386 برای سیستم‌های قدیمی‌تر) استفاده می‌کند. در سایر موارد، احتمالات موجود را می‌توان با استفاده از سیستم قبلی بدست آورد.
			</para>
			 <para>
				... کامل نیست ولی ممکن است بدرد بخورد. در هر صورت، مستندات رسمی موجود با رایانه، قابل اطمینان‌ترین منبع برای کسب این اطلاعات است.
			</para>
			 <table colsep="1" id="tab-corresp">
				<title>سازگاری سیستم عامل با معماری</title>
				 <tgroup cols="2">
					<thead>
						<row>
							<entry>سیستم عامل</entry>
							 <entry>معماری(ها)</entry>

						</row>

					</thead>
					 <tbody>
						<row>
							<entry>DEC Unix (OSF/1)</entry>
							 <entry>alpha, mipsel</entry>

						</row>
						 <row>
							<entry>HP Unix</entry>
							 <entry>ia64, hppa</entry>

						</row>
						 <row>
							<entry>IBM AIX</entry>
							 <entry>powerpc</entry>

						</row>
						 <row>
							<entry>Irix</entry>
							 <entry>mips</entry>

						</row>
						 <row>
							<entry>OS X</entry>
							 <entry>amd64, powerpc, i386</entry>

						</row>
						 <row>
							<entry>z/OS, MVS</entry>
							 <entry>s390x, s390</entry>

						</row>
						 <row>
							<entry>Solaris, SunOS</entry>
							 <entry>sparc, i386, m68k</entry>

						</row>
						 <row>
							<entry>Ultrix</entry>
							 <entry>mips</entry>

						</row>
						 <row>
							<entry>VMS</entry>
							 <entry>alpha</entry>

						</row>
						 <row>
							<entry>Windows 95/98/ME</entry>
							 <entry>i386</entry>

						</row>
						 <row>
							<entry>Windows NT/2000</entry>
							 <entry>i386, alpha, ia64, mipsel</entry>

						</row>
						 <row>
							<entry>Windows XP / Windows Server 2008</entry>
							 <entry>i386, amd64, ia64</entry>

						</row>
						 <row>
							<entry>Windows Vista / Windows 7 / Windows 8</entry>
							 <entry>i386, amd64</entry>

						</row>

					</tbody>

				</tgroup>

			</table>
			 <sidebar> <title><emphasis>سحت‌افزار</emphasis> رایانه ۶۴ بیت در مقابل ۳۲ بیت</title>
			 <indexterm>
				<primary>amd64</primary>
			</indexterm>
			 <indexterm>
				<primary>i386</primary>
			</indexterm>
			 <para>
				اکثر رایانه‌های جدید دارای پردازنده‌های ۶۴ بیتی Intel یا AMD هستند که با پردازنده‌های قدیمی‌تر ۳۲ بیت سازگاری دارند؛ بنابراین نرم‌افزاری که برای “i386” کامپایل می‌شود روی آن‌ها قابل اجرا است. از طرف دیگر، این حالت سازگاری، به تمام قابلیت‌های موجود در این پردازنده‌های جدید دسترسی ندارد. این همان دلیلی است که دبیان معماری “amd64” را فراهم کرده است، که برای پردازنده‌های اخیر AMD و پردازنده‌های “em64t” از Intel کار می‌کند (که شامل اکثر خانواده Core می‌شود)، که شباهت بسیاری به AMD64 دارند.
			</para>
			 </sidebar>
		</section>
		 <section>
			<title>نصب و پیکربندی سرویس‌های انتخاب شده</title>
			 <para>
				زمانی که دبیان نصب می‌شود، باید تک به تک تمام سرویس‌هایی که این رایانه از آن‌ها میزبانی می‌کند را نصب و پیکربندی کنیم. پیکربندی جدید باید بر اساس نیازهای موجود در پیکربندی سابق صورت گیرد تا فرآیند مهاجرت آسان‌تر دنبال شود. تمام اطلاعاتی که در گام‌های قبل جمع‌آوری گردیده‌اند برای ببا موفقیت اجرا کردن این قسمت، کاربردی خواهند بود.
			</para>
			 <figure>
				<title>نصب سرویس‌های انتخاب شده</title>
				 <mediaobject>
					<imageobject>
						<imagedata fileref="images/existing-setup-4.png" format="PNG" width="66%" />
					</imageobject>

				</mediaobject>

			</figure>
			 <para>
				قبل از ورود به این تمرین، به شدت توصیه می‌شود که باقی کتاب را بخوانید. پس از مطالعه آن است که می‌توانید به درک درستی از چگونگی پیکربندی سرویس‌های مورد نیاز دست یابید.
			</para>
			 <para>
			</para>

		</section>

	</section>
</chapter>

