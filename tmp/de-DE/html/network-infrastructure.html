<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">Kapitel 10. Netzwerk-Infrastruktur</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-de-DE-1.0-1" /><meta
        name="keywords"
        content="Netzwerk, Gateway, TCP/IP, IPv6, DNS, Bind, DHCP, QoS" /><link
        rel="home"
        href="index.html"
        title="Das Debian Administrationshandbuch" /><link
        rel="up"
        href="index.html"
        title="Das Debian Administrationshandbuch" /><link
        rel="prev"
        href="sect.power-management.html"
        title="9.12. Modernes Energiemanagement: Advanced Configuration and Power Interface (ACPI)" /><link
        rel="next"
        href="sect.virtual-private-network.html"
        title="10.2. Virtual Private Network" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/de-DE/stable/network-infrastructure.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>Zurück</strong></a></li><li
          class="home">Das Debian Administrationshandbuch</li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>Weiter</strong></a></li></ul><div
        xml:lang="de-DE"
        class="chapter"
        lang="de-DE"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  xmlns=""
                  id="network-infrastructure"></a>Kapitel 10. Netzwerk-Infrastruktur</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="network-infrastructure.html#sect.gateway">10.1. Gateway</a></span></dt><dt><span
                class="section"><a
                  href="sect.virtual-private-network.html">10.2. Virtual Private Network</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.openvpn">10.2.1. OpenVPN</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ssh-vpn">10.2.2. Virtual Private Network mit SSH</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.ipsec">10.2.3. IPsec</a></span></dt><dt><span
                    class="section"><a
                      href="sect.virtual-private-network.html#sect.pptp">10.2.4. PPTP</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.quality-of-service.html">10.3. Quality of Service</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-principe">10.3.1. Prinzip und Mechanismus</a></span></dt><dt><span
                    class="section"><a
                      href="sect.quality-of-service.html#sect.qos-config">10.3.2. Konfigurieren und Ausführen</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dynamic-routing.html">10.4. Dynamisches Routing</a></span></dt><dt><span
                class="section"><a
                  href="sect.ipv6.html">10.5. IPv6</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.ipv6.html#sect.ipv6-tunneling">10.5.1. Tunneln</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.domain-name-servers.html">10.6. Domain Name Server (DNS)</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-principe">10.6.1. Prinzip und Mechanismus</a></span></dt><dt><span
                    class="section"><a
                      href="sect.domain-name-servers.html#sect.dns-config">10.6.2. Konfigurieren</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.dhcp.html">10.7. DHCP</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-config">10.7.1. Konfigurieren</a></span></dt><dt><span
                    class="section"><a
                      href="sect.dhcp.html#sect.dhcp-dns">10.7.2. DHCP und DNS</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.network-diagnosis-tools.html">10.8. Werkzeuge für die Netzwerk-Diagnose</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.netstat">10.8.1. Lokale Diagnose: <code
                        class="command">netstat</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.nmap">10.8.2. Entfernte Diagnose: <code
                        class="command">nmap</code></a></span></dt><dt><span
                    class="section"><a
                      href="sect.network-diagnosis-tools.html#sect.sniffers">10.8.3. Netzwerk-Sniffer: <code
                        class="command">tcpdump</code> und <code
                        class="command">wireshark</code></a></span></dt></dl></dd></dl></div><div
          class="highlights"><div
            class="para">
		Linux stellt das ganze Unixerbe an Netzwerkfunktionalität zur Verfügung und Debian bietet einen kompletten Satz an Werkzeugen, um ein Netzwerk aufzubauen und zu verwalten. In diesem Kapitel werden diese Werkzeuge besprochen.
	</div></div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    xmlns=""
                    id="sect.gateway"></a>10.1. Gateway</h2></div></div></div><div
            class="para">
			Ein Gateway ist ein System, das mehrere Netzwerke verbindet. Dieser Ausdruck bezieht sich häufig auf den "Ausgang" eines lokalen Netzwerks auf dem vorgeschriebenen Pfad zu externen IP-Adressen. Das Gateway ist mit jedem der Netzwerke verbunden, die es verbindet, und routet IP-Pakete zwischen verschiedenen Schnittstellen.
		</div><a
            id="id-1.13.4.3"
            class="indexterm"></a><a
            id="id-1.13.4.4"
            class="indexterm"></a><a
            id="id-1.13.4.5"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ZURÜCK ZU DEN GRUNDLAGEN</em></span> IP-Paket</strong></p></div></div></div><a
              id="id-1.13.4.6.2"
              class="indexterm"></a><div
              class="para">
			Die meisten Netzwerke nutzen heute das IP-Protokoll (<span
                class="emphasis"><em>Internet-Protocol</em></span>). Dieses Protokoll unterteilt die gesendeten Daten in kleine Pakete. Jedes Paket enthält neben den Daten auch noch Hinweise zur korrekten Übertragung.
		</div></div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.tcp-udp"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ZURÜCK ZU DEN GRUNDLAGEN</em></span> TCP/UDP</strong></p></div></div></div><a
              id="id-1.13.4.7.2"
              class="indexterm"></a><a
              id="id-1.13.4.7.3"
              class="indexterm"></a><a
              id="id-1.13.4.7.4"
              class="indexterm"></a><a
              id="id-1.13.4.7.5"
              class="indexterm"></a><div
              class="para">
			Viele Programme verarbeiten die individuellen Pakete nicht selbst, auch wenn sie die Daten per IP übertragen. Sie nutzen oft TCP (<span
                class="emphasis"><em>Transmission Control Protocol/Transport Kontroll Protokoll</em></span>). TCP ist eine Schicht über IP, um Datenströme zwischen zwei Punkten zu ermöglichen. Programme sehen nur einen Eingang in den sie ihre Daten senden können, das die gleichen Daten garantiert ohne Verlust (und in der gleichen Reihenfolge) am Ende der Verbindung ankommen. Obwohl viele verschiedene Fehler in den unteren Schichten auftreten können, regelt das TCP die erneute Versendung verlorener Pakete; Pakete welche in falscher Reihenfolge ankommen (z. B. wegen verschiedener Pfade) werden in der richtigen Reihenfolge ausgegeben.
		</div><div
              class="para">
			Ein weiteres auf IP aufbauendes Protokoll ist UDP(<span
                class="emphasis"><em>User Datagram Protocol</em></span>). Im Gegensatz zu TCP ist es paketorientiert. Es wird ein anderes Ziel verfolgt: Es sendet ein Paket von einer Anwendung zu einer Anderen. Das Protokoll kümmert sich nicht um verlorene Pakete oder die Reihenfolge der Pakete. Der Hauptvorteil ist die sehr niedrige Latenz, ein verlorenes Paket hält den Datenstrom nicht auf bis dieses wieder übertragen wird.
		</div><div
              class="para">
			TCP und UDP nutzen Ports, das sind "Erweiterungs Nummern" um Verbindungen mit einer Anwendung der Maschine herzustellen. Dieses Konzept erlaubt es verschiedene Verbindungen mit einem Partner aufzubauen, da man diese Verbindungen anhand der Port-Nummer unterscheiden kann.
		</div><div
              class="para">
			Einige dieser Port-Nummern — standardisiert durch die IANA (<span
                class="emphasis"><em>Internet Assigned Numbers Authority</em></span>) — sind "well-known/gut bekannt" wegen der Netzwerkdienste welche üblicherweise dort laufen. TCP-Port 25 wird zum Beispiel meistens von Mail-Servern genutzt.<div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.iana.org/assignments/port-numbers">http://www.iana.org/assignments/port-numbers</a></div>
		</div></div><div
            class="para">
			Wenn ein lokales Netzwerk einen privaten Adressbereich verwendet (im Internet nicht erreichbar), muss das Gateway <span
              class="emphasis"><em>Addressen-Masquerading</em></span> anwenden, damit die Rechner im Netzwerk mit der Außenwelt kommunizieren können. Das Masquerading ist eine Art Proxy-Verfahren auf Netzwerk-Ebene: Jede von einem internen Rechner ausgehende Verbindung wird durch eine Verbindung vom Gateway selbst ersetzt (da das Gateway eine externe, erreichbare Adresse hat). Durch die maskierte Verbindung gehende Daten werden an die neue Adresse gesendet; Antwortdaten werden durch die maskierte Verbindung an den internen Rechner geschickt. Das Gateway verwendet eine Reihe fest zugeordneter TCP-Ports, gewöhnlich mit sehr hohen Nummern (über 60000). Jede von einem internen Rechner kommende Verbindung erscheint der Außenwelt dann so, als käme sie von einem dieser reservierten Ports.
		</div><a
            id="id-1.13.4.9"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CULTURE</em></span> Privater Addressbereich</strong></p></div></div></div><a
              id="id-1.13.4.10.2"
              class="indexterm"></a><a
              id="id-1.13.4.10.3"
              class="indexterm"></a><div
              class="para">
			RFC 1918 definiert drei IPv4-Adressbereiche, die nicht im Internet geroutet werden, sondern nur in lokalen Netzwerken. Das erste Netz, <code
                class="literal">10.0.0.0/8</code> (siehe Seitenleiste <a
                class="xref"
                href="sect.network-config.html#sidebar.networking-basics"><span
                  class="emphasis"><em>ZURÜCK ZU DEN GRUNDLAGEN</em></span> Wesentliche Netzwerkkonzepte (Ethernet, IP-Adresse, Subnetz, Broadcast)</a>), ist ein Klasse-A Bereich (mit 2<sup>24</sup> IP-Adressen). Das Zweite, <code
                class="literal">172.16.0.0/12</code>, enthält 16 Klasse-B Bereiche (<code
                class="literal">172.16.0.0/16</code> bis <code
                class="literal">172.31.0.0/16</code>), mit jeweils 2<sup>16</sup> IP-Adressen. <code
                class="literal">192.168.0.0/16</code> ist schließlich ein Klasse-B Bereich (der 256 Klasse-C Bereiche, <code
                class="literal">192.168.0.0/24</code> bis <code
                class="literal">192.168.255.0/24</code>, mit jeweils 256 IP-Adressen zusammenschließt). <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc1918.html">http://www.faqs.org/rfcs/rfc1918.html</a></div>
		</div></div><div
            class="para">
			Das Gateway kann auch zwei Arten von <span
              class="emphasis"><em>Network Address Translation</em></span> (oder kurz NAT genannt) durchführen. Die erste Art, <span
              class="emphasis"><em>Destination NAT</em></span> (DNAT), ist ein Verfahren zur Änderung der Ziel-IP-Adresse (oder des TCP- beziehungsweise UDP-Ports) für eine (gewöhnlich) ankommende Verbindung. Der Mechanismus zur Verbindungsverfolgung ändert auch die innerhalb derselben Verbindung nachfolgenden Pakete, um Kontinuität in der Kommunikation sicherzustellen. Die zweite Art des NAT ist <span
              class="emphasis"><em>Source NAT</em></span> (SNAT), bei dem das <span
              class="emphasis"><em>Masquerading</em></span> ein besonderer Fall ist; SNAT ändert die Ausgangs-IP-Adresse (oder den TCP- beziehungsweise UDP-Port) einer (gewöhnlich) abgehenden Verbindung. Wie beim DNAT werden alle Pakete innerhalb der Verbindung durch den Verbindungsverfolgungsmechanismus behandelt. Beachten Sie, dass NAT nur für IPv4 und seinen begrenzten Adressraum gültig ist; bei IPv6 vermindert die groSZe Anzahl von Adressen den Nutzen des NAT erheblich, da es zulässt, dass alle "internen" Adressen direkt ins Internet geleitet werden (dies bedeutet nicht, dass interne Rechner zugänglich sind, da dazwischenliegende Firewalls den Datenverkehr filtern können).
		</div><a
            id="id-1.13.4.12"
            class="indexterm"></a><a
            id="id-1.13.4.13"
            class="indexterm"></a><a
            id="id-1.13.4.14"
            class="indexterm"></a><a
            id="id-1.13.4.15"
            class="indexterm"></a><a
            id="id-1.13.4.16"
            class="indexterm"></a><a
            id="id-1.13.4.17"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ZURÜCK ZU DEN GRUNDLAGEN</em></span> Port-Weiterleitung</strong></p></div></div></div><a
              id="id-1.13.4.18.2"
              class="indexterm"></a><div
              class="para">
			Eine konkrete Anwendung von DNAT ist <span
                class="emphasis"><em>port forwarding</em></span>. Ankommende Verbindungen eines bestimmten Ports einer Maschine werden zu einem Port einer anderen Maschine weitergeleitet. Andere Lösungen erzielen ähnliche Ergebnisse, auf Anwendungsebene insbesondere <code
                class="command">ssh</code> (siehe <a
                class="xref"
                href="sect.remote-login.html#sect.ssh-port-forwarding">Abschnitt 9.2.1.3, „Verschlüsselte Tunnel mit Port-Weiterleitung einrichten“</a>) oder <code
                class="command">redir</code>.
		</div></div><div
            class="para">
			Genug der Theorie. Um aus einem Debian-System ein Gateway zu machen, genügt es die passende Option im Linux-Kernel zu aktivieren. Dies geschieht im virtuellen <code
              class="filename">/proc/</code>-Verzeichnis:
		</div><pre
            class="screen">
<code
              class="computeroutput"># </code><strong
              class="userinput"><code>echo 1 &gt; /proc/sys/net/ipv4/conf/default/forwarding</code></strong></pre><div
            class="para">
			Diese Option kann automatisch beim Booten gesetzt werden, wenn man in <code
              class="filename">/etc/sysctl.conf</code> die Option <code
              class="literal">net.ipv4.conf.default.forwarding</code> auf <code
              class="literal">1</code> setzt.
		</div><div
            class="example"><a
              xmlns=""
              id="example.sysctl.conf"></a><p
              class="title"><strong>Beispiel 10.1. Die Datei <code
                  class="filename">/etc/sysctl.conf</code></strong></p><div
              class="example-contents"><pre
                class="programlisting">
net.ipv4.conf.default.forwarding = 1
net.ipv4.conf.default.rp_filter = 1
net.ipv4.tcp_syncookies = 1</pre></div></div><div
            class="para">
			Derselbe Effekt kann für IPv6 durch einfaches Ersetzen von <code
              class="literal">ipv4</code> durch <code
              class="literal">ipv6</code> im manuellen Befehl und durch Verwendung der Zeile <code
              class="literal">net.ipv6.conf.all.forwarding</code> in <code
              class="filename">/etc/sysctl.conf</code> erreicht werden.
		</div><div
            class="para">
			Die Konfiguration von IPv4-Masquerading ist etwas schwieriger, und schließt die Konfiguration der <span
              class="emphasis"><em>netfilter</em></span>-Firewall ein.
		</div><div
            class="para">
			Auch NAT (für IPv4) erfordert die Konfiguration von <span
              class="emphasis"><em>netfilter</em></span>. Da der Hauptzweck dieser Komponente im Filtern von Paketen besteht, sind die Einzelheiten in <a
              class="xref"
              href="security.html">Kapitel 14: „<em>Sicherheit</em>“</a> aufgeführt (siehe <a
              class="xref"
              href="sect.firewall-packet-filtering.html">Abschnitt 14.2, „Firewall oder Paketfilter“</a>).
		</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.power-management.html"><strong>Zurück</strong>9.12. Modernes Energiemanagement: Advanced Config...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Nach oben</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Zum Anfang</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.virtual-private-network.html"><strong>Weiter</strong>10.2. Virtual Private Network</a></li></ul></body></html>
