<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.5. Einrichten von Windows-Freigaben mit Samba</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-de-DE-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="Das Debian Administrationshandbuch" /><link
        rel="up"
        href="network-services.html"
        title="Kapitel 11. Network Services: Postfix, Apache, NFS, Samba, Squid, LDAP, SIP, XMPP, TURN" /><link
        rel="prev"
        href="sect.nfs-file-server.html"
        title="11.4. NFS-Dateiserver" /><link
        rel="next"
        href="sect.http-ftp-proxy.html"
        title="11.6. HTTP/FTP-Proxy" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/de-DE/stable/sect.windows-file-server-with-samba.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.nfs-file-server.html"><strong>Zurück</strong></a></li><li
          class="home">Das Debian Administrationshandbuch</li><li
          class="next"><a
            accesskey="n"
            href="sect.http-ftp-proxy.html"><strong>Weiter</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.windows-file-server-with-samba"></a>11.5. Einrichten von Windows-Freigaben mit Samba</h2></div></div></div><div
          class="para">
			Samba ist ein Satz von Programmen, die das SMB-Protokoll (auch als „CIFS“ bekannt) auf Linux handhaben. Dieses Protokoll wird von Windows für Netzwerk-Freigaben und Netzwerkdrucker benutzt.
		</div><a
          id="id-1.14.8.3"
          class="indexterm"></a><a
          id="id-1.14.8.4"
          class="indexterm"></a><a
          id="id-1.14.8.5"
          class="indexterm"></a><a
          id="id-1.14.8.6"
          class="indexterm"></a><a
          id="id-1.14.8.7"
          class="indexterm"></a><div
          class="para">
			Samba kann auch als Domänencontroller unter Windows agieren. Es ist ein hervorragendes Instrument, um die nahtlose Integration von Linux-Servern und Arbeitsplatzrechnern, die noch unter Windows laufen, zu gewährleisten.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.8.9"></a>11.5.1. Samba-Server</h3></div></div></div><div
            class="para">
				The <span
              class="pkg pkg">samba</span> package contains the main two servers of Samba 4, <code
              class="command">smbd</code> and <code
              class="command">nmbd</code>.
			</div><a
            id="id-1.14.8.9.3"
            class="indexterm"></a><a
            id="id-1.14.8.9.4"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DOKUMENTATION</em></span> Weitere Schritte</strong></p></div></div></div><div
              class="para">
				The Samba server is extremely configurable and versatile, and can address a great many different use cases matching very different requirements and network architectures. This book only focuses on the use case where Samba is used as a standalone server, but it can also be a NT4 Domain Controller or a full Active Directory Domain Controller, or a simple member of an existing domain (which could be a managed by a Windows server).
			</div><a
              id="id-1.14.8.9.5.3"
              class="indexterm"></a><a
              id="id-1.14.8.9.5.4"
              class="indexterm"></a><div
              class="para">
				The <span
                class="pkg pkg">samba-doc</span> package contains a wealth of commented example files in <code
                class="filename">/usr/share/doc/samba-doc/examples/</code>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>HILFSPROGRAMM</em></span> Mit einem Windows-Server authentifizieren</strong></p></div></div></div><div
              class="para">
				Winbind gibt Systemadministratoren die Möglichkeit, einen Windows-Server als Authentifizierungsserver zu verwenden. Winbind integriert sich auch sauber in PAM und NSS. Dies ermöglicht es, Linux-Rechner so einzurichten, dass alle Benutzer einer Windows-Domäne automatisch ein Konto erhalten.
			</div><a
              id="id-1.14.8.9.6.3"
              class="indexterm"></a><div
              class="para">
				More information can be found in the <code
                class="filename">/usr/share/doc/samba-doc/examples/pam_winbind/</code> directory.
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.9.7"></a>11.5.1.1. Mit <code
                      class="command">debconf</code> konfigurieren</h4></div></div></div><div
              class="para">
					The package sets up a minimal configuration during the initial installation but you should really run <code
                class="command">dpkg-reconfigure samba-common</code> to adapt it:
				</div><div
              class="para">
					The first piece of required information is the name of the workgroup where the Samba server will belong (the answer is <code
                class="literal">FALCOTNET</code> in our case).
				</div><div
              class="para">
					Das Paket schlägt auch vor, den WINS-Server mithilfe der Information, die vom DHCP-Daemon bereitgestellt wird, zu identifizieren. Die Falcot Corp. Administratoren haben diese Option abgelehnt, da sie beabsichtigen, den Samba-Server selbst als WINS-Server zu verwenden.
				</div><a
              id="id-1.14.8.9.7.5"
              class="indexterm"></a></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.9.8"></a>11.5.1.2. Von Hand konfigurieren</h4></div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.14.8.9.8.2"></a>11.5.1.2.1. Änderungen in <code
                        class="filename">smb.conf</code></h5></div></div></div><div
                class="para">
						Aufgrund der Erfordernisse bei Falcot müssen weitere Optionen in der Konfigurationsdatei <code
                  class="filename">/etc/samba/smb.conf</code> angepasst werden. Die folgenden Auszüge fassen die Änderungen zusammen, die im Abschnitt <code
                  class="literal">[global]</code> vorgenommen wurden.
					</div><pre
                class="programlisting">
[global]

## Browsing/Identification ###

# Change this to the workgroup/NT-domain name your Samba server will part of
   workgroup = FALCOTNET

# Windows Internet Name Serving Support Section:
# WINS Support - Tells the NMBD component of Samba to enable its WINS Server
   wins support = yes <span
                  id="smb.conf.wins"><img
                    class="callout"
                    src="Common_Content/images/1.png"
                    alt="1" /></span>

[...]

####### Authentication #######

# Server role. Defines in which mode Samba will operate. Possible
# values are "standalone server", "member server", "classic primary
# domain controller", "classic backup domain controller", "active
# directory domain controller". 
#
# Most people will want "standalone sever" or "member server".
# Running as "active directory domain controller" will require first
# running "samba-tool domain provision" to wipe databases and create a
# new domain.
   server role = standalone server

# "security = user" is always a good idea. This will require a Unix account
# in this server for every user accessing the server.
   security = user <span
                  id="smb.conf.security"><img
                    class="callout"
                    src="Common_Content/images/2.png"
                    alt="2" /></span>

[...]
</pre><div
                class="calloutlist"><table
                  border="0"
                  summary="Callout list"><tr><td
                      width="5%"
                      valign="top"
                      align="left"><p><a
                          href="#smb.conf.wins"><img
                            class="callout"
                            src="Common_Content/images/1.png"
                            alt="1" /></a> </p></td><td
                      valign="top"
                      align="left"><div
                        class="para">
								Zeigt an, dass Samba für das lokale Netzwerk als ein Netbios-Namensserver (WINS) dienen soll.
							</div></td></tr><tr><td
                      width="5%"
                      valign="top"
                      align="left"><p><a
                          href="#smb.conf.security"><img
                            class="callout"
                            src="Common_Content/images/2.png"
                            alt="2" /></a> </p></td><td
                      valign="top"
                      align="left"><div
                        class="para">
								Dies ist die Standardeinstellung dieses Parameters; da er jedoch für die Samba-Konfiguration wesentlich ist, wird empfohlen, ihn ausdrücklich einzutragen. Jeder Benutzer muss sich vor dem Zugriff auf eine Freigabe authentifizieren.
							</div></td></tr></table></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.14.8.9.8.3"></a>11.5.1.2.2. Benutzer hinzufügen</h5></div></div></div><div
                class="para">
						Jeder Samba-Benutzer benötigt ein Konto auf dem Server; als erstes müssen die Unix-Konten erstellt, dann die Benutzer in Sambas Datenbank eingetragen werden. Der Unix-Schritt verläuft wie üblich (zum Beispiel unter Verwendung von <code
                  class="command">adduser</code>).
					</div><div
                class="para">
						Das Hinzufügen eines bestehenden Benutzers zur Samba-Datenbank erfolgt durch den Befehl <code
                  class="command">smbpasswd -a <em
                    class="replaceable">benutzer</em></code>; dieser Befehl fragt interaktiv nach dem Passwort.
					</div><div
                class="para">
						Ein Benutzer kann mit dem Befehl <code
                  class="command">smbpasswd -x <em
                    class="replaceable">benutzer</em></code> gelöscht werden. Auch ein Samba-Konto kann zeitweilig deaktiviert werden (mit <code
                  class="command">smbpasswd -d <em
                    class="replaceable">benutzer</em></code>) und später wieder reaktiviert (mit <code
                  class="command">smbpasswd -e <em
                    class="replaceable">benutzer</em></code>).
					</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.8.10"></a>11.5.2. Samba-Client</h3></div></div></div><div
            class="para">
				Die Client-Merkmale in Samba ermöglichen es einem Linux-Rechner, auf Windows-Freigaben und freigegebene Rechner zuzugreifen. Die hierfür benötigten Programme befinden sich in den Paketen <span
              class="pkg pkg">cifs-utils</span> und <span
              class="pkg pkg">smbclient</span>.
			</div><a
            id="id-1.14.8.10.3"
            class="indexterm"></a><a
            id="id-1.14.8.10.4"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.5"></a>11.5.2.1. Das Programm <code
                      class="command">smbclient</code></h4></div></div></div><div
              class="para">
					Das Programm <code
                class="command">smbclient</code> stellt Anfragen an SMB-Server. Es nimmt die Option <code
                class="literal">-U <em
                  class="replaceable">benutzer</em></code> entgegen, um sich mit dem Server unter einer bestimmten Identität zu verbinden. <code
                class="command">smbclient //<em
                  class="replaceable">server</em>/<em
                  class="replaceable">freigabe</em></code> greift interaktiv auf die Freigabe zu, in ähnlicher Weise wie der FTP-Client auf der Befehlszeile. <code
                class="command">smbclient -L <em
                  class="replaceable">server</em></code> listet alle auf einem Server verfügbaren (und sichtbaren) Freigaben auf.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.6"></a>11.5.2.2. Windows-Freigaben einhängen</h4></div></div></div><div
              class="para">
					Der Befehl <code
                class="command">mount</code> ermöglicht es (mit Hilfe von <code
                class="command">mount.cifs</code> aus dem Paket <span
                class="pkg pkg">cifs-utils</span>), eine Windows-Freigabe in die Linux-Dateisystemhierarchie einzuhängen.
				</div><a
              id="id-1.14.8.10.6.3"
              class="indexterm"></a><a
              id="id-1.14.8.10.6.4"
              class="indexterm"></a><div
              class="example"><a
                xmlns=""
                id="id-1.14.8.10.6.5"></a><p
                class="title"><strong>Beispiel 11.24. Eine Windows-Freigabe einhängen</strong></p><div
                class="example-contents"><pre
                  class="programlisting">
mount -t cifs //arrakis/shared /shared \
      -o credentials=/etc/smb-credentials
</pre></div></div><div
              class="para">
					Die Datei <code
                class="filename">/etc/smb-credentials</code> (die nicht von Benutzern lesbar sein darf) hat das folgende Format:
				</div><pre
              class="programlisting">
username = <em
                class="replaceable">benutzer</em>
password = <em
                class="replaceable">passwort</em></pre><div
              class="para">
					Weitere Optionen können auf der Befehlszeile angegeben werden; sie sind auf der Handbuchseite <span
                class="citerefentry"><span
                  class="refentrytitle">mount.cifs</span>(1)</span> vollständig aufgelistet. Insbesondere zwei Optionen können interessant sein: <code
                class="literal">uid</code> und <code
                class="literal">gid</code> ermöglichen es, den Benutzer und die Gruppe der am Einhängepunkt verfügbaren Dateien einzustellen, um den Zugriff nicht auf den Administrator zu begrenzen.
				</div><div
              class="para">
					EIn Einhängen einer Windows-Freigabe kann auch in <code
                class="filename">/etc/fstab</code> konfiguriert werden:
				</div><pre
              class="programlisting">
//<em
                class="replaceable">server</em>/shared /shared cifs credentials=/etc/smb-credentials
</pre><div
              class="para">
					Eine SMB/CIFS-Freigabe wird mit dem Befehl <code
                class="command">umount</code> ausgehängt.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.7"></a>11.5.2.3. Auf einem Netzwerkdrucker drucken</h4></div></div></div><div
              class="para">
					CUPS ist eine elegante Lösung, um von einem Linux-Arbeitsplatzrechner aus auf einem von einem Windows-Rechner freigegebenen Drucker zu drucken. Wenn das Paket <span
                class="pkg pkg">smbclient</span> installiert ist, ist es mit CUPS möglich, freigegebene Windows-Rechner automatisch zu installieren.
				</div><a
              id="id-1.14.8.10.7.3"
              class="indexterm"></a><div
              class="para">
					Dies sind die erforderlichen Schritte:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							Melden Sie sich an der Beniutzerschnittstelle von CUPS an: <code
                      class="literal">http://localhost:631/admin</code>
						</div></li><li
                  class="listitem"><div
                    class="para">
							Klicken Sie auf "Drucker hinzufügen".
						</div></li><li
                  class="listitem"><div
                    class="para">
							Wählen Sie das Gerät Drucker, nehmen Sie „Windows-Printer via SAMBA“.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Geben Sie den URI für den Drucker ein, er sieht folgendermaßen aus:
						</div><div
                    class="para">
							<code
                      class="literal">smb://<em
                        class="replaceable">benutzer</em>:<em
                        class="replaceable">passwort</em>@<em
                        class="replaceable">server</em>/<em
                        class="replaceable">drucker</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Geben Sie den Namen ein der den Drucker eindeutig bezeichnet. Dann fügen Sie die Beschreibung und den Aufstellort des Druckers hinzu. Das sind die Angaben, die den Endanwendern angezeigt werden, um den Drucker identifizieren zu können.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Geben Sie den Hersteller und das Modell des Druckers an oder stellen Sie direkt eine funktionierende Druckerbeschreibung (PPD, PostScript Printer Description) zur Verfügung.
						</div></li></ul></div><div
              class="para">
					Voilà, der Drucker ist einsatzbereit!
				</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.nfs-file-server.html"><strong>Zurück</strong>11.4. NFS-Dateiserver</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Nach oben</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Zum Anfang</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.http-ftp-proxy.html"><strong>Weiter</strong>11.6. HTTP/FTP-Proxy</a></li></ul></body></html>
