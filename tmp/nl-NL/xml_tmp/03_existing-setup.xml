<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
]>
<chapter id="existing-setup">
  <chapterinfo>
    <mediaobject condition="pdf">
      <imageobject>
        <imagedata fileref="images/chap-existing-setup.png" scalefit="1" />
      </imageobject>
    </mediaobject>
    <keywordset>
      <keyword>Bestaande Installatie</keyword>
      <keyword>Hergebruik</keyword>
      <keyword>Migratie</keyword>
    </keywordset>
  </chapterinfo>
  <title>De Bestaande Installatie Analyseren en Migreren</title>
  <highlights>
    <para>Iedere revisie van een computer systeem moet rekening houden met het bestaande systeem. Dit laat het hergebruiken van beschikbare middelen zo mogelijk toe en garandeert interoperabiliteit tussen verschillende elementen waaruit het systeem bestaat. Deze studie zal een algemeen kaderwerk te volgen in iedere migratie van een computer infrastructuur naar Linux introduceren.</para>
  </highlights>
  <section id="sect.heterogeneous-environments">
    <title>Co-existentie en Heterogene Omgevingen</title>
    <indexterm><primary>omgeving</primary><secondary>heterogene omgeving</secondary></indexterm>

    <para>Debian integreert zeer goed in alle soorten van bestaande omgevingen en werkt goed samen met ieder ander besuringssysteem. Deze bijna-perfecte harmonie komt van deuk vanuit de markt welke eist dat software uitgevers programma's ontwikkelen die standaarden volgen. Nakoming van deze standaarden laat beheerders toe om programma's uit te wisselen: cliënt of server, hetzij vrij of niet.</para>
    <section>
      <title>Integratie met Windows Machines</title>

      <para>Samba's SMB/CIFS ondersteuning verzekert excellente communicatie binnen een Windows context. Het deelt bestanden en printer-wachtrijen naar Windows cliënten en bevat software die Linux machines toelaat om middelen beschikbaar op Windows servers te gebruiken.</para>

      <sidebar>
        <title><emphasis>GEREEDSCHAP</emphasis> Samba</title>
        <indexterm><primary>Samba</primary></indexterm>

        <para>De laatste versie van Samba kan de meeste Windows functies vervangen: deze van een simpele Windows NT server (authenticatie, bestanden, printer wachtrijen, printer drivers downloaden, DFS, enz.) tot de meest geavanceerde (een domein controller compatibel met Active Directory).</para>
      </sidebar>
    </section>
    <section>
      <title>Integratie met OS X Machines</title>

      <indexterm><primary>Zeroconf</primary></indexterm>
      <indexterm><primary>Bonjour</primary></indexterm>
      <indexterm><primary>Avahi</primary></indexterm>
      <para>OS X machines bieden, en zijn in staat tot gebruik van, netwerk diensten zoals bestand servers and printer delen. Deze diensten zijn gepubliceerd op het lokale network, welke andere machine toestaat ze te ontdekken en er gebruik van te maken zonder enige manuele configuratie, door de Bonjour implementatie van het Zeroconf protocol pakket te gebruiken. Debian bevat een andere implementatie, Avahi genoemd, welke de zelfde functionaliteit biedt.</para>

      <indexterm><primary>AFP</primary></indexterm>
      <indexterm><primary>AppleShare</primary></indexterm>
      <para>In de andere richting kan de Netatalk daemon gebruikt worden om bestand servers te bieden aan OS X machines op het netwerk. Het implementeert het AFP (AppleShare) protocol als de nodige meldingen so dat de servers automatisch ontdekt kunnen worden door de OS X cliënten.</para>

      <indexterm><primary>AppleTalk</primary></indexterm>
      <para>Oudere Mac OS netwerken (voor OS X) gebruiken een ander protocol AppleTalk genaamd. Voor omgevingen waarbij machines die dit protocol betrokken zijn biedt Netatalk ook het AppleTalk protocol (eigenlijk begon het als een her-implementatie van dat protocol). Het verzekert de werking van de bestand server en de printer wachtrijen, als een tijd server (klok synchronisatie) Zijn router functie laat interconnectie met AppleTalk netwerken toe.</para>
    </section>
    <section>
      <title>Integratie met Andere Linux/Unix Machines</title>

      <para>Tenslotte, NFS en NIS, beide inbegrepen, garanderen interactie met Unix systemen. NFS verzekert bestand server functionaliteit terwijl NIS gebruiker directory's creëert. De BSD printer laag, gebruikt door de meeste Unix systemen, laat ook ket delen van printer wachtrijen toe.</para>

      <figure>
        <title>Co-existentie van Debian met OS X, Windows en Unix systemen</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/existing-setup-1.png" width="25%" />
          </imageobject>
        </mediaobject>
      </figure>
    </section>
  </section>
  <section id="sect.how-to-migrate">
    <title>Hoe Migreren</title>
    <indexterm><primary>migratie</primary></indexterm>

    <para>Om continuïteit van de diensten te garanderen moet iedere computer migratie gepland en uitgevoerd worden volgens het plan. Dit principe geldt altijd, wat het gebruikte besturingssysteem ook is.</para>
    <section>
      <title>Onderzoek en Diensten Identificeren</title>

      <para>Hoe simpel het lijkt, deze stap is essentieel. Een serieuze beheerder weet echt de principiële rol van iedere server, maar zulke rollen kunnen veranderen en soms hebben gebruikers met ervaring bepaalde “wilde” diensten geïnstalleerd. Weten dat deze bestaan zal je ten minste laten beslissen wat ermee te doen, in tegenstelling tot ze halsoverkop te verwijderen.</para>

      <para>Voor dit doel is het verstandig jouw gebruikers te informeren over het project voor de server te migreren. Om hen te betrekken in het project kan het goed zijn om de meest algemene vrij software programma's op hun desktops te installeren voor de migratie, met welke ze weer in aanraking komen na de migratie naar Debian; Libre Office en het Mozilla Pakket zijn hier de beste voorbeelden.</para>
      <section>
        <title>Netwerk en Processen</title>
        <indexterm><primary><command>nmap</command></primary></indexterm>
       
	<para>Het <command>nmap</command> gereedschap (in het pakket met dezelfde naam) zal Internet diensten snel identificeren geherbergd door een machine verbonden aan het netwerk zelfs zonder er op te moeten inloggen. geef simpelweg het volgende commando op een andere machine verbonden met hetzelfde netwerk:</para>

        <screen>
<computeroutput>$ </computeroutput><userinput>nmap mirwiz</userinput>
<computeroutput>Starting Nmap 6.47 ( http://nmap.org ) at 2015-03-24 11:34 CET
Nmap scan report for mirwiz (192.168.1.104)
Host is up (0.0037s latency).
Not shown: 999 closed ports
PORT   STATE SERVICE
22/tcp open  ssh

Nmap done: 1 IP address (1 host up) scanned in 0.13 seconds</computeroutput></screen>

        <sidebar>
          <title><emphasis>ALTERNATIEF</emphasis> Gebruik <command>netstat</command> om een lijst van beschikbare diensten te vinden</title>

	  <para>Op een Linux machine toont het <command>netstat -tupan</command> commando een lijst van actieve of TCP sessies in wacht, alsook UDP poorten waarop programma's draaien en luisteren. Dit faciliteert de identificatie van diensten aangeboden op het netwerk.</para>
        </sidebar>

        <sidebar>
          <title><emphasis>VERDER GAAN</emphasis> IPv6</title>

	  <para>Sommige netwerk commando's kunnen werken met IPv4 (meestal de standaard) en met IPv6. Deze bevatten de <command>nmap</command> en <command>netstat</command> commando's, maar ook andere, zoals <command>route</command> of <command>ip</command>. De cenventie is dat dit gedrag wordt ingeschakeld door de <parameter>-6</parameter> commando-lijn optie.</para>
        </sidebar>

	<para>Als de server een Unix machine is die shell accounts bied aan gebruikers, is het interessant om uit te maken of processen in de achtergrond worden uitgevoerd in de afwezigheid van hun eigenaar. Het commando <command>ps auxw</command> toont een lijst van alle processen met de identiteit van hun gebruiker. Door deze informatie te vergelijken met de output van het <command>who</command> commando, welke een lijst geeft van gebruikers die zijn ingelogd, is het mogelijk om schurk of ongedefinieerde servers of programma's die draaien in de achtergrond. Kijkend naar <filename>crontabs</filename> (tabellen die automatische geplande acties van gebruikers bevat) zal vaak interessante informatie bieden over functies uitgevoerd door de server (een complete uitleg van <command>cron</command> is beschikbaar in <xref linkend="sect.task-scheduling-cron-atd" />).</para>

	<para>In ieder geval, is het essentieel om jouw servers te back-uppen: dit laat toe om achteraf de informatie te herstellen, wanneer gebruikers specifieke problemen rapporteren ten gevolge van de migratie.</para>
      </section>
    </section>
    <section>
      <title>de Configuratie back-uppen</title>

      <para>Het is verstandig de configuratie van iedere geïdentificeerde dienst te bewaren om in staat te zijn om het equivalent te installeren op de ge-update server. Het echte minimum is om een backup te maken van de configuratie bestanden.</para>

      <para>Voor Unix machines zijn de configuratie bestanden meestal te vinden in <filename>/etc/</filename>, maar ze kunnen ook gevonden worden in een sub-directory van <filename>/usr/local/</filename>. Dit is het geval als een programma is geïnstalleerd van broncode in plaats van met een pakket. In sommige gevallen, kan men ze ook vinden onder <filename>/opt/</filename>.</para>

      <para>Voor data beheer systemen (zoals een databank) is het zeer sterk aanbevolen de date te exporteren naar een standaard formaat dat gemakkelijk kan geïmporteerd worden in de nieuwe software. Zo'n formaat is meestal in tekst modus en gedocumenteerd; Het kan, bij voorbeeld, een SQL dump zijn van een databank, of een LDIF bestand voor een LDAP server.</para>

      <figure>
        <title>Databank Back-up</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/existing-setup-2.png" width="50%" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>Iedere server software is anders en het is onmogelijk om alle bestaande gevallen in detail te beschrijven. Vergelijk de documentatie voor de bestaande en de nieuwe software om de exporteerbare (dus her-importeerbaar) delen en deze welke manuele handeling nodig hebben. Dit boek lezen zal de configuratie van de hoofd Linux server programma's verduidelijken.</para>
    </section>
    <section>
      <title>Een Bestaande Debian Server overnemen</title>
      <indexterm><primary>een Debian machine herstellen</primary></indexterm>
      <indexterm><primary>een Debian machine verkennen</primary></indexterm>
      <indexterm><primary>een Debian server overnemen</primary></indexterm>

      <para>Om het onderhoud effectief over te nemen, kan men een machine die al Debian draait analyseren.</para>

      <para>Het eerste bestand te controleren is <filename>/etc/debian_version</filename>, welke meestal het versie nummer van het geïnstalleerde Debian systeem bevat (het is onderdeel van het <emphasis>base-files</emphasis> pakket). Als het de <literal><replaceable>codenaam</replaceable>/sid</literal> bevat, betekend dit dat het systeem is ge-updatet met pakketten komende van een van de ontwikkel distributies (ofwel van testen of onstabiel).</para>

      <para>Het <command>apt-show-versions</command> programma (van het Debian pakket met dezelfde naam) controleert de lijst van geïnstalleerde pakketten en identificeert de beschikbare versies. <command>aptitude</command> kan ook gebruikt worden voor deze taken, zij het wel in een minder systematische methode.</para>

      <para>Een blik op het <filename>/etc/apt/sources.list</filename> bestand (en <filename>/etc/apt/sources.list.d/</filename> directory) zal tonen waar de geïnstalleerde Debian pakketten waarschijnlijk vandaan kwamen. Als er veel onbekende bronnen verschijnen kan de beheerder ervoor kiezen om het besturingssysteem van de computer volledig te herinstalleren om een optimale compatibiliteit met de software aangeboden door Debian verzekeren.</para>

      <para>Het <filename>sources.list</filename> bestand is vaak een goede indicator: de meerderheid van beheerders houden, ten minste in commentaren, de lijst van APT bronnen die eerder werden gebruikt bij. Maar je zou niet moeten vergeten dat bronnen gebruikt in het verleden gewist zijn, en dat sommige willekeurige pakketten gegrepen van het Internet manueel geïnstalleerd kunnen zijn. (met het <command>dpkg</command> commando). In dit geval, is de machine misleidend in zijn uiterlijk van “standaard” Debian. Dit is waarom je moet opletten voor iedere indicatie die de aanwezigheid van externe pakketten (aanwezigheid van <filename>deb</filename> bestanden in ongebruikelijke directory's, pakket versie nummers met een speciale achtervoegsel die aangeeft dat de oorsprong van buiten het Debian project ligt, zoals <literal>ubuntu</literal> of <literal>lmde</literal>, enz.)</para>

      <para>Het is ook interessant om de inhoud van de <filename>/usr/local/</filename> directory te analyseren, wiens doel het is om programma's manueel gecompileerd en geïnstalleerd te bevatten. geïnstalleerde software op deze manier op lijsten is instructief, omdat het de vraag doet rijzen waarom men het corresponderende Debian pakket, indien zo'n pakket bestaat, niet gebruikt is.</para>

      <sidebar>
        <title><emphasis>SNELLE KIJK</emphasis> <emphasis role="pkg">cruft</emphasis></title>

	<para>Het <emphasis role="pkg">cruft</emphasis> pakket stelt een lijst voor met beschikbare bestanden die geen eigendom zijn van enige pakket. Het heeft enkele filters (meer of minder effectief en min of meer recent) om de rapportage van sommige ligitieme bestanden te voorkomen (gegenereerd door Debian pakketten of gegenereerde configuratie bestanden die niet door <command>dpkg</command> beheerd worden, enz.).</para>

	<para>Let op om niet alles wat <command>cruft</command> kan rapporteren zomaar te verwijderen!</para>
      </sidebar>
    </section>
    <section>
      <title>Debian installeren</title>

      <para>Eenmaal alle nodige informatie op de huidige server bekend is, kunnen we hem uitschakelen en beginnen met de installatie van Debian.</para>
      <indexterm><primary>architectuur</primary></indexterm>

      <para>Om de geschikte versie te kiezen moeten we de architectuur van de computer kennen. Als het een redelijk recente PC is, is het meer daan waarschijnlijk een amd64 (oudere PC's waren meestal i386). In andere gevallen kunnen we de mogelijkheden beperken aan de hand van het vorige systeem.</para>

      <para><xref linkend="tab-corresp" xrefstyle="select: label nopage" /> is niet bedoeld om uitvoerig te zijn, maar kan behulpzaam zijn. In ieder geval is de originele documentatie van de computer de betrouwbaarste bron om deze informatie te vinden.</para>

      <table colsep="1" id="tab-corresp">
        <title>Passende besturingssystemen en architecturen</title>
        <tgroup cols="2">
          <thead>
            <row>
              <entry>Besturingssysteem</entry>
              <entry>Architectuur(en)</entry>
            </row>
          </thead>
          <tbody>
            <row>
              <entry>DEC Unix (OSF/1)</entry>
              <entry>alpha, mipsel</entry>
            </row>
            <row>
              <entry>HP Unix</entry>
              <entry>ia64, hppa</entry>
            </row>
            <row>
              <entry>IBM AIX</entry>
              <entry>powerpc</entry>
            </row>
            <row>
              <entry>Irix</entry>
              <entry>mips</entry>
            </row>
            <row>
              <entry>OS X</entry>
              <entry>amd64, powerpc, i386</entry>
            </row>
            <row>
              <entry>Z/OS, MVS</entry>
              <entry>s390x, s390</entry>
            </row>
            <row>
              <entry>Solaris, SunOS</entry>
              <entry>sparc, i386, m68k</entry>
            </row>
            <row>
              <entry>Ultrix</entry>
              <entry>mips</entry>
            </row>
            <row>
              <entry>VMS</entry>
              <entry>alpha</entry>
            </row>
            <row>
              <entry>Windows 95/98/ME</entry>
              <entry>i386</entry>
            </row>
            <row>
              <entry>Windows NT/2000</entry>
              <entry>i386, alpha, ia64, mipsel</entry>
            </row>
            <row>
              <entry>Windows XP / Windows Server 2008</entry>
              <entry>i386, amd64, ia64</entry>
            </row>
            <row>
              <entry>Windows Vista / Windows 7 / Windows 8</entry>
              <entry>i386, amd64</entry>
            </row>
          </tbody>
        </tgroup>
      </table>

      <sidebar>
        <title><emphasis>HARWARE</emphasis> 64 bit PC versus 32 bit PC</title>
        <indexterm><primary>amd64</primary></indexterm>
        <indexterm><primary>i386</primary></indexterm>

	<para>De meeste recente computers hebben 64 bit Intel of AMD Processoren, compatibel met oudere 32 bit processoren; de software gecompileerd voor “i386” architectuur werken dus. Aan de andere kant benut deze compatibiliteits-modus de mogelijkheden van deze nieuwe processoren niet. Dit is waarom Debian de “amd64” architectuur aanbied, welke erkt voor recente AMD chips en ook met Intel “em64t” processoren (inclusief de meeste van de Core reeks), welke heel gelijkaardig is aan AMD64.</para>
      </sidebar>
    </section>
    <section>
      <title>Installatie en Configuratie van de Geselecteerde Diensten</title>

      <para>Eenmaal Debian geïnstalleerd is moeten we alle diensten die deze computer zal herbergen één-voor-één installeren en configureren. De nieuwe configuratie moet rekening houden met de voorgaande om een gemakkelijke transitie te verzekeren. Alle informatie verzamelt in de eerste twee stappen zullen bruikbaar zijn om dit deel met succes af te sluiten.</para>

      <figure>
        <title>Installeer de geselecteerde diensten</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/existing-setup-4.png" width="66%" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>Voordat we met bij de voeten in de oefeningen duiken, wordt het ten zeerste aangeraden dat de rest van dit boek leest. Hierna zal je een beter begrip hebben van hoe de te verwachten diensten te configureren.</para>

      <para></para>
    </section>
  </section>
</chapter>
