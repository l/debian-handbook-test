<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
]>
<chapter id="existing-setup" lang="cs-CZ">
	<chapterinfo>
		 <keywordset>
			<keyword>Současné systémové nastavení</keyword>
			 <keyword>Znovupoužití</keyword>
			 <keyword>Přechod</keyword>

		</keywordset>

	</chapterinfo>
	 <title>Analýza současného systémového nastavení a přechodu</title>
	 <highlights> <para>
		Každá počítačová generálka by měla zohledňovat současný systém. To umožní znovupoužití dostupných zdrojů jak je to jen možné a zabezpečí vzájemnou provozuschopnost různých prvků obsahujících systém. Tato studie představí obecný rámec, který by se měl dodržet při jakémkoliv přechodu počítačové infrastruktury na Linux.
	</para>
	 </highlights> <section id="sect.heterogeneous-environments">
		<title>Spoluexistence v různorodém prostředí</title>
		 <indexterm>
			<primary>prostředí</primary>
			<secondary>různorodé prostředí</secondary>
		</indexterm>
		 <para>
			Debian se začleňuje velmi dobře do všech typů současných prostředí a rozumí si dobře s jakýmkoliv jiným operačním systémem. Tento téměř dokonalý soulad si svým tlakem vyžádal trh, který požaduje, aby vydavatelé softwaru vyvíjeli programy, které vyhovují standardům. Soulad se standardy dovoluje správcům přepínat programy: klienty nebo servry, ať už volné, či ne.
		</para>
		 <section>
			<title>Začlenění s Windows zařízeními</title>
			 <para>
				Podpora Samby SMB/CIFS zajišťuje vynikající komunikaci v rámci souvislostí s Windows. Sdílí soubory a tiskové fronty klientům Windows a zahrnuje software, který umožňuje linuxovským zařízením používat zdroje dostupné na serverech Windows.
			</para>
			 <sidebar> <title><emphasis>NÁSTROJ</emphasis> Samba</title>
			 <indexterm>
				<primary>Samba</primary>
			</indexterm>
			 <para>
				Poslendí verze Samby může nahradit většinu prvků Windows: od těch z jednoduchého serveru Windows NT (autentizace, soubory, tiskové fronty, stahování ovladačů tiskárny, DFS, apod.) až k těm nejpokročilejším (doménový ovladač kompatabilní s aktivním adresářem).
			</para>
			 </sidebar>
		</section>
		 <section>
			<title>Začlenění se zařízeními OS X</title>
			 <indexterm>
				<primary>Zeroconf</primary>
			</indexterm>
			 <indexterm>
				<primary>Bonjour</primary>
			</indexterm>
			 <indexterm>
				<primary>Avahi</primary>
			</indexterm>
			 <para>
				Zařízení OS X poskytují, a mohou používat, síťové služby jako jsou souborové servery a sdílení tiskáren. Tyto služby jsou zveřejněny na lokální síti, což umožňuje ostatním zařízením je prozkoumat a mít prospěch z jejich používání bez nějakého manuálního nastavování, za použití zavedení Bonjour z protokolové sady Zeroconf. Debian zahrnje jiné zavedení, které se nazývá Avahi a poskytuje ten samý rozsah funkcí.
			</para>
			 <indexterm>
				<primary>AFP</primary>
			</indexterm>
			 <indexterm>
				<primary>AppleShare</primary>
			</indexterm>
			 <para>
				Opačným směrem, Netatalk démon může být použit k poskytování souborových serverů vůči zařízením OS X v síti. Zavádí AFP (AppleShere) protokol stejně jako požadovaná oznámení, takže servery mohou být automaticky rozpoznány klienty OS X.
			</para>
			 <indexterm>
				<primary>AppleTalk</primary>
			</indexterm>
			 <para>
				Starší sítě Mac OS (před OS X) používaly odlišné protokoly nazývané AppleTalk. Pro prostředí zahrnující zařízení používající tento protokol, Netatalk také poskytuje protokol AppleTalk (v podstatě, začal jako znovuzavedení tohoto protokolu). To zabezpečuje funkčnost souborového serveru a tiskových front, stejně jako časového serveru (časové sladění hodin). Jeho směrovací funkce umožňuje vzájemné spojení se sítěmi AppleTalk.
			</para>

		</section>
		 <section>
			<title>Začlenění s ostatními zařízeními Linux/Unix</title>
			 <para>
				A nakonec, NFS a NIS, obě zahrnuté, zaručují spolupráci s Unixovými systémy. NFS zabezpečuje funkčnost souborového serveru, zatímco NIS vytváří uživatelské adresáře. Tisková vrstva BSD, používaná většinou Unixových systémů, také umožňuje sdílení tiskových front.
			</para>
			 <figure>
				<title>Soužití Debianu s OS X, Windows a systémy Unix</title>
				 <mediaobject>
					<imageobject>
						<imagedata fileref="images/existing-setup-1.png" format="PNG" width="25%" />
					</imageobject>

				</mediaobject>

			</figure>

		</section>

	</section>
	 <section id="sect.how-to-migrate">
		<title>Jak přejít</title>
		 <indexterm>
			<primary>přechod</primary>
		</indexterm>
		 <para>
			Za účelem pokračování služeb bez přerušení, musí být každý počítačový přechod naplánován a proveden podle plánu. Tato zásada platí pro použití jakéhokoliv operačního systému.
		</para>
		 <section>
			<title>Průzkum a identifikace služeb</title>
			 <para>
				Jakkoliv se tento krok zdá jednoduchý, je zásadní. Správný správce skutečně zná základní funkce každého serveru, ale takové funkce se mohou změnit a někdy i zkušení uživatelé mohli nainstalovat “divoké” služby. Vědomí, že existují, vám může minimálně umožnit se rozhodnout jak s nimi naložit, spíše, než je nahodile vymazat.
			</para>
			 <para>
				Za tímto účelem je moudré před přechodem serveru informovat uživatele o projektu. K jejich zapojení do projektu může být užitečné nainstalovat nejběžnější programy volného softwaru na jejich počítače ještě před přechodem, programy, se kterým přijdou do styku znovu po přechodu na Debian; Libre Office a sada Mozilla jsou zde nejlepšími příklady
			</para>
			 <section>
				<title>Síť a procesy</title>
				 <indexterm>
					<primary><command>nmap</command></primary>
				</indexterm>
				 <para>
					Nástroj <command>nmap</command> (v balíčku pod stejným jménem) rychle rozpozná internetové služby nacházející se na zařízení připojeného k síti bez toho, aniž by se k němu přihlásil. Jednoduše spusťte následující příkaz na jiném zařízení připojeného ke stejné síti:
				</para>
				 
<screen>
<computeroutput>$ </computeroutput><userinput>nmap mirwiz</userinput>
<computeroutput>Starting Nmap 7.40 ( https://nmap.org ) at 2017-06-06 14:41 CEST
Nmap scan report for mirwiz (192.168.1.104)
Host is up (0.00062s latency).
Not shown: 992 closed ports
PORT     STATE SERVICE
22/tcp   open  ssh
25/tcp   open  smtp
80/tcp   open  http
111/tcp  open  rpcbind
139/tcp  open  netbios-ssn
445/tcp  open  microsoft-ds
5666/tcp open  nrpe
9999/tcp open  abyss

Nmap done: 1 IP address (1 host up) scanned in 0.06 seconds</computeroutput></screen>
				 <sidebar> <title><emphasis>ALTERNATIVA</emphasis> Použití <command>netstatu</command> k nalezení seznamu dostupných služeb</title>
				 <para>
					Na Linuxových zařízeních, příkaz <command>netstat -tupan</command> ukáže seznam aktivních nebo dosud nevyřízených TCP akcí, stejně jako UDP rozhraní (portů), na kterých běžící programy čekají na odezvu. To usnadňuje identifikaci služeb nabízených sítí.
				</para>
				 </sidebar> <sidebar> <title><emphasis>JDEME DÁLE</emphasis> IPv6</title>
				 <para>
					Některé síťové příkazy mohou fungovat buď s IPv4 (obyčejně výchozí) nebo s IPv6. Mezi ně patří příkazy <command>nmap</command> a <command>netstat</command>, ale také další, jako <command>route</command> nebo <command>ip</command>. Je zvykem, že toto chování je umožněno <parameter>-6</parameter> volbou na příkazovém řádku.
				</para>
				 </sidebar> <para>
					Pokud je serverem Unixové zařízení nabízející uživatelům shellové účty, je zajímavé určit, zda jsou procesy prováděny na pozadí za nepřítomnosti svých majitelů. Příkaz <command>ps auxw</command> zobrazuje seznam všech procesů s jejich uživatelskou totožností. Kontrolou těchto informací s výstupem příkazu <command>who</command>, který poskytuje seznam přihlášených uživatelů, je možné identifikovat škodlivé nebo nedeklarované servery nebo programy běžící na pozadí. Pohledem na <filename>crontabs</filename> (tabulka vypisující automatické akce naplánované uživateli) často poskytuje zajímavé informace o funkcích naplňovaných serverem (kompletní vysvětlení <command>cron</command> je k dispozici na <xref linkend="sect.task-scheduling-cron-atd" />).
				</para>
				 <para>
					V každém případě ja důležité zálohovat vaše servery: to umožní navrácení informací poté, co budou uživatelé hlásit určité problémy po přechodu.
				</para>

			</section>

		</section>
		 <section>
			<title>Zálohování nastavení</title>
			 <para>
				Je moudré ponechat si nastavení každé rozpoznané služby kvůli tomu, abychom byli schopni nainstalovat obdobu na aktualizovaný server. Nutné minimum je si udělat zálohovou kopii souborů nastavení.
			</para>
			 <para>
				For Unix machines, the configuration files are usually found in <filename>/etc/</filename>, but they may be located in a sub-directory of <filename>/usr/local/</filename>. This is the case if a program has been installed from sources, rather than with a package. In some cases, one may also find them under <filename>/opt/</filename>.
			</para>
			 <para>
				For data managing services (such as databases), it is strongly recommended to export the data to a standard format that will be easily imported by the new software. Such a format is usually in text mode and documented; it may be, for example, an SQL dump for a database, or an LDIF file for an LDAP server.
			</para>
			 <figure>
				<title>Database backups</title>
				 <mediaobject>
					<imageobject>
						<imagedata fileref="images/existing-setup-2.png" format="PNG" width="50%" />
					</imageobject>

				</mediaobject>

			</figure>
			 <para>
				Each server software is different, and it is impossible to describe all existing cases in detail. Compare the documentation for the existing and the new software to identify the exportable (thus, re-importable) portions and those which will require manual handling. Reading this book will clarify the configuration of the main Linux server programs.
			</para>

		</section>
		 <section>
			<title>Taking Over an Existing Debian Server</title>
			 <indexterm>
				<primary>recovering a Debian machine</primary>
			</indexterm>
			 <indexterm>
				<primary>exploring a Debian machine</primary>
			</indexterm>
			 <indexterm>
				<primary>taking over a Debian server</primary>
			</indexterm>
			 <para>
				To effectively take over its maintenance, one may analyze a machine already running with Debian.
			</para>
			 <para>
				The first file to check is <filename>/etc/debian_version</filename>, which usually contains the version number for the installed Debian system (it is part of the <emphasis>base-files</emphasis> package). If it indicates <literal><replaceable>codename</replaceable>/sid</literal>, it means that the system was updated with packages coming from one of the development distributions (either testing or unstable).
			</para>
			 <para>
				The <command>apt-show-versions</command> program (from the Debian package of the same name) checks the list of installed packages and identifies the available versions. <command>aptitude</command> can also be used for these tasks, albeit in a less systematic manner.
			</para>
			 <para>
				A glance at the <filename>/etc/apt/sources.list</filename> file (and <filename>/etc/apt/sources.list.d/</filename> directory) will show where the installed Debian packages likely came from. If many unknown sources appear, the administrator may choose to completely reinstall the computer's system to ensure optimal compatibility with the software provided by Debian.
			</para>
			 <para>
				The <filename>sources.list</filename> file is often a good indicator: the majority of administrators keep, at least in comments, the list of APT sources that were previously used. But you should not forget that sources used in the past might have been deleted, and that some random packages grabbed on the Internet might have been manually installed (with the <command>dpkg</command> command). In this case, the machine is misleading in its appearance of “standard” Debian. This is why you should pay attention to any indication that will give away the presence of external packages (appearance of <filename>deb</filename> files in unusual directories, package version numbers with a special suffix indicating that it originated from outside the Debian project, such as <literal>ubuntu</literal> or <literal>lmde</literal>, etc.)
			</para>
			 <para>
				Likewise, it is interesting to analyze the contents of the <filename>/usr/local/</filename> directory, whose purpose is to contain programs compiled and installed manually. Listing software installed in this manner is instructive, since this raises questions on the reasons for not using the corresponding Debian package, if such a package exists.
			</para>
			 <sidebar> <title><emphasis>QUICK LOOK</emphasis> <emphasis role="pkg">cruft</emphasis></title>
			 <para>
				The <emphasis role="pkg">cruft</emphasis> package proposes to list the available files that are not owned by any package. It has some filters (more or less effective, and more or less up to date) to avoid reporting some legitimate files (files generated by Debian packages, or generated configuration files not managed by <command>dpkg</command>, etc.).
			</para>
			 <para>
				Be careful to not blindly delete everything that <command>cruft</command> might list!
			</para>
			 </sidebar>
		</section>
		 <section>
			<title>Installing Debian</title>
			 <para>
				Once all the required information on the current server is known, we can shut it down and begin to install Debian on it.
			</para>
			 <indexterm>
				<primary>architecture</primary>
			</indexterm>
			 <para>
				To choose the appropriate version, we must know the computer's architecture. If it is a reasonably recent PC, it is most likely to be amd64 (older PCs were usually i386). In other cases, we can narrow down the possibilities according to the previously used system.
			</para>
			 <para>
				<xref linkend="tab-corresp" xrefstyle="select: label nopage" /> is not intended to be exhaustive, but may be helpful. In any case, the original documentation for the computer is the most reliable source to find this information.
			</para>
			 <table colsep="1" id="tab-corresp">
				<title>Matching operating system and architecture</title>
				 <tgroup cols="2">
					<thead>
						<row>
							<entry>Operating System</entry>
							 <entry>Architecture(s)</entry>

						</row>

					</thead>
					 <tbody>
						<row>
							<entry>DEC Unix (OSF/1)</entry>
							 <entry>alpha, mipsel</entry>

						</row>
						 <row>
							<entry>HP Unix</entry>
							 <entry>ia64, hppa</entry>

						</row>
						 <row>
							<entry>IBM AIX</entry>
							 <entry>powerpc</entry>

						</row>
						 <row>
							<entry>Irix</entry>
							 <entry>mips</entry>

						</row>
						 <row>
							<entry>OS X</entry>
							 <entry>amd64, powerpc, i386</entry>

						</row>
						 <row>
							<entry>z/OS, MVS</entry>
							 <entry>s390x, s390</entry>

						</row>
						 <row>
							<entry>Solaris, SunOS</entry>
							 <entry>sparc, i386, m68k</entry>

						</row>
						 <row>
							<entry>Ultrix</entry>
							 <entry>mips</entry>

						</row>
						 <row>
							<entry>VMS</entry>
							 <entry>alpha</entry>

						</row>
						 <row>
							<entry>Windows 95/98/ME</entry>
							 <entry>i386</entry>

						</row>
						 <row>
							<entry>Windows NT/2000</entry>
							 <entry>i386, alpha, ia64, mipsel</entry>

						</row>
						 <row>
							<entry>Windows XP / Windows Server 2008</entry>
							 <entry>i386, amd64, ia64</entry>

						</row>
						 <row>
							<entry>Windows RT</entry>
							 <entry>armel, armhf, arm64</entry>

						</row>
						 <row>
							<entry>Windows Vista / Windows 7-8-10</entry>
							 <entry>i386, amd64</entry>

						</row>

					</tbody>

				</tgroup>

			</table>
			 <sidebar> <title><emphasis>HARDWARE</emphasis> 64 bit PC vs 32 bit PC</title>
			 <indexterm>
				<primary>amd64</primary>
			</indexterm>
			 <indexterm>
				<primary>i386</primary>
			</indexterm>
			 <para>
				Most recent computers have 64 bit Intel or AMD processors, compatible with older 32 bit processors; the software compiled for “i386” architecture thus works. On the other hand, this compatibility mode does not fully exploit the capabilities of these new processors. This is why Debian provides the “amd64” architecture, which works for recent AMD chips as well as Intel “em64t” processors (including most of the Core series), which are very similar to AMD64.
			</para>
			 </sidebar>
		</section>
		 <section>
			<title>Installing and Configuring the Selected Services</title>
			 <para>
				Once Debian is installed, we must install and configure one by one all of the services that this computer must host. The new configuration must take into consideration the prior one in order to ensure a smooth transition. All the information collected in the first two steps will be useful to successfully complete this part.
			</para>
			 <figure>
				<title>Install the selected services</title>
				 <mediaobject>
					<imageobject>
						<imagedata fileref="images/existing-setup-4.png" format="PNG" width="66%" />
					</imageobject>

				</mediaobject>

			</figure>
			 <para>
				Prior to jumping into this exercise with both feet, it is strongly recommended that you read the remainder of this book. After that you will have a more precise understanding of how to configure the expected services.
			</para>
			 <para>
			</para>

		</section>

	</section>
</chapter>

