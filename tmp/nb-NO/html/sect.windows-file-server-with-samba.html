<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">11.5. Oppsett av Windows Shares med Samba</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-nb-NO-1.0-1" /><meta
        name="keywords"
        content="Postfix, Apache, NFS, Samba, Squid, OpenLDAP, SIP" /><link
        rel="home"
        href="index.html"
        title="Håndbok for Debian-administratoren" /><link
        rel="up"
        href="network-services.html"
        title="Kapittel 11. Nettverkstjenester: Postfix, Apache, NFS, Samba, Squid, LDAP, SIP, XMPP, TURN" /><link
        rel="prev"
        href="sect.nfs-file-server.html"
        title="11.4. NFS-filtjener" /><link
        rel="next"
        href="sect.http-ftp-proxy.html"
        title="11.6. HTTP/FTP-mellomtjener" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/nb-NO/stable/sect.windows-file-server-with-samba.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.nfs-file-server.html"><strong>Forrige</strong></a></li><li
          class="home">Håndbok for Debian-administratoren</li><li
          class="next"><a
            accesskey="n"
            href="sect.http-ftp-proxy.html"><strong>Neste</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.windows-file-server-with-samba"></a>11.5. Oppsett av Windows Shares med Samba</h2></div></div></div><div
          class="para">
			Samba er en pakke med verktøy som håndterer SMB-protokollen (også kjent som «CIFS») på Linux. Denne protokollen brukes av Windows for nettverksressurser og delte skrivere.
		</div><a
          id="id-1.14.8.3"
          class="indexterm"></a><a
          id="id-1.14.8.4"
          class="indexterm"></a><a
          id="id-1.14.8.5"
          class="indexterm"></a><a
          id="id-1.14.8.6"
          class="indexterm"></a><a
          id="id-1.14.8.7"
          class="indexterm"></a><div
          class="para">
			Samba kan også virke som en Windows domenekontrollør. Denne er et enestående verktøy for å sikre sømløs integrasjon av Linux-tjenere og stasjonære kontormaskiner som fortsatt kjører Windows.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.8.9"></a>11.5.1. Samba-tjener</h3></div></div></div><div
            class="para">
				Pakken <span
              class="pkg pkg">samba</span> inneholder Samba 4s to hovedtjenere, <code
              class="command">smbd</code> og <code
              class="command">nmbd</code>.
			</div><a
            id="id-1.14.8.9.3"
            class="indexterm"></a><a
            id="id-1.14.8.9.4"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DOKUMENTASJON</em></span> For viderekommende</strong></p></div></div></div><div
              class="para">
				Samba-tjeneren er ekstremt oppsettbar og allsidig, og kan håndtere svært mange forskjellige bruksmåter som imøtekommer svært ulike krav og nettverksarkitekturer. Denne boken fokuserer bare på bruken der Samba brukes som en frittstående tjener, men det kan også være en NT4 Hoved domenekontroller (NT4 Domain Controller), eller en full Active Directory Domain Controller, eller et enkel medlem av et eksisterende domene (som kan være en styrt av en Windows-tjener).
			</div><a
              id="id-1.14.8.9.5.3"
              class="indexterm"></a><a
              id="id-1.14.8.9.5.4"
              class="indexterm"></a><div
              class="para">
				Pakken <span
                class="pkg pkg">samba-doc</span> inneholder et stort utvalg av kommenterte eksempelfiler i <code
                class="filename">/usr/share/doc/samba-doc/examples/</code>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>VERKTØY</em></span> Autentisering med en Windows-tjener</strong></p></div></div></div><div
              class="para">
				Winbind gir systemadministratorer muligheten til å bruke en Windows-server som en godkjenningstjener. Winbind integrerer også rent med PAM og NSS. Dette gjør det mulig å sette opp Linux-maskiner der alle brukere av et Windows-domene automatisk får en konto.
			</div><a
              id="id-1.14.8.9.6.3"
              class="indexterm"></a><div
              class="para">
				Mer informasjon kan finnes i <code
                class="filename">/usr/share/doc/samba-doc/examples/pam_winbind/</code>-mappen.
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.9.7"></a>11.5.1.1. Oppsett med <code
                      class="command">debconf</code></h4></div></div></div><div
              class="para">
					Pakken setter opp et minimalt oppsett under den første installasjonen, men du skulle virkelig kjøre <code
                class="command">dpkg-reconfigure samba-common</code> for tilpasning til:
				</div><div
              class="para">
					Den første delen med nødvendig informasjon er navnet på arbeidsgruppen som Samba-tjeneren vil tilhøre (svaret er <code
                class="literal">FALCOTNET</code> i vårt tilfelle).
				</div><div
              class="para">
					Pakken foreslår også å identifisere WINS-tjeneren ut fra opplysninger gitt av DHCP-bakgrunnsprosessen. Falcot Corp-administratorene forkastet dette alternativet, siden de har tenkt å bruke Samba-tjeneren som WINS-tjener.
				</div><a
              id="id-1.14.8.9.7.5"
              class="indexterm"></a></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.9.8"></a>11.5.1.2. Manuelt oppsett</h4></div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.14.8.9.8.2"></a>11.5.1.2.1. Forandringer i <code
                        class="filename">smb.conf</code></h5></div></div></div><div
                class="para">
						Kravene hos Falcot forutsetter også endringer i andre valg i <code
                  class="filename">/etc/samba/smb.conf</code>. Følgende utdrag oppsummerer de endringene som ble berørt i <code
                  class="literal">[global]</code>-seksjonen.
					</div><pre
                class="programlisting">
[global]

## Browsing/Identification ###

# Change this to the workgroup/NT-domain name your Samba server will part of
   workgroup = FALCOTNET

# Windows Internet Name Serving Support Section:
# WINS Support - Tells the NMBD component of Samba to enable its WINS Server
   wins support = yes <span
                  id="smb.conf.wins"><img
                    class="callout"
                    src="Common_Content/images/1.png"
                    alt="1" /></span>

[...]

####### Authentication #######

# Server role. Defines in which mode Samba will operate. Possible
# values are "standalone server", "member server", "classic primary
# domain controller", "classic backup domain controller", "active
# directory domain controller". 
#
# Most people will want "standalone sever" or "member server".
# Running as "active directory domain controller" will require first
# running "samba-tool domain provision" to wipe databases and create a
# new domain.
   server role = standalone server

# "security = user" is always a good idea. This will require a Unix account
# in this server for every user accessing the server.
   security = user <span
                  id="smb.conf.security"><img
                    class="callout"
                    src="Common_Content/images/2.png"
                    alt="2" /></span>

[...]</pre><div
                class="calloutlist"><table
                  border="0"
                  summary="Callout list"><tr><td
                      width="5%"
                      valign="top"
                      align="left"><p><a
                          href="#smb.conf.wins"><img
                            class="callout"
                            src="Common_Content/images/1.png"
                            alt="1" /></a> </p></td><td
                      valign="top"
                      align="left"><div
                        class="para">
								Viser at Samba skal fungere som en NetBIOS-navneserver (WINS) for det lokale nettverket.
							</div></td></tr><tr><td
                      width="5%"
                      valign="top"
                      align="left"><p><a
                          href="#smb.conf.security"><img
                            class="callout"
                            src="Common_Content/images/2.png"
                            alt="2" /></a> </p></td><td
                      valign="top"
                      align="left"><div
                        class="para">
								Dette er standardverdien for denne parameteren; men siden den er sentral i Samba-oppsettet, anbefales det å fylle den inn eksplisitt. Hver bruker må godkjennes før noen deling.
							</div></td></tr></table></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.14.8.9.8.3"></a>11.5.1.2.2. Å legge til brukere</h5></div></div></div><div
                class="para">
						Hver Samba-bruker trenger en konto på tjeneren; Unix-kontoer må opprettes først, deretter må brukeren bli registrert i Sambas database. Unix-trinnet utføres ganske vanlig (ved hjelp <code
                  class="command">adduser</code> for eksempel).
					</div><div
                class="para">
						Å legge til en eksisterende bruker til Samba-databasen er et spørsmål om å kjøre <code
                  class="command">smbpasswd -a <em
                    class="replaceable">bruker</em></code>-kommandoen; denne kommandoen ber interaktivt om passordet.
					</div><div
                class="para">
						En bruker kan bli slettet med <code
                  class="command">smbpasswd -x <em
                    class="replaceable">bruker</em></code>-kommandoen. En Samba-konto kan også midlertidig bli deaktivert (med <code
                  class="command">smbpasswd -d <em
                    class="replaceable">bruker</em></code>), og reaktivert senere (med <code
                  class="command">smbpasswd -e <em
                    class="replaceable">bruker</em></code>).
					</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.14.8.10"></a>11.5.2. Samba-klient</h3></div></div></div><div
            class="para">
				Klient-funksjonene i Samba tillater en Linux-maskin å få tilgang til Windows-delinger og delte skrivere. De nødvendige programmene er tilgjengelig i <span
              class="pkg pkg">cifs-utils</span> og <span
              class="pkg pkg">smbclient</span>-pakkene.
			</div><a
            id="id-1.14.8.10.3"
            class="indexterm"></a><a
            id="id-1.14.8.10.4"
            class="indexterm"></a><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.5"></a>11.5.2.1. Programmet <code
                      class="command">smbclient</code></h4></div></div></div><div
              class="para">
					Programmet <code
                class="command">smbclient</code> forespør SMB-tjenere. Det aksepterer et <code
                class="literal">-U <em
                  class="replaceable">bruker</em></code>-alternativ, for å koble til tjeneren med en bestemt identitet. <code
                class="command">smbclient //<em
                  class="replaceable">server</em>/<em
                  class="replaceable">dele</em></code> åpner for delingen interaktivt på en måte lik kommandolinje FTP-klienten. <code
                class="command">smbclient -L <em
                  class="replaceable">server</em></code> lister opp alle tilgjengelige (og synlige) delinger på en tjener.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.6"></a>11.5.2.2. Montere Windows-delinger</h4></div></div></div><div
              class="para">
					Kommandoen <code
                class="command">mount</code> tillater montering av en Windows-deling inn i Linux-filsystemhierarki (ved hjelp av <code
                class="command">mount.cifs</code> levert av <span
                class="pkg pkg">cifs-utils</span>).
				</div><a
              id="id-1.14.8.10.6.3"
              class="indexterm"></a><a
              id="id-1.14.8.10.6.4"
              class="indexterm"></a><div
              class="example"><a
                xmlns=""
                id="id-1.14.8.10.6.5"></a><p
                class="title"><strong>Eksempel 11.24. Å montere en Windows-deling</strong></p><div
                class="example-contents"><pre
                  class="programlisting">
mount -t cifs //arrakis/shared /shared \
      -o credentials=/etc/smb-credentials</pre></div></div><div
              class="para">
					Fil <code
                class="filename">/etc/smb-credentials</code> (som ikke må være lesbar av brukere) har følgende format:
				</div><pre
              class="programlisting">
username = <em
                class="replaceable">bruker</em>
password = <em
                class="replaceable">passord</em></pre><div
              class="para">
					Andre alternativer kan spesifiseres på kommandolinjen; den fullstendige listen er tilgjengelig i <span
                class="citerefentry"><span
                  class="refentrytitle">mount.cifs</span>(1)</span>-manulaside. Spesielt to alternativer kan være interessante: <code
                class="literal">uid</code> og <code
                class="literal">gid</code> som tillater å tvinge eieren og gruppen filer som er tilgjengelig i monteringen, for ikke å begrense adgangen til rot.
				</div><div
              class="para">
					En montering av en Windows-deling kan også settes opp i <code
                class="filename">/etc/fstab</code>:
				</div><pre
              class="programlisting">
//<em
                class="replaceable">tjener</em>/shared /shared cifs credentials=/etc/smb-credentials</pre><div
              class="para">
					Å avmontere en SMB/CIFS-deling er gjort med standarden <code
                class="command">umount</code>-kommandoen.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.14.8.10.7"></a>11.5.2.3. Å skrive ut på en delt skriver</h4></div></div></div><div
              class="para">
					CUPS er en elegant løsning for utskrift fra en Linux-arbeidsstasjon til en skriver som deles av en Windows-maskin. Når <span
                class="pkg pkg">smbclient</span> er installert, tillater CUPS automatisk installasjon av Windows-delte skrivere.
				</div><a
              id="id-1.14.8.10.7.3"
              class="indexterm"></a><div
              class="para">
					Her er skrittene som kreves:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							Bruk CUPS oppsettsgrensesnittet:<code
                      class="literal">http://localhost:631/admin</code>
						</div></li><li
                  class="listitem"><div
                    class="para">
							Klikk på «Legg til skriver».
						</div></li><li
                  class="listitem"><div
                    class="para">
							Velg skriverenheten, plukk ut «Windows Printer via SAMBA».
						</div></li><li
                  class="listitem"><div
                    class="para">
							Bruk tilkoblings-URI-en (angi URI) for nettverksskriveren. Den skal se ut som følger:
						</div><div
                    class="para">
							<code
                      class="literal">smb://<em
                        class="replaceable">bruker</em>:<em
                        class="replaceable">passord</em>@<em
                        class="replaceable">server</em>/<em
                        class="replaceable">skriver</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Skriv inn navnet som unikt identifiserer denne skriveren. Deretter skriver du inn beskrivelsen og plasseringen av skriveren. De er strengene som skal vises til sluttbrukere for å hjelpe dem med å identifisere skriverne.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Indiker produsenten/skrivermodellen, eller lever/gi direkte en skriverbeskrivelsesfil (PPD (PostScript Printer Description)) som virker.
						</div></li></ul></div><div
              class="para">
					Voilà, skriveren er operativ!
				</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.nfs-file-server.html"><strong>Forrige</strong>11.4. NFS-filtjener</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Opp</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Hjem</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.http-ftp-proxy.html"><strong>Neste</strong>11.6. HTTP/FTP-mellomtjener</a></li></ul></body></html>
