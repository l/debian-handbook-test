<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">9.5. syslog 系統事件</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-zh-TW-1.0-1" /><meta
        name="keywords"
        content="系統啟動, 初始化腳本, SSH, Telnet, 權力, 權限, 監督, Inetd, Cron, 備份, 熱插拔, PCMCIA, APM, ACPI" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="unix-services.html"
        title="章 9. Unix 服務" /><link
        rel="prev"
        href="sect.administration-interfaces.html"
        title="9.4. 管理介面" /><link
        rel="next"
        href="sect.inetd.html"
        title="9.6. The inetd Super-Server" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/zh-TW/stable/sect.syslog.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.administration-interfaces.html"><strong>前一頁</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.inetd.html"><strong>下一頁</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.syslog"></a>9.5. <code
                  class="command">syslog</code> 系統事件</h2></div></div></div><a
          id="id-1.12.8.2"
          class="indexterm"></a><a
          id="id-1.12.8.3"
          class="indexterm"></a><a
          id="id-1.12.8.4"
          class="indexterm"></a><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.syslog-principe"></a>9.5.1. 原則與機制</h3></div></div></div><div
            class="para">
				此 <code
              class="command">rsyslogd</code> 後台進程負責搜集來自應用程式與核心的服務訊息，然後送至日誌檔內 (通常儲存在 <code
              class="filename">/var/log/</code> 資料夾內)。遵守 <code
              class="filename">/etc/rsyslog.conf</code> 組態檔案的要求。
			</div><div
            class="para">
				每個日誌檔內的訊息都與應用程式次系統有關 (文件中稱為 “設施”)：
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">auth</code> 和 <code
                    class="literal">authpriv</code>：供認證之用；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">cron</code>：來自工作排程服務，<code
                    class="command">cron</code> 和 <code
                    class="command">atd</code>；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">daemon</code>：未受任何特別分類影響的後台進程 (DNS、NTP 等)；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">ftp</code>：關心 FTP 伺服器；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">kern</code>：來自核心的訊息；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">lpr</code>：來自列印次系統的；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">mail</code>：來自電子郵件次系統；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">news</code>：Usenet 次系統的訊息 (尤其是來自管理新聞群組的 NNTP — Network News Transfer Protocol — 伺服器)；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">syslog</code>：來自 <code
                    class="command">syslogd</code> 伺服器本身的訊息；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">user</code>：使用者訊息 (一般)；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">uucp</code>：來自 UUCP 伺服器 (Unix to Unix Copy Program，用於散布電子郵件訊息的通訊協定) 的訊息；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">local0</code> 至 <code
                    class="literal">local7</code>：保留給在地使用。
					</div></li></ul></div><div
            class="para">
				每個訊息有其自身的優先層級。以下的遞減的清單：
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">emerg</code>：“救命！” 緊急狀態，系統可能已掛了。
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">alert</code>：趕快，任何延誤可能造成危險，必須立即採取行動；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">crit</code>：情況嚴重；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">err</code>：錯誤；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">warn</code>：警示 (可能的錯誤)；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">notice</code>：情況正常，但訊息極重要；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">info</code>：資訊性訊息；
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">debug</code>：需要除錯的訊息。
					</div></li></ul></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.syslog-config"></a>9.5.2. 組態檔案</h3></div></div></div><div
            class="para">
				The syntax of the <code
              class="filename">/etc/rsyslog.conf</code> file is detailed in the <span
              class="citerefentry"><span
                class="refentrytitle">rsyslog.conf</span>(5)</span> manual page, but there is also HTML documentation available in the <span
              class="pkg pkg">rsyslog-doc</span> package (<code
              class="filename">/usr/share/doc/rsyslog-doc/html/index.html</code>). The overall principle is to write “selector” and “action” pairs. The selector defines all relevant messages, and the actions describes how to deal with them.
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.syslog-selector-syntax"></a>9.5.2.1. Syntax of the Selector</h4></div></div></div><div
              class="para">
					The selector is a semicolon-separated list of <code
                class="literal"><em
                  class="replaceable">subsystem</em>.<em
                  class="replaceable">priority</em></code> pairs (example: <code
                class="literal">auth.notice;mail.info</code>). An asterisk may represent all subsystems or all priorities (examples: <code
                class="literal">*.alert</code> or <code
                class="literal">mail.*</code>). Several subsystems can be grouped, by separating them with a comma (example: <code
                class="literal">auth,mail.info</code>). The priority indicated also covers messages of equal or higher priority; thus <code
                class="literal">auth.alert</code> indicates the <code
                class="literal">auth</code> subsystem messages of <code
                class="literal">alert</code> or <code
                class="literal">emerg</code> priority. Prefixed with an exclamation point (!), it indicates the opposite, in other words the strictly lower priorities; <code
                class="literal">auth.!notice</code>, thus, indicates messages issued from <code
                class="literal">auth</code>, with <code
                class="literal">info</code> or <code
                class="literal">debug</code> priority. Prefixed with an equal sign (=), it corresponds to precisely and only the priority indicated (<code
                class="literal">auth.=notice</code> only concerns messages from <code
                class="literal">auth</code> with <code
                class="literal">notice</code> priority).
				</div><div
              class="para">
					Each element in the list on the selector overrides previous elements. It is thus possible to restrict a set or to exclude certain elements from it. For example, <code
                class="literal">kern.info;kern.!err</code> means messages from the kernel with priority between <code
                class="literal">info</code> and <code
                class="literal">warn</code>. The <code
                class="literal">none</code> priority indicates the empty set (no priorities), and may serve to exclude a subsystem from a set of messages. Thus, <code
                class="literal">*.crit;kern.none</code> indicates all the messages of priority equal to or higher than <code
                class="literal">crit</code> not coming from the kernel.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.syslog-action-syntax"></a>9.5.2.2. Syntax of Actions</h4></div></div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>BACK TO BASICS</em></span> The named pipe, a persistent pipe</strong></p></div></div></div><a
                id="id-1.12.8.6.4.2.2"
                class="indexterm"></a><a
                id="id-1.12.8.6.4.2.3"
                class="indexterm"></a><div
                class="para">
					A named pipe is a particular type of file that operates like a traditional pipe (the pipe that you make with the “|” symbol on the command line), but via a file. This mechanism has the advantage of being able to relate two unrelated processes. Anything written to a named pipe blocks the process that writes until another process attempts to read the data written. This second process reads the data written by the first, which can then resume execution.
				</div><div
                class="para">
					Such a file is created with the <code
                  class="command">mkfifo</code> command.
				</div></div><div
              class="para">
					The various possible actions are:
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							add the message to a file (example: <code
                      class="filename">/var/log/messages</code>);
						</div></li><li
                  class="listitem"><div
                    class="para">
							send the message to a remote <code
                      class="command">syslog</code> server (example: <code
                      class="literal">@log.falcot.com</code>);
						</div></li><li
                  class="listitem"><div
                    class="para">
							send the message to an existing named pipe (example: <code
                      class="literal">|/dev/xconsole</code>);
						</div></li><li
                  class="listitem"><div
                    class="para">
							send the message to one or more users, if they are logged in (example: <code
                      class="literal">root,rhertzog</code>);
						</div></li><li
                  class="listitem"><div
                    class="para">
							send the message to all logged in users (example: <code
                      class="literal">*</code>);
						</div></li><li
                  class="listitem"><div
                    class="para">
							write the message in a text console (example: <code
                      class="literal">/dev/tty8</code>).
						</div></li></ul></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>SECURITY</em></span> Forwarding logs</strong></p></div></div></div><a
                id="id-1.12.8.6.4.5.2"
                class="indexterm"></a><div
                class="para">
					It is a good idea to record the most important logs on a separate machine (perhaps dedicated for this purpose), since this will prevent any possible intruder from removing traces of their intrusion (unless, of course, they also compromise this other server). Furthermore, in the event of a major problem (such as a kernel crash), you have the logs available on another machine, which increases your chances of determining the sequence of events that caused the crash.
				</div><div
                class="para">
					To accept log messages sent by other machines, you must reconfigure <span
                  class="emphasis"><em>rsyslog</em></span>: in practice, it is sufficient to activate the ready-for-use entries in <code
                  class="filename">/etc/rsyslog.conf</code> (<code
                  class="literal">$ModLoad imudp</code> and <code
                  class="literal">$UDPServerRun 514</code>).
				</div></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.administration-interfaces.html"><strong>前一頁</strong>9.4. 管理介面</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一層</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始頁</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.inetd.html"><strong>下一頁</strong>9.6. The inetd Super-Server</a></li></ul></body></html>
