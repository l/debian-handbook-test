<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">8.2. 組態網路</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-zh-TW-1.0-1" /><meta
        name="keywords"
        content="組態, 在地化, 地區設定, 網路, 名稱解析, 使用者, 群組, 帳號, 命令列解析器, Shell, 列印, 啟動程式, 編譯核心" /><link
        rel="home"
        href="index.html"
        title="The Debian Administrator's Handbook" /><link
        rel="up"
        href="basic-configuration.html"
        title="章 8. 基本組態：網路、帳號、列印..." /><link
        rel="prev"
        href="basic-configuration.html"
        title="章 8. 基本組態：網路、帳號、列印..." /><link
        rel="next"
        href="sect.hostname-name-service.html"
        title="8.3. 設定主機名稱與組態名稱服務" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/zh-TW/stable/sect.network-config.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="basic-configuration.html"><strong>前一頁</strong></a></li><li
          class="home">The Debian Administrator's Handbook</li><li
          class="next"><a
            accesskey="n"
            href="sect.hostname-name-service.html"><strong>下一頁</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.network-config"></a>8.2. 組態網路</h2></div></div></div><div
          class="sidebar"><a
            xmlns=""
            id="sidebar.networking-basics"></a><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>基本</em></span> 必要的網路概念 (Ethernet、IP 位址、次網路、廣播)</strong></p></div></div></div><a
            id="id-1.11.6.2.2"
            class="indexterm"></a><a
            id="id-1.11.6.2.3"
            class="indexterm"></a><a
            id="id-1.11.6.2.4"
            class="indexterm"></a><a
            id="id-1.11.6.2.5"
            class="indexterm"></a><a
            id="id-1.11.6.2.6"
            class="indexterm"></a><a
            id="id-1.11.6.2.7"
            class="indexterm"></a><a
            id="id-1.11.6.2.8"
            class="indexterm"></a><div
            class="para">
			當代的網路多半使用 Ethernet 協定，資料分為小小的區塊稱為框並且一次傳送一個框。傳送的速度從舊型 Ethernet 卡的 10 Mb/s 至最新卡的 10 Gb/s (最常見的速度為 100 Mb/s 至 1 Gb/s)。最常見的纜線是 10BASE-T、100BASE-T、1000BASE-T 或 10GBASE-T，視需求而定 (T 是雙絞線英文名稱的第一個字母 “twisted pair”)；這些纜線以 RJ45 連結器相接。當然還有其他類型的纜線，通常供速度超過 1 Gb/s 以上的環境使用。
		</div><a
            id="id-1.11.6.2.10"
            class="indexterm"></a><a
            id="id-1.11.6.2.11"
            class="indexterm"></a><div
            class="para">
			IP 位址是一組數字用於辨識電腦在地區網路或網際網路的介面。最常用的是 IP 版本是 (IPv4)，此組數字由 32 位元編成，通常以句點區隔的 4 個數字表示 (如 <code
              class="literal">192.168.0.1</code>)，使用 0 至 255 之間的數字 (含在內，對應於 8 位元的資料)。通信協定的下個版本是 IPv6，採用 128 位元表示一個位址，其位址以 16 進位表示，用冒號區隔 (如，2001:0db8:13bb:0002:0000:0000:0000:0020，或 2001:db8:13bb:2::20 簡版表示)。
		</div><a
            id="id-1.11.6.2.13"
            class="indexterm"></a><a
            id="id-1.11.6.2.14"
            class="indexterm"></a><a
            id="id-1.11.6.2.15"
            class="indexterm"></a><div
            class="para">
			次網路遮罩 (網路遮罩) 設定對應於網路的 IP 位址二進位代碼，其餘的則有機器指定。在前述的固定 IPv4 位址中，次網路遮罩，<code
              class="literal">255.255.255.0</code> (以 2 進位表示，就是 24 個 “1” 之後接著 8 個 “0”) 表示 IP 位址前 24 位元對應至網路位址，且其餘 8 個則指向機器。在 IPv6 裡，為了方便閱讀，祗表示數字 “1”；IPv6 網路的網路遮罩可以是 <code
              class="literal">64</code>。
		</div><div
            class="para">
			網路位址是一個 IP 位址，描述機器的號碼是 0。IPv4 位址的範圍是完成的網路以此語法表示，<span
              class="emphasis"><em>a.b.c.d/e</em></span>，<span
              class="emphasis"><em>a.b.c.d</em></span> 是網路位址，而 <span
              class="emphasis"><em>e</em></span> 是被影響的位元數。因此，此網路可寫成：<code
              class="literal">192.168.0.0/24</code>。在 IPv6 的類似語法為：<code
              class="literal">2001:db8:13bb:2::/64</code>。
		</div><a
            id="id-1.11.6.2.18"
            class="indexterm"></a><a
            id="id-1.11.6.2.19"
            class="indexterm"></a><div
            class="para">
			路由器用於連結多個網路。進入路由器的資訊被引導至正確的網路。所以，路由器分析進來的封包，根據其目的位址轉送至其他地方。路由器通常稱為閘道器；協助進入在地網路以外的地方 (網際網路之類的外部網路)。
		</div><a
            id="id-1.11.6.2.21"
            class="indexterm"></a><div
            class="para">
			特定的廣播位址連結網路內所有的站台。幾乎不曾 “發送”，祗在網路內發送問題。就是說，經由廣播發送的資料封包不會通常路由器。
		</div><div
            class="para">
			本章祗討論 IPv4 位址，現在最常見的。IPv6 協定的詳情在 <a
              class="xref"
              href="sect.ipv6.html">節 10.5, “IPv6”</a>，其概念是一樣的。
		</div></div><div
          class="para">
			初始安裝時會自動組態網路，<code
            class="filename">/etc/network/interfaces</code> 檔案內已有完備的組態。以 <code
            class="literal">auto</code> 起頭的資料在開機時自動被 <span
            class="pkg pkg">ifupdown</span> 組態，且組態它的 <code
            class="filename">/etc/init.d/networking</code> init 腳本。通常是 <code
            class="literal">eth0</code>，指向第一個 Ethernet 網卡。
		</div><a
          id="id-1.11.6.4"
          class="indexterm"></a><a
          id="id-1.11.6.5"
          class="indexterm"></a><a
          id="id-1.11.6.6"
          class="indexterm"></a><a
          id="id-1.11.6.7"
          class="indexterm"></a><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>其他</em></span> NetworkManager</strong></p></div></div></div><a
            id="id-1.11.6.8.2"
            class="indexterm"></a><div
            class="para">
			漫遊設定推薦使用的網路管理器 (見 <a
              class="xref"
              href="sect.network-config.html#sect.roaming-network-config">節 8.2.4, “網路自動組態漫遊使用者”</a>)，同樣適用於預設的網路管理工具。啟動電腦時以人工啟用 <code
              class="filename">.ini</code> 之類的檔案在 <code
              class="filename">/etc/NetworkManager/system-connections/</code> 之內或經由圖形工具 (<code
              class="command">nm-connection-editor</code>)，可以同時新增 “系統連結”。想要網路管理器處理它們時，記得關閉 <code
              class="filename">/etc/network/interfaces</code> 內的所有條目。<div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="https://wiki.gnome.org/Projects/NetworkManager/SystemSettings/jessie">https://wiki.gnome.org/Projects/NetworkManager/SystemSettings/jessie</a></div> <div
              xmlns=""
              class="url">→ <a
                xmlns="http://www.w3.org/1999/xhtml"
                href="https://developer.gnome.org/NetworkManager/0.9/ref-settings.html">https://developer.gnome.org/NetworkManager/0.9/ref-settings.html</a></div>
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.interface-ethernet"></a>8.2.1. Ethernet 介面</h3></div></div></div><div
            class="para">
				電腦使用 Ethernet 網路卡時，必須以下列的方法之一組態 IP 網路。最簡單的方式是以 DHCP 動態組態，需要在地網路的 DHCP 伺服器。可以使用與下例 <code
              class="literal">hostname</code> 設定的主機名稱。DHCP 伺服器就會送出組態設定給適當的網路。
			</div><a
            id="id-1.11.6.9.3"
            class="indexterm"></a><a
            id="id-1.11.6.9.4"
            class="indexterm"></a><div
            class="example"><a
              xmlns=""
              id="example.config-dhcp"></a><p
              class="title"><strong>範例 8.1. DHCP 組態</strong></p><div
              class="example-contents"><pre
                class="programlisting">
auto eth0
iface eth0 inet dhcp
  hostname arrakis</pre></div></div><div
            class="para">
				“靜態” 組態必須以固定方式指明網路設定。至少包括 IP 網址及次網路遮罩；有時也列出網路及廣播位址。必須以閘道指出連結外部的路由器。
			</div><div
            class="example"><a
              xmlns=""
              id="example.static-network"></a><p
              class="title"><strong>範例 8.2. 靜態組態</strong></p><div
              class="example-contents"><pre
                class="programlisting">
auto eth0
iface eth0 inet static
  address 192.168.0.3
  netmask 255.255.255.0
  broadcast 192.168.0.255
  network 192.168.0.0
  gateway 192.168.0.1</pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>說明</em></span> 多位址</strong></p></div></div></div><div
              class="para">
				在一個實體網路卡上可以連結多個介面，而且可以設定多個 IP 位址。IP 位址本身可以經由 DNS 對應至多個網域名稱，名稱本身可以對應至多個 IP 位址。
			</div><div
              class="para">
				如您所想，組態可以極為複雜，不過祗限於極為特殊的例子。此處引用的例子都是一般常見的組態。
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.ppp-rtc"></a>8.2.2. 經由 PSTN 數據機的 PPP 連結</h3></div></div></div><a
            id="id-1.11.6.10.2"
            class="indexterm"></a><a
            id="id-1.11.6.10.3"
            class="indexterm"></a><a
            id="id-1.11.6.10.4"
            class="indexterm"></a><a
            id="id-1.11.6.10.5"
            class="indexterm"></a><div
            class="para">
				點對點 (PPP) 連結建立斷續的連結；這是電話數據機最常見的連結方式 (“PSTN 數據機”，經由公共交換電話網路)。
			</div><div
            class="para">
				電話數據機需要帳號才能連結，包括電話號碼、使用者名稱、密碼、以及認證協定。這種連結 Debian 同名套件內的使用 <code
              class="command">pppconfig</code> 工具。預設使用的名稱是 <code
              class="literal">提供者</code> (做為網際網路服務提供者)。對認證協定有疑義時，選擇 <span
              class="emphasis"><em>PAP</em></span>：大多數網際網路服務提供者使用它。
			</div><a
            id="id-1.11.6.10.8"
            class="indexterm"></a><a
            id="id-1.11.6.10.9"
            class="indexterm"></a><div
            class="para">
				組態之後，就可以使用 <code
              class="command">pon</code> 命令 (<code
              class="literal">提供者</code> 的預設值不適用時，將連結的名稱當成參數)。以 <code
              class="command">poff</code> 命令斷線。這兩個令可以被根使用者執行，或位在 <code
              class="literal">dip</code> 群組的其他使用者。
			</div><a
            id="id-1.11.6.10.11"
            class="indexterm"></a><a
            id="id-1.11.6.10.12"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.adsl"></a>8.2.3. 以 ADSL 數據連結</h3></div></div></div><a
            id="id-1.11.6.11.2"
            class="indexterm"></a><a
            id="id-1.11.6.11.3"
            class="indexterm"></a><a
            id="id-1.11.6.11.4"
            class="indexterm"></a><div
            class="para">
				“ADSL 數據機” 一辭包括不同功能的多種設備。使用 Linux 的數據機有 Ethernet 介面 (不祗是 USB 介面)。這是極為普遍的數據機；大部份的 ADSL 網際網路服務商出借 (或出租) 一個含 Ethernet 介面的 “盒子”。視其類型而有不同的設定。
			</div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.adsl-pppoe"></a>8.2.3.1. 支援 PPPOE 的數據機</h4></div></div></div><a
              id="id-1.11.6.11.6.2"
              class="indexterm"></a><a
              id="id-1.11.6.11.6.3"
              class="indexterm"></a><div
              class="para">
					部份 Ethernet 數據機使用 PPPOE 協定 (乙太網上的對等協定，Point to Point Protocol over Ethernet)。<code
                class="command">pppoeconf</code> 工具 (位於同名套件內) 將組態其連結。修改 <code
                class="filename">/etc/ppp/peers/dsl-provider</code> 檔案內容時，採用 <code
                class="filename">/etc/ppp/pap-secrets</code> 與 <code
                class="filename">/etc/ppp/chap-secrets</code> 檔案的內容。建議全盤接納所有的提議。
				</div><div
              class="para">
					組態完成之後，以命令 <code
                class="command">pon dsl-provider</code> 開啟 ADSL 連結，並以命令 <code
                class="command">poff dsl-provider</code> 斷線。
				</div><a
              id="id-1.11.6.11.6.6"
              class="indexterm"></a><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>秘訣</em></span>啟動 <code
                          class="command">ppp</code> 於開機時</strong></p></div></div></div><a
                id="id-1.11.6.11.6.7.2"
                class="indexterm"></a><a
                id="id-1.11.6.11.6.7.3"
                class="indexterm"></a><div
                class="para">
					PPP 在 ADSL 上的連結，其本意是斷斷續續的。因為不是依照連線時間收費，所以不必隨時打開它。標準的方法是使用 init 系統。
				</div><div
                class="para">
					在 <span
                  class="distribution distribution">Jessie</span> 預設的 init 系統是 <code
                  class="command">systemd</code>。在 ADSL 連結自動重新啟動很簡單，新增一個像 <code
                  class="filename">/etc/systemd/system/adsl-connection.service</code> 之類的 “unit file” 就可以了，其內容類似以下的：
				</div><pre
                class="programlisting">[Unit]
Description=ADSL connection

[Service]
Type=forking
ExecStart=/usr/sbin/pppd call dsl-provider
Restart=always

[Install]
WantedBy=multi-user.target</pre><div
                class="para">
					設定這個 unit file 之後，還需以 <code
                  class="command">systemctl enable adsl-connection</code> 命令啟動它。然後以手動方式，啟動此命令 <code
                  class="command">systemctl start adsl-connection</code> 迴圈；然後就可在開機時自動啟動。
				</div><div
                class="para">
					未使用 <code
                  class="command">systemd</code> 命令的系統 (包括 <span
                  class="distribution distribution">Wheezy</span> 及更早的 Debian 版本)，可使用標準的 SystemV init。在這種系統裡，祗需在 <code
                  class="filename">/etc/inittab</code> 檔案加入一行字；然後，在斷線之後，執行 <code
                  class="command">init</code> 就可重新連線。
				</div><pre
                class="programlisting">
adsl:2345:respawn:/usr/sbin/pppd call dsl-provider</pre><div
                class="para">
					撥接後自動斷線的 ADSL，這種方法減少中斷的次數。
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.adsl-pptp"></a>8.2.3.2. 支援 PPTP 的數據機</h4></div></div></div><a
              id="id-1.11.6.11.7.2"
              class="indexterm"></a><div
              class="para">
					PPTP (點對點隧道協議，Point-to-Point Tunneling Protocol) 協定由微軟創製。在 ADSL 的初期就已布置，取代 PPPOE。若被強迫使用此協定，參見 <a
                class="xref"
                href="sect.virtual-private-network.html#sect.pptp">節 10.2.4, “PPTP”</a>。
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="sect.adsl-dhcp"></a>8.2.3.3. 支援 DHCP 數據機</h4></div></div></div><div
              class="para">
					以 Ethernet 纜線 (跳線) 連線電腦的數據機，可以在電腦以 DHCP 組態網路連結；數據機自動成為閘道且執行路由的功能 (就是管理電腦與網際網路的流量)。
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>基本</em></span> 直接連結 Ethernet 的跳線</strong></p></div></div></div><a
                id="id-1.11.6.11.8.3.2"
                class="indexterm"></a><div
                class="para">
					電腦網路卡經由特定纜線接收資料，也從同樣的管道送出資料。電腦連上地區網路後，通常以纜線 (直接連線或跳線) 連結網路上與中繼器或交換器。若想直接連結兩部電腦 (不經過交換器或中繼器)，必須經由網路卡送出資料至接收端的另個網路卡，反之亦然。這就是跳線的作用，以及使用它的原因。
				</div><div
                class="para">
					此區別在現在的環境沒有作用，現代的網路卡可以自動偵測纜線的類型並據以配合它，所以兩種纜線都可運用自如。
				</div></div><div
              class="para">
					大部份的 “ADSL 路由器” 也能這麼做，網際網路服務供應商提供的 ADSL 數據機也具有此功能。
				</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.roaming-network-config"></a>8.2.4. 網路自動組態漫遊使用者</h3></div></div></div><a
            id="id-1.11.6.12.2"
            class="indexterm"></a><a
            id="id-1.11.6.12.3"
            class="indexterm"></a><div
            class="para">
				Falcot 公司的工程師擁有專業用的筆電，同時也在家裡使用它。根據使用場所的不同，網路有不同的組態方式。在家裡，可能使用 WiFi 網路 (以 WPA 鑰保護)，在工作場合則使用較安全與頻寬更充足的固接網路。
			</div><div
            class="para">
				為了避免人工連結與斷線對應的網路介面，管理者在漫遊機器安裝 <span
              class="pkg pkg">network-manager</span> 套件。此軟體可以讓使用者從圖形桌面的小圖示，在多個網路間切換。按下此圖示即顯示可用的網路 (固接與無線)，藉以選擇其中之一。此程式儲存曾連結網路的組態，斷線時自動選擇最佳的網路。
			</div><div
            class="para">
				為了達到這個目的，程式分為兩個部份：在根部執行後台進程並組態網路介面與使用者介面控制該後台進程。PolicyKit 處理必要的權限以控制此程式，然後由 Debian 組態 PolicyKit 讓 netdev 群組成員可以新增或修改 Network Manager 的連結。
			</div><div
            class="para">
				程式自身已組態後，網路管理器就能夠處理多種類型的連線 (DHCP、手動組態、地區網路)。所以能夠系統地忽略在 <code
              class="filename">/etc/network/interfaces</code> 裡面不合適的網路介面。網路管理器無法提供未顯示網路連線的詳情，最簡單的方法是刪除 <code
              class="filename">/etc/network/interfaces</code> 內必須由網路管理器組態的所有介面。
			</div><div
            class="para">
				在初始安裝階段選擇 “桌面環境”的工作，就能夠預設安裝此程式。
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>其他</em></span> 由“網路設定檔”組態</strong></p></div></div></div><a
              id="id-1.11.6.12.9.2"
              class="indexterm"></a><div
              class="para">
				更進階的使用者可能布望試用 <span
                class="pkg pkg">guessnet</span> 套件做為網路自動組態的工具。以一組測試腳本決定啟用與組態的網路設定檔。
			</div><div
              class="para">
				以人工選定網路設定的使用者，將偏向使用在同名套件內找到的 <span
                class="pkg pkg">netenv</span> 程式。
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="basic-configuration.html"><strong>前一頁</strong>章 8. 基本組態：網路、帳號、列印...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一層</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始頁</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.hostname-name-service.html"><strong>下一頁</strong>8.3. 設定主機名稱與組態名稱服務</a></li></ul></body></html>
