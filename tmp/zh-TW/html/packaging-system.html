<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">章 5. 套件系統：工具與基本原則</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-zh-TW-1.0-1" /><meta
        name="keywords"
        content="執行檔套件, 原始檔套件, dpkg, 相依性, 衝突" /><link
        rel="home"
        href="index.html"
        title="Debian管理者手冊" /><link
        rel="up"
        href="index.html"
        title="Debian管理者手冊" /><link
        rel="prev"
        href="sect.after-first-boot.html"
        title="4.3. 首次啟動之後" /><link
        rel="next"
        href="sect.package-meta-information.html"
        title="5.2. 軟體套件中介資訊" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/zh-TW/stable/packaging-system.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.after-first-boot.html"><strong>前一頁</strong></a></li><li
          class="home">Debian管理者手冊</li><li
          class="next"><a
            accesskey="n"
            href="sect.package-meta-information.html"><strong>下一頁</strong></a></li></ul><div
        xml:lang="zh-TW"
        class="chapter"
        lang="zh-TW"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  xmlns=""
                  id="packaging-system"></a>章 5. 套件系統：工具與基本原則</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="packaging-system.html#sect.binary-package-structure">5.1. 執行檔套件的結構</a></span></dt><dt><span
                class="section"><a
                  href="sect.package-meta-information.html">5.2. 軟體套件中介資訊</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#sect.control">5.2.1. 描述：<code
                        class="filename">control</code> 檔案</a></span></dt><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#sect.configuration-scripts">5.2.2. 組態腳本</a></span></dt><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#sect.conffiles">5.2.3. 校驗，組態檔案清單</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.source-package-structure.html">5.3. 原始套件的結構</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.source-package-structure.html#id-1.8.7.4">5.3.1. 格式</a></span></dt><dt><span
                    class="section"><a
                      href="sect.source-package-structure.html#id-1.8.7.5">5.3.2. Debian 內的使用</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.manipulating-packages-with-dpkg.html">5.4. 以 <code
                    class="command">dpkg</code> 管理套件</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#id-1.8.8.5">5.4.1. 安裝套件</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#id-1.8.8.6">5.4.2. 移除套件</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#id-1.8.8.7">5.4.3. 查詢 <code
                        class="command">dpkg</code> 的資料庫與檢查 <code
                        class="filename">.deb</code> 檔案</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#id-1.8.8.8">5.4.4. <code
                        class="command">dpkg</code> 的日誌檔</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#sect.multi-arch">5.4.5. 多架構支援</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.coexistence-with-other-packaging-systems.html">5.5. 與其他打包系統共存</a></span></dt></dl></div><div
          class="highlights"><div
            class="para">
		身為 Debian 系統管理員，經常處理 <code
              class="filename">.deb</code> 套件，因為含有一致的功能單元 (應用程式、文件等)，強化安裝與維護工作。所以能夠瞭解它們是什麼與如何使用是應該的。
	</div></div><div
          class="para">
		本章介紹 “執行檔” 與 “原始檔” 套件的結構與內容。前者是 <code
            class="filename">.deb</code> 檔案，以 <code
            class="command">dpkg</code> 執行，後者是原始碼，以及建立執行檔套件的指令。
	</div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    xmlns=""
                    id="sect.binary-package-structure"></a>5.1. 執行檔套件的結構</h2></div></div></div><a
            id="id-1.8.5.2"
            class="indexterm"></a><a
            id="id-1.8.5.3"
            class="indexterm"></a><div
            class="para">
			The Debian package format is designed so that its content may be extracted on any Unix system that has the classic commands <code
              class="command">ar</code>, <code
              class="command">tar</code>, and <code
              class="command">xz</code> (sometimes <code
              class="command">gzip</code> or <code
              class="command">bzip2</code>). This seemingly trivial property is important for portability and disaster recovery.
		</div><div
            class="para">
			Imagine, for example, that you mistakenly deleted the <code
              class="command">dpkg</code> program, and that you could thus no longer install Debian packages. <code
              class="command">dpkg</code> being a Debian package itself, it would seem your system would be done for... Fortunately, you know the format of a package and can therefore download the <code
              class="filename">.deb</code> file of the <span
              class="pkg pkg">dpkg</span> package and install it manually (see sidebar <a
              class="xref"
              href="packaging-system.html#sidebar.dpkg-apt-ar"><span
                class="emphasis"><em>工具</em></span> <code
                class="command">dpkg</code>、<code
                class="command">APT</code> 與 <code
                class="command">ar</code></a>). If by some misfortune one or more of the programs <code
              class="command">ar</code>, <code
              class="command">tar</code> or <code
              class="command">gzip</code>/<code
              class="command">xz</code>/<code
              class="command">bzip2</code> have disappeared, you will only need to copy the missing program from another system (since each of these operates in a completely autonomous manner, without dependencies, a simple copy will suffice). If your system suffered some even more outrageous fortune, and even these don't work (maybe the deepest system libraries are missing?), you should try the static version of <code
              class="command">busybox</code> (provided in the <span
              class="pkg pkg">busybox-static</span> package), which is even more self-contained, and provides subcommands such as <code
              class="command">busybox ar</code>, <code
              class="command">busybox tar</code> and <code
              class="command">busybox xz</code>.
		</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.dpkg-apt-ar"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>工具</em></span> <code
                        class="command">dpkg</code>、<code
                        class="command">APT</code> 與 <code
                        class="command">ar</code></strong></p></div></div></div><a
              id="id-1.8.5.6.2"
              class="indexterm"></a><a
              id="id-1.8.5.6.3"
              class="indexterm"></a><a
              id="id-1.8.5.6.4"
              class="indexterm"></a><div
              class="para">
			<code
                class="command">dpkg</code> 是處理 <code
                class="filename">.deb</code> 檔案的程式，提取、分析與解包他們。
		</div><div
              class="para">
			<code
                class="command">APT</code> 是允許對系統進行高階修改的一群程式：安裝或移除套件 (同時保持原來的相依性)、升級系統、列出可用的套件等。
		</div><a
              id="id-1.8.5.6.7"
              class="indexterm"></a><div
              class="para">
			As for the <code
                class="command">ar</code> program, it allows handling files of the same name: <code
                class="command">ar t <em
                  class="replaceable">archive</em></code> displays the list of files contained in such an archive, <code
                class="command">ar x <em
                  class="replaceable">archive</em></code> extracts the files from the archive into the current working directory, <code
                class="command">ar d <em
                  class="replaceable">archive</em> <em
                  class="replaceable">file</em></code> deletes a file from the archive, etc. Its man page (<span
                class="citerefentry"><span
                  class="refentrytitle">ar</span>(1)</span>) documents all its other features. <code
                class="command">ar</code> is a very rudimentary tool that a Unix administrator would only use on rare occasions, but admins routinely use <code
                class="command">tar</code>, a more evolved archive and file management program. This is why it is easy to restore <code
                class="command">dpkg</code> in the event of an erroneous deletion. You would only have to download the Debian package and extract the content from the <code
                class="filename">data.tar.xz</code> archive in the system's root (<code
                class="filename">/</code>):
		</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>ar x dpkg_1.18.24_amd64.deb</code></strong>
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>tar -C / -p -xJf data.tar.xz</code></strong></pre></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>基礎</em></span> Man 手冊註記</strong></p></div></div></div><div
              class="para">
			初學者不太容易找到 “<span
                class="citerefentry"><span
                  class="refentrytitle">ar</span>(1)</span>” 的參考資料。實際上祗需進入 man 頁面第 1 區的 <code
                class="literal">ar</code>。
		</div><div
              class="para">
			有時，此註記也用來消除模棱兩可，例如 <code
                class="command">printf</code> 命令可能指的是 <span
                class="citerefentry"><span
                  class="refentrytitle">printf</span>(1)</span> 與 C 程式語言的 <code
                class="function">printf</code> 函數，指的是 <span
                class="citerefentry"><span
                  class="refentrytitle">printf</span>(3)</span>。
		</div><div
              class="para">
			<a
                class="xref"
                href="solving-problems.html">章 7, <em>解決問題與找到相關資訊</em></a> 討論手冊的詳情 (見 <a
                class="xref"
                href="solving-problems.html#sect.manual-pages">節 7.1.1, “手冊頁面”</a>)。
		</div></div><div
            class="para">
			查看 <code
              class="filename">.deb</code> 檔案的內容：
		</div><pre
            class="screen"><code
              class="computeroutput">$ </code><strong
              class="userinput"><code>ar t dpkg_1.18.24_amd64.deb</code></strong>
<code
              class="computeroutput">debian-binary
control.tar.gz
data.tar.xz
$ </code><strong
              class="userinput"><code>ar x dpkg_1.18.24_amd64.deb</code></strong>
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>ls</code></strong>
<code
              class="computeroutput">control.tar.gz  data.tar.xz  debian-binary  dpkg_1.18.24_amd64.deb
$ </code><strong
              class="userinput"><code>tar tJf data.tar.xz | head -n 15</code></strong>
<code
              class="computeroutput">./
./etc/
./etc/alternatives/
./etc/alternatives/README
./etc/cron.daily/
./etc/cron.daily/dpkg
./etc/dpkg/
./etc/dpkg/dpkg.cfg
./etc/dpkg/dpkg.cfg.d/
./etc/logrotate.d/
./etc/logrotate.d/dpkg
./sbin/
./sbin/start-stop-daemon
./usr/
./usr/bin/
$ </code><strong
              class="userinput"><code>tar tzf control.tar.gz</code></strong>
<code
              class="computeroutput">./
./conffiles
./postinst
./md5sums
./prerm
./control
./postrm
$ </code><strong
              class="userinput"><code>cat debian-binary</code></strong>
<code
              class="computeroutput">2.0</code></pre><div
            class="para">
			如您所見，Debian 套件的 <code
              class="command">ar</code> 包括以下三個檔案：
		</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">debian-binary</code>. This is a text file which simply indicates the version of the <code
                    class="filename">.deb</code> file used (in 2017: version 2.0).
				</div></li><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">control.tar.gz</code>。這個檔案包括軟體套件的名稱與版本等中介資料。安裝與移除時，套件管理工具可以修正部份的中介資料，以配合機器內已有的套件清單。
				</div></li><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">data.tar.xz</code>. This archive contains all of the files to be extracted from the package; this is where the executable files, documentation, etc., are all stored. Some packages may use other compression formats, in which case the file will be named differently (<code
                    class="filename">data.tar.bz2</code> for bzip2, <code
                    class="filename">data.tar.gz</code> for gzip).
				</div></li></ul></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.after-first-boot.html"><strong>前一頁</strong>4.3. 首次啟動之後</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上一層</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>起始頁</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.package-meta-information.html"><strong>下一頁</strong>5.2. 軟體套件中介資訊</a></li></ul></body></html>
