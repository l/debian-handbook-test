<?xml version='1.0' encoding='utf-8' ?>
<!DOCTYPE chapter PUBLIC "-//OASIS//DTD DocBook XML V4.5//EN" "http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd" [
]>
<chapter id="installation">
  <chapterinfo>
    <mediaobject condition="pdf">
      <imageobject>
        <imagedata fileref="images/chap-installation.png" scalefit="1" />
      </imageobject>
    </mediaobject>
    <keywordset>
      <keyword>インストール</keyword>
      <keyword>パーティショニング</keyword>
      <keyword>フォーマット</keyword>
      <keyword>ファイルシステム</keyword>
      <keyword>ブートセクタ</keyword>
      <keyword>ハードウェア検出</keyword>
    </keywordset>
  </chapterinfo>
  <title>インストール</title>
  <highlights>
    <para>Debian を使うには、コンピュータにインストールする必要があります。そしてインストール作業を担当しているのが <emphasis>debian-installer</emphasis> プログラムです。適切なインストール作業は多くの手順からなります。この章ではそれぞれの手順を時系列順に概説します。</para>
  </highlights>
  <indexterm><primary>インストール作業</primary><secondary>システムのインストール作業</secondary></indexterm>

  <sidebar>
    <title><emphasis>BACK TO BASICS</emphasis> 付録の補習講座</title>

    <para>コンピュータの仕組みをよく知っているなら、インストール作業は難しくありません。よく知らないなら、この章を読む前にちょっと遠回りして<xref linkend="short-remedial-course" />を読んでください。</para>
  </sidebar>

  <para><emphasis role="distribution">Jessie</emphasis> 向けのインストーラは <command>debian-installer</command> を使っています。<command>debian-installer</command> の採用するモジュール式設計のおかげで、インストーラはさまざまな状況下で動作し、進化し、変化に適応することが可能です。数多くのアーキテクチャをサポートすることで生じる制限にも関わらず、インストールの各段階でユーザを補助することにより、インストーラは初心者にとても優しいものになっています。自動ハードウェア検出、ガイド付きのパーティショニング、グラフィカルユーザインターフェースのおかげで、初心者が Debian を使い始めた初期に直面するほとんどの問題は解決されています。</para>
  <indexterm><primary>インストーラ</primary></indexterm>
  <indexterm><primary><command>debian-installer</command></primary></indexterm>

  <para>インストール作業を行うには 80 MB の RAM (ランダムアクセスメモリ) と最低 700 MB のハードドライブの空き領域が必要です。Falcot のすべてのコンピュータはこの基準を満足しています。しかし、これらの数字はグラフィカルデスクトップを含まない、極めて限定されたシステムをインストールする際の最低要件であるということに注意してください。一般的なオフィスデスクトップワークステーション用途では、最低でも 512 MB の RAM と 5 GB のハードドライブの空き領域が推奨されます。</para>

  <sidebar>
    <title><emphasis>BEWARE</emphasis> Wheezy からのアップグレード</title>

    <para>Debian Wheezy が既にコンピュータ上にインストール済みなら、この章を読まなくても構いません! 他のディストリビューションと異なり、Debian はシステムを再インストールすることなく、あるバージョンから次のバージョンに更新することが可能です。再インストールは不必要というだけでなく、危険をはらんでいます。なぜなら、再インストールは既にインストール済みのプログラムを削除してしまうからです。</para>

    <para>Debian システムのアップグレード方法は<xref linkend="sect.dist-upgrade" />で説明されています。</para>
  </sidebar>
  <section id="sect.installation-methods">
    <title>インストール方法</title>

    <para>Debian システムは、マシンの BIOS が対応していれば、さまざまな種類のメディアからインストールできます。たとえば、CD-ROM、USB メモリ、さらにネットワーク経由からも起動できます。</para>

    <sidebar>
      <title><emphasis>BACK TO BASICS</emphasis> BIOS、ハードウェアとソフトウェアのインターフェース</title>
      <indexterm><primary>BIOS</primary></indexterm>
      <indexterm><primary>Basic Input/Output System</primary></indexterm>

      <para>BIOS (Basic Input/Output System の略) はマザーボード (すべての周辺装置を接続する電子回路ボード) に組み込まれたソフトウェアで、オペレーティングシステムを読み込むために (適合するブートローダ経由で) コンピュータの起動時に実行されます。BIOS はバックグラウンドでハードウェアとソフトウェア (今回の場合 Linux カーネル) 間のインターフェースを提供します。</para>
    </sidebar>
    <section id="sect.install-cd">
      <title>CD-ROM/DVD-ROM からのインストール</title>

      <para>システムのインストール時に最も広く使われている方法が CD-ROM (DVD-ROM を使っても全く同じです) からインストールする方法です。具体的に言えば、コンピュータは CD-ROM や DVD-ROM から起動され、インストールプログラムが以降の作業を引き継ぎます。</para>

      
      <para>Debian はさまざまな種類の CD-ROM を用意しており、各 CD-ROM は別々の用途向けに設計されています。たとえば <emphasis>netinst</emphasis> (ネットワークインストール) にはインストーラと Debian 基本システムが含まれており、従ってそれ以外のプログラムはダウンロードされます。<emphasis>netinst</emphasis> の「イメージ」はディスクと完全に同じ内容の ISO-9660 ファイルシステムで、そのサイズは 150 から 280 MB 程度です (イメージのサイズはアーキテクチャに依存します)。一方で、完全版にはすべてのパッケージが含まれ、インターネットにアクセスできないコンピュータにシステムをインストールすることが可能です。従ってこれには 84 枚程度の CD-ROM が必要です (DVD-ROM の場合は 12 枚程度、Blu-ray ディスクの場合は 2 枚程度です)。プログラムは人気と重要度に基づいてディスクごとに分けられています。従って多くの場合、最もよく使われているソフトウェアが含まれている最初の 3 枚のディスクがあれば十分でしょう。</para>

      <para>最後のイメージは <filename>mini.iso</filename> としても知られており、インストーラの副産物として入手できます。このイメージにはネットワークを設定するために必要な最小限の要素だけが含まれており、その他の要素はすべてダウンロードされます (インストーラの部品もダウンロードします。このため、インストーラの新バージョンがリリースされた時点でこのイメージは使えなくなります)。<filename>mini.iso</filename> のイメージは普通の Debian アーカイブミラーの <filename>dists/<replaceable>release</replaceable>/main/installer-<replaceable>arch</replaceable>/current/images/netboot/</filename> ディレクトリの下に配置されています。</para>
      <indexterm><primary><filename>mini.iso</filename></primary></indexterm>

      <sidebar>
        <title><emphasis>TIP</emphasis> マルチアーキテクチャディスク</title>

	<para>多くのインストール CD-ROM や DVD-ROM は単一のハードウェアアーキテクチャ専用です。完全版をダウンロードする場合、システムをインストールしたいコンピュータのハードウェアで動作するインストーラが組み込まれている CD-ROM や DVD-ROM を選ばなければいけません。</para>

	<para>一部の CD/DVD-ROM イメージは複数のアーキテクチャで動作します。このため、<emphasis>i386</emphasis> と <emphasis>amd64</emphasis> アーキテクチャの <emphasis>netinst</emphasis> イメージを含む CD-ROM イメージが用意されています。また、インストーラを含み、<emphasis>i386</emphasis> と <emphasis>amd64</emphasis> 用のバイナリパッケージおよび対応するソースパッケージの選択が可能な DVD-ROM イメージも用意されています。</para>
      </sidebar>
      <indexterm><primary>CD-ROM</primary><secondary>インストール用 CD-ROM</secondary></indexterm>
      <indexterm><primary>CD-ROM</primary><secondary><emphasis>netinst CD-ROM</emphasis></secondary></indexterm>
      <indexterm><primary>DVD-ROM</primary><secondary>インストール用 DVD-ROM</secondary></indexterm>
      <indexterm><primary>DVD-ROM</primary><secondary><emphasis>netinst DVD-ROM</emphasis></secondary></indexterm>

      <para>Debian のインストール用 CD-ROM を作るためには、CD-ROM イメージをダウンロードして、ディスクに書き込む必要があります。Debian インストール用 CD-ROM は購入することも可能で、これはプロジェクトに対する幾ばくかの資金援助になります。CD-ROM イメージ業者とダウンロード場所のリストがウェブサイトで公開されています。<ulink type="block" url="http://www.debian.org/CD/index.html" /></para>
    </section>
    <section id="sect.install-usb">
      <title>USB メモリからの起動</title>
      <indexterm><primary>USB メモリ</primary></indexterm>

      <para>多くのコンピュータは USB デバイスから起動できるため、USB メモリ (これは単なるフラッシュメモリディスクに過ぎません) から Debian をインストールすることも可能です。</para>

      <para>インストールマニュアルでは <command>debian-installer</command> を含む USB メモリを作成する方法が説明されています。USB メモリの作成手順は極めて単純です。なぜなら、i386 と amd64 アーキテクチャ用の ISO イメージは CD-ROM からだけでなく USB メモリからも起動できるハイブリッドイメージになっているからです。</para>

      <para>最初に USB メモリのデバイス名を確認しなければいけません (たとえば <literal>/dev/sdb</literal> です)。これを行う最も簡単な方法が <command>dmesg</command> コマンドを使ってカーネルの出したメッセージを確認する方法です。次に前もってダウンロードしておいた ISO イメージ (たとえば debian-8.0.0-amd64-i386-netinst.iso) を <command>cat debian-8.0.0-amd64-i386-netinst.iso &gt;/dev/sdb; sync</command> というコマンドを実行してコピーしなければいけません。このコマンドは USB メモリに直接アクセスし、無差別に内容を削除するため、実行には管理者権限が必要です。</para>

      <para>より詳しい説明はインストールマニュアルに書いてあります。インストールマニュアルの中で特に注目すべき箇所は、より複雑な手順で USB メモリを準備する方法です。この方法を使うことで、インストーラのデフォルトオプションを (カーネルコマンドラインを使い) カスタマイズすることが可能です。<ulink type="block" url="http://www.debian.org/releases/stable/amd64/ch04s03.html" /></para>
    </section>
    <section id="sect.install-net">
      <title>ネットワークブート経由のインストール</title>
      <indexterm><primary>インストール</primary><secondary><emphasis>netboot インストール</emphasis></secondary></indexterm>
      <indexterm><primary>インストール</primary><secondary><emphasis>PXE インストール</emphasis></secondary></indexterm>
      <indexterm><primary>インストール</primary><secondary><emphasis>TFTP インストール</emphasis></secondary></indexterm>

      <para>多くの BIOS では、カーネルと最低限のファイルシステムイメージをダウンロードすることでネットワークからカーネルを直接起動できるようになっています。<acronym>PXE</acronym> や <acronym>TFTP</acronym> ブートなどと呼ばれるこの方法は CD-ROM ドライブを持たないコンピュータやメディアからの起動をサポートしていない BIOS を備えたコンピュータにインストールを行う場合の救世主になります。</para>

      <para>ネットワークブート経由のインストール方法は 2 段階で行われます。最初に、コンピュータ起動中に BIOS (またはネットワークカード) が自動的に IP アドレスを取得するために BOOTP/DHCP 要求を出します。BOOTP または DHCP サーバがこれに応答し、ファイル名とネットワーク設定を返します。ネットワークの設定が終了した後、クライアントコンピュータは先に返されたファイル名のファイルを取得するために TFTP (Trivial File Transfer Protocol) 要求を出します。ファイルの取得が終わったら、ファイルをあたかもブートローダであるかのごとく実行します。そしてブートローダが Debian インストールプログラムを起動し、インストーラがハードドライブ、CD-ROM、USB メモリから起動したのと同様に実行されます。</para>

      <para>ネットブート経由のインストール方法に関するすべての詳しい情報はインストールガイド (「TFTP ネットブート用ファイルの準備」の節) に書かれています。<ulink type="block" url="http://www.debian.org/releases/stable/amd64/ch05s01.html#boot-tftp" /><ulink type="block" url="http://www.debian.org/releases/stable/amd64/ch04s05.html" /></para>
    </section>
    <section id="sect.install-auto">
      <title>その他のインストール方法</title>

      <para>Debian を多数のコンピュータに特別な設定でインストールしなければいけない場合、手作業ではなく自動でインストールを行うことが多いです。インストールの状況と複雑度合いに依存しますが、FAI (Fully Automatic Installer、<xref linkend="sect.fai" />で説明されています) を使うか、preseed ファイルを使ってカスタマイズされたインストール CD (<xref linkend="sect.d-i-preseeding" />を参照してください) を使えば、自動でインストールを行うことが可能です。</para>
    </section>
  </section>
  <section id="sect.installation-steps">
    <title>インストール作業の各段階</title>
    <section id="sect.install-boot">
      <title>起動とインストーラの開始</title>

      <para>BIOS が CD-ROM や DVD-ROM からの起動を開始したら、Isolinux ブートローダメニューが表示されます。この段階では Linux カーネルはまだ読み込まれていません。従ってこのメニューでは、起動させるカーネルを選択し、起動処理中にカーネルに渡すことが可能なパラメータを入力できます。</para>

      <para>標準的なインストールを実行したい場合、矢印キーで「Install」もしくは「Graphical install」を選び、<keycap>Enter</keycap> を押して残りのインストール作業を開始します。DVD-ROM が「マルチアーキテクチャ」ディスクであり、マシンが Intel または AMD の 64 ビットプロセッサを搭載している場合、「64 bit install」および「64 bit graphical install」というメニューオプションを使って 64 ビット版 (<emphasis>amd64</emphasis>) をインストールすることも可能です。これ以外の場合、デフォルトの 32 ビット版 (<emphasis>i386</emphasis>) がインストールされます。現実的には 64 ビット版をインストールする場合が多いでしょう。なぜなら最新のマシンは 64 ビットプロセッサを搭載しており、64 ビット版では新しいコンピュータに備えられていることの多い大容量 RAM をうまく取り扱うことが可能だからです。</para>

      <sidebar>
        <title><emphasis>GOING FURTHER</emphasis> 32 ビットか 64 ビットか?</title>
        <indexterm><primary>PAE</primary></indexterm>
        <indexterm><primary>物理アドレス拡張</primary></indexterm>
        <indexterm><primary>32/64 ビットの選択</primary></indexterm>

	<para>32 ビットシステムと 64 ビットシステムの本質的な差異はメモリアドレスのサイズにあります。理論的には、32 ビットシステムでは 4 GB (2<superscript>32</superscript> バイト) 以上の RAM を取り扱うことができません。現実的には、PAE (物理アドレス拡張) 機能を扱えるプロセッサを備えたマシンで <literal>686-pae</literal> カーネル版を使うことでこの制限を回避することが可能です。しかし、PAE を使うとシステムの性能に深刻な影響をおよぼします。そのため、大容量の RAM を載せたサーバでは 64 ビットモードを使うほうが有益です。</para>

	<para>オフィスコンピュータ (数パーセントの性能の違いを無視しても構わない場合) について言えば、一部のプロプライエタリプログラム (たとえば Skype) は 64 ビット版を提供していない場合があることを覚えておいてください。技術的に言えば、これらのプログラムを 64 ビットシステムで動かすことは可能です。しかし、すべての必要なライブラリの 32 ビット版をインストールしなければいけませんし (<xref linkend="sect.multi-arch" />を参照してください)、<command>setarch</command> または <command>linux32</command> コマンド (<emphasis role="pkg">util-linux</emphasis> パッケージに含まれます) を使ってシステム環境に関してアプリケーションを騙さなければいけない場合があります。<indexterm><primary><command>setarch</command></primary></indexterm><indexterm><primary><command>linux32</command></primary></indexterm></para>
      </sidebar>

      <sidebar>
        <title><emphasis>IN PRACTICE</emphasis> Debian を既存の Windows システムと共存させる</title>
        <indexterm><primary>デュアルブート</primary></indexterm>

	<para>コンピュータで既に Windows が動いている場合、Debian をインストールするのに Windows システムを削除する必要はありません。Windows と Debian を別のディスクまたはパーティションにインストールすれば、Windows と Debian のシステムを同時に備え持つことが可能で、コンピュータの起動時に起動するシステムを選択することが可能です。この構成は「デュアルブート」と呼ばれており、Debian のインストールシステムは「デュアルブート」構成を設定できます。設定はインストール中のハードドライブのパーティショニング段階およびブートローダの設定段階で行います (補注<xref linkend="sidebar.shrinking-partition" />および<xref linkend="sidebar.bootloader-dual-boot" />を参照してください)。</para>

	<para>既に稼働中の Windows システムがある場合、CD-ROM を使わずとも Debian をインストールできます。Debian は軽量の Debian インストーラをダウンロードして、ハードディスクに Debian をセットアップするための Windows プログラムを提供しています。コンピュータを再起動し、Windows を通常起動するかインストールプログラムを起動するかを選択するだけです。また、このプログラムはかなり露骨な名前の専用ウェブサイトで配布されています…。<ulink type="block" url="http://ftp.debian.org/debian/tools/win32-loader/stable/" /><ulink type="block" url="http://www.goodbye-microsoft.com/" /></para>
      </sidebar>

      <sidebar>
        <title><emphasis>BACK TO BASICS</emphasis> ブートローダ</title>
        <indexterm><primary>ローダ</primary><secondary>ブートローダ</secondary></indexterm>
        <indexterm><primary>ブートローダ</primary></indexterm>
        <indexterm><primary>ブート</primary><secondary>ローダ</secondary></indexterm>

	<para>ブートローダとは BIOS から操作を受け取った直後に Linux カーネルを起動させる低レベルプログラムです。この作業を行うために、ブートローダは起動したい Linux カーネルの格納場所を探すことができなければいけません。i386 と amd64 アーキテクチャでブートローダとして最も利用されているプログラムは比較的古参の LILO とその現代的な代替である GRUB です。Isolinux と Syslinux はリムーバブルメディアから起動する際によく使われる代替プログラムです。</para>
      </sidebar>

      <para>各メニューエントリはそれを選択して <keycap>Enter</keycap> を押した後に実行されるコマンドに対応しています。必要に応じて実行されるコマンドを編集するには、エントリを選択した後 <keycap>Enter</keycap> を押す前に <keycap>TAB</keycap> キーを押します。「Help」メニューエントリは古いコマンドラインインターフェースを表示します。このインターフェースでは、<keycap>F1</keycap> から <keycap>F10</keycap> までのキーを使って、プロンプトから利用できるさまざまなオプションについての詳細が書かれた別のヘルプ画面が表示されます。極めて特殊な場合を除いて、「Help」メニューエントリを参照する必要はないでしょう。</para>

      <para>「expert」モード (「Advanced options」メニューの中にあります) を使うことで、インストール中に利用できるすべてのオプションを詳細に設定したり、各インストールステップを自動的に次々と進むのではなく毎回ナビゲーションを表示するようにできます。「expert」モードはとても詳細なモードで、設定できる選択肢が数多く表示されすぎてわかりにくいかもしれませんので、ご注意ください。</para>

      <figure>
        <title>起動画面</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-boot.png" scalefit="1" width="65%" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>ひとたび起動すれば、インストールプログラムがインストールの最初から最後まですべての手順を誘導します。この節ではそれぞれの手順を詳細に解説しています。ここではマルチアーキテクチャ DVD-ROM (より詳しく言えば Jessie インストーラのベータ 4) を使ったインストールを順に見ていきます。<emphasis>netinst</emphasis> を使ったインストールおよびインストーラの完成版では、少し様子が違うかもしれません。グラフィカルモードのインストールの様子も載せていますが、「クラッシック」(テキストモード) インストールとの違いは見た目だけです。</para>
    </section>
    <section id="sect.install-lang">
      <title>言語の選択</title>
      <indexterm><primary>選択</primary><secondary>言語の選択</secondary></indexterm>

      <para>起動直後のインストールプログラムでは英語が使われていますが、最初にこれ以降のインストール作業の表示言語として使われる言語を選択します。たとえば、日本語を選択したらインストール中の表示言語はすべて日本語になります (そしてシステムも日本語に設定されます)。さらに、以降のインストール作業のデフォルト選択肢 (特にキーボードレイアウトのデフォルト選択肢) がより適切なものになります。</para>

      <sidebar>
        <title><emphasis>BACK TO BASICS</emphasis> キーボード操作</title>

	<para>インストール作業のいくつかの段階では情報の入力が求められます。それらの画面にはさまざまな入力場所 (テキストエリア、チェックボックス、選択リスト、OK ボタンやキャンセルボタン) があり、入力場所は「フォーカスされている」かもしれません。それぞれの入力場所からフォーカスを移動させるには、<keycap>TAB</keycap> キーを使ってください。</para>

	<para>グラフィカルモードでは、いつもグラフィカルデスクトップでやっているのと同じやり方でマウスを使ってください。</para>
      </sidebar>

      <figure role="flow.inline">
        <title>言語の選択</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-lang.png" scalefit="1" width="50%" />
          </imageobject>
        </mediaobject>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-lang-txt.png" scalefit="1" width="50%" />
          </imageobject>
        </mediaobject>
      </figure>
    </section>
    <section id="sect.install-country">
      <title>国の選択</title>
      <indexterm><primary>選択</primary><secondary>国の選択</secondary></indexterm>

      <para>2 段階目に国を選択します。インストーラは、先に選択した言語と国の情報を組み合わせて、最も適切と思われるキーボードレイアウトを提案します。さらに、国情報はタイムゾーンの設定にも影響をおよぼします。ここで日本を選択した場合、日本で標準的な QWERTY キーボードが提案され、適切なタイムゾーンが提供されます。</para>

      <figure role="flow.inline">
        <title>国の選択</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-country.png" scalefit="1" width="50%" />
          </imageobject>
        </mediaobject>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-country-txt.png" scalefit="1" width="50%" />
          </imageobject>
        </mediaobject>
      </figure>
    </section>
    <section id="sect.install-keyboard">
      <title>キーボードレイアウトの選択</title>
      <indexterm><primary>キーボードレイアウト</primary></indexterm>
      <indexterm><primary>レイアウト、キーボード</primary></indexterm>

      <para>ここで提案された「日本語」キーボードは日本で主流の QWERTY レイアウトです。</para>

      <figure role="flow.inline">
        <title>キーボードの選択</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-keyboard.png" scalefit="1" width="50%" />
          </imageobject>
        </mediaobject>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-keyboard-txt.png" scalefit="1" width="50%" />
          </imageobject>
        </mediaobject>
      </figure>
    </section>
    <section id="sect.install-detect-hardware">
      <title>ハードウェアの検出</title>

      <para>ほとんどの場合、ハードウェア検出は完全に自動的に行われます。インストーラがハードウェアを検出し、CD の内容を読み出すために CD-ROM ドライブを特定しようと試みます。インストーラは検出されたさまざまなハードウェアに対応するモジュールを読み込み、その後 CD-ROM を「マウント」して内容を読みます。ここまでの段階を CD に含まれる起動イメージ (サイズが制限されており、CD からの起動時に BIOS がメモリ内に読み込んだファイル) が担当しています。</para>

      <para>インストーラはほぼすべてのドライブ、特に標準的な ATAPI 周辺機器 (IDE や EIDE と呼ばれることもあります)、を取り扱うことが可能です。しかし、CD-ROM ドライブの検出に失敗する場合、インストーラは CD-ROM ドライバに相当するカーネルモジュールを (たとえば USB メモリから) 読み込むための画面を表示します。</para>
    </section>
    <section id="sect.install-load-components">
      <title>コンポーネントの読み込み</title>

      <para>CD の内容が利用できるようになったら、インストーラは以降の作業に必要なすべてのファイルを読み込みます。これには、残りのハードウェア (特にネットワークカード) 用の追加ドライバおよびインストールプログラムの構成要素が含まれます。</para>
    </section>
    <section id="sect.install-detect-network">
      <title>ネットワークハードウェアの検出</title>

      <para>この段階でインストーラは、ネットワークカードを自動的に特定し、関連するモジュールを自動的に読み込もうとします。自動検出に失敗した場合でも、手作業で読み込むモジュールを選択できます。どのモジュールでも動かなければ、リムーバブルデバイスから個々のモジュールをロードすることが可能です。最後に挙げた解決策は、適切なドライバが標準的な Linux カーネルには含まれていないけれども、メーカーのウェブサイトなど別のどこかから入手できる、という場合のみ必要です。</para>

      <para><emphasis>netinst</emphasis> を使ってインストールする場合、Debian パッケージはネットワークから読み込まれるため、この段階は間違いなく成功するでしょう。</para>
    </section>
    <section id="sect.install-network-config">
      <title>ネットワークの設定</title>
      <indexterm><primary>設定</primary><secondary>ネットワーク</secondary><tertiary>静的</tertiary></indexterm>
      <indexterm><primary>設定</primary><secondary>ネットワーク</secondary><tertiary>DHCP</tertiary></indexterm>

      <para>可能な限り各段階を自動化するために、インストーラは DHCP (IPv4 の場合) と IPv6 のネットワーク発見機能を使って自動的にネットワークを設定しようとします。設定に失敗した場合、多くの選択肢が提案されます。ここで提案される選択肢には、通常の DHCP 設定で再挑戦、マシンの名前を宣言して DHCP を設定、静的なネットワークを設定、があります。</para>

      <para>ここで挙げた最後の選択肢を選んだ場合、IP アドレス、サブネットマスク、ゲートウェイの IP アドレス、マシン名、ドメイン名、の情報が必要です。</para>

      <sidebar>
        <title><emphasis>TIP</emphasis> DHCP を使わない設定</title>

	<para>インストール中にマシンに静的 IP アドレスを定義したいのでローカルネットワーク内で動いている DHCP サーバを使わせたくない場合、CD-ROM から起動する際に <userinput>netcfg/use_dhcp=false</userinput> オプションを追加してください。起動したいメニューエントリにカーソルを合わせた状態で <keycap>TAB</keycap> キーを押して、<keycap>Enter</keycap> キーを押す前に必要なオプションを追加してください。</para>
      </sidebar>

      <sidebar>
        <title><emphasis>BEWARE</emphasis> 場当たり的な設定の禁止</title>

	<para>多くのローカルエリアネットワークはすべてのマシンが信頼できるという暗黙の了解の下に成り立っており、1 台でも不適切な設定のコンピュータがあるとネットワーク全体が混乱します。つまり、あなたのマシンを勝手にローカルエリアネットワークへ接続する前に、ネットワーク管理者から適切な設定 (たとえば、IP アドレス、ネットマスク、ブロードキャストアドレス) を教わってください。</para>
      </sidebar>
    </section>
    <section>
      <title>管理者パスワード</title>
      <indexterm><primary>アカウント</primary><secondary>管理者アカウント</secondary></indexterm>

      <para>マシンの管理者用に確保されているスーパーユーザ root アカウントはインストール中に自動的に作成されます。このため、パスワードが要求されます。インストーラは確認用にもう一度パスワードを尋ねます。これは後から修正することが難しい入力ミスを避けるためです。</para>

      <figure>
        <title>管理者パスワード</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-rootpw.png" scalefit="1" width="65%" />
          </imageobject>
        </mediaobject>
      </figure>

      <sidebar>
        <title><emphasis>SECURITY</emphasis> 管理者パスワード</title>

	<para>root ユーザのパスワードは長くて (8 文字以上で) 推測できないものであるべきです。実際、インターネットに接続されたコンピュータ (さらにサーバ) はその種類を問わず、定期的に頻繁に使われるパスワードを用いた自動接続攻撃の標的にされます。時には、単語と数字の組み合わせをパスワードとして試す、辞書攻撃にさらされるかもしれません。子供や両親の名前、誕生日などをパスワードとして使わないでください。なぜなら、多くの同僚がそれを知っているかもしれないからです。さらに、そのような人にここでセットアップされている種類のコンピュータを自由に使わせてはいけません。</para>

	<para>他のユーザのパスワードに対しても同じことが言えますが、管理権限を持たないユーザのアカウントが乗っ取られたとしても、その影響はそれほど大きくありません。</para>

	<para>もし名案が浮かばなければ、遠慮せずに <command>pwgen</command> (同名のパッケージに含まれます) などのパスワード生成ソフトウェアを使ってください。</para>
      </sidebar>
    </section>
    <section>
      <title>1 人目のユーザの作成</title>

      <para>Debian は管理者に root で作業するという悪習を身に付けさせないために、強制的に標準的なユーザアカウントを作成します。この予防原則は本質的に、人的ミスによる損害を抑えるためには必要最低限の権限だけで作業する必要がある、ということを意味しています。このため、インストーラは 1 人目のユーザの完全な名前、ユーザ名、パスワード (入力ミスの危険を防ぐために 2 回) を尋ねるでしょう。</para>

      <figure>
        <title>1 人目のユーザの名前</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-username.png" scalefit="1" width="65%" />
          </imageobject>
        </mediaobject>
      </figure>
    </section>
    <section id="sect.install-clock-config">
      <title>時刻の設定</title>

      <para>ネットワークを利用できる場合、システムの内部時計は NTP サーバを使って (1 度だけ) 更新されます。こうすることで、初回起動時以降のログのタイムスタンプが修正されます。常に正確な時刻に合わせるためには、最初のインストール後に NTP デーモンのセットアップが必要です (<xref linkend="sect.time-synchronization" />を参照してください)。</para>
    </section>
    <section id="sect.install-detect-disks">
      <title>ディスクや他のデバイスの検出</title>

      <para>この段階で Debian がインストールされるであろうハードドライブが自動的に検出されます。検出されたハードドライブは次の段階、パーティショニング、で表示されます。</para>
    </section>
    <section id="sect.install-partman">
      <title>パーティショニングツールの開始</title>
      <indexterm><primary>パーティショニング</primary></indexterm>

      <sidebar>
        <title><emphasis>CULTURE</emphasis> パーティショニング法</title>

	<para>パーティショニングはインストール時に必ず必要な作業で、ハードドライブ上の利用できる領域をハードドライブ上に保存されるであろうデータとコンピュータで予定されている用途に従って分割する作業です (分割されたそれぞれの区画を「パーティション」と呼びます)。パーティショニングの段階で、使用するファイルシステムを選択します。これらすべてが、性能、データのセキュリティ、サーバの管理、に影響をおよぼします。</para>
      </sidebar>

      <para>その昔、パーティショニングは新規ユーザにとって難しい作業でした。パーティショニングには、Linux ファイルシステムと仮想メモリ (スワップ) が保存されるディスクの一区画 (「パーティション」) を定義する必要があります。この作業は、残しておきたい既存の他のオペレーティングシステムがマシン上にある場合に、複雑になります。実際には、既存のシステムのパーティションを変更しない (または、損害を与えずにパーティションのサイズを変更する) ように注意しなければいけません。</para>

      <para>幸いなことに、インストーラに含まれるパーティショニングソフトウェアは「ガイド付き」モードを備えています。このモードを使う場合、ユーザにパーティショニング方法の候補が提示されます。多くの場合、ソフトウェアの提案を確認するだけで事足ります。</para>

      <figure>
        <title>パーティショニング方法の選択</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-partman.png" scalefit="1" width="65%" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>パーティショニングツールの最初の画面では、ハードドライブ全体を使ってパーティションを作成する選択肢が表示されます。(新しい) コンピュータに Linux だけをインストールする場合、このパーティショニング方法が明らかに最も単純です。この場合「ガイド - ディスク全体を使う」を選んでください。コンピュータに 2 種類のオペレーティングシステム用の 2 台のハードドライブが装備されている場合、ドライブごとにオペレーティングシステムを分けるのも解決策の 1 つです。こうすることでパーティショニングが楽になります。どちらの場合も、次の画面では、関連するエントリから Linux をインストールするディスク (たとえば「SCSI1 (0,0,0) (sda) - 12.9 GB ATA VBOX HARDDISK」) を選択します。その後、ガイド付きのパーティショニングが始まります。</para>

      <figure>
        <title>ガイド付きパーティショニングを適用するディスク</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-partman-disk.png" scalefit="1" width="65%" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>ガイド付きパーティショニングでは、パーティションの代わりに LVM 論理ボリュームを作成することも可能です (LVM については後から説明します)。残りの操作は同じですから、「ガイド - ディスク全体を使い LVM をセットアップする」の選択肢 (暗号化の有無に関わらず) については説明しません。</para>

      <para>他の事例、たとえば Linux を既存のパーティションと共存させたい場合、手作業でパーティショニングを実行しなければいけません。</para>
      <section id="sect.install-autopartman-mode">
        <title>ガイド付きパーティショニング</title>
        <indexterm><primary>パーティショニング</primary><secondary>ガイド付きパーティショニング</secondary></indexterm>

	<para>ガイド付きパーティショニングツールでは、それぞれ別の用途に適した 3 種類のパーティショニング機構を選択できます。</para>

        <figure>
          <title>ガイド付きパーティショニング</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="images/inst-autopartman-mode.png" scalefit="1" width="65%" />
            </imageobject>
          </mediaobject>
        </figure>

	<para>1 番目のパーティショニング機構は「すべてのファイルを 1 つのパーティションに」です。これは、Linux システムツリー全体 (ルート <filename>/</filename> ディレクトリ以下すべて) を単一のファイルシステムに保存します。このパーティショニングは単純かつ頑強であり、個人および単一ユーザシステム用途にぴったりです。実際には、2 つのパーティションが作られます。具体的に言えば、システム全体用と仮想メモリ (swap) 用のパーティションが作られます。</para>

	<para>2 番目のパーティショニング機構は「<filename>/home</filename> パーティションの分割」です。これは、1 番目のパーティショニング機構とよく似ていますが、ファイル階層を 2 つに分離します。具体的に言えば、片方には Linux システム (<filename>/</filename>) を、もう片方には「ホームディレクトリ」(ユーザデータ、ファイルとサブディレクトリは <filename>/home/</filename> 以下に配置されます) を収めます。</para>

	<para>最後のパーティショニング機構は「<filename>/home</filename>, <filename>/var</filename>, <filename>/tmp</filename> パーティションを分割」です。これはサーバや複数のユーザが利用するシステムに適しています。これはファイルツリーを多くのパーティションに分離します。具体的に言えば、ルート (<filename>/</filename>) とユーザアカウント (<filename>/home/</filename>) パーティションの分離に加え、サーバソフトウェアのデータ (<filename>/var/</filename>) と一時ファイル (<filename>/tmp/</filename>) 用パーティションも分離します。ファイルツリーが格納されるパーティションをこのように分離するとさまざまな利点を得ることが可能です。ユーザが利用できるハードドライブ領域を使い切ってしまうことでサーバが動かなくなることがなくなります (ユーザが満杯にできるハードドライブ領域を <filename>/tmp/</filename> と <filename>/home/</filename> だけに制限できます)。さらにデーモンのデータ (特にログ) がシステムの他の領域を圧迫することがなくなります。</para>

        <sidebar>
          <title><emphasis>BACK TO BASICS</emphasis> ファイルシステムの選択</title>
          <indexterm><primary>システム</primary><secondary>ファイルシステム</secondary></indexterm>
          <indexterm><primary>ファイル</primary><secondary>システム</secondary></indexterm>

	  <para>ファイルシステムはハードドライブにデータを格納する方法を定義しています。既存のファイルシステムにはそれぞれ長所と制限があります。頑強なものもあれば、効率のよいものもあります。すなわち、自分の必要としていることをよく理解している人は最も適切なファイルシステムを選択することが可能です。既にさまざまなファイルシステムに対する長所や制限が比較検討されています。たとえば ReiserFS ファイルシステムは、多くの小さなファイルを読む場合は特に効率が良いとされています。また、<emphasis>XFS</emphasis> は巨大なファイルを高速に取り扱えます。Debian のデフォルトファイルシステムである <emphasis>ext4</emphasis> は良い妥協点で、昔から Linux で使われてきた 3 つの古いファイルシステム (<emphasis>ext</emphasis>、<emphasis>ext2</emphasis>、<emphasis>ext3</emphasis>) を基に開発されました。<emphasis>ext4</emphasis> は <emphasis>ext3</emphasis> にあったいくつかの制限を克服しており、とりわけ大容量のハードドライブに適しています。将来が期待されている <emphasis>btrfs</emphasis> を試すという選択肢もあります。<emphasis>btrfs</emphasis> は最近の LVM または RAID を使用する際に要求される非常に多くの機能を備えています。</para>

	  <para>ジャーナル化されたファイルシステム (<emphasis>ext3</emphasis>、<emphasis>ext4</emphasis>、<emphasis>btrfs</emphasis>、<emphasis>reiserfs</emphasis>、<emphasis>xfs</emphasis> など) では、突発的な障害が起きた際にディスク全体を完全に解析することなく (<emphasis>ext2</emphasis> システムでは完全に解析することが必要でした) ファイルシステムを以前の整合性の取れた状態に戻せるようにするために、特別な対策が取られています。実際に作業を実行する前に、その作業の内容をジャーナルに書き込むことにより、この対策機能は実現されています。作業が中断された場合、ジャーナルを使って作業を「再実行」することが可能です。逆に言うと、ジャーナルの更新中に障害が発生した場合、最後の作業は単純に無視されます。その結果、ジャーナルに書き込まれたデータは失われるかもしれませんが、ディスク上のデータは変更されていないので、整合性が保たれます。これはまさにファイルシステムに対するトランザクション処理と言えます。</para>
        </sidebar>

	<para>パーティションの種類を選択した後、ガイド付きパーティショニングツールはパーティショニング案を算出し、画面に提示します。必要であれば、ユーザはパーティショニング案を変更することも可能です。特に、標準的なファイルシステム (<emphasis>ext4</emphasis>) が不適切な場合は、別のファイルシステムを選択することが可能です。しかしながら多くの場合、インストーラの提示したパーティショニング案は妥当です。承諾するには「パーティショニングの終了とディスクへの変更の書き込み」エントリを選択してください。</para>

        <figure>
          <title>パーティショニングの確認</title>
          <mediaobject>
            <imageobject>
              <imagedata fileref="images/inst-partman-validation.png" scalefit="1" width="65%" />
            </imageobject>
          </mediaobject>
        </figure>
      </section>
      <section id="sect.manual-partitioning">
        <title>手作業のパーティショニング</title>
        <indexterm><primary>パーティショニング</primary><secondary>手作業のパーティショニング</secondary></indexterm>

	<para>手作業でパーティショニングを実行すればより柔軟にパーティションを設定できます (各パーティションの目的とサイズを選ぶことが可能です)。また、ソフトウェア RAID を希望する場合、手作業でパーティショニングを実行しなければいけません。</para>

        <sidebar id="sidebar.shrinking-partition">
          <title><emphasis>IN PRACTICE</emphasis> Windows パーティションの縮小</title>
          <indexterm><primary>パーティションサイズの変更</primary></indexterm>
          <indexterm><primary>パーティションの縮小</primary></indexterm>

	  <para>Debian を他のオペレーティングシステム (Windows など) と共存させてインストールする場合、Debian 専用のパーティションを作成するためには、他のシステムから使われていないハードドライブ領域を必要とします。多くの場合、これは Windows パーティションを縮小し、できた空き領域を再利用することを意味しています。</para>

	  <para>Debian インストーラでは、手作業でパーティショニングを実行すれば、パーティションの縮小作業を実行できます。パーティションを縮小するには Windows パーティションを選択し、新しいサイズを入力するだけです (Debian インストーラは FAT と NTFS の両方のパーティションの縮小に対応しています)。</para>
        </sidebar>

	<para>最初の画面では、利用できるディスク、パーティション、パーティションを割り当てられていない空き領域が表示されます。表示されたそれぞれの要素を選択できます。さらに <keycap>Enter</keycap> キーを押せば、実行できる操作のリストが表示されます。</para>

	<para>ディスクを選択すれば、そのディスク上のすべてのパーティションを削除できます。</para>

	<para>ディスクの空き領域を選択すれば、新しいパーティションを作成できます。ガイド付きパーティショニングを空き領域に適用することも可能です。この方法は、ディスクには別のオペレーティングシステムがインストールされているけれども、標準的なやり方で Linux のパーティショニングを実行したいという場合に興味深い解決策です。ガイド付きパーティショニングに関する詳しい情報は<xref linkend="sect.install-autopartman-mode" />をご覧ください。</para>

        <sidebar>
          <title><emphasis>BACK TO BASICS</emphasis> マウントポイント</title>
          <indexterm><primary>マウントポイント</primary></indexterm>
          <indexterm><primary>ポイント、マウントポイント</primary></indexterm>

	  <para>マウントポイントとは、パーティションに保存されたファイルシステムの内容を格納するディレクトリツリーです。つまり <filename>/home/</filename> にマウントされたパーティションにはユーザデータが格納されます。</para>

	  <para>マウントポイントが「<filename>/</filename>」の場合、ファイルツリーの<emphasis>ルート</emphasis>を意味し、このパーティションのルートには Debian システムが格納されます。</para>
        </sidebar>

        <sidebar>
          <title><emphasis>BACK TO BASICS</emphasis> 仮想メモリ、スワップ</title>
          <indexterm><primary>仮想メモリ</primary></indexterm>
          <indexterm><primary>スワップ</primary></indexterm>
          <indexterm><primary>パーティション</primary><secondary>スワップパーティション</secondary></indexterm>
          <indexterm><primary>スワップパーティション</primary></indexterm>

	  <para>Linux カーネルは、仮想メモリのおかげでメモリ (RAM) の空き領域が不足した際にしばらくの間使われていない RAM の内容をハードディスクのスワップパーティションに保存して、少しの RAM 空き領域を確保することが可能です。</para>

	  <para>仮想メモリのような付加的メモリを装うために、Windows ではファイルシステムに直接格納されるスワップファイルが利用されています。逆に、Linux ではこの目的専用のパーティション「スワップパーティション」が利用されています。</para>
        </sidebar>

	<para>以下は、パーティションを選んだ後に指定できる、選択したパーティションの取り扱い方のリストです。</para>
        <itemizedlist>
          <listitem>
	    <para>選択したパーティションをフォーマットし、マウントポイントを指定してパーティションをファイルツリーに含めます。</para>
          </listitem>
          <listitem>
	    <para>選択したパーティションをスワップパーティションとして使います。</para>
          </listitem>
          <listitem>
	    <para>選択したパーティションを「暗号化物理ボリューム」にします (パーティションに含まれる秘密のデータを守るには、以下を参照してください)。</para>
          </listitem>
          <listitem>
	    <para>選択したパーティションを「LVM 用物理ボリューム」にします (LVM の概念は、この章の後で詳しく議論します)。</para>
          </listitem>
          <listitem>
	    <para>選択したパーティションを RAID デバイスとして利用します (この章の後半を参照してください)。</para>
          </listitem>
          <listitem>
	    <para>選択したパーティションを使わないことにして、そのままにしておくことも可能です。</para>
          </listitem>
        </itemizedlist>
      </section>
      <section id="sect.install-software-raid">
        <title>マルチディスクデバイスの設定 (ソフトウェア RAID)</title>
        <indexterm><primary>RAID</primary><secondary>ソフトウェア RAID</secondary></indexterm>
        <indexterm><primary>ソフトウェア RAID</primary></indexterm>
        <indexterm><primary>デバイス</primary><secondary>マルチディスクデバイス</secondary></indexterm>

	<para>一部の RAID レベルでは複数のハードドライブに保存された情報を複製することで、RAID を構成する 1 台のハードドライブがデータに影響をおよぼすハードウェア障害を起こした際にデータが消失することを防いでいます。レベル 1 RAID は単純で、2 台のハードドライブに全く同じデータの複製を作ります。これに対して、レベル 5 RAID は冗長データを複数のディスクに分散します。このため、障害の起きたドライブに含まれたデータを完全に復元することが可能です。</para>

	<para>ここでは最も簡単に設定できるレベル 1 RAID だけを説明します。最初に、全く同じサイズのパーティションを 2 つ別々のドライブに作成し、「RAID の物理ボリューム」とラベル付けします。</para>

	<para>2 つのパーティションを 1 つの仮想ディスクにまとめるためにはパーティショニングツールで「ソフトウェア RAID の設定」を選び、設定画面で「MD デバイスの作成」を選んでください。その後、新しいデバイスに関する一連の質問に答える必要があります。最初の質問では、使用する RAID レベルを尋ねられます。今回の場合「RAID1」です。2 番目の質問では、アクティブデバイスの数を尋ねられます。アクティブデバイスの数とは MD デバイスに含めるパーティションの数で、今回の場合 2 台です。3 番目の質問では、予備デバイスの数を尋ねられます。今回の場合 0 台です。つまり、ディスク障害が起きた際に機能を代替させるためのディスクを追加する計画はないということです。最後の質問では、RAID デバイス用のパーティションを尋ねられます。これは事前に用意した 2 つのパーティションです (「raid」と明示されているパーティション以外は選ばないでください)。</para>

	<para>メインメニューに戻ると、新しい仮想「RAID」ディスクが表示されます。このディスクは削除できない単一のパーティションとして表示されますが、選択すればこれを使用できます (他のパーティションと同じ方法で選択してください)。</para>

	<para>RAID 機能に関するより詳しい情報は<xref linkend="sect.raid-soft" />を参照してください。</para>
      </section>
      <section id="sect.install-lvm">
        <title>論理ボリュームマネージャ (LVM) の設定</title>
        <indexterm><primary>LVM</primary><secondary>インストール中に行う LVM の設定</secondary></indexterm>
        <indexterm><primary>論理ボリュームマネージャ</primary><secondary>インストール中に行う論理ボリュームマネージャの設定</secondary></indexterm>

	<para>LVM を使うことで、複数のディスクにまたがる「仮想」パーティションを作成できます。LVM を使うことの利点は 2 つあります。具体的に言えば、パーティションのサイズは、もはや個々のディスクによって制限を受けるのではなく、累積ボリュームによって制限を受けます。さらにパーティションのサイズはいつでも (ディスクを追加した後などに) 変更できます。</para>

	<para>LVM では特有の専門用語を使います。たとえば仮想パーティションは「論理ボリューム」と呼ばれます。「論理ボリューム」は「ボリュームグループ」の一部分を表し、「論理ボリューム」は複数の「物理ボリューム」群から構成されます。実際のところ、これらの専門用語は「実」パーティション (またはソフトウェア RAID デバイス) から作られるものです。</para>
        <indexterm><primary>ボリューム</primary><secondary>論理ボリューム</secondary></indexterm>
        <indexterm><primary>ボリューム</primary><secondary>物理ボリューム</secondary></indexterm>
        <indexterm><primary>グループ</primary><secondary>ボリュームのグループ</secondary></indexterm>
        <indexterm><primary>ボリューム</primary><secondary>グループ</secondary></indexterm>

	<para>LVM はとても単純な方法で実現されています。すなわち、それぞれのボリュームは物理であるか論理であるかに関わらず同じサイズのブロックに分割され、ブロックは LVM に対応付けられます。新しいディスクを追加した場合は新しい物理ボリュームの作成が必要で、新しいブロックは任意のボリュームグループに関連付けることが可能です。拡張されたボリュームグループ内のすべてのパーティションは、ディスク領域の許す限り拡張することが可能です。</para>

	<para>パーティショニングツールは数段階で LVM を設定します。最初に、存在するディスク上に「LVM の物理ボリューム」となるパーティションを作成しなければいけません。LVM を稼働させるには、「論理ボリュームマネージャの設定」を選び、同じ設定画面で「ボリュームグループの作成」から、存在する物理ボリュームを作成するボリュームグループに関連付けてください。最後に、このボリュームグループ内に論理ボリュームを作成してください。自動パーティショニングシステムを使えばこれらの全段階を自動的に実行できる点に注意してください。</para>

	<para>パーティショニングメニューでは、各物理ボリュームは削除できない単一のパーティションを持つディスクとして表示されますが、LVM 用として望み通り使うことが可能です。</para>

	<para>LVM の使い方については<xref linkend="sect.lvm" />で詳しく説明されています。</para>
      </section>
      <section>
        <title>暗号化されたパーティションの設定</title>
        <indexterm><primary>LUKS</primary></indexterm>
        <indexterm><primary>dm-crypt</primary></indexterm>
        <indexterm><primary>パーティション</primary><secondary>暗号化されたパーティション</secondary></indexterm>
        <indexterm><primary>パーティションの暗号化</primary></indexterm>
        <indexterm><primary>機密</primary><secondary>ファイル</secondary></indexterm>
        <indexterm><primary>ファイル</primary><secondary>機密性</secondary></indexterm>

	<para>データの機密性を保証するには、たとえばコンピュータやハードドライブを紛失したり盗難された時に備えて、一部のパーティションのデータを暗号化しておく必要があります。暗号化の可否はファイルシステムの種類に依存しません。なぜなら、Linux (より具体的に言えば dm-crypt ドライバ) は LVM と同様にデバイスマッパを使い、暗号化されたデータが保存されるパーティション上に仮想パーティション (この内容が保護されます) を作成するからです (LUKS、Linux Unified Key Setup、のおかげで標準的なフォーマットが定められ、暗号化されたデータおよび使われている暗号化アルゴリズムを表すメタ情報の保存が可能になりました)。</para>

        <sidebar id="sidebar.encrypted-swap-partition">
          <title><emphasis>SECURITY</emphasis> 暗号化されたスワップパーティション</title>

	  <para>暗号化されたパーティションを使う場合、暗号化鍵はメモリ (RAM) の中に保存されています。暗号化鍵が入手できればデータの復号化が可能になりますから、コンピュータやハードドライブの泥棒もしくはメンテナンス技術者に暗号化鍵の複製を入手されないようにするには、暗号化鍵の複製を RAM に残さないようにすることが最も重要です。しかしながらラップトップでは RAM の中に暗号化鍵の複製を残すという状況が簡単に起こります。なぜなら、ハイバネーションの際に RAM の内容はスワップパーティションに保存されるからです。スワップパーティションが暗号化されていない場合、泥棒は暗号化鍵を入手して、暗号化されたパーティションのデータを復号化するかもしれません。このため、暗号化されたパーティションを使うなら、スワップパーティションの暗号化も欠かせません!</para>

	  <para>Debian インストーラはスワップパーティションが暗号化されていないにも関わらず暗号化されたパーティションを作ろうとしたらユーザに警告します。</para>
        </sidebar>

	<para>暗号化されたパーティションを作成するには、最初にあるパーティションを暗号化用に割り当てなければいけません。割り当てを行うには、パーティションを選択し「暗号化の物理ボリューム」として使うように設定してください。物理ボリュームを含むディスクのパーティショニングの後、「暗号化されたボリュームの設定」を選んでください。パーティショニングツールは (真のデータの位置をより分かりにくくするために) 物理ボリュームをでたらめなデータで初期化することを提案し、「暗号化パスフレーズ」の入力を要求します。暗号化されたパーティションの内容にアクセスする場合、パスフレーズはコンピュータの起動時に毎回入力しなければいけません。この段階が完了しパーティショニングツールメニューまで戻ったら、「暗号化ボリューム」から新しいパーティションを利用できるはずです。「暗号化ボリューム」は他のパーティションと同様に設定できます。多くの場合、「暗号化ボリューム」は LVM の物理ボリュームとして利用されます。そうすれば、複数のパーティション (LVM 論理ボリューム) をスワップパーティションも含めて同じ暗号化鍵で保護することが可能になります (補注<xref linkend="sidebar.encrypted-swap-partition" />を参照してください)。</para>
      </section>
    </section>
    <section>
      <title>基本システムのインストール</title>
      <indexterm><primary>システム</primary><secondary>基本システム</secondary></indexterm>

      <para>この段階ではユーザの入力は不要で、Debian の「基本システム」パッケージがインストールされます。基本システムには Debian パッケージを管理する <command>dpkg</command> と <command>apt</command> ツールだけでなく、システムを起動させてシステムを使うのに必要なユーティリティが含まれています。</para>

      <figure>
        <title>基本システムのインストール</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-basesystem.png" scalefit="1" width="65%" />
          </imageobject>
        </mediaobject>
      </figure>
    </section>
    <section>
      <title>パッケージマネージャ (<command>apt</command>) の設定</title>
      <indexterm><primary>設定</primary><secondary>APT の初期設定</secondary></indexterm>
      <indexterm><primary>APT</primary><secondary>初期設定</secondary></indexterm>

      <para>追加ソフトウェアをインストールできるようにするためには、APT を設定し、Debian パッケージを探す場所を決めなければいけません。この段階は可能な限り自動化されています。パッケージマネージャの設定はパッケージを探す場所をネットワークソースにするか CD-ROM だけにするかを尋ねる質問から始まります。</para>

      <sidebar>
        <title><emphasis>NOTE</emphasis> ドライブ中の Debian CD-ROM</title>

	<para>インストーラが CD/DVD ドライブに Debian のインストールディスクを検出した場合、ネットワーク上のパッケージを探しに行くように APT を設定する必要はありません。なぜなら APT はリムーバブルメディアドライブからパッケージを読むように自動的に設定されているからです。このディスクがインストールディスクセットの一部だった場合、インストーラは他のディスクに収められているすべてパッケージを参照するために他のディスクを「探索」することを提案するでしょう。</para>
      </sidebar>

      <para>ネットワークからパッケージを取得することを選んだ場合、次の 2 つの質問で国とその国で利用できる Debian アーカイブミラーを選択し、パッケージをダウンロードするサーバを選びます (Debian アーカイブミラーとは Debian マスターアーカイブにあるファイルのコピーをホストしている公開サーバです)。</para>

      <figure>
        <title>Debian アーカイブミラーの選択</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-mirror.png" scalefit="1" width="65%" />
          </imageobject>
        </mediaobject>
      </figure>

      <para>最後にインストーラは HTTP プロキシを使うことを提案します。プロキシを入力しなかった場合、インターネットに直接アクセスします。ここで <literal>http://proxy.falcot.com:3128</literal> と入力した場合、APT は Falcot の<foreignphrase>プロキシ/キャッシュ</foreignphrase>である「Squid」プログラムを使うでしょう。プロキシの設定を見つけ出すには、同じネットワークに接続された別のマシンでウェブブラウザの設定を確認してみてください。</para>

      <para>APT は <filename>Packages.gz</filename> と <filename>Sources.gz</filename> ファイルを自動的にダウンロードし、認識するパッケージのリストを更新します。</para>

      <sidebar>
        <title><emphasis>BACK TO BASICS</emphasis> HTTP プロキシ</title>
        <indexterm><primary>プロキシ</primary></indexterm>
        <indexterm><primary>プロキシキャッシュ</primary></indexterm>
        <indexterm><primary>キャッシュ、プロキシ</primary></indexterm>
        <indexterm><primary>Squid</primary></indexterm>

	<para>HTTP プロキシはネットワークユーザの HTTP 要求を転送するサーバです。プロキシは転送したファイルのコピーを保存することでダウンロードの高速化に寄与する場合があります (そのためこれはプロキシ/キャッシュと呼ばれます)。時として、プロキシは外部のウェブサーバにアクセスする唯一の手段である場合があります。そしてこのような場合、必ずインストール中のプロキシ関連の質問に答えてください。そうすれば、プログラムはプロキシを通じて Debian パッケージをダウンロードできるようになります。</para>

	<para>Squid は Falcot Corp がプロキシサービスを提供するために使っているサーバソフトウェアの名前です。</para>
      </sidebar>
    </section>
    <section>
      <title>Debian パッケージ人気コンテスト</title>

      <para>Debian システムには <emphasis role="pkg">popularity-contest</emphasis> と呼ばれるパッケージが含まれています。<emphasis role="pkg">popularity-contest</emphasis> はパッケージの使用統計を収集するためのパッケージです。毎週、このプログラムはインストール済みパッケージと最近利用されたパッケージの情報を収集し、この情報を匿名で Debian プロジェクトのサーバに送信します。Debian プロジェクトはこの情報を基に各パッケージの相対的重要度を決定します。パッケージの相対的重要度はパッケージの優先度に影響をおよぼします。特に、インストールメディアの完全なセットをダウンロードまたは購入したくないというユーザの利便性を考慮して、インストール CD-ROM に収録されるパッケージは最も「人気」のパッケージだけに限られています。</para>

      <para><emphasis role="pkg">popularity-contest</emphasis> は、ユーザの利用法の機密性を配慮して、要求されない限りインストールされません。</para>
    </section>
    <section>
      <title>インストールするパッケージの選択</title>

      <para>以降の段階では、マシンの大ざっぱな用途を選択します。ここで提案されている 10 種類のタスクはインストールされるパッケージのリストに対応しています。後からインストール済みパッケージのリストを微調整したり仕上げる必要があるという点は変わりませんが、ここでタスクを選択して必要と思われるパッケージをインストールしておくことは後の作業の良い足掛かりとなります。</para>

      <para>一部のパッケージは、検出されたハードウェアに基づき、自動的にインストールされます (<emphasis role="pkg">discover</emphasis> パッケージの <command>discover-pkginstall</command> プログラムがこれを担当します)。たとえば、VirtualBox 仮想マシンが検出されたら、プログラムは <emphasis role="pkg">virtualbox-guest-dkms</emphasis> パッケージをインストールします。<emphasis role="pkg">virtualbox-guest-dkms</emphasis> は仮想マシンをホストシステムとうまく統合するためのものです。</para>

      <figure>
        <title>タスクの選択</title>
        <mediaobject>
          <imageobject>
            <imagedata fileref="images/inst-tasksel.png" scalefit="1" width="65%" />
          </imageobject>
        </mediaobject>
      </figure>
    </section>
    <section id="sect.installing-grub">
      <title>GRUB ブートローダのインストール</title>
      <indexterm><primary>ローダ</primary><secondary>ブートローダ</secondary></indexterm>
      <indexterm><primary>ブートローダ</primary></indexterm>
      <indexterm><primary>GRUB</primary></indexterm>

      <para>ブートローダは BIOS が起動する最初のプログラムです。ブートローダは Linux カーネルをメモリに読み込み、実行します。通常ブートローダはユーザに対して、読み込むカーネルまたは起動したいオペレーティングシステムを選択できるメニューを表示します。</para>

      <sidebar id="sidebar.bootloader-dual-boot">
        <title><emphasis>BEWARE</emphasis> ブートローダとデュアルブート</title>
        <indexterm><primary>デュアルブート</primary></indexterm>

	<para>Debian インストール作業では、この段階でコンピュータに既にインストールされたオペレーティングシステムを検出し、関連するエントリをブートメニューに自動的に追加します。しかし、中にはこのような作業を行わないインストールプログラムもあります。</para>

	<para>特に、Debian のインストール後に Windows をインストール (または再インストール) する場合、Debian がインストールしたブートローダは消去されます。Debian はまだハードドライブに残っていますが、もはやブートメニューに表示されません。排他的でないブートローダをセットアップするには、Debian インストールシステムを <userinput>rescue</userinput> モードで起動してください。この操作はインストールマニュアルに詳しく書かれています。<ulink type="block" url="http://www.debian.org/releases/stable/amd64/ch08s07.html" /></para>
      </sidebar>

      <para>デフォルトでは、GRUB が表示したメニューにはすべてのインストールされたカーネルおよび検出された他のオペレーティングシステムが含まれています。このため、GRUB はマスターブートレコード内にインストールされるべきです。古いカーネルバージョンを残しておけば、最近インストールされたカーネルが欠陥品かハードウェアと相性が悪い場合にも同じシステムを起動できる状態が保存されます。このため、インストール済みの古いカーネルバージョンを保持しておくことは合理的な方法です。</para>

      <para>GRUB はその技術的優位性のおかげで Debian がインストールするデフォルトのブートローダに採用されています。そして GRUB は多くのファイルシステムをサポートしているため、新しいカーネルのインストールの後に GRUB を毎回更新する必要がありません。なぜなら、GRUB は起動中に設定を読んで、新しいカーネルの正確な位置を見つけ出すからです。GRUB の バージョン 1 (現在は「Grub Legacy」として知られています) は LVM とソフトウェア RAID の組み合わせを取り扱うことができませんでした。しかし、デフォルトでインストールされるバージョン 2 はより完成度の高いものです。また、LILO (別のブートローダ) のインストールが推奨される状況もまだあるかもしれません。そのような場合、インストーラは自動的に LILO を提案します。</para>

      <para>GRUB の設定に関する詳しい情報は<xref linkend="sect.config-grub" />を参照してください。</para>

      <sidebar>
        <title><emphasis>BEWARE</emphasis> ブートローダとアーキテクチャ</title>

	<para>この章で紹介した LILO と GRUB は <emphasis>i386</emphasis> と <emphasis>amd64</emphasis> アーキテクチャ用のブートローダです。もし別のアーキテクチャに Debian をインストールするなら、別のブートローダが必要です。とりわけ、<emphasis>powerpc</emphasis> 用には <command>yaboot</command> または <command>quik</command>、<emphasis>sparc</emphasis> 用には <command>silo</command>、<emphasis>alpha</emphasis> 用には <command>aboot</command>、<emphasis>mips</emphasis> 用には <command>arcboot</command> が用意されています。</para>
      </sidebar>
    </section>
    <section>
      <title>インストールの完了と再起動</title>

      <para>これでインストールが完了しました。インストーラは、ドライブから CD-ROM を取り出し、コンピュータを再起動するよう促します。</para>
    </section>
  </section>
  <section id="sect.after-first-boot">
    <title>初回起動の後</title>

    <para>特定のデスクトップを選ばずに (または「GNOME」を選んで)「Debian デスクトップ環境」のタスクを有効化してインストールを進めていた場合、<command>gdm3</command> ログインマネージャが表示されます。</para>

    <figure>
      <title>初回起動</title>
      <mediaobject>
        <imageobject>
          <imagedata fileref="images/inst-gdm.png" scalefit="1" width="65%" />
        </imageobject>
      </mediaobject>
    </figure>

    <para>作成したユーザを使ってログインし、すぐに仕事を始められます。</para>
    <section>
      <title>追加ソフトウェアのインストール</title>

      <para>インストールされているパッケージはシステムのインストール中に選択したタスクを基に選ばれたものですが、実際のマシンの用途には不要なパッケージがインストールされている場合もあります。このような場合、パッケージをインストールしたり削除するためにパッケージ管理ツールを使いたくなるかもしれません。最も頻繁に利用されるパッケージ管理ツール (「Debian デスクトップ環境」タスクを選んだ場合にインストールされます) は <command>apt</command> (コマンドラインから利用します) と <command>synaptic</command> (メニューの「Synaptic パッケージマネージャ」から利用します) の 2 種類です。</para>

      <para>一連のプログラムグループのインストールを楽にするために、Debian はシステムに特定の (メールサーバ、ファイルサーバなどの) 機能を持たせる際に必要な作業をまとめた「タスク」を作りました。「タスク」を選択する機会はインストール中にもありましたし、パッケージ管理ツールである <command>aptitude</command> (タスクは専用のセクション内にリストされています) および <command>synaptic</command> (<menuchoice> <guimenu>編集(E)</guimenu> <guimenuitem>タスクを利用してパッケージにマークする(T)…</guimenuitem> </menuchoice>とメニューを進みます) からもタスクにアクセスすることが可能です。</para>

      <para>aptitude は全画面のテキストモードで動く APT へのインターフェースです。aptitude を使えば、利用できるパッケージをさまざまな状態 (インストール済み、未インストールのパッケージ、タスク、セクションなど) ごとに分類したリストを閲覧したり、各パッケージに対して利用できるすべての情報 (依存パッケージ、衝突パッケージ、パッケージ説明文など) を確認できます。また、各パッケージに対して一時的に「インストール」や「削除」マークを付け、後からその操作を実行させることが可能です (インストールは <keycap>+</keycap> キー、削除は <keycap>-</keycap> キーでマークします)。マークした操作は、<keycap>g</keycap> キー (「go!」の「g」) を押して確認したら、一斉に実行されます。インストールし忘れたパッケージがあっても心配ありません。この場合、最初のインストールが完了したら、もう一度 <command>aptitude</command> を実行すればよいのです。</para>
      <indexterm><primary>aptitude</primary></indexterm>

      <sidebar>
        <title><emphasis>TIP</emphasis> Debian は非英語言語話者に配慮しています</title>

	<para>いくつかのタスクはシステムを英語以外の言語向けに地域化するためのタスクです。これらのタスクには、翻訳された文書、辞書、異なる言語の話者に有益なさまざまな他のパッケージが含まれています。インストール中に非英語言語を選択した場合には、適切なタスクが自動的に選択されます。</para>
      </sidebar>

      <sidebar>
        <title><emphasis>CULTURE</emphasis> <command>dselect</command>、パッケージをインストールする古いインターフェース</title>

	<para><command>aptitude</command> 以前、インストールするパッケージを選択するための標準的なプログラムは <command>dselect</command> で、<command>dselect</command> は <command>dpkg</command> に対する古いグラフィカルインターフェースでした。<command>dselect</command> は初心者には使い難いプログラムなので、推奨しません。</para>
        <indexterm><primary><command>dselect</command></primary></indexterm>
      </sidebar>

      <para>もちろん、すべてのタスクを選択しないことも可能です。その場合、<command>apt-get</command> や <command>aptitude</command> コマンド (両方ともコマンドラインから利用できます) を使って必要なソフトウェアを手作業でインストールします。</para>

      <sidebar>
        <title><emphasis>VOCABULARY</emphasis> パッケージの依存関係と衝突</title>

	<para>Debian パッケージング用語で「依存」は対象のパッケージが適切に動作するために必要な他のパッケージを意味しています。逆に、「衝突」は対象のパッケージと共存してインストールできない他のパッケージを意味しています。</para>

	<para>これらの概念は<xref linkend="packaging-system" />で詳しく議論されています。</para>
      </sidebar>
    </section>
    <section>
      <title>システムのアップグレード</title>
      <indexterm><primary>safe-upgrade</primary></indexterm>

      <para>一般的に言えば、最初に <command>aptitude safe-upgrade</command> (インストールされたプログラムを自動的に更新するコマンド) を実行することをお勧めします。特に最新の Debian 安定版バージョンのリリース以降に発表されたセキュリティ更新を適用しなければいけません。更新の際に、標準的な Debian 設定ツールである <command>debconf</command> を使って追加的な質問をされるかもしれません。<command>aptitude</command> を使った更新に関する詳しい情報は、<xref linkend="sect.apt-upgrade" />を参照してください。</para>
    </section>
  </section>
</chapter>
