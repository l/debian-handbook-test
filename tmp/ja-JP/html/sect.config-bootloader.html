<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">8.8. ブートローダの設定</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-ja-JP-1.0-1" /><meta
        name="keywords"
        content="設定, 地域化, ロケール, ネットワーク, 名前解決, ユーザ, グループ, アカウント, コマンドラインインタプリタ, シェル, 印刷, ブートローダ, カーネルのコンパイル" /><link
        rel="home"
        href="index.html"
        title="Debian 管理者ハンドブック" /><link
        rel="up"
        href="basic-configuration.html"
        title="第 8 章 基本設定、ネットワーク、アカウント、印刷..." /><link
        rel="prev"
        href="sect.config-printing.html"
        title="8.7. プリンタ設定" /><link
        rel="next"
        href="sect.config-misc.html"
        title="8.9. その他の設定: 時刻同期、ログ、共有アクセス…" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/ja-JP/stable/sect.config-bootloader.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.config-printing.html"><strong>戻る</strong></a></li><li
          class="home">Debian 管理者ハンドブック</li><li
          class="next"><a
            accesskey="n"
            href="sect.config-misc.html"><strong>次へ</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.config-bootloader"></a>8.8. ブートローダの設定</h2></div></div></div><a
          id="id-1.11.12.2"
          class="indexterm"></a><a
          id="id-1.11.12.3"
          class="indexterm"></a><div
          class="para">
			ブートローダは既に機能しているかもしれませんが、ブートローダがマスターブートレコードから消えてしまった状況に備えて、ブートローダの設定方法とイントール方法を知っておくのは常に良い考えです。この状況は Windows などの他のオペレーティングシステムをインストールした後に起こる場合があります。以下の情報はブートローダ設定の変更が必要になった際にそれを変更するための助けになるでしょう。
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>BACK TO BASICS</em></span> マスターブートレコード</strong></p></div></div></div><a
            id="id-1.11.12.5.2"
            class="indexterm"></a><a
            id="id-1.11.12.5.3"
            class="indexterm"></a><div
            class="para">
			マスターブートレコード (MBR) は最初のハードディスクの最初の 512 バイトを専有し、BIOS は対象のオペレーティングシステムを起動できるプログラムに操作を受け渡すために真っ先に MBR を読み込みます。一般にブートローダは MBR にインストールされ、その前に MBR にあった情報は削除されます。
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.identify-disks"></a>8.8.1. ディスクの識別</h3></div></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CULTURE</em></span> <span
                        class="emphasis"><em>udev</em></span> と <code
                        class="filename">/dev/</code></strong></p></div></div></div><div
              class="para">
				伝統的に、<code
                class="filename">/dev/</code> ディレクトリはシステムの周辺機器を表す目的でいわゆる「スペシャル」ファイルを保存する場所でした (補注<a
                class="xref"
                href="sect.creating-accounts.html#sidebar.special-files">「<span
                  class="emphasis"><em>BACK TO BASICS</em></span> デバイスアクセスパーミッション」</a>を参照してください)。昔 <code
                class="filename">/dev/</code> ディレクトリには、潜在的に利用する可能性のあるすべてのスペシャルファイルが含まれていました。このやり方には多くの欠点がありました。特に使うことのできるデバイスの数が制限されていた点 (名前リストがハードコードされていた点)、実際に使えるスペシャルファイルがどれなのか分からない点が問題でした。
			</div><div
              class="para">
				今日、スペシャルファイルの管理は完全に動的に行われるようになっており、ホットスワップできるコンピュータデバイスの性質とうまく合っています。カーネルは <span
                class="emphasis"><em>udev</em></span> と協力し、対応するデバイスが取り付けられたり取り外された際に、スペシャルファイルを作成したり削除したりします。この理由により <code
                class="filename">/dev/</code> を保存しておく必要はなくなり、RAM ベースのファイルシステムでは最初 <code
                class="filename">/dev/</code> ディレクトリを空にしておいて関連するエントリだけを含めるようにしています。
			</div><div
              class="para">
				カーネルは新たに追加されたデバイスに関する多くの情報をやり取りして、そのデバイスを識別するメジャー/マイナー番号の組を配布します。<code
                class="command">udevd</code> はデバイスに必要なパーミッション設定と命名を行ったスペシャルファイルを作成します。さらに <code
                class="command">udevd</code> は別名を作成し、追加的操作 (デバイスの初期化や登録作業など) を実行することも可能です。<code
                class="command">udevd</code> の挙動は (カスタマイズが可能な) 巨大ルール群によって決定されます。
			</div><div
              class="para">
				動的に名前を付けることで、あるデバイスに常に同じ名前を持たせることが可能になります。名前は接続するコネクタや接続順に依存しないので、特に複数の USB 周辺機器を使う場合に便利です。1 台目のハードドライブの最初のパーティションは後方互換性を保つために <code
                class="filename">/dev/sda1</code> と呼ばれます。しかしあなたがそう望むなら <code
                class="filename">/dev/root-partition</code> と呼ぶことも可能ですし、両方の名前を同時に使うことも可能です。なぜなら <code
                class="command">udevd</code> を設定すれば自動的にシンボリックリンクを作成するようにできるからです。
			</div><div
              class="para">
				古くは、一部のカーネルモジュールはユーザが関連するデバイスファイルにアクセスを試行した時点で自動的に読み込まれていました。今現在この方針は使われておらず、モジュールを読み込む前に周辺機器のスペシャルファイルが存在することはありません。しかしこれは大きな問題ではありません。なぜなら、自動ハードウェア検出のおかげで多くのモジュールは起動時に読み込まれるからです。しかし、検出できない周辺機器 (非常に古いディスクドライブや PS/2 マウスなど) ではこの挙動が問題になります。<code
                class="literal">floppy</code>、<code
                class="literal">psmouse</code>、<code
                class="literal">mousedev</code> モジュールを <code
                class="filename">/etc/modules</code> に追加して、起動時に強制的にこれらのモジュールを読み込むことを検討してください。
			</div></div><a
            id="id-1.11.12.6.3"
            class="indexterm"></a><a
            id="id-1.11.12.6.4"
            class="indexterm"></a><div
            class="para">
				ブートローダを設定するには、必ずさまざまなハードドライブとそのパーティションを識別しなければいけません。Linux はこの目的のために <code
              class="filename">/dev/</code> ディレクトリ内で「ブロック」スペシャルファイルを使います。Debian <span
              class="distribution distribution">Squeeze</span> 以降、ハードドライブの命名規則は Linux カーネルによって統一化されました。現在、すべてのハードドライブ (IDE/PATA、SATA、SCSI、USB、IEEE 1394) は <code
              class="filename">/dev/sd*</code> と表されます。
			</div><div
            class="para">
				それぞれのパーティションは自分が存在するディスク上の番号で表されます。たとえば、<code
              class="filename">/dev/sda1</code> は 1 台目のディスクの最初のパーティションで、<code
              class="filename">/dev/sdb3</code> は 2 台目のディスクの 3 番目のパーティションです。
			</div><a
            id="id-1.11.12.6.7"
            class="indexterm"></a><a
            id="id-1.11.12.6.8"
            class="indexterm"></a><a
            id="id-1.11.12.6.9"
            class="indexterm"></a><a
            id="id-1.11.12.6.10"
            class="indexterm"></a><div
            class="para">
				PC アーキテクチャ (つまり「i386」およびその年下のいとこである「amd64」) では、長い間「MS-DOS」パーティションテーブルフォーマットを使うよう制限を受けていました。このフォーマットはディスク 1 台当たりに作れる「プライマリ」パーティションの数を 4 つに制限していました。この制限を乗り越えるためには、プライマリパーティションの 1 つを「拡張」パーティションとして作成します。拡張パーティションには追加的な「セカンダリ」パーティションを含めることが可能です。このようなセカンダリパーティションには 5 以上の番号が割り振られます。従って、最初のセカンダリパーティションは <code
              class="filename">/dev/sda5</code>、2 番目は <code
              class="filename">/dev/sda6</code> などのように割り振られるでしょう。
			</div><div
            class="para">
				MS-DOS パーティションテーブルフォーマットのもう一つの制限は、2 TiB を超えるサイズのディスクを取り扱うことができないという点です。近年のディスクではこの制限が現実的な問題になりつつあります。
			</div><a
            id="id-1.11.12.6.13"
            class="indexterm"></a><a
            id="id-1.11.12.6.14"
            class="indexterm"></a><div
            class="para">
				GPT と呼ばれる新しいパーティションテーブルフォーマットを使うことで上に挙げた制限が緩和されます。GPT では、パーティション数は最大で 128 個に制限され (標準的な設定を使った場合)、ディスクサイズは最大で 8 ZiB (80 億テラバイト以上) に制限されます。1 台のディスクに多くの物理パーティションを作成する場合、ディスクのパーティショニングを行う際に必ず GPT フォーマットでパーティションテーブルを作成するよう注意してください。
			</div><div
            class="para">
				どのディスクがどの SATA コントローラに (たとえば SCSI チェーンの 3 番目に) 接続されているかを記憶するのは常に簡単というわけではありません。なぜなら、特にホットプラグ対応のハードドライブ (これには多くの SATA ディスクや外部ディスクが含まれます) の名前は起動の度に変わるからです。幸いなことに、<code
              class="command">udev</code> は <code
              class="filename">/dev/sd*</code> に加えて、固有名のシンボリックリンクを作成します。曖昧でない方法でハードドライブを識別したい場合にはこのシンボリックリンクを使うことが可能です。これらのシンボリックリンクは <code
              class="filename">/dev/disk/by-id</code> に保存されています。たとえば 2 台の物理ディスクを備えるマシンでは以下のようなシンボリックリンクが見つかります。
			</div><pre
            class="screen"><code
              class="computeroutput">mirexpress:/dev/disk/by-id# </code><strong
              class="userinput"><code>ls -l
</code></strong><code
              class="computeroutput">合計 0
lrwxrwxrwx 1 root root  9  7月 23 08:58 ata-STM3500418AS_9VM3L3KP -&gt; ../../sda
lrwxrwxrwx 1 root root 10  7月 23 08:58 ata-STM3500418AS_9VM3L3KP-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root root 10  7月 23 08:58 ata-STM3500418AS_9VM3L3KP-part2 -&gt; ../../sda2
[...]
lrwxrwxrwx 1 root root  9  7月 23 08:58 ata-WDC_WD5001AALS-00L3B2_WD-WCAT00241697 -&gt; ../../sdb
lrwxrwxrwx 1 root root 10  7月 23 08:58 ata-WDC_WD5001AALS-00L3B2_WD-WCAT00241697-part1 -&gt; ../../sdb1
lrwxrwxrwx 1 root root 10  7月 23 08:58 ata-WDC_WD5001AALS-00L3B2_WD-WCAT00241697-part2 -&gt; ../../sdb2
[...]
lrwxrwxrwx 1 root root  9  7月 23 08:58 scsi-SATA_STM3500418AS_9VM3L3KP -&gt; ../../sda
lrwxrwxrwx 1 root root 10  7月 23 08:58 scsi-SATA_STM3500418AS_9VM3L3KP-part1 -&gt; ../../sda1
lrwxrwxrwx 1 root root 10  7月 23 08:58 scsi-SATA_STM3500418AS_9VM3L3KP-part2 -&gt; ../../sda2
[...]
lrwxrwxrwx 1 root root  9  7月 23 08:58 scsi-SATA_WDC_WD5001AALS-_WD-WCAT00241697 -&gt; ../../sdb
lrwxrwxrwx 1 root root 10  7月 23 08:58 scsi-SATA_WDC_WD5001AALS-_WD-WCAT00241697-part1 -&gt; ../../sdb1
lrwxrwxrwx 1 root root 10  7月 23 08:58 scsi-SATA_WDC_WD5001AALS-_WD-WCAT00241697-part2 -&gt; ../../sdb2
[...]
lrwxrwxrwx 1 root root  9  7月 23 16:48 usb-LaCie_iamaKey_3ed00e26ccc11a-0:0 -&gt; ../../sdc
lrwxrwxrwx 1 root root 10  7月 23 16:48 usb-LaCie_iamaKey_3ed00e26ccc11a-0:0-part1 -&gt; ../../sdc1
lrwxrwxrwx 1 root root 10  7月 23 16:48 usb-LaCie_iamaKey_3ed00e26ccc11a-0:0-part2 -&gt; ../../sdc2
[...]
lrwxrwxrwx 1 root root  9  7月 23 08:58 wwn-0x5000c50015c4842f -&gt; ../../sda
lrwxrwxrwx 1 root root 10  7月 23 08:58 wwn-0x5000c50015c4842f-part1 -&gt; ../../sda1
[...]
mirexpress:/dev/disk/by-id# </code></pre><div
            class="para">
				いくつかのディスクは複数回リストされています (なぜなら、それらは ATA ディスクであり同時に SCSI ディスクとしても振る舞うからです)。しかしながら、ディスクに固有の情報は主にディスクの製品番号とシリアル番号であるという点に注意してください。ここから、目的の周辺機器のシンボリックリンクを見つけることが可能です。
			</div><div
            class="para">
				以降の節で挙げる設定ファイルの例はこれと同じディスク構成のマシンに対する設定です。具体的に言えば、1 台の SATA ディスクがあり、最初のパーティションに古い Windows がインストールされており、2 番目のパーティションに Debian GNU/Linux がインストールされている状態です。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.config-lilo"></a>8.8.2. LILO の設定</h3></div></div></div><a
            id="id-1.11.12.7.2"
            class="indexterm"></a><a
            id="id-1.11.12.7.3"
            class="indexterm"></a><div
            class="para">
				<span
              class="emphasis"><em>LILO</em></span> (LInux LOader) は最も古い (実直だが素朴な) ブートローダです。<span
              class="emphasis"><em>LILO</em></span> は MBR に起動するカーネルの物理アドレスを書くため、LILO および LILO の設定ファイルを更新した際にはその後に必ず <code
              class="command">lilo</code> コマンドを使わなければいけません。このルールを忘れて、古いカーネルを削除したり、置き換えた新しいカーネルを古いカーネルがあった場所と同じディスクの場所に置かなかったりすると、システムが起動できないと表示されます。
			</div><div
            class="para">
				LILO の設定ファイルは <code
              class="filename">/etc/lilo.conf</code> です。標準的な設定を行う単純なファイルは以下の例のように書けます。
			</div><div
            class="example"><a
              xmlns=""
              id="example.lilo.conf"></a><p
              class="title"><strong>例 8.3 LILO の設定ファイル</strong></p><div
              class="example-contents"><pre
                class="programlisting">
# このディスクに LILO をインストールします。
# ここではパーティションではなくディスクを指定してください。
# LILO は MBR にインストールされます。
boot=/dev/sda
# Debian がインストールされているパーティション
root=/dev/sda2
# デフォルトで起動させるアイテム
default=Linux

# 最新のカーネルイメージ
image=/vmlinuz
  label=Linux
  initrd=/initrd.img
  read-only

# 古いカーネル (最新のカーネルが起動しなかった際に使います)
image=/vmlinuz.old
  label=LinuxOLD
  initrd=/initrd.img.old
  read-only
  optional

# Linux と Windows のデュアルブート用
other=/dev/sda1
  label=Windows</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.config-grub"></a>8.8.3. GRUB 2 の設定</h3></div></div></div><a
            id="id-1.11.12.8.2"
            class="indexterm"></a><a
            id="id-1.11.12.8.3"
            class="indexterm"></a><div
            class="para">
				<span
              class="emphasis"><em>GRUB</em></span> (GRand Unified Bootloader) はより新しいブートローダです。カーネル更新の後に GRUB を実行する必要はありません。それどころか <span
              class="emphasis"><em>GRUB</em></span> はファイルシステムを読む方法とディスクからカーネルを探し出す方法を知っています。GRUB を最初のディスクの MBR にインストールするためには、<code
              class="command">grub-install /dev/sda</code> を実行してください。<a
              id="id-1.11.12.8.4.4"
              class="indexterm"></a>
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>NOTE</em></span> GRUB におけるディスク名の命名規則</strong></p></div></div></div><div
              class="para">
				GRUB は BIOS から提供される情報に従ってハードドライブを識別します。<code
                class="literal">(hd0)</code> は最初に検出されたディスクに対応し、<code
                class="literal">(hd1)</code> は 2 番目に対応します。多くの場合、この順番は Linux 上でディスクが検出される普通の順番と完全に一致しますが、SCSI や IDE ディスクを使っている場合、問題が起きるかもしれません。GRUB は検出した対応関係を <code
                class="filename">/boot/grub/device.map</code> ファイルの中に保存します。管理者がこの対応関係に間違いを見つけた場合 (BIOS が Linux と違う順番でドライブを検出するということを知っている場合)、対応関係を修正して、再度 <code
                class="command">grub-install</code> を実行してください。<code
                class="command">grub-mkdevicemap</code> を使えば、<code
                class="filename">device.map</code> ファイルのたたき台を作成することが可能です。
			</div><div
              class="para">
				GRUB はパーティションを識別する名前も使います。MS-DOS フォーマットの「標準的な」パーティションを使っている場合、最初のディスクの最初のパーティションは <code
                class="literal">(hd0,msdos1)</code>、2 番目のパーティションは <code
                class="literal">(hd0,msdos2)</code> です。
			</div></div><div
            class="para">
				GRUB 2 の設定は <code
              class="filename">/boot/grub/grub.cfg</code> に保存されていますが、このファイルは (Debian の場合) 別のファイルから生成されます。<code
              class="filename">/boot/grub/grub.cfg</code> を直接変更しないでください。なぜなら、<code
              class="command">update-grub</code> が実行されたら (さまざまなパッケージの更新時に実行されることがあります) そのようなその場限りの変更は失われるからです。<code
              class="filename">/boot/grub/grub.cfg</code> ファイルに対して最も一般的な変更を加える (たとえば、カーネルに渡すコマンドラインパラメータを追加したり、メニューの表示される時間を変える) には <code
              class="filename">/etc/default/grub</code> に含まれる変数を使います。メニューにエントリを追加するには <code
              class="filename">/boot/grub/custom.cfg</code> ファイルを作成するか、<code
              class="filename">/etc/grub.d/50_custom</code> ファイルを変更してください。より複雑な設定をするには <code
              class="filename">/etc/grub.d</code> にある他のファイルを変更するか、このディレクトリにファイルを追加してください。<code
              class="filename">/etc/grub.d</code> ディレクトリに含まれるスクリプトは設定スニペットを返すスクリプトであり、場合によっては外部プログラムを使用するかもしれません。これらのスクリプトは起動したいカーネルのリストを更新するためのものです。すなわち <code
              class="filename">10_linux</code> はインストール済み Linux カーネルをリストアップします。そして <code
              class="filename">20_linux_xen</code> は Xen 仮想システムをリストアップし、<code
              class="filename">30_os-prober</code> は他のオペレーティングシステム (Windows、OS X、Hurd) をリストアップします。
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.config-yaboot"></a>8.8.4. Macintosh コンピュータ (PowerPC) の場合、Yaboot の設定</h3></div></div></div><a
            id="id-1.11.12.9.2"
            class="indexterm"></a><div
            class="para">
				Yaboot は PowerPC プロセッサを搭載する古い Macintosh コンピュータ用のブートローダです。古い Macintosh コンピュータは PC のように起動せず、「bootstrap」パーティションを使って起動します。「bootstrap」パーティションには、BIOS (または OpenFirmware) が実行する Yaboot が含まれ、さらに <code
              class="command">ybin</code> プログラムがインストールする <code
              class="command">yaboot</code> と設定ファイルも含まれています。設定ファイル <code
              class="filename">/etc/yaboot.conf</code> (このファイルは bootstrap パーティションにコピーされ、<code
              class="command">yaboot</code> がディスク上からカーネルのパーティションを見つける方法を指定するファイルです) を変更したら、<code
              class="command">ybin</code> コマンドを再度実行する必要があります。
			</div><div
            class="para">
				<code
              class="command">ybin</code> を実行する前に、適切な <code
              class="filename">/etc/yaboot.conf</code> を作らなければいけません。以下は最低限の設定例です。<a
              id="id-1.11.12.9.4.3"
              class="indexterm"></a>
			</div><div
            class="example"><a
              xmlns=""
              id="example.yaboot.conf"></a><p
              class="title"><strong>例 8.4 Yaboot の設定ファイル</strong></p><div
              class="example-contents"><pre
                class="programlisting">
# bootstrap パーティション
boot=/dev/sda2
# ディスク
device=hd:
# Linux パーティション
partition=3
root=/dev/sda3
# 3 秒間何もしなければ起動します
# (timeout は 10 倍の値を設定してください)
timeout=30

install=/usr/lib/yaboot/yaboot
magicboot=/usr/lib/yaboot/ofboot
enablecdboot

# 最近インストールされたカーネル
image=/vmlinux
        label=linux
        initrd=/initrd.img
        read-only

# 古いカーネル
image=/vmlinux.old
        label=old
        initrd=/initrd.img.old
        read-only

# Linux と Mac OSX のデュアルブート用
macosx=/dev/sda5

# bsd=/dev/sdaX および macos=/dev/sdaX
# の可能性もあります</pre></div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.config-printing.html"><strong>戻る</strong>8.7. プリンタ設定</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上に戻る</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>ホーム</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.config-misc.html"><strong>次へ</strong>8.9. その他の設定: 時刻同期、ログ、共有アクセス…</a></li></ul></body></html>
