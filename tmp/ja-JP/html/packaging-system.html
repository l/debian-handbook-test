<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">第 5 章 パッケージシステム、ツールと基本原則</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-9-ja-JP-1.0-1" /><meta
        name="keywords"
        content="バイナリパッケージ, ソースパッケージ, dpkg, 依存関係, 衝突" /><link
        rel="home"
        href="index.html"
        title="Debian 管理者ハンドブック" /><link
        rel="up"
        href="index.html"
        title="Debian 管理者ハンドブック" /><link
        rel="prev"
        href="sect.after-first-boot.html"
        title="4.3. 初回起動の後" /><link
        rel="next"
        href="sect.package-meta-information.html"
        title="5.2. パッケージのメタ情報" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/ja-JP/stable/packaging-system.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.after-first-boot.html"><strong>戻る</strong></a></li><li
          class="home">Debian 管理者ハンドブック</li><li
          class="next"><a
            accesskey="n"
            href="sect.package-meta-information.html"><strong>次へ</strong></a></li></ul><div
        xml:lang="ja-JP"
        class="chapter"
        lang="ja-JP"><div
          class="titlepage"><div><div><h1
                class="title"><a
                  xmlns=""
                  id="packaging-system"></a>第 5 章 パッケージシステム、ツールと基本原則</h1></div></div></div><div
          class="toc"><dl
            class="toc"><dt><span
                class="section"><a
                  href="packaging-system.html#sect.binary-package-structure">5.1. バイナリパッケージの構造</a></span></dt><dt><span
                class="section"><a
                  href="sect.package-meta-information.html">5.2. パッケージのメタ情報</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#sect.control">5.2.1. 説明、<code
                        class="filename">control</code> ファイル</a></span></dt><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#sect.configuration-scripts">5.2.2. 設定スクリプト</a></span></dt><dt><span
                    class="section"><a
                      href="sect.package-meta-information.html#sect.conffiles">5.2.3. チェックサム、設定ファイルのリスト</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.source-package-structure.html">5.3. ソースパッケージの構造</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.source-package-structure.html#id-1.8.7.4">5.3.1. フォーマット</a></span></dt><dt><span
                    class="section"><a
                      href="sect.source-package-structure.html#id-1.8.7.5">5.3.2. Debian 内での使われ方</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.manipulating-packages-with-dpkg.html">5.4. <code
                    class="command">dpkg</code> を用いたパッケージの操作</a></span></dt><dd><dl><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#id-1.8.8.5">5.4.1. パッケージのインストール</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#id-1.8.8.6">5.4.2. パッケージの削除</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#id-1.8.8.7">5.4.3. <code
                        class="command">dpkg</code> のデータベースへの問い合わせと <code
                        class="filename">.deb</code> ファイルの調査</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#id-1.8.8.8">5.4.4. <code
                        class="command">dpkg</code> のログファイル</a></span></dt><dt><span
                    class="section"><a
                      href="sect.manipulating-packages-with-dpkg.html#sect.multi-arch">5.4.5. マルチアーキテクチャサポート</a></span></dt></dl></dd><dt><span
                class="section"><a
                  href="sect.coexistence-with-other-packaging-systems.html">5.5. 他のパッケージングシステムとの共存</a></span></dt></dl></div><div
          class="highlights"><div
            class="para">
		Debian システム管理者は日常的に <code
              class="filename">.deb</code> パッケージを取り扱います。なぜなら、パッケージにはそのパッケージを使うために必要なすべての要素 (アプリケーション、文書など) が含まれており、パッケージによってこれらの要素のインストールとメンテナンスが楽になるからです。ゆえに、パッケージとはどのようなもので、パッケージはどのように取り扱われるべきものなのかを知っておくことは良い考えです。
	</div></div><div
          class="para">
		この章では、「バイナリパッケージ」と「ソースパッケージ」の構造と内容について説明します。バイナリパッケージとは <code
            class="command">dpkg</code> が直接取り扱う <code
            class="filename">.deb</code> ファイルです。一方、ソースパッケージにはソースコードおよびバイナリパッケージをビルドするための説明が含まれています。
	</div><div
          class="section"><div
            class="titlepage"><div><div><h2
                  class="title"><a
                    xmlns=""
                    id="sect.binary-package-structure"></a>5.1. バイナリパッケージの構造</h2></div></div></div><a
            id="id-1.8.5.2"
            class="indexterm"></a><a
            id="id-1.8.5.3"
            class="indexterm"></a><div
            class="para">
			The Debian package format is designed so that its content may be extracted on any Unix system that has the classic commands <code
              class="command">ar</code>, <code
              class="command">tar</code>, and <code
              class="command">xz</code> (sometimes <code
              class="command">gzip</code> or <code
              class="command">bzip2</code>). This seemingly trivial property is important for portability and disaster recovery.
		</div><div
            class="para">
			Imagine, for example, that you mistakenly deleted the <code
              class="command">dpkg</code> program, and that you could thus no longer install Debian packages. <code
              class="command">dpkg</code> being a Debian package itself, it would seem your system would be done for... Fortunately, you know the format of a package and can therefore download the <code
              class="filename">.deb</code> file of the <span
              class="pkg pkg">dpkg</span> package and install it manually (see sidebar <a
              class="xref"
              href="packaging-system.html#sidebar.dpkg-apt-ar">「<span
                class="emphasis"><em>TOOLS</em></span> <code
                class="command">dpkg</code>、<code
                class="command">APT</code>、<code
                class="command">ar</code>」</a>). If by some misfortune one or more of the programs <code
              class="command">ar</code>, <code
              class="command">tar</code> or <code
              class="command">gzip</code>/<code
              class="command">xz</code>/<code
              class="command">bzip2</code> have disappeared, you will only need to copy the missing program from another system (since each of these operates in a completely autonomous manner, without dependencies, a simple copy will suffice). If your system suffered some even more outrageous fortune, and even these don't work (maybe the deepest system libraries are missing?), you should try the static version of <code
              class="command">busybox</code> (provided in the <span
              class="pkg pkg">busybox-static</span> package), which is even more self-contained, and provides subcommands such as <code
              class="command">busybox ar</code>, <code
              class="command">busybox tar</code> and <code
              class="command">busybox xz</code>.
		</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.dpkg-apt-ar"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>TOOLS</em></span> <code
                        class="command">dpkg</code>、<code
                        class="command">APT</code>、<code
                        class="command">ar</code></strong></p></div></div></div><a
              id="id-1.8.5.6.2"
              class="indexterm"></a><a
              id="id-1.8.5.6.3"
              class="indexterm"></a><a
              id="id-1.8.5.6.4"
              class="indexterm"></a><div
              class="para">
			<code
                class="command">dpkg</code> は <code
                class="filename">.deb</code> ファイルを取り扱うプログラムで、特に <code
                class="filename">.deb</code> ファイルの抽出、分析、展開を担当しています。
		</div><div
              class="para">
			<code
                class="command">APT</code> はシステムの変更操作をさらに手際よく行うプログラム群です。具体的に言えば、<code
                class="command">APT</code> はパッケージのインストールや削除 (依存関係を破壊することなく)、システムの更新、利用できるパッケージの表示などを行います。
		</div><a
              id="id-1.8.5.6.7"
              class="indexterm"></a><div
              class="para">
			As for the <code
                class="command">ar</code> program, it allows handling files of the same name: <code
                class="command">ar t <em
                  class="replaceable">archive</em></code> displays the list of files contained in such an archive, <code
                class="command">ar x <em
                  class="replaceable">archive</em></code> extracts the files from the archive into the current working directory, <code
                class="command">ar d <em
                  class="replaceable">archive</em> <em
                  class="replaceable">file</em></code> deletes a file from the archive, etc. Its man page (<span
                class="citerefentry"><span
                  class="refentrytitle">ar</span>(1)</span>) documents all its other features. <code
                class="command">ar</code> is a very rudimentary tool that a Unix administrator would only use on rare occasions, but admins routinely use <code
                class="command">tar</code>, a more evolved archive and file management program. This is why it is easy to restore <code
                class="command">dpkg</code> in the event of an erroneous deletion. You would only have to download the Debian package and extract the content from the <code
                class="filename">data.tar.xz</code> archive in the system's root (<code
                class="filename">/</code>):
		</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>ar x dpkg_1.18.24_amd64.deb</code></strong>
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>tar -C / -p -xJf data.tar.xz</code></strong></pre></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>BACK TO BASICS</em></span> man ページの表記</strong></p></div></div></div><div
              class="para">
			初心者にとって、文献から「<span
                class="citerefentry"><span
                  class="refentrytitle">ar</span>(1)</span>」の資料を探すことは、わかりにくいことかもしれません。<span
                class="citerefentry"><span
                  class="refentrytitle">ar</span>(1)</span> は第 1 セクションにある <code
                class="literal">ar</code> と名付けられた man ページを参照する便利な表記です。
		</div><div
              class="para">
			man ページの表記は曖昧さをなくすために使われる場合があります。たとえば、<code
                class="command">printf</code> コマンドの man ページは <span
                class="citerefentry"><span
                  class="refentrytitle">printf</span>(1)</span> と表記し、C 言語の <code
                class="function">printf</code> 関数の man ページは <span
                class="citerefentry"><span
                  class="refentrytitle">printf</span>(3)</span> と表記することで、両者を区別します。
		</div><div
              class="para">
			詳細は<a
                class="xref"
                href="solving-problems.html">第 7 章「<em>問題の解決と関連情報の探索</em>」</a>で議論されています (<a
                class="xref"
                href="solving-problems.html#sect.manual-pages">第 7.1.1 節「マニュアルページ」</a>をご覧ください)。
		</div></div><div
            class="para">
			それでは <code
              class="filename">.deb</code> ファイルの内容を見てみましょう。
		</div><pre
            class="screen"><code
              class="computeroutput">$ </code><strong
              class="userinput"><code>ar t dpkg_1.18.24_amd64.deb</code></strong>
<code
              class="computeroutput">debian-binary
control.tar.gz
data.tar.xz
$ </code><strong
              class="userinput"><code>ar x dpkg_1.18.24_amd64.deb</code></strong>
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>ls</code></strong>
<code
              class="computeroutput">control.tar.gz  data.tar.xz  debian-binary  dpkg_1.18.24_amd64.deb
$ </code><strong
              class="userinput"><code>tar tJf data.tar.xz | head -n 15</code></strong>
<code
              class="computeroutput">./
./etc/
./etc/alternatives/
./etc/alternatives/README
./etc/cron.daily/
./etc/cron.daily/dpkg
./etc/dpkg/
./etc/dpkg/dpkg.cfg
./etc/dpkg/dpkg.cfg.d/
./etc/logrotate.d/
./etc/logrotate.d/dpkg
./sbin/
./sbin/start-stop-daemon
./usr/
./usr/bin/
$ </code><strong
              class="userinput"><code>tar tzf control.tar.gz</code></strong>
<code
              class="computeroutput">./
./conffiles
./postinst
./md5sums
./prerm
./control
./postrm
$ </code><strong
              class="userinput"><code>cat debian-binary</code></strong>
<code
              class="computeroutput">2.0</code></pre><div
            class="para">
			ご覧の通り、Debian パッケージの <code
              class="command">ar</code> アーカイブは以下の 3 つのファイルから成り立っています。
		</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">debian-binary</code>. This is a text file which simply indicates the version of the <code
                    class="filename">.deb</code> file used (in 2017: version 2.0).
				</div></li><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">control.tar.gz</code>。このアーカイブファイルには、パッケージの名前やバージョンなど、利用できるすべてのメタ情報が含まれています。このメタ情報の一部と、たとえば、マシンにインストールされているパッケージのリストを照らし合わせて、パッケージ管理ツールはパッケージをインストールまたはアンインストールが可能かを決定します。
				</div></li><li
                class="listitem"><div
                  class="para">
					<code
                    class="filename">data.tar.xz</code>. This archive contains all of the files to be extracted from the package; this is where the executable files, documentation, etc., are all stored. Some packages may use other compression formats, in which case the file will be named differently (<code
                    class="filename">data.tar.bz2</code> for bzip2, <code
                    class="filename">data.tar.gz</code> for gzip).
				</div></li></ul></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.after-first-boot.html"><strong>戻る</strong>4.3. 初回起動の後</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上に戻る</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>ホーム</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.package-meta-information.html"><strong>次へ</strong>5.2. パッケージのメタ情報</a></li></ul></body></html>
