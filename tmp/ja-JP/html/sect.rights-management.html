<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">9.3. 権限の管理</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-ja-JP-1.0-1" /><meta
        name="keywords"
        content="システム起動, 初期化スクリプト, SSH, Telnet, 権限, パーミッション, 管理, inetd, cron, バックアップ, ホットプラグ, PCMCIA, APM, ACPI" /><link
        rel="home"
        href="index.html"
        title="Debian 管理者ハンドブック" /><link
        rel="up"
        href="unix-services.html"
        title="第 9 章 Unix サービス" /><link
        rel="prev"
        href="sect.remote-login.html"
        title="9.2. リモートログイン" /><link
        rel="next"
        href="sect.administration-interfaces.html"
        title="9.4. 管理インターフェース" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/ja-JP/stable/sect.rights-management.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.remote-login.html"><strong>戻る</strong></a></li><li
          class="home">Debian 管理者ハンドブック</li><li
          class="next"><a
            accesskey="n"
            href="sect.administration-interfaces.html"><strong>次へ</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.rights-management"></a>9.3. 権限の管理</h2></div></div></div><div
          class="para">
			Linux は完全なマルチユーザシステムです。このため、ユーザの権限に基づいてファイルやディレクトリに対する操作を制御するためにパーミッションシステムを提供することが必要です。このパーミッションシステムはすべてのシステムリソースとデバイスに対して適用されます (Unix システムではすべてのデバイスはファイルまたはディレクトリとして表現されます)。この原理はすべての Unix システムで共通ですが、特に興味深く比較的知られていない上級の使い方があるので、注意は常に必要です。
		</div><a
          id="id-1.12.6.3"
          class="indexterm"></a><a
          id="id-1.12.6.4"
          class="indexterm"></a><a
          id="id-1.12.6.5"
          class="indexterm"></a><a
          id="id-1.12.6.6"
          class="indexterm"></a><a
          id="id-1.12.6.7"
          class="indexterm"></a><a
          id="id-1.12.6.8"
          class="indexterm"></a><div
          class="para">
			ファイルとディレクトリには 3 種類のユーザ別に特定のパーミッションが付けられます。以下に 3 種類のユーザを挙げます。
		</div><div
          xmlns:d="http://docbook.org/ns/docbook"
          class="itemizedlist"><ul><li
              class="listitem"><div
                class="para">
					所有者 (「user」の <code
                  class="literal">u</code> で表記されます)。
				</div></li><li
              class="listitem"><div
                class="para">
					所有グループ (「group」の <code
                  class="literal">g</code> で表記されます)。これはグループに所属する全ユーザを意味しています。
				</div></li><li
              class="listitem"><div
                class="para">
					その他 (「other」の <code
                  class="literal">o</code> で表記されます)。
				</div></li></ul></div><div
          class="para">
			3 種類の権限は組み合わせて使うことが可能です。以下に 3 種類の権限を挙げます。
		</div><div
          xmlns:d="http://docbook.org/ns/docbook"
          class="itemizedlist"><ul><li
              class="listitem"><div
                class="para">
					読み込み (「read」の <code
                  class="literal">r</code> で表記されます)。
				</div></li><li
              class="listitem"><div
                class="para">
					書き込み (または変更。「write」の <code
                  class="literal">w</code> で表記されます)。
				</div></li><li
              class="listitem"><div
                class="para">
					実行 (「eXecute」の <code
                  class="literal">x</code> で表記されます)。
				</div></li></ul></div><a
          id="id-1.12.6.13"
          class="indexterm"></a><a
          id="id-1.12.6.14"
          class="indexterm"></a><a
          id="id-1.12.6.15"
          class="indexterm"></a><a
          id="id-1.12.6.16"
          class="indexterm"></a><div
          class="para">
			ファイルの場合、これらの権限は簡単に理解できます。すなわち、読み込み権限があれば、内容を読むことが可能です (コピーも可能です)。書き込み権限があれば、内容を変更することが可能です。実行権限があれば、内容を実行することが可能です (実行権限に意味があるのは対象がプログラムの場合に限ります)。
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>SECURITY</em></span> <code
                      class="literal">setuid</code> と <code
                      class="literal">setgid</code> 実行ファイル</strong></p></div></div></div><div
            class="para">
			<code
              class="literal">setuid</code> と <code
              class="literal">setgid</code> (「s」で表記されます) は実行ファイルに関係する 2 種類の特別な権限です。<code
              class="literal">setuid</code> と <code
              class="literal">setgid</code> は 0 か 1 で表されるブール値のため、「ビット」と呼ばれることが多い点に注意してください。<code
              class="literal">setuid</code> および <code
              class="literal">setgid</code> 権限を使うと、実行されたプログラムは所有者および所有グループの権限で動くことになります。このメカニズムを使うと、プログラムはプログラムを実行したユーザが通常持っているよりも高位のパーミッションを要求する機能にアクセスできるようになります。
		</div><a
            id="id-1.12.6.18.3"
            class="indexterm"></a><a
            id="id-1.12.6.18.4"
            class="indexterm"></a><div
            class="para">
			root が所有者の <code
              class="literal">setuid</code> されたプログラムは一貫してスーパーユーザとして実行されるため、この種のプログラムが安全で信頼できるプログラムか否かという点はとても重要です。実際、好きなコマンドを呼び出すために root が所有者の <code
              class="literal">setuid</code> されたプログラムを破壊することで、ユーザは root ユーザになりすまし、システムのすべての権限を掌握することが可能です。
		</div></div><div
          class="para">
			ディレクトリは別のやり方で取り扱われます。読み込み権限があれば、そのエントリ (ファイルとディレクトリ) のリストを閲覧することが可能です。書き込み権限があれば、ファイルを作成および削除することが可能です。実行権限があれば、そのディレクトリを横断することが可能です (<code
            class="command">cd</code> コマンドでそのディレクトリに移動できます)。ディレクトリの読み込み権限がなくてもディレクトリを横断できるならば、ディレクトリ内の名前を知っているエントリにアクセスすることが可能です。ただし、エントリの存在を知らないかエントリの完全な名前を知らない場合、そのエントリを見つけることはできません。
		</div><div
          class="sidebar"><a
            xmlns=""
            id="sidebar.setgid-dir"></a><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>SECURITY</em></span> <code
                      class="literal">setgid</code> ディレクトリと<span
                      class="emphasis"><em>スティッキービット</em></span></strong></p></div></div></div><a
            id="id-1.12.6.20.2"
            class="indexterm"></a><div
            class="para">
			<code
              class="literal">setgid</code> ビットはディレクトリにも適用されます。<code
              class="literal">setgid</code> ビットが適用されたディレクトリの中に新しく作成されたアイテムは、作成者のメイングループを継承するのではなく、自動的に親ディレクトリの所有グループを割り当てられます。こうすることで、ユーザが同じ専用グループに所属する複数のユーザの間で共有されているファイルツリーの中で作業をしている場合、(<code
              class="command">newgrp</code> コマンドを使って) 自分のメイングループを変更する必要がなくなります。
		</div><a
            id="id-1.12.6.20.4"
            class="indexterm"></a><div
            class="para">
			「スティッキー」ビット (「t」で表記されます) とはディレクトリだけに有効なパーミッションです。これは特に誰もが書き込み権限を持つ一時ディレクトリ (<code
              class="filename">/tmp/</code> など) に使われます。すなわち、スティッキービットを付けられたディレクトリ以下に含まれるファイルの削除を制限できます。ファイルは所有者 (または親ディレクトリの所有者) だけが削除できるようになります。<code
              class="filename">/tmp/</code> にスティッキービットがなければ、<code
              class="filename">/tmp/</code> ディレクトリ以下にある他のユーザのファイルを誰でも削除できることになります。
		</div></div><div
          class="para">
			以下はファイルのパーミッションを制御する 3 種類のコマンドです。
		</div><div
          xmlns:d="http://docbook.org/ns/docbook"
          class="itemizedlist"><ul><li
              class="listitem"><div
                class="para">
					<code
                  class="command">chown <em
                    class="replaceable">user</em> <em
                    class="replaceable">file</em></code>。これはファイルの所有者を変更します。
				</div></li><li
              class="listitem"><div
                class="para">
					<code
                  class="command">chgrp <em
                    class="replaceable">group</em> <em
                    class="replaceable">file</em></code>。これはファイルの所有グループを変更します。
				</div></li><li
              class="listitem"><div
                class="para">
					<code
                  class="command">chmod <em
                    class="replaceable">rights</em> <em
                    class="replaceable">file</em></code>。これはファイルのパーミッションを変更します。
				</div></li></ul></div><div
          class="para">
			権限の指定方法には 2 種類あります。それらの中でも、記号指定が最もわかりやすく覚えやすいでしょう。これは上で述べた文字記号を使います。ユーザのカテゴリ (<code
            class="literal">u</code>/<code
            class="literal">g</code>/<code
            class="literal">o</code>) に対する権限を (<code
            class="literal">=</code> で) 明示したり、(<code
            class="literal">+</code> で) 追加したり、(<code
            class="literal">-</code> で) 取り除いたりできます。そんなわけで、<code
            class="literal">u=rwx,g+rw,o-r</code> 式は、所有者に読み込み、書き込み、実行権限を与え、所有グループに読み込み、書き込み権限を追加し、その他のユーザから読み込み権限を奪います。追加と削除によって変更されない権限はそのままです。「all」を意味する文字 <code
            class="literal">a</code> は 3 つのユーザカテゴリすべてを表現します。このため、<code
            class="literal">a=rx</code> はすべてのカテゴリのユーザに対して同じ権限を与えます (読み込みと実行権限を与え、書き込み権限を与えません)。
		</div><a
          id="id-1.12.6.24"
          class="indexterm"></a><a
          id="id-1.12.6.25"
          class="indexterm"></a><a
          id="id-1.12.6.26"
          class="indexterm"></a><a
          id="id-1.12.6.27"
          class="indexterm"></a><a
          id="id-1.12.6.28"
          class="indexterm"></a><div
          class="para">
			数値表記は各権限を値 (8 進数) で表現します。具体的に言えば、読み込みは 4、書き込みは 2、実行権限は 1 で表現します。権限を組み合わせるには組み合わせたい権限に対応する数字を合計します。ユーザの各カテゴリ (所有者、グループ、その他) に対して与える権限を同じ順番で連結して、それぞれの権限を表現します。
		</div><div
          class="para">
			たとえば、<code
            class="command">chmod 754 <em
              class="replaceable">file</em></code> コマンドは以下の権限を設定します。すなわち、所有者に書き込み、読み込み、実行権限を設定し (7 = 4 + 2 + 1 なので)、さらに所有グループに読み込み、実行権限を設定し (5 = 4 + 1 なので)、さらにその他のユーザに読み込み権限を設定します。<code
            class="literal">0</code> はいかなる権限も与えないことを意味します。このため <code
            class="command">chmod 600 <em
              class="replaceable">file</em></code> は所有者に読み込み、書き込み権限を設定し、所有者以外のユーザにはいかなる権限も与えません。最もよく使われる権限の組み合わせは、実行ファイルやディレクトリの場合 <code
            class="literal">755</code> で、データファイルの場合 <code
            class="literal">644</code> です。
		</div><div
          class="para">
			同じ原則に従って特別な権限を表す 4 番目の桁は先に説明した 3 桁の権限表記の前に付けます。<code
            class="literal">setuid</code>、<code
            class="literal">setgid</code>、<code
            class="literal">sticky</code> ビットがそれぞれ 4、2、1 に対応します。<code
            class="command">chmod 4754</code> は前に説明した権限に加えて、<code
            class="literal">setuid</code> ビットを設定します。
		</div><div
          class="para">
			8 進数表記で権限を指定すると、対象のファイルに対するすべての権限が同じものに設定されます。すなわち、たとえば所有グループに読み込み権限を与えるなどの新しい権限を追加したい場合、8 進数表記は使えません。なぜなら、既に設定されている権限を考慮した新しい権限の数値表記が対象のファイルすべてで同じ数値表記になるとは限らないからです。
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>TIP</em></span> 再帰的操作</strong></p></div></div></div><div
            class="para">
			しばしばファイルツリー全体の権限を変更しなければいけない場合があります。<code
              class="command">chown</code>、<code
              class="command">chgrp</code>、<code
              class="command">chmod</code> には、サブディレクトリ内で再帰的に操作を行うための <code
              class="literal">-R</code> オプションが用意されています。
		</div><div
            class="para">
			再帰的な操作を行う場合、ディレクトリとファイルの違いが原因で時々問題が起こることがあります。このため、「X」文字が権限の記号表記に導入されました。「X」文字はディレクトリ (と誰かが実行権限を持つファイル) だけに適用される実行権限を表します。このため、<code
              class="command">chmod -R a+X <em
                class="replaceable">directory</em></code> は、すべてのサブディレクトリと少なくとも 1 つのカテゴリのユーザ (所有者、所有グループ、その他のユーザのうちの誰か一人) が既に実行権限を持っているすべてのファイルに対して、すべてのカテゴリのユーザ (<code
              class="literal">a</code>) の実行権限を追加します。
		</div></div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>TIP</em></span> ユーザとグループの変更</strong></p></div></div></div><div
            class="para">
			しばしば、ファイルのグループと所有者を同時に変更したい場合があります。この用途向けに <code
              class="command">chown</code> コマンドには特別な構文があります。具体的に言えば、<code
              class="command">chown <em
                class="replaceable">user</em>:<em
                class="replaceable">group</em> <em
                class="replaceable">file</em></code> です。
		</div></div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>GOING FURTHER</em></span> <code
                      class="command">umask</code></strong></p></div></div></div><div
            class="para">
			アプリケーションがファイルを作成する際、ファイルには目安となるパーミッションが割り当てられます。このパーミッションは <code
              class="command">umask</code> コマンドで表示される特定の権限を削除したパーミッションです。シェルで <code
              class="command">umask</code> を実行すると、<code
              class="computeroutput">0022</code> などのマスクが表示されます。これは権限の単純な 8 進数表記で、これで表される権限が体系的に削除されます (<code
              class="computeroutput">0022</code> の場合、所有グループとその他のユーザに対する書き込み権限が削除されます)。
		</div><a
            id="id-1.12.6.35.3"
            class="indexterm"></a><a
            id="id-1.12.6.35.4"
            class="indexterm"></a><a
            id="id-1.12.6.35.5"
            class="indexterm"></a><div
            class="para">
			新しい 8 進数値でマスクを再設定したければ、<code
              class="command">umask</code> コマンドでマスクを変更できます。シェル初期化ファイル (たとえば、<code
              class="filename">~/.bash_profile</code>) の中で <code
              class="command">umask</code> コマンドを使った場合、作業セッション内で有効なデフォルトのマスクを変更します。
		</div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.remote-login.html"><strong>戻る</strong>9.2. リモートログイン</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>上に戻る</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>ホーム</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.administration-interfaces.html"><strong>次へ</strong>9.4. 管理インターフェース</a></li></ul></body></html>
