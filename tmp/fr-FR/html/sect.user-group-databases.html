<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">8.4. Base de données des utilisateurs et des groupes</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-fr-FR-1.0-1" /><meta
        name="keywords"
        content="Configuration, Francisation, Locales, Réseau, Résolution de noms, Utilisateurs, Groupes, Création de compte, Interpréteur de commandes, Shell, Impression, Chargeur de démarrage, Compilation de noyau" /><link
        rel="home"
        href="index.html"
        title="Le cahier de l'administrateur Debian" /><link
        rel="up"
        href="basic-configuration.html"
        title="Chapitre 8. Configuration de base : réseau, comptes, impression..." /><link
        rel="prev"
        href="sect.hostname-name-service.html"
        title="8.3. Attribution et résolution de noms" /><link
        rel="next"
        href="sect.creating-accounts.html"
        title="8.5. Création de compte" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/fr-FR/stable/sect.user-group-databases.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.hostname-name-service.html"><strong>Précédent</strong></a></li><li
          class="home">Le cahier de l'administrateur Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.creating-accounts.html"><strong>Suivant</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.user-group-databases"></a>8.4. Base de données des utilisateurs et des groupes</h2></div></div></div><a
          id="id-1.11.8.2"
          class="indexterm"></a><a
          id="id-1.11.8.3"
          class="indexterm"></a><a
          id="id-1.11.8.4"
          class="indexterm"></a><a
          id="id-1.11.8.5"
          class="indexterm"></a><div
          class="para">
			La liste des utilisateurs est habituellement stockée dans le fichier <code
            class="filename">/etc/passwd</code>, alors que le fichier <code
            class="filename">/etc/shadow</code> stocke les mots de passe chiffrés. Tous deux sont de simples fichiers texte, au format relativement simple, consultables et modifiables avec un éditeur de texte. Chaque utilisateur y est décrit sur une ligne par plusieurs champs séparés par deux-points (« <code
            class="literal">:</code> »).
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>ATTENTION</em></span> Édition des fichiers système</strong></p></div></div></div><div
            class="para">
			Les fichiers système mentionnés dans ce chapitre sont au format texte simple et sont donc éditables avec un éditeur de texte. Étant donnée leur importance, il est toutefois recommandé de prendre des précautions supplémentaires garantissant qu'un fichier ne soit pas modifié par plusieurs personnes à la fois (ce qui pourrait causer une corruption).
		</div><div
            class="para">
			Pour cela, il suffit d'employer la commande <code
              class="command">vipw</code> pour éditer <code
              class="filename">/etc/passwd</code>, ou <code
              class="command">vigr</code> pour <code
              class="filename">/etc/group</code>. Ces dernières posent un verrou sur le fichier concerné avant d'exécuter un éditeur de texte (<code
              class="command">vi</code> par défaut, sauf si la variable d'environnement <code
              class="varname">EDITOR</code> est définie). L'option <code
              class="literal">-s</code> de ces commandes permet d'éditer le fichier <span
              class="foreignphrase"><em
                class="foreignphrase">shadow</em></span> correspondant.
		</div></div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>B.A.-BA</em></span> <span
                      class="foreignphrase"><em
                        class="foreignphrase">Crypt</em></span>, une fonction à sens unique</strong></p></div></div></div><a
            id="id-1.11.8.8.2"
            class="indexterm"></a><div
            class="para">
			<code
              class="command">crypt</code> est une fonction à sens unique qui transforme une chaîne (<code
              class="varname">A</code>) en une autre chaîne (<code
              class="varname">B</code>) de telle sorte qu'à partir de <code
              class="varname">B</code>, il ne soit pas possible dans le cas général de retrouver <code
              class="varname">A</code>. La seule manière d'identifier <code
              class="varname">A</code> est de tester toutes les valeurs possibles, en vérifiant pour chacune si sa transformation par la fonction produit <code
              class="varname">B</code> ou non. Elle utilise jusqu'à 8 caractères en entrée (chaîne <code
              class="varname">A</code>) et génère une chaîne de 13 caractères ASCII imprimables (chaîne <code
              class="varname">B</code>).
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-passwd"></a>8.4.1. Liste des utilisateurs : <code
                    class="filename">/etc/passwd</code></h3></div></div></div><div
            class="para">
				Voici la liste des champs du fichier <code
              class="filename">/etc/passwd</code> :
			</div><a
            id="id-1.11.8.9.3"
            class="indexterm"></a><a
            id="id-1.11.8.9.4"
            class="indexterm"></a><a
            id="id-1.11.8.9.5"
            class="indexterm"></a><a
            id="id-1.11.8.9.6"
            class="indexterm"></a><a
            id="id-1.11.8.9.7"
            class="indexterm"></a><a
            id="id-1.11.8.9.8"
            class="indexterm"></a><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						identifiant (ou <span
                    class="foreignphrase"><em
                      class="foreignphrase">login</em></span>), par exemple <code
                    class="literal">rhertzog</code> ;
					</div></li><li
                class="listitem"><div
                  class="para">
						mot de passe : il s'agit d'un mot de passe chiffré par la fonction à sens unique (<code
                    class="command">crypt</code>), qui utilise <code
                    class="literal">DES</code>, <code
                    class="literal">MD5</code>, <code
                    class="literal">SHA-256</code> ou <code
                    class="literal">SHA-512</code>. La valeur spéciale « <code
                    class="literal">x</code> » indique que le mot de passe chiffré est stocké dans <code
                    class="filename">/etc/shadow</code> ;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">uid</code> : numéro unique identifiant l'utilisateur ;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">gid</code> : numéro unique du groupe principal de l'utilisateur (Debian crée par défaut un groupe spécifique à chacun) ;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">GECOS</code> : champ de renseignements qui contient habituellement le nom complet de l'utilisateur ;
					</div></li><li
                class="listitem"><div
                  class="para">
						répertoire de connexion, attribué à l'utilisateur pour qu'il y stocke ses fichiers personnels (la variable d'environnement <code
                    class="varname">$HOME</code> y pointe habituellement) ;
					</div></li><li
                class="listitem"><div
                  class="para">
						programme à exécuter après la connexion. Il s'agit généralement d'un interpréteur de commandes (shell), donnant libre cours à l'utilisateur. Si l'on précise <code
                    class="command">/bin/false</code> (programme qui ne fait rien et rend la main immédiatement), l'utilisateur ne pourra pas se connecter.
					</div></li></ul></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>B.A.-BA</em></span> Groupe Unix</strong></p></div></div></div><a
              id="id-1.11.8.9.10.2"
              class="indexterm"></a><div
              class="para">
				Un groupe Unix est une entité regroupant plusieurs utilisateurs afin qu'ils puissent facilement se partager des fichiers à l'aide du système de droits intégré (en jouissant justement des mêmes droits). On peut également restreindre l'utilisation de certains programmes à un groupe donné.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-shadow"></a>8.4.2. Le fichier des mots de passe chiffrés et cachés : <code
                    class="filename">/etc/shadow</code></h3></div></div></div><a
            id="id-1.11.8.10.2"
            class="indexterm"></a><a
            id="id-1.11.8.10.3"
            class="indexterm"></a><div
            class="para">
				Le fichier <code
              class="filename">/etc/shadow</code> contient les champs suivants :
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						identifiant (ou <span
                    class="foreignphrase"><em
                      class="foreignphrase">login</em></span>) ;
					</div></li><li
                class="listitem"><div
                  class="para">
						mot de passe chiffré ;
					</div></li><li
                class="listitem"><div
                  class="para">
						plusieurs champs de gestion de l'expiration du mot de passe.
					</div></li></ul></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DOCUMENTATION</em></span> Formats de <code
                        class="filename">/etc/passwd</code>, <code
                        class="filename">/etc/shadow</code> et <code
                        class="filename">/etc/group</code></strong></p></div></div></div><div
              class="para">
				Ces formats sont documentés dans les pages de manuel suivantes : <span
                class="citerefentry"><span
                  class="refentrytitle">passwd</span>(5)</span>, <span
                class="citerefentry"><span
                  class="refentrytitle">shadow</span>(5)</span> et <span
                class="citerefentry"><span
                  class="refentrytitle">group</span>(5)</span>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SÉCURITÉ</em></span> Sûreté du fichier <code
                        class="filename">/etc/shadow</code></strong></p></div></div></div><div
              class="para">
				<code
                class="filename">/etc/shadow</code>, contrairement à son alter ego <code
                class="filename">/etc/passwd</code>, est inaccessible en lecture aux utilisateurs. Tout mot de passe chiffré stocké dans <code
                class="filename">/etc/passwd</code> est lisible par tous ; un indélicat peut alors entreprendre de le « casser » par une méthode de force brute, consistant simplement à chiffrer successivement tous les mots de passe simples pour tenter de le découvrir. Cette attaque, dite « du dictionnaire », qui dévoile les mots de passe mal choisis, n'est plus possible avec le fichier <code
                class="filename">/etc/shadow</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.account-modification"></a>8.4.3. Modifier un compte ou mot de passe existant</h3></div></div></div><a
            id="id-1.11.8.11.2"
            class="indexterm"></a><a
            id="id-1.11.8.11.3"
            class="indexterm"></a><a
            id="id-1.11.8.11.4"
            class="indexterm"></a><a
            id="id-1.11.8.11.5"
            class="indexterm"></a><a
            id="id-1.11.8.11.6"
            class="indexterm"></a><div
            class="para">
				Quelques commandes permettent de modifier la plupart des informations stockées dans ces bases de données. Chaque utilisateur peut ainsi changer de mot de passe, sans doute le champ le plus variable, grâce à la commande <code
              class="command">passwd</code>. <code
              class="command">chfn</code> <span
              class="foreignphrase"><em
                class="foreignphrase">(CHange Full Name)</em></span>, réservée au super-utilisateur root, intervient sur le champ <code
              class="literal">GECOS</code>. <code
              class="command">chsh</code> <span
              class="foreignphrase"><em
                class="foreignphrase">(CHange SHell)</em></span> permet de changer de « shell de login », ou interpréteur de commandes de connexion, mais le choix des utilisateurs sera limité à la liste donnée dans <code
              class="filename">/etc/shells</code> — alors que l'administrateur pourra saisir le nom de programme de son choix.
			</div><div
            class="para">
				Enfin, la commande <code
              class="command">chage</code> <span
              class="foreignphrase"><em
                class="foreignphrase">(CHange AGE)</em></span> donnera à l'administrateur la possibilité de modifier les conditions d'expiration du mot de passe (l'option <code
              class="literal">-l <em
                class="replaceable">utilisateur</em></code> listant la configuration actuelle). On pourra d'ailleurs forcer l'expiration d'un mot de passe grâce à la commande <code
              class="command">passwd -e <em
                class="replaceable">utilisateur</em></code>, qui obligera l'utilisateur à changer son mot de passe à la prochaine connexion.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.disabling-account"></a>8.4.4. Bloquer un compte</h3></div></div></div><a
            id="id-1.11.8.12.2"
            class="indexterm"></a><a
            id="id-1.11.8.12.3"
            class="indexterm"></a><div
            class="para">
				On peut se trouver dans l'obligation de « bloquer le compte » d'un utilisateur, par mesure disciplinaire, dans le cadre d'une enquête, ou tout simplement en cas de départ prolongé ou définitif de l'utilisateur. Il s'agit en fait de l'empêcher de se connecter à nouveau, sans pour autant détruire son compte et ses fichiers. Cela s'effectue simplement par la commande <code
              class="command">passwd -l <em
                class="replaceable">utilisateur</em></code> (<span
              class="foreignphrase"><em
                class="foreignphrase">lock</em></span>, ou bloquer). La remise en service s'effectue de même, avec l'option <code
              class="literal">-u</code> (<span
              class="foreignphrase"><em
                class="foreignphrase">unlock</em></span>, ou débloquer).
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.intro-nss"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>POUR ALLER PLUS LOIN</em></span> Base de données système et NSS</strong></p></div></div></div><a
              id="id-1.11.8.12.5.2"
              class="indexterm"></a><a
              id="id-1.11.8.12.5.3"
              class="indexterm"></a><div
              class="para">
				Au lieu d'employer les fichiers habituels pour gérer les listes des utilisateurs et des groupes, on peut recourir à d'autres types de bases de données — comme LDAP ou <code
                class="command">db</code> — en employant un module NSS (<span
                class="foreignphrase"><em
                  class="foreignphrase">Name Service Switch</em></span>, ou multiplexeur de service de noms) adéquat. Les listes des modules employés se trouvent dans le fichier <code
                class="filename">/etc/nsswitch.conf</code> sous les entrées <code
                class="literal">passwd</code>, <code
                class="literal">shadow</code> et <code
                class="literal">group</code>. Voir la <a
                class="xref"
                href="sect.ldap-directory.html#sect.config-nss">Section 11.7.3.1, « Configuration de NSS »</a> pour un exemple concret d'emploi du module NSS pour LDAP.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-group"></a>8.4.5. Liste des groupes : <code
                    class="filename">/etc/group</code></h3></div></div></div><div
            class="para">
				La liste des groupes est stockée dans le fichier <code
              class="filename">/etc/group</code>, simple base de données textuelle au format comparable à celui de <code
              class="filename">/etc/passwd</code>, qui utilise les champs suivants :
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						identifiant (le nom du groupe) ;
					</div></li><li
                class="listitem"><div
                  class="para">
						mot de passe (facultatif) : il ne sert qu'à intégrer un groupe dont on n'est pas habituellement membre (avec la commande <code
                    class="command">newgrp</code> ou <code
                    class="command">sg</code> — voir encadré <a
                    class="xref"
                    href="sect.user-group-databases.html#sidebar.working-with-several-groups"><span
                      class="emphasis"><em>B.A.-BA</em></span> Travailler avec plusieurs groupes</a>) ;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">gid</code> : numéro unique identifiant le groupe ;
					</div></li><li
                class="listitem"><div
                  class="para">
						liste des membres : liste des identifiants d'utilisateurs membres du groupe, séparés par des virgules.
					</div></li></ul></div><div
            class="para">
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.working-with-several-groups"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>B.A.-BA</em></span> Travailler avec plusieurs groupes</strong></p></div></div></div><a
              id="id-1.11.8.13.5.2"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.3"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.4"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.5"
              class="indexterm"></a><div
              class="para">
				Chaque utilisateur peut donc faire partie de plusieurs groupes ; l'un d'entre eux est son « groupe principal » ; le groupe principal par défaut est mis en place lors de la connexion. Par défaut, chaque fichier qu'il crée lui appartient, ainsi qu'au groupe principal. Cela n'est pas toujours souhaitable : c'est par exemple le cas lors d'un travail dans un répertoire partagé grâce à un groupe différent de son groupe principal. Dans ce cas, l'utilisateur a intérêt à changer temporairement de groupe principal grâce aux commandes <code
                class="command">newgrp</code> — qui démarre un nouveau shell — ou <code
                class="command">sg</code> — qui se contente d'exécuter une commande. Ces commandes permettent aussi de rejoindre un groupe dont on ne fait pas partie si le groupe est protégé par un mot de passe connu.
			</div><div
              class="para">
				Une alternative consiste à positionner le bit <code
                class="literal">setgid</code> sur le répertoire, ce qui permet aux fichiers créés dans ce répertoire d'appartenir automatiquement au bon groupe. On se référera pour les détails à l'encadré <a
                class="xref"
                href="sect.rights-management.html#sidebar.setgid-dir"><span
                  class="emphasis"><em>SÉCURITÉ</em></span> Répertoire <code
                  class="literal">setgid</code> et sticky bit</a>.
			</div><div
              class="para">
				La commande <code
                class="command">id</code> permet de vérifier à tout instant son identifiant personnel (variable <code
                class="varname">uid</code>), le groupe principal actuel (variable <code
                class="varname">gid</code>) et la liste des groupes dont on fait partie (variable <code
                class="varname">groupes</code>).
			</div></div><a
            id="id-1.11.8.13.6"
            class="indexterm"></a><a
            id="id-1.11.8.13.7"
            class="indexterm"></a><div
            class="para">
				Les commandes <code
              class="command">groupadd</code> et <code
              class="command">groupdel</code> permettent respectivement de créer et de supprimer un groupe. La commande <code
              class="command">groupmod</code> modifie les informations d'un groupe (son <code
              class="literal">gid</code> ou son identifiant). La commande <code
              class="command">passwd -g <em
                class="replaceable">groupe</em></code> modifiera le mot de passe d'un groupe, tandis que la commande <code
              class="command">passwd -r -g <em
                class="replaceable">groupe</em></code> le supprimera.
			</div><a
            id="id-1.11.8.13.9"
            class="indexterm"></a><a
            id="id-1.11.8.13.10"
            class="indexterm"></a><a
            id="id-1.11.8.13.11"
            class="indexterm"></a><a
            id="id-1.11.8.13.12"
            class="indexterm"></a><a
            id="id-1.11.8.13.13"
            class="indexterm"></a><a
            id="id-1.11.8.13.14"
            class="indexterm"></a><a
            id="id-1.11.8.13.15"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ASTUCE</em></span> <code
                        class="command">getent</code></strong></p></div></div></div><a
              id="id-1.11.8.13.16.2"
              class="indexterm"></a><div
              class="para">
				La commande <code
                class="command">getent</code> (<span
                class="foreignphrase"><em
                  class="foreignphrase">get entries</em></span>) consulte les bases de données du système de manière classique, en employant les appels système adéquats, donc les modules NSS configurés dans le fichier <code
                class="filename">/etc/nsswitch.conf</code>. Elle prend un ou deux arguments : le nom de la base de données à consulter et une éventuelle clé de recherche. Ainsi, la commande <code
                class="command">getent passwd rhertzog</code> renvoie les informations de la base de données des utilisateurs concernant l'utilisateur <code
                class="literal">rhertzog</code>.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.hostname-name-service.html"><strong>Précédent</strong>8.3. Attribution et résolution de noms</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Niveau supérieur</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Sommaire</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.creating-accounts.html"><strong>Suivant</strong>8.5. Création de compte</a></li></ul></body></html>
