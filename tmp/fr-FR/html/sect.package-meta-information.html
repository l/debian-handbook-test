<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">5.2. Méta-informations d'un paquet</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-fr-FR-1.0-1" /><meta
        name="keywords"
        content="Paquet binaire, Paquet source, dpkg, Dépendances, Conflit" /><link
        rel="home"
        href="index.html"
        title="Le cahier de l'administrateur Debian" /><link
        rel="up"
        href="packaging-system.html"
        title="Chapitre 5. Système de paquetage, outils et principes fondamentaux" /><link
        rel="prev"
        href="packaging-system.html"
        title="Chapitre 5. Système de paquetage, outils et principes fondamentaux" /><link
        rel="next"
        href="sect.source-package-structure.html"
        title="5.3. Structure d'un paquet source" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/fr-FR/stable/sect.package-meta-information.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="packaging-system.html"><strong>Précédent</strong></a></li><li
          class="home">Le cahier de l'administrateur Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.source-package-structure.html"><strong>Suivant</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.package-meta-information"></a>5.2. Méta-informations d'un paquet</h2></div></div></div><a
          id="id-1.8.6.2"
          class="indexterm"></a><a
          id="id-1.8.6.3"
          class="indexterm"></a><div
          class="para">
			Le paquet Debian n'est pas qu'une archive de fichiers destinés à l'installation. Il s'inscrit dans un ensemble plus vaste en décrivant des relations avec les autres paquets Debian (dépendances, conflits, suggestions). Il fournit également des scripts permettant d'exécuter des commandes lors des différentes étapes du parcours du paquet (installation, suppression, mise à jour). Ces données sont utilisées par les outils de gestion des paquets mais ne font pas partie du logiciel empaqueté ; elles constituent, au sein du paquet, ce que l'on appelle ses « méta-informations » (informations portant sur les informations).
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.control"></a>5.2.1. Description : fichier <code
                    class="filename">control</code></h3></div></div></div><a
            id="id-1.8.6.5.2"
            class="indexterm"></a><a
            id="id-1.8.6.5.3"
            class="indexterm"></a><a
            id="id-1.8.6.5.4"
            class="indexterm"></a><div
            class="para">
				Ce fichier utilise une structure similaire à un en-tête de courriel (défini par la RFC 2822). Par exemple pour <span
              class="pkg pkg">apt</span>, le fichier <code
              class="filename">control</code> ressemble à ce qui suit :
			</div><pre
            class="screen">
<code
              class="computeroutput">$ </code><strong
              class="userinput"><code>apt-cache show apt</code></strong>
<code
              class="computeroutput">Package: apt
Version: 1.0.9.8.1
Installed-Size: 3789
Maintainer: APT Development Team &lt;deity@lists.debian.org&gt;
Architecture: amd64
Replaces: manpages-it (&lt;&lt; 2.80-4~), manpages-pl (&lt;&lt; 20060617-3~), openjdk-6-jdk (&lt;&lt; 6b24-1.11-0ubuntu1~), sun-java5-jdk (&gt;&gt; 0), sun-java6-jdk (&gt;&gt; 0)
Depends: libapt-pkg4.12 (&gt;= 1.0.9.8.1), libc6 (&gt;= 2.15), libgcc1 (&gt;= 1:4.1.1), libstdc++6 (&gt;= 4.9), debian-archive-keyring, gnupg
Suggests: aptitude | synaptic | wajig, dpkg-dev (&gt;= 1.17.2), apt-doc, python-apt
Conflicts: python-apt (&lt;&lt; 0.7.93.2~)
Breaks: manpages-it (&lt;&lt; 2.80-4~), manpages-pl (&lt;&lt; 20060617-3~), openjdk-6-jdk (&lt;&lt; 6b24-1.11-0ubuntu1~), sun-java5-jdk (&gt;&gt; 0), sun-java6-jdk (&gt;&gt; 0)
Description-fr: gestionnaire de paquets en ligne de commande
 Ce paquet fournit des outils en ligne de commande pour la recherche, la
 gestion ainsi que la demande d'informations à propos de paquets, le tout
 grâce à un accès bas niveau aux fonctionnalités de la bibliothèque libapt-pkg.
 .
 Ces outils sont :
  * apt-get pour la récupération de paquets et d'informations à leur sujet
     depuis des sources authentifiées et pour l'installation, la mise à
     niveau et la suppression de paquets ainsi que leurs dépendances ;
  * apt-cache pour consulter les informations disponibles sur les paquets
     installés et installables ;
  * apt-cdrom pour utiliser des médias amovibles en tant que source de
     paquets ;
  * apt-config qui sert d'interface pour les réglages de configuration ;
  * apt-key qui sert d'interface pour gérer les clés d'authentification.
Description-md5: 9fb97a88cb7383934ef963352b53b4a7
Tag: admin::package-management, devel::lang:ruby, hardware::storage,
 hardware::storage:cd, implemented-in::c++, implemented-in::perl,
 implemented-in::ruby, interface::commandline, network::client,
 protocol::ftp, protocol::http, protocol::ipv6, role::program,
 role::shared-lib, scope::application, scope::utility, sound::player,
 suite::debian, use::downloading, use::organizing, use::searching,
 works-with::audio, works-with::software:package, works-with::text
Section: admin
Priority: important
Filename: pool/main/a/apt/apt_1.0.9.8.1_amd64.deb
Size: 1109900
MD5sum: 52acb9bf9006c1b7fb8679f859c93fb1
SHA1: f55b5aed9385945e9097de625d200c1c7b98f4ca
SHA256: 16b5132418cfa8ed638bda0366dfb6f82007a9964002e979c73ddbd48b755cb8</code></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>B.A.-BA</em></span> RFC — les normes d'Internet</strong></p></div></div></div><a
              id="id-1.8.6.5.7.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.7.3"
              class="indexterm"></a><div
              class="para">
				RFC est l'abréviation de <span
                class="foreignphrase"><em
                  class="foreignphrase">Request For Comments</em></span>, appel à commentaires (en anglais). Une RFC est un document généralement technique, exposant ce qui deviendra une norme d'Internet. Avant d'être standardisées et figées, ces normes sont soumises à une revue publique (d'où leur nom). C'est l'IETF <span
                class="foreignphrase"><em
                  class="foreignphrase">(Internet Engineering Task Force)</em></span> qui fait évoluer le statut de ces documents (<span
                class="foreignphrase"><em
                  class="foreignphrase">proposed standard</em></span>, <span
                class="foreignphrase"><em
                  class="foreignphrase">draft standard</em></span> ou <span
                class="foreignphrase"><em
                  class="foreignphrase">standard</em></span>, respectivement proposition de standard, brouillon de standard et standard).
			</div><div
              class="para">
				La RFC 2026 définit le processus de standardisation de protocoles d'Internet. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.faqs.org/rfcs/rfc2026.html">http://www.faqs.org/rfcs/rfc2026.html</a></div>
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.8"></a>5.2.1.1. Dépendances : champ <code
                      class="literal">Depends</code></h4></div></div></div><a
              id="id-1.8.6.5.8.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.8.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.8.4"
              class="indexterm"></a><div
              class="para">
					Les dépendances sont définies dans le champ <code
                class="literal">Depends</code> des en-têtes du paquet. Il s'agit d'une liste de conditions à remplir pour que le paquet fonctionne correctement, informations utilisées par des outils comme <code
                class="command">apt</code> pour installer les versions des bibliothèques dont dépend le programme à installer. Pour chaque dépendance, il est possible de restreindre l'espace des versions qui satisfont la condition. Autrement dit, il est possible d'exprimer le fait que l'on a besoin du paquet <span
                class="pkg pkg">libc6</span> dans une version supérieure ou égale à « 2.15 » (cela s'écrit « <code
                class="command">libc6 (&gt;= 2.15)</code> »). Les opérateurs de comparaison de versions sont les suivants :
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="itemizedlist"><ul><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&lt;&lt;</code> : strictement inférieur à ;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&lt;=</code> : inférieur ou égal à ;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">=</code> : égal à (attention, « <code
                      class="literal">2.6.1</code> » n'est pas égal à « <code
                      class="literal">2.6.1-1</code> ») ;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&gt;=</code> : supérieur ou égal à ;
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">&gt;&gt;</code> : strictement supérieur à.
						</div></li></ul></div><div
              class="para">
					Dans une liste de conditions à remplir, la virgule sert de séparateur. Sur le plan logique, son sens est celui d'un « et ». Au sein d'une condition, la barre verticale (« | ») exprime un « ou » logique (il s'agit d'un « ou » inclusif, non d'un « ou bien »). Prioritaire sur le « et », elle est utilisable autant de fois que nécessaire. Ainsi, la dépendance « (A ou B) et C » s'écrit <code
                class="command">A | B, C</code>. En revanche, l'expression « A ou (B et C) » doit être développée en « (A ou B) et (A ou C) » puisque le champ <code
                class="literal">Depends</code> ne tolère pas de parenthèses changeant les priorités entre les opérateurs logiques « ou » et « et ». Elle s'écrira donc <code
                class="command">A | B, A | C</code>. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://www.debian.org/doc/debian-policy/ch-relationships.html">http://www.debian.org/doc/debian-policy/ch-relationships.html</a></div>
				</div><a
              id="id-1.8.6.5.8.8"
              class="indexterm"></a><div
              class="para">
					Le système de dépendances est un bon mécanisme pour garantir le fonctionnement d'un logiciel, mais il trouve un autre usage avec les « métapaquets ». Il s'agit de paquets vides, décrivant uniquement des dépendances. Ils facilitent l'installation d'un ensemble cohérent de logiciels présélectionnés par le mainteneur du métapaquet ; en effet, <code
                class="command">apt install <em
                  class="replaceable">métapaquet</em></code> installera automatiquement l'ensemble de ces logiciels grâce aux dépendances du métapaquet. Les paquets <span
                class="pkg pkg">gnome</span>, <span
                class="pkg pkg">kde</span> et <span
                class="pkg pkg">linux-image-amd64</span> sont des exemples de métapaquets.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>CHARTE DEBIAN</em></span> <code
                          class="literal">Pre-Depends</code>, un <code
                          class="literal">Depends</code> plus exigeant</strong></p></div></div></div><a
                id="id-1.8.6.5.8.10.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.8.10.3"
                class="indexterm"></a><div
                class="para">
					Des « pré-dépendances », données dans le champ « <code
                  class="literal">Pre-Depends</code> » de l'en-tête du paquet, complètent les dépendances normales ; leur syntaxe est identique. Une dépendance normale indique que le paquet concerné doit être décompacté et configuré avant que le paquet la déclarant ne soit lui-même configuré. Une pré-dépendance stipule que le paquet concerné doit être décompacté et configuré avant même d'exécuter le script de pré-installation du paquet la déclarant, c'est-à-dire avant son installation proprement dite.
				</div><div
                class="para">
					Une pré-dépendance est très contraignante pour <code
                  class="command">apt</code>, qui doit ordonnancer la liste des paquets à installer. Elles sont donc déconseillées en l'absence de nécessité stricte. Il est même recommandé de consulter l'avis des (autres) développeurs sur <code
                  class="email"><a
                    class="email"
                    href="mailto:debian-devel@lists.debian.org">debian-devel@lists.debian.org</a></code> avant d'ajouter une pré-dépendance. En règle générale, il est possible de trouver une solution de substitution qui permet de l'éviter.
				</div></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>CHARTE DEBIAN</em></span> Champs <code
                          class="literal">Recommends</code>, <code
                          class="literal">Suggests</code> et <code
                          class="literal">Enhances</code></strong></p></div></div></div><a
                id="id-1.8.6.5.8.11.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.8.11.3"
                class="indexterm"></a><div
                class="para">
					Les champs <code
                  class="literal">Recommends</code> (recommande) et <code
                  class="literal">Suggests</code> (suggère) décrivent des dépendances facultatives. Les dépendances « recommandées », les plus importantes, améliorent considérablement les fonctionnalités offertes par le paquet sans pour autant être indispensables à son fonctionnement. Les dépendances « suggérées », secondaires, indiquent que certains paquets peuvent se compléter et augmenter leur utilité respective — mais il est parfaitement raisonnable d'installer l'un sans les autres.
				</div><div
                class="para">
					Il faut systématiquement installer les paquets « recommandés », sauf si vous savez précisément pourquoi vous n'en avez pas besoin. Inversement, il est inutile d'installer les paquets « suggérés », sauf si vous savez pourquoi vous en aurez besoin.
				</div><a
                id="id-1.8.6.5.8.11.6"
                class="indexterm"></a><div
                class="para">
					Le champ <code
                  class="literal">Enhances</code> (améliore) décrit lui aussi une suggestion, mais dans un contexte différent. Il se situe en effet dans le paquet suggéré, et non pas dans celui qui profite de la suggestion. Son intérêt est de pouvoir ajouter une suggestion sans devoir modifier le paquet concerné par celle-ci. Ainsi, tous les <span
                  class="foreignphrase"><em
                    class="foreignphrase">add-ons</em></span> (ajouts), <span
                  class="foreignphrase"><em
                    class="foreignphrase">plug-ins</em></span> (greffons) et autres extensions d'un logiciel pourront ensuite prendre place dans la liste des suggestions liées au logiciel. Ce dernier champ, bien qu'existant depuis plusieurs années, est encore largement ignoré par des programmes comme <code
                  class="command">apt</code> ou <code
                  class="command">synaptic</code>. L'objectif est cependant qu'une suggestion faite par le biais d'un champ <code
                  class="literal">Enhances</code> apparaisse à l'utilisateur en complément des suggestions traditionnelles — réalisées avec le champ <code
                  class="literal">Suggests</code>.
				</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.9"></a>5.2.1.2. Conflits : champ <code
                      class="literal">Conflicts</code></h4></div></div></div><a
              id="id-1.8.6.5.9.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.9.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.9.4"
              class="indexterm"></a><div
              class="para">
					Le champ <code
                class="literal">Conflicts</code> permet d'indiquer qu'un paquet ne peut être installé en même temps qu'un autre. Les raisons les plus courantes sont les suivantes : les deux paquets incluent un fichier portant le même nom, fournissent le même service sur le même port TCP, ou gênent mutuellement leur bon fonctionnement.
				</div><div
              class="para">
					<code
                class="command">dpkg</code> refusera d'installer un paquet s'il déclenche un conflit avec un autre paquet déjà présent, sauf si le nouveau paquet précise qu'il « remplace » le paquet installé — auquel cas <code
                class="command">dpkg</code> choisira de remplacer l'ancien par le nouveau. <code
                class="command">apt</code> suit toujours vos instructions : si vous choisissez d'installer le nouveau paquet, il proposera automatiquement de désinstaller celui qui pose problème.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.10"></a>5.2.1.3. Incompatibilités : champ <code
                      class="literal">Breaks</code></h4></div></div></div><a
              id="id-1.8.6.5.10.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.10.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.10.4"
              class="indexterm"></a><div
              class="para">
					Le champ <code
                class="literal">Breaks</code> a un effet similaire à celui de <code
                class="literal">Conflicts</code>, mais une signification particulière. Il signale en effet que l'installation du paquet « casse » un autre paquet (ou certaines versions particulières de ce dernier). En général, cette incompatibilité entre les deux paquets est transitoire et la relation <code
                class="literal">Breaks</code> désigne spécifiquement les versions incompatibles entre elles.
				</div><div
              class="para">
					<code
                class="command">dpkg</code> refusera d'installer un paquet qui casse un paquet déjà installé et <code
                class="command">apt</code> essaiera de résoudre le problème en mettant à jour le paquet qui serait cassé par une version plus récente (que l'on suppose corrigée pour être à nouveau compatible).
				</div><div
              class="para">
					Ce genre de situation peut se rencontrer dans le cas de mises à jour sans compatibilité ascendante : c'est le cas si la nouvelle version ne fonctionne plus comme l'ancienne et entraîne un dysfonctionnement d'un autre logiciel en l'absence de dispositions particulières. Le champ <code
                class="literal">Breaks</code> évite que l'utilisateur soit confronté à ces problèmes.
				</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.11"></a>5.2.1.4. Éléments fournis : champ <code
                      class="literal">Provides</code></h4></div></div></div><a
              id="id-1.8.6.5.11.2"
              class="indexterm"></a><div
              class="para">
					Ce champ introduit le concept très intéressant de « paquet virtuel ». Il a de nombreux rôles, mais on en distingue deux principaux. Le premier consiste à utiliser un paquet virtuel pour lui associer un service générique (le paquet « fournit » le service). Le second indique qu'un paquet en remplace complètement un autre et qu'à ce titre il peut également satisfaire les dépendances déclarées sur celui-ci. Il est ainsi possible de créer un paquet de substitution sans avoir de contrainte sur son nom.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>VOCABULAIRE</em></span> Métapaquet et paquet virtuel</strong></p></div></div></div><a
                id="id-1.8.6.5.11.4.2"
                class="indexterm"></a><a
                id="id-1.8.6.5.11.4.3"
                class="indexterm"></a><a
                id="id-1.8.6.5.11.4.4"
                class="indexterm"></a><div
                class="para">
					Distinguons bien les métapaquets des paquets virtuels. Les premiers sont des paquets réels (dotés de fichiers <code
                  class="filename">.deb</code>), dont le seul intérêt est d'exprimer des dépendances.
				</div><div
                class="para">
					Les paquets virtuels, quant à eux, n'existent pas physiquement ; il s'agit juste d'un moyen d'identifier des paquets réels sur la base d'un critère logique commun (service fourni, compatibilité avec un programme standard ou un paquet préexistant, etc.).
				</div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.8.6.5.11.5"></a>5.2.1.4.1. La fourniture d'un « service »</h5></div></div></div><div
                class="para">
						Détaillons le premier cas par un exemple : tous les serveurs de courrier électronique tels que <span
                  class="pkg pkg">postfix</span> ou <span
                  class="pkg pkg">sendmail</span> déclarent « fournir » le paquet virtuel <span
                  class="pkg pkg">mail-transport-agent</span>. Ainsi, tout paquet qui a besoin de ce service pour fonctionner (ce peut être un gestionnaire de listes de diffusion, comme <span
                  class="pkg pkg">smartlist</span> ou <span
                  class="pkg pkg">sympa</span>) se contentera de déclarer dans ses dépendances <span
                  class="pkg pkg">mail-transport-agent</span> au lieu d'y préciser une grande liste de choix toujours incomplète (<code
                  class="command">postfix | sendmail | exim4 | ...</code>). Par ailleurs, il ne sert à rien d'installer deux serveurs de courrier électronique ; c'est pourquoi chacun de ces paquets déclare un conflit avec le paquet virtuel <span
                  class="pkg pkg">mail-transport-agent</span>. Un conflit d'un paquet avec lui-même est ignoré par le système, mais cette technique interdira d'installer de concert deux serveurs de courrier électronique.
					</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>CHARTE DEBIAN</em></span> Liste des paquets virtuels</strong></p></div></div></div><a
                  id="id-1.8.6.5.11.5.3.2"
                  class="indexterm"></a><div
                  class="para">
						Pour que les paquets virtuels soient utiles, il faut que tout le monde s'entende sur leur nom. C'est pourquoi ils sont standardisés par la charte Debian. La liste comprend entre autres <span
                    class="pkg pkg">mail-transport-agent</span> pour les serveurs de courrier électronique, <span
                    class="pkg pkg">c-compiler</span> pour les compilateurs C, <span
                    class="pkg pkg">www-browser</span> pour les navigateurs web, <span
                    class="pkg pkg">httpd</span> pour les serveurs web, <span
                    class="pkg pkg">ftp-server</span> pour les serveurs FTP, <span
                    class="pkg pkg">x-terminal-emulator</span> pour les émulateurs de terminal en mode graphique (<code
                    class="command">xterm</code>) et <span
                    class="pkg pkg">x-window-manager</span> pour les gestionnaires de fenêtres.
					</div><div
                  class="para">
						La liste complète est disponible sur le Web. <div
                    xmlns=""
                    class="url">→ <a
                      xmlns="http://www.w3.org/1999/xhtml"
                      href="http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt">http://www.debian.org/doc/packaging-manuals/virtual-package-names-list.txt</a></div>
					</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.8.6.5.11.6"></a>5.2.1.4.2. L'interchangeabilité avec un autre paquet</h5></div></div></div><div
                class="para">
						Le champ <code
                  class="literal">Provides</code> s'avère aussi intéressant lorsque le contenu d'un paquet est intégré dans un paquet plus vaste. Ainsi, le module Perl <span
                  class="pkg pkg">libdigest-md5-perl</span> était un module facultatif en Perl 5.6, qui a été intégré en standard dans Perl 5.8 (et les versions suivantes, comme la version 5.14 présente dans <span
                  class="distribution distribution">Jessie</span>). Le paquet <span
                  class="pkg pkg">perl</span> déclare donc depuis sa version 5.8 <code
                  class="literal">Provides: libdigest-md5-perl</code> afin que les dépendances sur ce paquet soient satisfaites si l'utilisateur dispose de Perl 5.8 ou plus récent. Le paquet <span
                  class="pkg pkg">libdigest-md5-perl</span> lui-même a ainsi pu être supprimé, n'ayant plus de raison d'être.
					</div><div
                class="figure"><a
                  xmlns=""
                  id="id-1.8.6.5.11.6.3"></a><div
                  class="figure-contents"><div
                    class="mediaobject"><img
                      src="images/virtual-package.png"
                      alt="Usage d'un champ Provides pour ne pas casser les dépendances" /></div></div><p
                  class="title"><strong>Figure 5.1. Usage d'un champ <code
                      class="literal">Provides</code> pour ne pas casser les dépendances</strong></p></div><div
                class="para">
						Cette fonctionnalité est très utile puisqu'il n'est jamais possible d'anticiper les aléas du développement et qu'il faut être capable de s'ajuster aux renommages et autres remplacements automatiques de logiciels obsolètes.
					</div><div
                class="sidebar"><div
                  class="titlepage"><div><div><p
                        class="title"><strong><span
                            class="emphasis"><em>B.A.-BA</em></span> Perl, un langage de programmation</strong></p></div></div></div><a
                  id="id-1.8.6.5.11.6.5.2"
                  class="indexterm"></a><a
                  id="id-1.8.6.5.11.6.5.3"
                  class="indexterm"></a><div
                  class="para">
						Perl (<span
                    class="foreignphrase"><em
                      class="foreignphrase">Practical Extraction and Report Language</em></span>, ou langage pratique d'extraction et de rapports) est un langage de programmation très populaire. Il dispose de nombreux modules prêts à l'emploi fournissant des fonctionnalités couvrant un spectre très large d'applications et diffusés par le réseau de serveurs CPAN (<span
                    class="foreignphrase"><em
                      class="foreignphrase">Comprehensive Perl Archive Network</em></span>, ou réseau exhaustif d'archives de Perl). <div
                    xmlns=""
                    class="url">→ <a
                      xmlns="http://www.w3.org/1999/xhtml"
                      href="http://www.perl.org/">http://www.perl.org/</a></div> <div
                    xmlns=""
                    class="url">→ <a
                      xmlns="http://www.w3.org/1999/xhtml"
                      href="http://www.cpan.org/">http://www.cpan.org/</a></div>
					</div><div
                  class="para">
						Comme il s'agit d'un langage interprété, un programme rédigé en Perl ne requiert pas de compilation préalable à son exécution. C'est pourquoi l'on parle de « scripts Perl ».
					</div></div></div><div
              class="section"><div
                class="titlepage"><div><div><h5
                      class="title"><a
                        xmlns=""
                        id="id-1.8.6.5.11.7"></a>5.2.1.4.3. Anciennes limitations</h5></div></div></div><div
                class="para">
						Les paquets virtuels souffraient de quelques limitations, dont la plus importante était l'absence de numéro de version. Pour reprendre l'exemple précédent, une dépendance <code
                  class="literal">Depends: libdigest-md5-perl (&gt;= 1.6)</code> n'était donc jamais satisfaite, pour le système de paquetage, par la présence de Perl 5.10 — bien qu'en réalité elle l'était probablement. Ne le sachant pas, le système de paquetage optait pour une politique du moindre risque en supposant que les versions ne correspondaient pas.
					</div><div
                class="para">
						Cette limitation a été levée avec <span
                  class="pkg pkg">dpkg</span> 1.17.11, et n'existe plus dans Jessie. Les paquets peuvent assigner une version aux paquets virtuels qu'ils fournissent avec une dépendance telle que <code
                  class="literal">Provides: libdigest-md5-perl (= 1.8)</code>.
					</div></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.5.12"></a>5.2.1.5. Remplacements : champ <code
                      class="literal">Replaces</code></h4></div></div></div><a
              id="id-1.8.6.5.12.2"
              class="indexterm"></a><a
              id="id-1.8.6.5.12.3"
              class="indexterm"></a><a
              id="id-1.8.6.5.12.4"
              class="indexterm"></a><div
              class="para">
					Le champ <code
                class="literal">Replaces</code> indique que le paquet contient des fichiers également présents dans un autre paquet, mais qu'il a légitimement le droit de les remplacer. En l'absence de cette précision, <code
                class="command">dpkg</code> échoue en précisant qu'il ne peut pas écraser les fichiers d'un autre paquet (en fait, il est possible de lui forcer la main avec l'option <code
                class="literal">--force-overwrite</code>, mais ce n'est pas considéré comme une opération standard). Cela permet d'identifier les problèmes potentiels et contraint le mainteneur à étudier la question avant de choisir d'ajouter ou non ce champ.
				</div><div
              class="para">
					L'emploi de ce champ se justifie dans le cas de changements de noms de paquets ou lorsqu'un paquet est intégré dans un autre. Cela se produit également quand le mainteneur a décidé de répartir différemment les fichiers entre divers paquets binaires produits depuis le même paquet source : un fichier remplacé n'appartient plus à l'ancien paquet, mais uniquement au nouveau.
				</div><div
              class="para">
					Si tous les fichiers d'un paquet installé ont été remplacés, il est considéré comme supprimé. Enfin, ce champ incite aussi <code
                class="command">dpkg</code> à supprimer le paquet remplacé en cas de conflit.
				</div><div
              class="sidebar"><a
                xmlns=""
                id="sidebar.debtags"></a><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>POUR ALLER PLUS LOIN</em></span> Le champ <code
                          class="literal">Tag</code></strong></p></div></div></div><div
                class="para">
					Dans l'exemple d'<span
                  class="pkg pkg">apt</span>, cité plus haut, on peut constater la présence d'un champ que nous n'avons pas encore décrit, le champ <code
                  class="literal">Tag</code> (étiquette). Il ne s'agit pas d'un champ décrivant une relation entre paquets, mais simplement d'une catégorisation du paquet dans une taxonomie thématique. Cette classification des paquets selon plusieurs critères (type d'interface, langage de programmation, domaine d'application, etc.) est présente de longue date dans Debian, mais elle n'est pas encore intégrée dans tous les outils ; <code
                  class="command">aptitude</code> affiche ces étiquettes et permet de s'en servir comme critères de recherche. Pour ceux que la syntaxe de recherche d'<code
                  class="command">aptitude</code> rebute, signalons le site qui permet de naviguer dans la base de données des étiquettes : <div
                  xmlns=""
                  class="url">→ <a
                    xmlns="http://www.w3.org/1999/xhtml"
                    href="http://debtags.alioth.debian.org/">http://debtags.alioth.debian.org/</a></div>
				</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.configuration-scripts"></a>5.2.2. Scripts de configuration</h3></div></div></div><a
            id="id-1.8.6.6.2"
            class="indexterm"></a><a
            id="id-1.8.6.6.3"
            class="indexterm"></a><a
            id="id-1.8.6.6.4"
            class="indexterm"></a><a
            id="id-1.8.6.6.5"
            class="indexterm"></a><a
            id="id-1.8.6.6.6"
            class="indexterm"></a><div
            class="para">
				En plus du fichier <code
              class="filename">control</code>, l'archive <code
              class="filename">control.tar.gz</code> de chaque paquet Debian peut contenir un certain nombre de scripts, appelés par <code
              class="command">dpkg</code> à différentes étapes du traitement d'un paquet. La charte Debian détaille longuement les cas possibles en précisant les scripts appelés et les arguments qu'ils reçoivent. Ces séquences peuvent être compliquées puisque si l'un des scripts échoue, <code
              class="command">dpkg</code> essaiera de revenir dans un état satisfaisant en annulant l'installation ou la suppression en cours (tant que cela est possible).
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>POUR ALLER PLUS LOIN</em></span> Base de données de <code
                        class="command">dpkg</code></strong></p></div></div></div><a
              id="id-1.8.6.6.8.2"
              class="indexterm"></a><a
              id="id-1.8.6.6.8.3"
              class="indexterm"></a><div
              class="para">
				Tous les scripts de configuration des paquets installés sont stockés dans le répertoire <code
                class="filename">/var/lib/dpkg/info/</code> sous la forme d'un fichier préfixé par le nom du paquet. On y trouve également, pour chaque paquet, un fichier d'extension <code
                class="filename">.list</code> contenant la liste des fichiers appartenant au paquet.
			</div><div
              class="para">
				Le fichier <code
                class="filename">/var/lib/dpkg/status</code> contient une série de blocs d'informations (au format des fameux en-têtes de courriers électroniques, RFC 2822) décrivant le statut de chaque paquet. On y trouve également les informations contenues dans le fichier <code
                class="filename">control</code> des différents paquets installés.
			</div></div><div
            class="para">
				D'une manière générale, le script <code
              class="filename">preinst</code> est exécuté préalablement à l'installation du paquet alors que le <code
              class="filename">postinst</code> la suit. De même, <code
              class="filename">prerm</code> est invoqué avant la suppression du paquet et <code
              class="filename">postrm</code> après. Une mise à jour d'un paquet équivaut à en supprimer la version précédente puis à installer la nouvelle. Il n'est pas possible de détailler ici tous les scénarios d'actions réussies, mais évoquons quand même les deux plus courants : une installation/mise à jour et une suppression.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ATTENTION</em></span> Noms symboliques des scripts</strong></p></div></div></div><div
              class="para">
				Les séquences décrites dans cette section font appel à des scripts de configuration aux noms particuliers, comme <code
                class="command">ancien-prerm</code> ou <code
                class="command">nouveau-postinst</code>. Il s'agit respectivement du script <code
                class="command">prerm</code> contenu dans l'ancienne version du paquet (installé avant la mise à jour) et du script <code
                class="command">postinst</code> de sa nouvelle version (mis en place par la mise à jour).
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ASTUCE</em></span> Diagrammes d'états</strong></p></div></div></div><div
              class="para">
				Manoj Srivastava a réalisé des diagrammes expliquant comment les scripts de configuration sont appelés par <code
                class="command">dpkg</code>. Des diagrammes similaires avaient également été développés par le projet Debian Women ; ils sont un peu plus simples à comprendre mais moins complets. <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="http://people.debian.org/~srivasta/MaintainerScripts.html">http://people.debian.org/~srivasta/MaintainerScripts.html</a></div> <div
                xmlns=""
                class="url">→ <a
                  xmlns="http://www.w3.org/1999/xhtml"
                  href="https://wiki.debian.org/MaintainerScripts">https://wiki.debian.org/MaintainerScripts</a></div>
			</div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.6.12"></a>5.2.2.1. Installation et mise à jour</h4></div></div></div><a
              id="id-1.8.6.6.12.2"
              class="indexterm"></a><div
              class="para">
					Voici les étapes d'une installation (ou mise à jour) :
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="orderedlist"><ol><li
                  class="listitem"><div
                    class="para">
							En cas de mise à jour, <code
                      class="command">dpkg </code> appelle la commande <code
                      class="command">ancien-prerm upgrade <em
                        class="replaceable">nouvelle-version</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Pour une mise à jour toujours, <code
                      class="command">dpkg</code> exécute alors <code
                      class="command">nouveau-preinst upgrade <em
                        class="replaceable">ancienne-version</em></code> ; pour une première installation, il exécute <code
                      class="command">nouveau-preinst install</code>. Il peut ajouter l'ancienne version en dernier paramètre si le paquet avait déjà été installé et supprimé entre-temps (mais non purgé, les fichiers de configuration ayant alors été conservés).
						</div></li><li
                  class="listitem"><div
                    class="para">
							Les fichiers du nouveau paquet sont décompactés. Si un fichier existait au préalable, il est remplacé mais une copie de sauvegarde est temporairement réalisée.
						</div></li><li
                  class="listitem"><div
                    class="para">
							En cas de mise à jour, <code
                      class="command">dpkg</code> exécute <code
                      class="command">ancien-postrm upgrade <em
                        class="replaceable">nouvelle-version</em></code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> met à jour toutes ses données internes (liste de fichiers, scripts de configuration) et supprime les copies de sauvegarde des fichiers remplacés. C'est un point de non-retour : <code
                      class="command">dpkg</code> ne dispose plus désormais de tous les éléments nécessaires pour revenir à l'état antérieur.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> va mettre à jour les fichiers de configuration en demandant à l'utilisateur de trancher s'il est incapable de tout gérer automatiquement. Les détails de cette procédure se trouvent dans la <a
                      class="xref"
                      href="sect.package-meta-information.html#sect.conffiles">Section 5.2.3, « Sommes de contrôle, liste des fichiers de configuration »</a>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							Enfin, <code
                      class="command">dpkg</code> configure le paquet en exécutant <code
                      class="command">nouveau-postinst configure <em
                        class="replaceable">dernière-version-configurée</em></code>.
						</div></li></ol></div></div><div
            class="section"><div
              class="titlepage"><div><div><h4
                    class="title"><a
                      xmlns=""
                      id="id-1.8.6.6.13"></a>5.2.2.2. Suppression de paquets</h4></div></div></div><div
              class="para">
					Voici les étapes pour une suppression de paquet :
				</div><div
              xmlns:d="http://docbook.org/ns/docbook"
              class="orderedlist"><ol><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> appelle <code
                      class="command">prerm remove</code>.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> supprime tous les fichiers du paquet, à l'exception des fichiers de configuration et des scripts de configuration.
						</div></li><li
                  class="listitem"><div
                    class="para">
							<code
                      class="command">dpkg</code> exécute <code
                      class="command">postrm remove</code>. Tous les scripts de configuration, sauf le <code
                      class="filename">postrm</code>, sont effacés. Si l'utilisateur n'a pas demandé la « purge » du paquet, les opérations s'arrêtent là.
						</div></li><li
                  class="listitem"><div
                    class="para">
							En cas de purge complète du paquet (demandée avec <code
                      class="command">dpkg --purge</code> ou <code
                      class="command">dpkg -P</code>), les fichiers de configuration sont supprimés, ainsi qu'un certain nombre de copies (<code
                      class="filename">*.dpkg-tmp</code>, <code
                      class="filename">*.dpkg-old</code>, <code
                      class="filename">*.dpkg-new</code>) et de fichiers temporaires ; <code
                      class="command">dpkg</code> exécute ensuite <code
                      class="command">postrm purge</code>.
						</div></li></ol></div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>VOCABULAIRE</em></span> La purge, une suppression complète</strong></p></div></div></div><a
                id="id-1.8.6.6.13.4.2"
                class="indexterm"></a><div
                class="para">
					Lorsqu'un paquet Debian est supprimé, les fichiers de configuration sont conservés afin de faciliter une éventuelle réinstallation. De même, les données gérées par un démon (comme le contenu de l'annuaire d'un serveur LDAP, ou le contenu de la base de données pour un serveur SQL) sont habituellement conservées.
				</div><div
                class="para">
					Pour supprimer toute donnée associée au paquet, il faut procéder à sa « purge » avec la commande <code
                  class="command">dpkg -P <em
                    class="replaceable">paquet</em></code>, <code
                  class="command">apt-get remove --purge <em
                    class="replaceable">paquet</em></code> ou <code
                  class="command">aptitude purge <em
                    class="replaceable">paquet</em></code>.
				</div><div
                class="para">
					Étant donné le caractère définitif de cette suppression de données, on prendra garde de ne pas utiliser la purge à la légère.
				</div></div><a
              id="id-1.8.6.6.13.5"
              class="indexterm"></a><div
              class="para">
					Les quatre scripts évoqués précédemment sont complétés par un script <code
                class="filename">config</code>, fourni par les paquets utilisant <code
                class="command">debconf</code> pour obtenir de l'utilisateur des informations de configuration. Lors de l'installation, ce script définit en détail les questions posées par <code
                class="command">debconf</code>. Les réponses sont enregistrées dans la base de données de <code
                class="command">debconf</code> pour référence ultérieure. Le script est généralement exécuté par <code
                class="command">apt</code> avant d'installer un à un tous les paquets afin de regrouper en début de processus toutes les questions posées à l'utilisateur. Les scripts de pré- et post-installation pourront ensuite exploiter ces informations pour effectuer un traitement conforme aux vœux de l'utilisateur.
				</div><div
              class="sidebar"><div
                class="titlepage"><div><div><p
                      class="title"><strong><span
                          class="emphasis"><em>OUTIL</em></span> <code
                          class="command">debconf</code></strong></p></div></div></div><a
                id="id-1.8.6.6.13.7.2"
                class="indexterm"></a><div
                class="para">
					<code
                  class="command">debconf</code> fut créé pour résoudre un problème récurrent chez Debian. Tous les paquets Debian incapables de fonctionner sans un minimum de configuration posaient des questions à l'utilisateur avec des appels à <code
                  class="command">echo</code> et <code
                  class="command">read</code> dans les scripts shell <code
                  class="filename">postinst</code> et similaires. Mais cela impliquait également, lors d'une grosse installation ou mise à jour, de rester à côté de son ordinateur pour renseigner ces requêtes qui pouvaient se produire à tout moment. Ces interactions manuelles ont désormais presque totalement disparu au profit de l'outil <code
                  class="command">debconf</code>.
				</div><div
                class="para">
					<code
                  class="command">debconf</code> offre de nombreuses caractéristiques intéressantes : il contraint le développeur à spécifier les interactions avec l'utilisateur, il permet de localiser les différentes chaînes de caractères affichées (toutes les traductions sont stockées dans le fichier <code
                  class="filename">templates</code> décrivant les interactions), il dispose de différents modules d'affichage pour présenter les questions à l'utilisateur (modes texte, graphique, non interactif) et il permet de créer une base centrale de réponses pour partager la même configuration entre plusieurs ordinateurs... Mais la plus importante est qu'il est maintenant possible de présenter toutes les questions d'un bloc à l'utilisateur avant de démarrer une longue installation ou mise à jour. L'utilisateur peut alors vaquer à ses occupations pendant que le système s'installe, sans avoir à rester devant son écran pour y surveiller l'installation.
				</div></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.conffiles"></a>5.2.3. Sommes de contrôle, liste des fichiers de configuration</h3></div></div></div><a
            id="id-1.8.6.7.2"
            class="indexterm"></a><a
            id="id-1.8.6.7.3"
            class="indexterm"></a><a
            id="id-1.8.6.7.4"
            class="indexterm"></a><a
            id="id-1.8.6.7.5"
            class="indexterm"></a><a
            id="id-1.8.6.7.6"
            class="indexterm"></a><div
            class="para">
				En plus des données de contrôle et des scripts de configuration déjà cités dans les sections précédentes, l'archive <code
              class="filename">control.tar.gz</code> d'un paquet Debian en contient d'autres. Le premier, <code
              class="filename">md5sums</code>, contient la liste des empreintes numériques de tous les fichiers du paquet. Son principal avantage est de permettre à <code
              class="command">dpkg --verify</code> (que nous étudierons dans la <a
              class="xref"
              href="sect.supervision.html#sect.dpkg-verify">Section 14.3.3.1, « Audit des paquets avec <code
                class="command">dpkg --verify</code> »</a>) de vérifier que ces fichiers n'ont pas été modifiés depuis leur installation. Vous pouvez noter que lorsque ce fichier n'existe pas, <code
              class="command">dpkg</code> le génère dynamiquement au moment de l'installation (et l'enregistre dans la base de données dpkg comme les autres fichiers de contrôle).
			</div><div
            class="para">
				<code
              class="filename">conffiles</code> liste les fichiers du paquet qu'il faudra gérer comme des fichiers de configuration. Les fichiers de configuration peuvent être modifiés par l'administrateur, et <code
              class="command">dpkg</code> va essayer de garder ces changements pendant une mise à jour de paquet.
			</div><div
            class="para">
				En effet, dans une telle situation, <code
              class="command">dpkg</code> se comporte aussi intelligemment que possible : si le fichier de configuration standard n'a pas évolué entre les deux versions, il ne fait rien. Sinon, il va essayer de le mettre à jour. Deux cas sont possibles : soit l'administrateur n'a pas touché à ce fichier de configuration, auquel cas <code
              class="command">dpkg</code> installe automatiquement la nouvelle version disponible, soit le fichier a été modifié, auquel cas <code
              class="command">dpkg</code> demande à l'administrateur quelle version il souhaite utiliser (l'ancienne avec les modifications, ou la nouvelle fournie par le paquet). Pour l'aider à prendre sa décision, <code
              class="command">dpkg</code> lui propose de consulter un « <code
              class="command">diff</code> » présentant les différences entre les deux versions. S'il choisit de conserver l'ancienne version, la nouvelle sera stockée au même emplacement dans un fichier suffixé de <code
              class="filename">.dpkg-dist</code>. S'il choisit la nouvelle version, l'ancienne sera conservée dans un fichier <code
              class="filename">.dpkg-old</code>. La dernière possibilité offerte consiste à interrompre momentanément <code
              class="command">dpkg</code> pour éditer le fichier et tenter d'y reprendre les modifications pertinentes (préalablement identifiées grâce au <span
              class="foreignphrase"><em
                class="foreignphrase">diff</em></span>).
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.questions-conffiles"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>POUR ALLER PLUS LOIN</em></span> Éviter les questions sur les fichiers de configuration</strong></p></div></div></div><div
              class="para">
				<code
                class="command">dpkg</code> gère la mise à jour des fichiers de configuration mais interrompt régulièrement ses opérations pour solliciter l'avis de l'administrateur. Cette caractéristique est relativement désagréable pour qui souhaite obtenir une mise à jour non interactive. C'est pourquoi ce programme propose des options permettant de répondre systématiquement selon la même logique : <code
                class="command">--force-confold</code> conserve l'ancienne version du fichier ; <code
                class="command">--force-confnew</code> utilise la nouvelle version du fichier (ces choix sont respectés même si le fichier n'a pas été modifié par l'administrateur ; ce n'est que rarement l'effet souhaité). Si de plus vous précisez <code
                class="command">--force-confdef</code>, il fera le choix automatique quand c'est possible (c'est-à-dire lorsque le fichier de configuration original n'a pas été modifié) et ne se rabattra sur <code
                class="command">--force-confnew</code> ou <code
                class="command">--force-confold</code> que dans les autres cas.
			</div><div
              class="para">
				Ces options s'appliquent à <code
                class="command">dpkg</code>, mais la plupart du temps un administrateur travaillera directement avec les programmes <code
                class="command">aptitude</code> ou <code
                class="command">apt-get</code>. Il est donc nécessaire de connaître la syntaxe qui permet de leur indiquer les options à passer à <code
                class="command">dpkg</code> (leurs interfaces en ligne de commande sont très similaires).
			</div><pre
              class="screen">
<code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt -o DPkg::options::="--force-confdef" -o DPkg::options::="--force-confold" full-upgrade</code></strong></pre><div
              class="para">
				On peut placer ces options directement dans la configuration d'<code
                class="command">apt</code> plutôt que de les lui spécifier à chaque fois en ligne de commande. Pour cela, il suffit d'écrire la ligne suivante dans le fichier <code
                class="filename">/etc/apt/apt.conf.d/local</code> :
			</div><div
              class="informalexample"><pre
                class="programlisting">
DPkg::options { "--force-confdef"; "--force-confold"; }</pre></div><div
              class="para">
				Intégrer cette option dans le fichier de configuration permettra d'en profiter même dans le cadre d'une interface graphique telle qu'<code
                class="command">aptitude</code>.
			</div></div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.questions-conffiles-bis"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>POUR ALLER PLUS LOIN</em></span> Forcer dpkg à poser les questions sur les fichiers de configuration</strong></p></div></div></div><div
              class="para">
				L'option <code
                class="command">--force-confask</code> demande à <code
                class="command">dpkg</code> d'afficher les questions concernant les fichiers de configuration même dans les cas où cela n'est normalement plus nécessaire. Ainsi, en réinstallant un paquet avec cette option, <code
                class="command">dpkg</code> posera à nouveau la question pour tous les fichiers de configuration modifiés par l'administrateur. C'est très pratique notamment pour réinstaller le fichier de configuration original s'il a été supprimé et si aucune copie n'est disponible : une réinstallation normale ne suffit pas car <code
                class="command">dpkg</code> considère la suppression comme une forme de modification légitime et n'installe donc pas le fichier de configuration désiré.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="packaging-system.html"><strong>Précédent</strong>Chapitre 5. Système de paquetage, outils et princ...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Niveau supérieur</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Sommaire</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.source-package-structure.html"><strong>Suivant</strong>5.3. Structure d'un paquet source</a></li></ul></body></html>
