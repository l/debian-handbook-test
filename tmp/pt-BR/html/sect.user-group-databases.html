<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">8.4. Usuário e grupo bancos de dados</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-pt-BR-1.0-1" /><meta
        name="keywords"
        content="Configuração, Localização, Localidades, Rede, Resolução de nomes, Usuários, Grupos, Contas, Interpretador de linha de comando, Shell, Impressão, Sistema de iniciação, Compilação de kernel" /><link
        rel="home"
        href="index.html"
        title="O Manual do Administrador Debian" /><link
        rel="up"
        href="basic-configuration.html"
        title="Capítulo 8. Configuração Básica: Rede, Contas, Impressão..." /><link
        rel="prev"
        href="sect.hostname-name-service.html"
        title="8.3. Ajustando o Nome de Host e Configurando o Serviço de Nomes" /><link
        rel="next"
        href="sect.creating-accounts.html"
        title="8.5. Criação de Contas" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/pt-BR/stable/sect.user-group-databases.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="sect.hostname-name-service.html"><strong>Anterior</strong></a></li><li
          class="home">O Manual do Administrador Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.creating-accounts.html"><strong>Próxima</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.user-group-databases"></a>8.4. Usuário e grupo bancos de dados</h2></div></div></div><a
          id="id-1.11.8.2"
          class="indexterm"></a><a
          id="id-1.11.8.3"
          class="indexterm"></a><a
          id="id-1.11.8.4"
          class="indexterm"></a><a
          id="id-1.11.8.5"
          class="indexterm"></a><div
          class="para">
			A lista de usuários é normalmente armazenada no <code
            class="filename">/etc/passwd</code>, enquanto o <code
            class="filename">/etc/shadow</code> armazena senhas criptografadas. Ambos são arquivos de texto, em um formato relativamente simples, que podem ser lidos e modificados com um editor de texto. Cada usuário está listado lá em uma linha com vários campos separados por dois-pontos (“<code
            class="literal">:</code>”).
		</div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>NOTA</em></span> Editando arquivos do sistema</strong></p></div></div></div><div
            class="para">
			Os arquivos de sistema mencionados neste capítulo são todos os arquivos de texto simples e podem ser editados com um editor de texto. Considerando sua importância para a funcionalidade de núcleo do sistema, é sempre uma boa idéia tomar precauções extras ao editar arquivos do sistema. Primeiro, sempre faça uma cópia ou backup de um arquivo de sistema antes de abrir ou alterar isso. Em segundo lugar, em servidores ou máquinas, onde mais de uma pessoa potencialmente poderia acessar o mesmo arquivo ao mesmo tempo, tome medidas extras para proteção contra corrupção de arquivo.
		</div><div
            class="para">
			Por este motivo, é suficiente usar o comando <code
              class="command">vipw</code> para editar o arquivo <code
              class="filename">/etc/passwd</code>, ou <code
              class="command">vigr</code> para editar <code
              class="filename">/etc/group</code>. Estes comandos travam o arquivo em questão antes de executar o editor de texto (o <code
              class="command">vi</code> por padrão , a menos que a variável de ambiente <code
              class="varname">EDITOR</code> tenha sido alterada). A opção <code
              class="literal">-s</code> nestes comandos permite a edição do arquivo <span
              class="foreignphrase"><em
                class="foreignphrase">shadow</em></span> correspondente.
		</div></div><div
          class="sidebar"><div
            class="titlepage"><div><div><p
                  class="title"><strong><span
                      class="emphasis"><em>DE VOLTA AO BÁSICO</em></span> Crypt, uma função de mão única</strong></p></div></div></div><a
            id="id-1.11.8.8.2"
            class="indexterm"></a><div
            class="para">
			<code
              class="command">crypt</code> é uma função unidirecional que transforma uma string (<code
              class="varname">A</code>) em outra string (<code
              class="varname">B</code>) de forma que <code
              class="varname">A</code> não possa ser derivada de <code
              class="varname">B</code>. A única forma de identificar <code
              class="varname">A</code> é testando todos os valores possíveis, verificando cada um para determinar se a transformação pela função vai produzir <code
              class="varname">B</code> ou não. Ele usa até 8 caracteres como entrada (string <code
              class="varname">A</code>) e gera uma string de 13 caracteres ASCII, imprimível (string <code
              class="varname">B</code>).
		</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-passwd"></a>8.4.1. Lista de Usuários: <code
                    class="filename">/etc/passwd</code></h3></div></div></div><div
            class="para">
				Aqui está uma lista de campos do arquivo <code
              class="filename">/etc/passwd</code>:
			</div><a
            id="id-1.11.8.9.3"
            class="indexterm"></a><a
            id="id-1.11.8.9.4"
            class="indexterm"></a><a
            id="id-1.11.8.9.5"
            class="indexterm"></a><a
            id="id-1.11.8.9.6"
            class="indexterm"></a><a
            id="id-1.11.8.9.7"
            class="indexterm"></a><a
            id="id-1.11.8.9.8"
            class="indexterm"></a><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						login, por exemplo <code
                    class="literal">rhertzog</code>;
					</div></li><li
                class="listitem"><div
                  class="para">
						password: é uma senha criptografada por uma função unidirecional (<code
                    class="command">crypt</code>), que se baseia em <code
                    class="literal">DES</code>, <code
                    class="literal">MD5</code>, <code
                    class="literal">SHA-256</code> ou <code
                    class="literal">SHA-512</code>. O valor especial “<code
                    class="literal">x</code>” indica que a senha criptografada é armazenada em <code
                    class="filename">/etc/shadow</code>;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">uid</code>: identificar numérico único para cada usuário;
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">gid</code>:número único para o grupo principal do usuário (O Debian cria, por padrão, um grupo específico para cada usuário);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">GECOS</code>: campo de dados contendo normalmente o nome completo de usuário;
					</div></li><li
                class="listitem"><div
                  class="para">
						diretório de login, atribuído ao usuário para armazenar arquivos pessoais (a variável de ambiente <code
                    class="varname">$HOME</code> geralmente aponta para ele);
					</div></li><li
                class="listitem"><div
                  class="para">
						programa para executar no login. Em geral é um interpretador de comandos (shell), deixando o usuário com "rédea solta". Se você especificar <code
                    class="command">/bin/false</code> (que não faz nada e devolve o controle imediatamente), o usuário não vai conseguir fazer login.
					</div></li></ul></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DE VOLTA AO BÁSICO</em></span> Grupo Unix</strong></p></div></div></div><a
              id="id-1.11.8.9.10.2"
              class="indexterm"></a><div
              class="para">
				Um grupo do Unix é uma entidade que contém vários usuários de forma que eles possam compartilhar arquivos facilmente usando o sistema de permissões integrado (com os benefícios dos mesmos direitos). Você também pode restringir o uso de certos programas a um grupo específico.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-shadow"></a>8.4.2. O Oculto e Criptografo Arquivo de Senhas: <code
                    class="filename">/etc/shadow</code></h3></div></div></div><a
            id="id-1.11.8.10.2"
            class="indexterm"></a><a
            id="id-1.11.8.10.3"
            class="indexterm"></a><div
            class="para">
				O arquivo <code
              class="filename">/etc/shadow</code> contém os seguintes campos:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						login;
					</div></li><li
                class="listitem"><div
                  class="para">
						senha criptografada;
					</div></li><li
                class="listitem"><div
                  class="para">
						diversos campos controlam a expiração da senha.
					</div></li></ul></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DOCUMENTAÇÃO</em></span> formatos de arquivos de <code
                        class="filename">/etc/passwd</code>, <code
                        class="filename">/etc/shadow</code> e <code
                        class="filename">/etc/group</code></strong></p></div></div></div><div
              class="para">
				Estes formatos estão documentados nas seguintes páginas de manuais: <span
                class="citerefentry"><span
                  class="refentrytitle">passwd</span>(5)</span>, <span
                class="citerefentry"><span
                  class="refentrytitle">shadow</span>(5)</span>, e <span
                class="citerefentry"><span
                  class="refentrytitle">group</span>(5)</span>.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>SEGURANÇA</em></span> <code
                        class="filename">/etc/shadow</code> segurança de arquivos</strong></p></div></div></div><div
              class="para">
				<code
                class="filename">/etc/shadow</code>, ao contrário do seu alter-ego, <code
                class="filename">/etc/passwd</code>, não pode ser lido por usuários normais. Qualquer senha criptografada armazenada em <code
                class="filename">/etc/passwd</code> pode ser lida por todo mundo; um cracker pode tentar "quebrar" (ou revelar) uma senha através de um dos vários métodos "força bruta" que, de forma geral, tantam adivinhar uma combinação muito usada de caracteres. Este ataque — chamado de "ataque de dicionário" — não é mais possível em sistemas usando o <code
                class="filename">/etc/shadow</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.account-modification"></a>8.4.3. Modificando uma Conta de Usuário Existente ou Senha</h3></div></div></div><a
            id="id-1.11.8.11.2"
            class="indexterm"></a><a
            id="id-1.11.8.11.3"
            class="indexterm"></a><a
            id="id-1.11.8.11.4"
            class="indexterm"></a><a
            id="id-1.11.8.11.5"
            class="indexterm"></a><a
            id="id-1.11.8.11.6"
            class="indexterm"></a><div
            class="para">
				Os seguintes comandos permitem a modificação das informações armazenadas em campos específicos do banco de dados do usuário: <code
              class="command">passwd</code> permite que um usuário comum altere sua senha, que por sua vez, atualiza o arquivo <code
              class="filename">/etc/shadow</code>; <code
              class="command">chfn</code>(CHange Full Name), reservado para o superusuário (root), modifica o campo <code
              class="literal">GECOS</code>.<code
              class="command">chsh</code> (CHange SHell) permite que o usuário altere seu shell de login, contudo, as opções disponíveis estarão limitadas as opções listadas em <code
              class="filename">/etc/shells</code>; o administrador, por outro lado, não tem essa restrição e pode definir o shell para qualquer programa de sua escolha.
			</div><div
            class="para">
				Finalmente, o comando <code
              class="command">chage</code> (CHange AGE) permite ao administrador alterar as configurações de expiração da senha (a opção <code
              class="literal">-l <em
                class="replaceable">user</em></code> irá listar as configurações corrente). Vocẽ também pode forçar a expiração da senha usando o comando <code
              class="command">passwd -e <em
                class="replaceable">user</em></code>, o qual irá requerer que o usuário altere sua senha na próxima vez que iniciar uma sessão.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.disabling-account"></a>8.4.4. Desabilitando uma Conta</h3></div></div></div><a
            id="id-1.11.8.12.2"
            class="indexterm"></a><a
            id="id-1.11.8.12.3"
            class="indexterm"></a><div
            class="para">
				Você pode necessitar “desabilitar uma conta” (bloquear um usuário), como uma medida disciplinar, para propósitos de uma investigação, ou simplesmente no caso de uma prolongada ou definitiva ausência de um usuário. Uma conta desabilitada significa que o usuário não pode iniciar uma sessão ou ganhar acesso a máquina. A conta permanece intacta na máquina e nenhum arquivo ou dado é apagado; ela é simplesmente inacessível. Isso é feito usando o comando <code
              class="command">passwd -l <em
                class="replaceable">user</em></code> (bloqueio). Reabilitar a conta é feito de maneira similar, com a opção <code
              class="literal">-u</code> (desbloqueio).
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.intro-nss"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>APROFUNDANDO</em></span> NSS e banco de dados do sistema</strong></p></div></div></div><a
              id="id-1.11.8.12.5.2"
              class="indexterm"></a><a
              id="id-1.11.8.12.5.3"
              class="indexterm"></a><div
              class="para">
				Ao invés de usar os arquivos usuais para gerenciar listas de usuários e grupos, você pode usar outros tipos de banco de dados, como LDAP ou <code
                class="command">db</code>, usando o módulo NSS (Name Service Switch) apropriado. Os módulos usados estão listados no arquivo <code
                class="filename">/etc/nsswitch.conf</code>, sob as entradas <code
                class="literal">passwd</code>, <code
                class="literal">shadow</code> e <code
                class="literal">group</code>. Veja <a
                class="xref"
                href="sect.ldap-directory.html#sect.config-nss">Seção 11.7.3.1, “Configurando o NSS”</a> para um exemplo específico de uso do módulo NSS pelo LDAP.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.etc-group"></a>8.4.5. Lista de Grupo: <code
                    class="filename">/etc/group</code></h3></div></div></div><div
            class="para">
				Grupos são listados no arquivo <code
              class="filename">/etc/group</code>, um banco de dados de texto simples em um formato similar ao arquivo <code
              class="filename">/etc/passwd</code>, com os seguintes campos:
			</div><div
            xmlns:d="http://docbook.org/ns/docbook"
            class="itemizedlist"><ul><li
                class="listitem"><div
                  class="para">
						nome do grupo;
					</div></li><li
                class="listitem"><div
                  class="para">
						senha (opcional): Isso só é usado para participar de um grupo quando não se é um membro usual (com os comandos <code
                    class="command">newgrp</code> ou <code
                    class="command">sg</code>, veja barra lateral <a
                    class="xref"
                    href="sect.user-group-databases.html#sidebar.working-with-several-groups"><span
                      class="emphasis"><em>DE VOLTA AO BÁSICO</em></span> Trabalhando com grupos diversos</a>);
					</div></li><li
                class="listitem"><div
                  class="para">
						<code
                    class="literal">gid</code>: identificar numérico único para cada grupo;
					</div></li><li
                class="listitem"><div
                  class="para">
						lista de membros: lista de nomes de usuários que são membros do grupo, separados por vírgulas.
					</div></li></ul></div><div
            class="para">
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.working-with-several-groups"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DE VOLTA AO BÁSICO</em></span> Trabalhando com grupos diversos</strong></p></div></div></div><a
              id="id-1.11.8.13.5.2"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.3"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.4"
              class="indexterm"></a><a
              id="id-1.11.8.13.5.5"
              class="indexterm"></a><div
              class="para">
				Cada usuário pode ser membro de muitos grupos; um deles é seu “grupo principal”. O grupo principal de um usuário é, por padrão, criado durante a configuração inicial do usuário. Por padrão, cada arquivo que o usuário criar pertencerá a eles, assim como ao seu grupo principal. Isso nem sempre é desejável; por exemplo, quando o usuário precisa trabalhar em um diretório compartilhado por um grupo diferente de seu grupo principal. Neste caso, o usuário precisa alterar seu grupo principal usando os seguintes comandos: <code
                class="command">newgrp</code>, o qual inicia um novo shell, ou <code
                class="command">sg</code>, o qual simplesmente executa um comando usando o grupo alternativo fornecido. Esses comandos também permitem ao usuário participar de um grupo o qual ele não pertence. Se o grupo é protegido por senha, ele terá de fornecer a senha apropriada antes de o comando ser executado.
			</div><div
              class="para">
				Alternativamente, o usuário pode definir o bit <code
                class="literal">setgid</code> no diretório, o que causa aos arquivos criados neste diretório serem automaticamente pertencentes ao grupo correto. Para mais detalhes, veja a barra lateral <a
                class="xref"
                href="sect.rights-management.html#sidebar.setgid-dir"><span
                  class="emphasis"><em>SEGURANÇA</em></span> <code
                  class="literal">setgid</code> diretório e <span
                  class="emphasis"><em>sticky bit</em></span></a>.
			</div><div
              class="para">
				O comando <code
                class="command">id</code> exibe o estado corrente de um usuário, com sua identidade pessoal(variável <code
                class="varname">uid</code>), grupo principal corrente (variável <code
                class="varname">gid</code>), e a lista de grupos aos quais pertence (variável <code
                class="varname">groups</code>).
			</div></div><a
            id="id-1.11.8.13.6"
            class="indexterm"></a><a
            id="id-1.11.8.13.7"
            class="indexterm"></a><div
            class="para">
				Os comandos <code
              class="command">addgroup</code> e <code
              class="command">delgroup</code> adicionam ou apagam um grupo, respectivamente. O comando <code
              class="command">groupmod</code> modifica a informação do grupo (seu <code
              class="literal">gid</code> ou identificador). O comando <code
              class="command">passwd -g <em
                class="replaceable">grupo</em></code> altera a senha para o grupo, enquanto o comando <code
              class="command">passwd -r -g <em
                class="replaceable">grupo</em></code> o apaga.
			</div><a
            id="id-1.11.8.13.9"
            class="indexterm"></a><a
            id="id-1.11.8.13.10"
            class="indexterm"></a><a
            id="id-1.11.8.13.11"
            class="indexterm"></a><a
            id="id-1.11.8.13.12"
            class="indexterm"></a><a
            id="id-1.11.8.13.13"
            class="indexterm"></a><a
            id="id-1.11.8.13.14"
            class="indexterm"></a><a
            id="id-1.11.8.13.15"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DICA</em></span> <code
                        class="command">getent</code></strong></p></div></div></div><a
              id="id-1.11.8.13.16.2"
              class="indexterm"></a><div
              class="para">
				O comando <code
                class="command">getent</code> (obter entradas) faz a checagem padrão do banco de dados do sistemas, usando as funções de biblioteca apropriadas, as quais, por sua vez, chamam os módulos NSS configurados no arquivo <code
                class="filename">/etc/nsswitch.conf</code>. O comando recebe um ou dois argumentos: o nome do banco de dados a ser checado, e uma possível chave de busca. Assim, o comando <code
                class="command">getent passwd rhertzog</code> dará as informações do banco de dados do usuário em relação ao usuário<code
                class="literal">rhertzog</code>.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="sect.hostname-name-service.html"><strong>Anterior</strong>8.3. Ajustando o Nome de Host e Configurando o Se...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Acima</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Principal</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.creating-accounts.html"><strong>Próxima</strong>8.5. Criação de Contas</a></li></ul></body></html>
