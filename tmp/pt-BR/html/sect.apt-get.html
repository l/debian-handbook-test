<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html
    xmlns="http://www.w3.org/1999/xhtml"><head><meta
        http-equiv="Content-Type"
        content="text/html; charset=UTF-8" /><title
        xmlns:d="http://docbook.org/ns/docbook">6.2. Comandos aptitude, apt-get e apt</title><link
        rel="stylesheet"
        type="text/css"
        href="Common_Content/css/default.css" /><link
        rel="stylesheet"
        media="print"
        href="Common_Content/css/print.css"
        type="text/css" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="generator"
        content="publican v4.3.2" /><meta
        xmlns:d="http://docbook.org/ns/docbook"
        name="package"
        content="Debian-debian-handbook-8-pt-BR-1.0-1" /><meta
        name="keywords"
        content="apt, apt-get, apt-cache, aptitude, synaptic, sources.list, apt-cdrom" /><link
        rel="home"
        href="index.html"
        title="O Manual do Administrador Debian" /><link
        rel="up"
        href="apt.html"
        title="Capítulo 6. Manutenções e atualizações: As ferramentas APT" /><link
        rel="prev"
        href="apt.html"
        title="Capítulo 6. Manutenções e atualizações: As ferramentas APT" /><link
        rel="next"
        href="sect.apt-cache.html"
        title="6.3. O Comando apt-cache" /><meta
        xmlns=""
        name="flattr:id"
        content="4pz9jq" /><link
        xmlns=""
        rel="canonical"
        href="https://debian-handbook.info/browse/pt-BR/stable/sect.apt-get.html" /></head><body><div
        id="banner"><a
          href="http://debian-handbook.info/get/"><span
            class="text">Download the ebook</span></a></div><p
        id="title"><a
          class="left"
          href="http://www.debian.org"><img
            alt="Product Site"
            src="Common_Content/images//image_left.png" /></a><a
          class="right"
          href="index.html"><img
            alt="Documentation Site"
            src="Common_Content/images//image_right.png" /></a></p><ul
        class="docnav top"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>Anterior</strong></a></li><li
          class="home">O Manual do Administrador Debian</li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>Próxima</strong></a></li></ul><div
        class="section"><div
          class="titlepage"><div><div><h2
                class="title"><a
                  xmlns=""
                  id="sect.apt-get"></a>6.2. Comandos <code
                  class="command">aptitude</code>, <code
                  class="command">apt-get</code> e <code
                  class="command">apt</code></h2></div></div></div><a
          id="id-1.9.11.2"
          class="indexterm"></a><a
          id="id-1.9.11.3"
          class="indexterm"></a><a
          id="id-1.9.11.4"
          class="indexterm"></a><div
          class="para">
			APT é um projeto amplo, cujos planos originais incluem uma interface gráfica. Ele é baseado numa biblioteca que contém as aplicações principais, e o <code
            class="command">apt-get</code> é a primeira interface — em linha de comando — que foi desenvolvida dentro do projeto. O <code
            class="command">apt</code> é uma segunda interface baseada em linha de comando fornecida pelo APT que supera alguns erros de projeto do <code
            class="command">apt-get</code>.
		</div><div
          class="para">
			Várias outras interfaces gráficas apareceram como projetos externos: <code
            class="command">synaptic</code>, <code
            class="command">aptitude</code> (que tem uma interface modo texto e uma gráfica — que ainda não está completa), <code
            class="command">wajig</code>, etc. A interface mais recomendada, <code
            class="command">apt</code>, é a que nós iremos usar nos exemplos dados nesta seção. Note, porém, que a sintaxe de linha de comando do <code
            class="command">apt-get</code> e <code
            class="command">aptitude</code> são muito semelhantes. Quando existirem diferenças importantes entre o <code
            class="command">apt</code>, <code
            class="command">apt-get</code> e o <code
            class="command">aptitude</code>, essas diferenças serão detalhadas.
		</div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.9.11.7"></a>6.2.1. Initialização</h3></div></div></div><div
            class="para">
				Para qualquer trabalho com o APT, a lista de pacotes disponíveis precisa ser atualizada; isto pode ser feito simplesmente com <code
              class="command">apt update</code>. Dependendo da velocidade de sua conexão, a operação pode demorar um pouco, pois ela baixa alguns arquivos <code
              class="filename">Packages</code>/<code
              class="filename">Sources</code>/<code
              class="filename">Translation-<em
                class="replaceable">language-code</em></code>, que tornaram-se gradualmente cada vez maiores devido o desenvolvimento do Debian (pelo menos 10 MB de dados para a seção <code
              class="literal">main</code>). Obviamente, instalar de um conjunto de CD-ROMs não baixa nada — neste caso, a operação é bastante rápida.
			</div><a
            id="id-1.9.11.7.3"
            class="indexterm"></a><a
            id="id-1.9.11.7.4"
            class="indexterm"></a><a
            id="id-1.9.11.7.5"
            class="indexterm"></a></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="id-1.9.11.8"></a>6.2.2. Instalação e remoção</h3></div></div></div><a
            id="id-1.9.11.8.2"
            class="indexterm"></a><a
            id="id-1.9.11.8.3"
            class="indexterm"></a><a
            id="id-1.9.11.8.4"
            class="indexterm"></a><a
            id="id-1.9.11.8.5"
            class="indexterm"></a><div
            class="para">
				Com o APT, os pacotes podem ser adicionados ou removidos do sistema, respectivamente com <code
              class="command">apt install <em
                class="replaceable">pacote</em></code> e <code
              class="command">apt remove <em
                class="replaceable">pacote</em></code>. Em ambos os casos, o APT vai instalar automaticamente as dependências necessárias ou apagar os pacotes que dependem do pacote que está para ser removido. O comando <code
              class="command">apt purge <em
                class="replaceable">pacote</em></code> envolve uma desinstalação completa - os arquivos de configuração também são excluídos.
			</div><a
            id="id-1.9.11.8.7"
            class="indexterm"></a><a
            id="id-1.9.11.8.8"
            class="indexterm"></a><a
            id="id-1.9.11.8.9"
            class="indexterm"></a><a
            id="id-1.9.11.8.10"
            class="indexterm"></a><a
            id="id-1.9.11.8.11"
            class="indexterm"></a><a
            id="id-1.9.11.8.12"
            class="indexterm"></a><a
            id="id-1.9.11.8.13"
            class="indexterm"></a><a
            id="id-1.9.11.8.14"
            class="indexterm"></a><a
            id="id-1.9.11.8.15"
            class="indexterm"></a><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DICA</em></span> Instalando a mesma seleção de pacotes diversas vezes</strong></p></div></div></div><div
              class="para">
				Pode ser útil instalar sistematicamente a mesma lista de pacotes em vários computadores. Isso pode ser feito facilmente.
			</div><div
              class="para">
				Em primeiro lugar, recupere a lista de pacotes instalados no computador que servirá como o "modelo" para copiar.
			</div><pre
              class="screen"><code
                class="computeroutput">$ </code><strong
                class="userinput"><code>dpkg --get-selections &gt;pkg-list</code></strong></pre><div
              class="para">
				O arquivo <code
                class="filename">pkg-list</code> passa a conter a lista dos pacotes instalados. Em seguida, transfira o arquivo <code
                class="filename">pkg-list</code> para os computadores que você quer atualizar e use os seguintes comandos:
			</div><pre
              class="screen">## Atualiza banco de dados do dpkg de pacotes conhecidos
# <strong
                class="userinput"><code>avail=`mktemp`</code></strong>
# <strong
                class="userinput"><code>apt-cache dumpavail &gt; "$avail"</code></strong>
# <strong
                class="userinput"><code>dpkg --merge-avail "$avail"</code></strong>
# <strong
                class="userinput"><code>rm -f "$avail"</code></strong>
## Seleções de Atualização do dpkg
# <strong
                class="userinput"><code>dpkg --set-selections &lt; pkg-list</code></strong>
## Pedir apt-get para instalar os pacotes selecionados
# <strong
                class="userinput"><code>apt-get dselect-upgrade</code></strong></pre><div
              class="para">
				Os primeiros comandos registram a lista de pacotes disponíveis no banco de dados dpkg, então <code
                class="command">dpkg --set-selections</code> restaura a seleção de pacotes que você deseja instalar, e o <code
                class="command">apt-get</code> executa as operações necessárias! <code
                class="command">aptitude</code> não tem este comando.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DICA</em></span> Removendo e instalando ao mesmo tempo</strong></p></div></div></div><div
              class="para">
				É possível pedir ao <code
                class="command">apt</code> (ou <code
                class="command">apt-get</code> ou <code
                class="command">aptitude</code>) para instalar certos pacotes e remover outros na mesma linha de comando ao adicionar um sufixo. Com um comando <code
                class="command">apt install</code>, adicione “<code
                class="literal">-</code>” aos nomes de pacotes que você deseja remover. Com um comando <code
                class="command">apt remove</code>, adicione “<code
                class="literal">+</code>” para os nomes dos pacotes que você deseja instalar.
			</div><div
              class="para">
				O próximo exemplo mostra duas maneiras diferentes de instalar <em
                class="replaceable">package1</em> \t e remover <em
                class="replaceable">package2</em>.
			</div><pre
              class="screen"># <strong
                class="userinput"><code>apt install <em
                    class="replaceable">pacote1</em> <em
                    class="replaceable">pacote2-</em></code></strong>
[...]
# <strong
                class="userinput"><code>apt remove <em
                    class="replaceable">pacote1+</em> <em
                    class="replaceable">pacote2</em></code></strong>
[...]</pre><div
              class="para">
				Este também pode ser utilizado para excluir os pacotes que de outra forma seriam instalados, por exemplo, devido a uma <code
                class="literal">Advertência</code>. Em geral, o solucionador de dependência vai usar essa informação como uma dica para procurar soluções alternativas.
			</div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DICA</em></span> <code
                        class="command">apt --reinstall</code> e <code
                        class="command">aptitude reinstall</code></strong></p></div></div></div><a
              id="id-1.9.11.8.18.2"
              class="indexterm"></a><div
              class="para">
				O sistema pode, às vezes, ser danificado com a remoção ou modificação de arquivos num pacote. A forma mais fácil de recuperar estes arquivos é reinstalar o pacote afetado. Infelizmente, o sistema de empacotamento nota que o pacote está instalado e se recusa educadamente a reinstalá-lo; para evitar isto, use a opção <code
                class="literal">--reinstall</code> dos comandos <code
                class="command">apt</code> e<code
                class="command">apt-get</code>. O comando abaixo reinstala o <span
                class="pkg pkg">postfix</span> mesmo quando ele já estejapresente:
			</div><pre
              class="screen"><code
                class="computeroutput"># </code><strong
                class="userinput"><code>apt --reinstall install postfix</code></strong></pre><div
              class="para">
				O <code
                class="command">aptitude</code> em linha de comando é ligeiramente diferente, mas atinge os mesmos resultados com <code
                class="command">aptitude reinstall postfix</code>.
			</div><div
              class="para">
				O problema não ocorre com o <code
                class="command">dpkg</code>, mas o administrador raramente usa-o diretamente.
			</div><div
              class="para">
				Seja cuidadoso! Usar o <code
                class="command">apt --reinstall</code> para recuperar pacotes alterados durante um ataque com certeza não retorna o sistema ao que ele era. <a
                class="xref"
                href="sect.dealing-with-compromised-machine.html">Seção 14.7, “Lidando com uma máquina comprometida”</a> detalha os passos necessários para lidar com um sistema comprometido.
			</div></div><div
            class="para">
				Se o arquivo <code
              class="filename">sources.list</code> menciona muitas distribuições, é possível passar a versão do pacote a instalar. Um número de versão específico pode ser solicitado com <code
              class="command">apt install <em
                class="replaceable">pacote</em>=<em
                class="replaceable">versão</em></code>, mas indicar sua destribuição de origem (<span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span> ou <span
              class="distribution distribution">Unstable</span>) — com o <code
              class="command">apt install <em
                class="replaceable">pacote</em>/<em
                class="replaceable">distribuição</em></code> — é normalmente preferido. Com este comando, é possível voltar a uma versão antiga do pacote (se por exemplo você sabe que isto vai funcionar bem), desde que ela ainda esteja disponível em alguma das fontes referenciadas pelo arquivo <code
              class="filename">sources.list</code>. Por outro lado, o arquivamento <code
              class="literal">snapshot.debian.org</code> pode vir ao seu socorro (veja a barra lateral <a
              class="xref"
              href="apt.html#sidebar.snapshot.debian.org"><span
                class="emphasis"><em>INDO ALÉM</em></span> versões de pacotes antigas: <code
                class="literal">snapshot.debian.org</code></a>).
			</div><div
            class="example"><a
              xmlns=""
              id="id-1.9.11.8.20"></a><p
              class="title"><strong>Exemplo 6.3. Instalação da versão <span
                  class="distribution distribution">unstable</span> do <span
                  class="pkg pkg">spamassassin</span></strong></p><div
              class="example-contents"><pre
                class="screen"><code
                  class="computeroutput"># </code><strong
                  class="userinput"><code>apt install spamassassin/unstable</code></strong></pre></div></div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>APROFUNDANDO</em></span> O cache dos arquivos <code
                        class="filename">.deb</code></strong></p></div></div></div><div
              class="para">
				APT mantém uma cópia de cada arquivo <code
                class="filename">.deb</code> baixado no diretório <code
                class="filename">/var/cache/apt/archives/</code>. Caso haja atualizações frequentes, este diretório pode rapidamente ocupar um grande espaço em disco com várias versões de cada pacote; você deve regularmente passear por eles. Dois comandos podem ser usados: <code
                class="command">apt-get clean</code> esvazia completamente o diretório; <code
                class="command">apt-get autoclean</code> remove apenas os pacotes que não podem mais ser baixados (por terem sumido dos espelhos Debian) e são agora claramente inúteis (o parâmetro de configuração <code
                class="literal">APT::Clean-Installed</code> evita a remoção de arquivos <code
                class="filename">.deb</code> que estão atualmente instalados). Note que o <code
                class="command">apt</code> não tem suporte para esses comandos.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.apt-upgrade"></a>6.2.3. Atualização do sistema</h3></div></div></div><a
            id="id-1.9.11.9.2"
            class="indexterm"></a><a
            id="id-1.9.11.9.3"
            class="indexterm"></a><a
            id="id-1.9.11.9.4"
            class="indexterm"></a><a
            id="id-1.9.11.9.5"
            class="indexterm"></a><div
            class="para">
				Atualizações regulares são recomendadas, pois elas incluem as últimas atualizações de segurança. Para atualizar, use <code
              class="command">apt upgrade</code>, <code
              class="command">apt-get upgrade</code> ou <code
              class="command">aptitude safe-upgrade</code> (claro que depois de um <code
              class="command">apt update</code>). Este comando busca por pacotes instalados que possam ser atualizados sem remover nenhum pacote. Em outras palavras, o objetivo é garantir uma atualização com o mínimo de transtorno possível. O <code
              class="command">apt-get</code> é um pouco mais pesado que <code
              class="command">aptitude</code> ou o <code
              class="command">apt</code> por que ele vai se recusar a instalar pacotes que não estavam instalados antes.
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.apt-pdiff"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DICA</em></span> Atualização incremental</strong></p></div></div></div><div
              class="para">
				Como já explicado, o objetivo do comando <code
                class="command">apt update</code> é baixar para cada pacote fonte o arquivo <code
                class="filename">Packages</code> (ou <code
                class="filename">Sources</code>) correspondente. Entretanto, mesmo depois de uma compressão com <code
                class="command">bzip2</code>, estes arquivos podem continuar muito grandes (o <code
                class="filename">Packages.xz</code> da seção <span
                class="foreignphrase"><em
                  class="foreignphrase">main</em></span> da <span
                class="distribution distribution">Jessie</span> ocupa mais de 6 MB). Se você quiser atualizar com frequência, o download pode levar muito tempo.
			</div><div
              class="para">
				Para acelerar o processo do APT pode baixar arquivos “diff” contendo as mudanças desde o update anterior, ao invés de todo o arquivo. Para isto, os espelhos oficiais do Debian distribuem arquivos diferentes que listam as diferenças entre uma versão do arquivos <code
                class="filename">Packages</code> e a versão seguinte. Eles são gerados em cada atualização dos arquivamentos e um histórico de uma semana é guardado. Cada um destes arquvios de "diff" apenas ocupam uns poucos kilobytes para a <span
                class="distribution distribution">Unstable</span>, de forma que a quatidade de dados baixados por um <code
                class="command">apt update</code> semanal é às vezes dividido por 10. Para distribuições como a <span
                class="distribution distribution">Stable</span> e a <span
                class="distribution distribution">Testing</span>, que mudam menos, o ganho é ainda mais visível.
			</div><div
              class="para">
				Entretanto, algumas vezes é interessante forçar o download do arquivo <code
                class="filename">Packages</code> todo, especialmente quando a última atualização é muito antiga e o mecanismo de diferenças incremental não vai ajudar muito. Isto também pode ser interessante quando o acesso à rede é muito rápido mas o processador da máquina que vai atualizar nem tanto, pois o tempo economizado para o download é maior que o perdido para juntar as versões dos arquivos (iniciando com a versão antiga e aplicando as diferenças baixadas). Para fazer isto, você pode usar o parâmetro de configuração <code
                class="literal">Acquire::Pdiffs</code> e configurar ele para <code
                class="literal">false</code>.
			</div></div><div
            class="para">
				O <code
              class="command">apt</code> vai geralmente selecionar o número de versão mais recente (exceto para pacotes de <span
              class="distribution distribution">Experimental</span> e <span
              class="distribution distribution">stable-backports</span>, que são normalmente ignorados independente do número da versão). Se você especificar a versão <span
              class="distribution distribution">Testing</span> ou a <span
              class="distribution distribution">Unstable</span> em seu arquivo <code
              class="filename">sources.list</code>, um <code
              class="command">apt upgrade</code> vai trocar a maioria do seu sistema <span
              class="distribution distribution">Stable</span> para <span
              class="distribution distribution">Testing</span> ou <span
              class="distribution distribution">Unstable</span>, que pode não ser o que você pretende.
			</div><div
            class="para">
				Para dizer ao <code
              class="command">apt</code> para usar uma distribuição específica quando buscando por pacotes para atualizar, você precisa usar a opção <code
              class="literal">-t</code> ou <code
              class="literal">--target-release</code>, seguida do nome da distribuição que você quer (por exemplo: <code
              class="command">apt -t stable upgrade</code>). para evitar ficar usando esta opção toda vez que usa o <code
              class="command">apt</code>, você pode adicionar <code
              class="literal">APT::Default-Release "stable";</code> no arquivo <code
              class="filename">/etc/apt/apt.conf.d/local</code>.
			</div><a
            id="id-1.9.11.9.10"
            class="indexterm"></a><a
            id="id-1.9.11.9.11"
            class="indexterm"></a><a
            id="id-1.9.11.9.12"
            class="indexterm"></a><a
            id="id-1.9.11.9.13"
            class="indexterm"></a><a
            id="id-1.9.11.9.14"
            class="indexterm"></a><div
            class="para">
				Para atualizações mais importantes, como mudar de uma versão principal do Debian para a seguinte, você precisa usar <code
              class="command">apt full-upgrade</code>. Com esta instrução, o <code
              class="command">apt</code> vai completar a atualização mesmo se ele tiver que remover alguns pacotes obsoletos ou instalar novas dependências. Este também é o comando usado pelos usuários que trabalham diariamente com a versão Debian <span
              class="distribution distribution">Unstable</span> e seguem sua evolução dia após dia. É tão simples que dispensa explicações: a reputação do APT é baseada nesta fantástica funcionalidade.
			</div><div
            class="para">
				Diferente do <code
              class="command">apt</code> e <code
              class="command">aptitude</code>, o <code
              class="command">apt-get</code> não conhece o comando <code
              class="command">full-upgrade</code>. Em seu lugar, você deve usar <code
              class="command">apt-get dist-upgrade</code> (”atualização de distribuição”), o histórico e bem conhecido comando que o <code
              class="command">apt</code> e <code
              class="command">aptitude</code> também aceitam para conveniência dos usuários que ficaram acostumados com ele.
			</div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.apt-config"></a>6.2.4. Opções de configuração</h3></div></div></div><a
            id="id-1.9.11.10.2"
            class="indexterm"></a><a
            id="id-1.9.11.10.3"
            class="indexterm"></a><a
            id="id-1.9.11.10.4"
            class="indexterm"></a><div
            class="para">
				Além dos elementos de configuração já mencionados, é possível configurar certos aspectos do APT adicionando diretivas num arquivo do diretório <code
              class="filename">/etc/apt/apt.conf.d/</code>. Lembre, por exemplo, que é possível para o APT pedir ao <code
              class="command">dpkg</code> para ignorar erros de conflito em arquivos ao especificar <code
              class="literal">DPkg::options { "--force-overwrite"; }</code>.
			</div><div
            class="para">
				Se a rede só puder ser acessada através de um proxy, adicione uma linha como <code
              class="literal">Acquire::http::proxy "http://<em
                class="replaceable">seu-proxy</em>:3128"</code>. Para um proxy FTP, escreva <code
              class="literal">Acquire::ftp::proxy "ftp://<em
                class="replaceable">seu-proxy</em>"</code>. Para descobrir mais opções de configuração, leia a página de manual do <span
              class="citerefentry"><span
                class="refentrytitle">apt.conf</span>(5)</span> com o comando <code
              class="command">man apt.conf</code> (para detalhes sobre páginas de manual, veja <a
              class="xref"
              href="solving-problems.html#sect.manual-pages">Seção 7.1.1, “Páginas de Manual”</a>).
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.directory.d"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DE VOLTA AO BÁSICO</em></span> Diretórios terminados em <code
                        class="filename">.d</code></strong></p></div></div></div><a
              id="id-1.9.11.10.7.2"
              class="indexterm"></a><div
              class="para">
				Directórios com um sufixo <code
                class="filename">.d</code> estão sendo cada vez mais usados. Cada diretório representa um arquivo de configuração que é separado em múltiplos arquivos. Neste sentido, todos os arquivos em <code
                class="filename">/etc/apt/apt.conf.d/</code> são instruções para a configuração do APT. APT inclui eles em ordem alfabética, assim os últimos podem altera um elemento de configuração definido em um dos primeiros.
			</div><div
              class="para">
				Esta estrutura trás alguma flexibilidade ao administrador da máquina e aos mantenedores de pacotes. Na verdade, o administrador pode modificar facilmente a configuração do software ao adicionar um arquivo pronto para usar no diretório em questão sem ter que alterar um arquivo existente. mantenedores de pacotes usam a mesma abordagem quando precisam adaptar a configuração de outro software para garantir que ele coexista perfeitamente com o seu. A política Debian proíbe explicitamente modificare arquivos de configuração de outros pacotes — apenas usuários tem autorização para isto. Lembre que durante uma atualização de pacote, o usuário escolhe a versão do arquivo de configuração que deve ser mantida quando uma modificação é detectada. Qualquer modificação externa do arquivo irá ativar este requisito, que irá perturbar o administrador, que é a certeza de não ter mudificado nada.
			</div><div
              class="para">
				Sem um diretório <code
                class="filename">.d</code> é impossível para um pacote externo mudar as configurações de um programa sem modificar seu arquivo de configuração. Ao invés disto, ele deve pedir para o usuário fazer isto ele próprio e descrever no arquivo <code
                class="filename">/usr/share/doc/<em
                  class="replaceable">pacote</em>/README.Debian</code> as operações a serem feitas.
			</div><div
              class="para">
				Dependendo da aplicação, o diretório <code
                class="filename">.d</code> é usado diretamente ou gerenciado por um script externo que vai concatenar todos os arquivos para criar um outro arquivo de configuração. É importante executar o script depois de qualquer mudança neste diretório, para que as modificações mais recentes sejam aplicadas. Da mesma forma, é importante não trabalhar diretamente no arquivo de configuração criado automaticamente, já que toda alteração será perdida na próxima execução do script. A escolha de um método (diretório <code
                class="filename">.d</code> usado diretamente ou arquivo gerado a partir do diretório) é normalmente ditada por restrições de implementação, mas em ambos os casos os ganhos em termos de flexibilidade de configuração superam as pequenas complicações que são trazidas. O servidor de email Exim 4 é um exemplo do método de arquivo gerado: ele pode ser configurado através de vários arquivos (<code
                class="filename">/etc/exim4/conf.d/*</code>) que são concatenados em <code
                class="filename">/var/lib/exim4/config.autogenerated</code> pelo comando <code
                class="command">update-exim4.conf</code>.
			</div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.apt.priorities"></a>6.2.5. Gerenciar prioridades de pacote</h3></div></div></div><div
            class="para">
				Um dos mais importantes aspectos na configuração do APT é o gerenciamento de prioridades associadas com cadafonte de pacote ("package source"). Por Exemplo, você pode querer extender uma distribuição com um ou dois pacotes mais novos da <span
              class="distribution distribution">Testing</span>, <span
              class="distribution distribution">Unstable</span> ou <span
              class="distribution distribution">Experimental</span>. É possível atribuir uma prioridade a cada pacote disponível (o mesmo pacote pode ter várias prioridades dependendo da sua versão ou da distribuição que o disponibiliza). Estas prioridades vão influenciar o comportamento do APT: para cada pacote, ele vai sempre selecionar a versão com a prioridade mais alta (exceto se esta versão é mais velha que a instalada e se sua prioridade for menor que 1000).
			</div><a
            id="id-1.9.11.11.3"
            class="indexterm"></a><a
            id="id-1.9.11.11.4"
            class="indexterm"></a><a
            id="id-1.9.11.11.5"
            class="indexterm"></a><a
            id="id-1.9.11.11.6"
            class="indexterm"></a><a
            id="id-1.9.11.11.7"
            class="indexterm"></a><a
            id="id-1.9.11.11.8"
            class="indexterm"></a><a
            id="id-1.9.11.11.9"
            class="indexterm"></a><div
            class="para">
				O APT define várias prioridades padrão. Cada versão de pacote instalada tem a prioridade 100. uma versão não instalada tem a prioridade 500 por padrão, mas pode pular para 990 se for parte da versão de destino (definida com a opção de linha de comando <code
              class="literal">-t</code> ou a diretiva de configuração <code
              class="literal">APT::Default-Release</code>).
			</div><div
            class="para">
				Você pode modificar as prioridades adicionando entradas no arquivo <code
              class="filename">/etc/apt/preferences</code> com os nomes dos pacotes afetados, sua versão, sua origem e sua nova prioridade.
			</div><div
            class="para">
				O APT nunca vai instalar uma versão mais antiga de um pacote (quer dizer, um pacote cujo número de versão é menor que o que está atualmente instalado) exceto se sua prioridade for maior que 1000. O APT vai sempre instalar o pacote de prioridade mais alta que satisfizer esta restrição. Se dois pacotes têm a mesma prioridade, o APT instala o mais novo (o que tiver o maior número de versão). Se dois pacotes da mesma versão tiverem a mesma prioridade mas conteúdos diferentes, o APT instala a versão que não estiver instalada (esta regra foi criada para o caso onde uma atualização de pacote que não incrementa o número de revisão, que é normalmente necessário).
			</div><div
            class="para">
				Em termos mai concretos, umpacote cuja prioridade é menor que 0 nunca vai ser instalado. Um pacote com a prioridade entre 0 100 só vai ser instalado se nenhuma outra versão do pacote estiver instalada. Com uma prioridade entre 100 e 500, o pacote só será instalado se não houver uma versão mais nova instalada ou disponível em outra distribuição. Um pacote de prioridade entre 501 e 990 só será instalado se não houver uma versão mais nova instalada ou disponível numa distribuição destino. Com uma prioridade entre 990 e 1000, o pacote será instalado a menos que a versão instalada seja mais nova. Uma prioridade maior que 1000 vai sempre levar à instalação do pacote, mesmo se ela força o APT a fazer downgrade para uma versão mais antiga.
			</div><div
            class="para">
				Quando o APT verifica o <code
              class="filename">/etc/apt/preferences</code>, ele leva em conta primeiro as entradas mais específicas (geralmente aquelas especificando o pacote em consideração), para depois ir para as mais genéricas (incluindo, por exemplo, todos os pacotes de uma distribuição). Se várias entradas genéricas existirem, o primeiro "match" é usado. O critério de seleção disponível inclui o nome do pacote e a fonte que o fornece. Cada fonte de pacote é identificada pela informação contida em um arquivo <code
              class="filename">Release</code> que o APT baixa junto com os arquivos <code
              class="filename">Packages</code>. Ele especifica a origem (normalmente "Debian" para os pacotes de espelhos oficiais, mas pode ser também um nome de pessoa ou organização para repositórios de terceiros). Ele também dá o nome da distribuição (normalmente <span
              class="distribution distribution">Stable</span>, <span
              class="distribution distribution">Testing</span>, <span
              class="distribution distribution">Unstable</span> ou <span
              class="distribution distribution">Experimental</span> para as distribuições padrão fornecidas pelo Debian) junto com sua versão (por exemplo 8 para o Debian <span
              class="distribution distribution">Jessie</span>). Vamos dar uma olhada na sintaxe em alguns estudos de caso reais deste mecanismo.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>CASO ESPECÍFICO</em></span> Prioridade do <span
                        class="distribution distribution">experimental</span></strong></p></div></div></div><a
              id="id-1.9.11.11.15.2"
              class="indexterm"></a><div
              class="para">
				Se você listou a <span
                class="distribution distribution">Experimental</span> em seu arquivo <code
                class="filename">sources.list</code>, os pacotes correspondentes quase nunca vão ser instalados, por que a prioridade padrão do APT é 1. Este é, claro, um caso particular, projetado para evitar que usuários instalem pacotes da <span
                class="distribution distribution">Experimental</span> por engano. Os pacotes podem apenas ser intalados digitando <code
                class="command">aptitude install <em
                  class="replaceable">pacote</em>/experimental</code> — usuários digitando este comando podem apenas ser avisados dos riscos que estão assumindo. Ainda é possível (embora <span
                class="emphasis"><em>não</em></span> recomendado) tratar pacotes da <span
                class="distribution distribution">Experimental</span> como aqueles de outras distribuições dando a eles uma prioridade de 500. Isto é feito com uma entrada específica no <code
                class="filename">/etc/apt/preferences</code>:
			</div><div
              class="informalexample"><pre
                class="programlisting">Package: *
Pin: release a=experimental
Pin-Priority: 500</pre></div></div><div
            class="para">
				Vamos supor que você só quer usar os pacotes da versão estável do Debian. As previstas em outras versões não devem ser instaladas exceto se explicitamente solicitado. Você poderia escrever as seguintes entradas do arquivo <code
              class="filename">/etc/apt/preferences</code> :
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: *
Pin: release a=stable
Pin-Priority: 900

Package: *
Pin: release o=Debian
Pin-Priority: -10</pre></div><div
            class="para">
				<code
              class="literal">a=stable</code> define o nome da distribuição selecionada. <code
              class="literal">o=Debian</code> limita o escopo para pacotes cuja origem seja "Debian".
			</div><div
            class="para">
				Suponha agora que você tenha um servidor com vários programas locais que dependem da versão 5.14 do Perl e que você queira garantir que atualizações não vão instalar outra versão dele. Você pode usar esta entrada:
			</div><div
            class="informalexample"><pre
              class="programlisting">Package: perl
Pin: version 5.14*
Pin-Priority: 1001</pre></div><div
            class="para">
				A documentação de referência para este arquivo de configuração está disponível na página de manual <span
              class="citerefentry"><span
                class="refentrytitle">apt_preferences</span>(5)</span>, que você lê com <code
              class="command">man apt_preferences</code>.
			</div><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DICA</em></span> Comentários no <code
                        class="filename">/etc/apt/preferences</code></strong></p></div></div></div><a
              id="id-1.9.11.11.22.2"
              class="indexterm"></a><a
              id="id-1.9.11.11.22.3"
              class="indexterm"></a><a
              id="id-1.9.11.11.22.4"
              class="indexterm"></a><div
              class="para">
				Não existe uma sintaxe oficial para colocar comentários no arquivo <code
                class="filename">/etc/apt/preferences</code>, mas algumas descrições textuais pode ser fornecidas colocando um ou mais campos "<code
                class="literal">Explanation</code>" no começo de cada entrada:
			</div><div
              class="informalexample"><pre
                class="programlisting">Explanation: O pacote xserver-xorg-video-intel fornecido
Explanation: na experimental pode ser usado com segurança
Package: xserver-xorg-video-intel
Pin: release a=experimental
Pin-Priority: 500</pre></div></div></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.apt-mix-distros"></a>6.2.6. Trabalhando com Distribuições Diversas</h3></div></div></div><div
            class="para">
				Sendo o <code
              class="command">apt</code> uma ferramenta assim tão maravilhosa, é tentador pegar pacotes de outras ditribuicões. Por exemplo, depois de instalar um sistema <span
              class="distribution distribution">Stable</span>, você pode querer tentar um pacote de software disponível na <span
              class="distribution distribution">Testing</span> ou <span
              class="distribution distribution">Unstable</span> sem divergir muito do estado inicial do sistema.
			</div><div
            class="para">
				Mesmo se você ocasionalmente encontrar problemas enquanto estiver misturando pacotes de distribuições diferentes, o <code
              class="command">apt</code> gerencia tal coexistência muito bem e limita os riscos de forma bastante efetiva. A melhor maneira de proceder é listando todas as distribuições usadas em <code
              class="filename">/etc/apt/sources.list</code> (algumas pessoas sempre botam as três distribuições, mas lembre-se que <span
              class="distribution distribution">Unstable</span> é reservada para usuários experientes) e definindo a sua distribuição de referência com o parâmetro <code
              class="literal">APT::Default-Release</code> (Veja <a
              class="xref"
              href="sect.apt-get.html#sect.apt-upgrade">Seção 6.2.3, “Atualização do sistema”</a>).
			</div><div
            class="para">
				Suponha que <span
              class="distribution distribution">Stable</span> é sua distribuição de referência mas que <span
              class="distribution distribution">Testing</span> e <span
              class="distribution distribution">Unstable</span> também estão listadas em seu arquivo <code
              class="filename">sources.list</code>. Neste caso, você pode usar <code
              class="command">apt- install <em
                class="replaceable">pacote</em>/testing</code> para instalar um pacote da <span
              class="distribution distribution">Testing</span>. Se a instalação falha devido a algumas dependências não-satisfeitas, deixe ela resolver estas dependências na <span
              class="distribution distribution">Testing</span> adicionando o parâmetro <code
              class="literal">-t testing</code>. O mesmo obviamente se aplica à <span
              class="distribution distribution">Unstable</span>.
			</div><div
            class="para">
				Nesta situação, atualizações (<code
              class="command">upgrade</code> e <code
              class="command">full-upgrade</code>) são feitas no <span
              class="distribution distribution">Stable</span> exceto para pacotes já atualizados para uma outra distribuição: estes vão seguir as atualizações disponíveis em outras distribuições. Nós iremos explicar este comportamento com a ajuda de prioridades padrão configuradas pelo APT abaixo. Não hesite em usar <code
              class="command">apt-cache policy</code> (veja a barra lateral <a
              class="xref"
              href="sect.apt-get.html#sidebar.apt-cache-policy"><span
                class="emphasis"><em>DICA</em></span> <code
                class="command">apt-cache policy</code></a>) para verificar as prioridades dadas.
			</div><div
            class="para">
				Tudo se baseia no fato de que o APT apenas considera pacotes com versão igual ou superior à instalada (assumindo que o <code
              class="filename">/etc/apt/preferences</code> não foi usado para forçar prioridades maiores que 1000 para alguns pacotes).
			</div><div
            class="sidebar"><a
              xmlns=""
              id="sidebar.apt-cache-policy"></a><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>DICA</em></span> <code
                        class="command">apt-cache policy</code></strong></p></div></div></div><div
              class="para">
				Para entender melhor o mecanismo das prioridades, não hesite em executar <code
                class="command">apt-cache policy</code> para exibir as prioridades padrão associadas a cada fonte de pacote. Você também pode usar <code
                class="command">apt-cache policy <em
                  class="replaceable">pacote</em></code> para exibir as prioridades de todas as versões disponíveis de um dado pacote.
			</div></div><div
            class="para">
				Suponha que você instalou a versão 1 de um primeiro pacote da <span
              class="distribution distribution">Stable</span> e que versão 2 e 3 estão respectivamente disponíveis na <span
              class="distribution distribution">Testing</span> e na <span
              class="distribution distribution">Unstable</span>. A versão instalada tem uma prioridade de 100 mas a versão disponível na <span
              class="distribution distribution">Stable</span> (exatamente a mesma) tem uma prioridade de 990 (porque ela é parte da "target release"). Pacotes na <span
              class="distribution distribution">Testing</span> e na <span
              class="distribution distribution">Unstable</span> tem a prioridade de 500 (a prioridade padrão de uma versão não instalada). O ganhador é então a versão 1 com uma prioridade de 990. O pacote “fica na <span
              class="distribution distribution">Stable</span>”.
			</div><div
            class="para">
				Tomemos o exemplo de outro pacote cuja versão 2 foi instalada da <span
              class="distribution distribution">Testing</span>. A versão 1 está disponível na <span
              class="distribution distribution">Stable</span> e a versão 3 na <span
              class="distribution distribution">Unstable</span>. A versão 1 (de prioridade 990 — logo, menor que 1000) é descartada pois é menor que a versão instalada. Sobram apenas as versões 2 e 3, ambas de prioridade 500. Perante esta alternativa, o APT seleciona a versão mais nova, aquela da <span
              class="distribution distribution">Unstable</span>. Se você não quer que um pacote instalado da <span
              class="distribution distribution">Testing</span> migre para a <span
              class="distribution distribution">Unstable</span>, você terá que atribuir uma prioridade menor que 500 (490 por exemplo) para pacotes vindo da <span
              class="distribution distribution">Unstable</span>. Você pode modificar o <code
              class="filename">/etc/apt/preferences</code> para obter este efeito:
			</div><pre
            class="programlisting">Package: *
Pin: release a=unstable
Pin-Priority: 490</pre></div><div
          class="section"><div
            class="titlepage"><div><div><h3
                  class="title"><a
                    xmlns=""
                    id="sect.automatic-tracking"></a>6.2.7. Rastreando Pacotes Instalados Automaticamente</h3></div></div></div><div
            class="para">
				Uma das funcionalidades essenciais do <code
              class="command">apt</code> é o rastreamento de pacotes instalados somente através de dependências. Estes pacotes são chamados de "automático", e muitas vezes incluem bibliotecas, por exemplo.
			</div><div
            class="para">
				Com esta informação, quando os pacotes são removidos, os gerenciadores de pacotes podem computar uma lista de pacotes automáticos que não são mais necessários (porque não há nenhum pacote "instalado manualmente" dependendo deles). <code
              class="command">apt-get autoremove</code> vai se livrar desses pacotes. O <code
              class="command">aptitude</code> e o <code
              class="command">apt</code> não tem esse comando: o primeiro porque os remove automaticamente assim que são identificados, e o último provavelmente porque o usuário não precisará rodar manualmente tal comando Em todos os casos, as ferramentas exibem uma clara mensagem listando os pacotes afetados.
			</div><a
            id="id-1.9.11.13.4"
            class="indexterm"></a><a
            id="id-1.9.11.13.5"
            class="indexterm"></a><a
            id="id-1.9.11.13.6"
            class="indexterm"></a><a
            id="id-1.9.11.13.7"
            class="indexterm"></a><div
            class="para">
				É um bom hábito marcar como automático qualquer pacote que você não precisa diretamente de modo que eles são automaticamente removidos quando eles não são mais necessários.<code
              class="command">apt-mark auto <em
                class="replaceable">pacote</em></code> marcará o pacote dado como automático enquanto <code
              class="command">apt-mark manual <em
                class="replaceable">pacote</em></code> faz o oposto. <code
              class="command">aptitude markauto</code> e <code
              class="command">aptitude unmarkauto</code> trabalham da mesma forma, embora eles ofereçam mais recursos para a marcação de muitos pacotes de uma vez (veja <a
              class="xref"
              href="sect.apt-frontends.html#sect.aptitude">Seção 6.4.1, “<code
                class="command">aptitude</code>”</a>). A interface interativa baseada em console do <code
              class="command">aptitude</code> também torna mais fácil para analisar a "opção automático" em muitos pacotes.
			</div><a
            id="id-1.9.11.13.9"
            class="indexterm"></a><div
            class="para">
				Alguém pode querer saber porque um pacote foi automaticamente instalado no sistema. Para obter esta informação na linha de comando, você pode usar <code
              class="command">aptitude why <em
                class="replaceable">pacote</em></code> (<code
              class="command">apt</code> e <code
              class="command">apt-get</code> não tem recurso semelhante):
			</div><pre
            class="screen"><code
              class="computeroutput">$ </code><strong
              class="userinput"><code>aptitude why python-debian
</code></strong><code
              class="computeroutput">i   aptitude         Recommends apt-xapian-index         
i A apt-xapian-index Depends    python-debian (&gt;= 0.1.15)
</code></pre><div
            class="sidebar"><div
              class="titlepage"><div><div><p
                    class="title"><strong><span
                        class="emphasis"><em>ALTERNATIVA</em></span> <code
                        class="command">deborphan</code> e <code
                        class="command">debfoster</code></strong></p></div></div></div><a
              id="id-1.9.11.13.12.2"
              class="indexterm"></a><a
              id="id-1.9.11.13.12.3"
              class="indexterm"></a><div
              class="para">
				Nos dias em que <code
                class="command">apt</code>, <code
                class="command">apt-get</code> e <code
                class="command">aptitude</code> não foram capazes de rastrear pacotes automáticos, havia dois utilitários que produziam listas de pacotes desnecessários: <code
                class="command">deborphan</code> e <code
                class="command">debfoster</code>.
			</div><div
              class="para">
				<code
                class="command">deborphan</code> é o mais rudimentar dos dois. Ele simplesmente varre as seções <code
                class="literal">libs</code> e <code
                class="literal">oldlibs</code> (na ausência de instruções complementares) procurando por pacotes atualmente instalados e que nenhum outro pacote dependa. A lista resultante pode servir como uma base para remover pacotes desnecessários.
			</div><div
              class="para">
				<code
                class="command">debfoster</code> tem uma abordagem mais elaborada, parecida com a de um APT: Ele mantém uma lista de pacotes que foram explicitamente instalados, e lembra que pacotes são realmente requeridos entre cada invocação. Se novos pacotes aparecem no sistema e se o <code
                class="command">debfoster</code> não reconhece eles como pacotes requeridos, eles serão mostrados na tela junto com uma lista de suas dependências. O programa então oferece uma escolha: remover o pacote (possivelmente junto com tudo que depende dele), marcá-lo como explicitamente requerido, ou ignorâ-lo temporariamente.
			</div></div></div></div><ul
        class="docnav"><li
          class="previous"><a
            accesskey="p"
            href="apt.html"><strong>Anterior</strong>Capítulo 6. Manutenções e atualizações: As ferram...</a></li><li
          class="up"><a
            accesskey="u"
            href="#"><strong>Acima</strong></a></li><li
          class="home"><a
            accesskey="h"
            href="index.html"><strong>Principal</strong></a></li><li
          class="next"><a
            accesskey="n"
            href="sect.apt-cache.html"><strong>Próxima</strong>6.3. O Comando apt-cache</a></li></ul></body></html>
